
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ae-plugins.docsforadobe.dev/effect-details/multi-frame-rendering-in-ae/">
      
      
        <link rel="prev" href="../../effect-basics/errors/">
      
      
        <link rel="next" href="../effect-details/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>Multi-Frame Rendering in AE - After Effects C++ SDK Guide</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d7758b05.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../../css/print-site.css">
    
      <link rel="stylesheet" href="../../css/print-site-material.css">
    
      <link rel="stylesheet" href="../../_static/extra.css">
    
      <link rel="stylesheet" href="../../docs/_global/css/global.css">
    
      <link rel="stylesheet" href="../../docs/_global/css/global-syntax-highlight.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#multi-frame-rendering-in-ae" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
  Welcome to the new docsforadobe guide!

  This is a work in progress.

  Please provide all feedback via
  <a ref="me" href="https://github.com/orgs/docsforadobe/discussions">
    <span class="twemoji">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 1h8.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 10.25 10H7.061l-2.574 2.573A1.458 1.458 0 0 1 2 11.543V10h-.25A1.75 1.75 0 0 1 0 8.25v-5.5C0 1.784.784 1 1.75 1M1.5 2.75v5.5c0 .138.112.25.25.25h1a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.75.75 0 0 1 .53-.22h3.5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25m13 2a.25.25 0 0 0-.25-.25h-.5a.75.75 0 0 1 0-1.5h.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 14.25 12H14v1.543a1.458 1.458 0 0 1-2.487 1.03L9.22 12.28a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l2.22 2.22v-2.19a.75.75 0 0 1 .75-.75h1a.25.25 0 0 0 .25-.25Z"/></svg>
    </span>
    <strong>the org's discussion forum</strong>
  </a>.

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://docsforadobe.dev" title="After Effects C++ SDK Guide" class="md-header__button md-logo" aria-label="After Effects C++ SDK Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            After Effects C++ SDK Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Multi-Frame Rendering in AE
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/docsforadobe/after-effects-plugin-guide/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    after-effects-plugin-guide
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://docsforadobe.dev" title="After Effects C++ SDK Guide" class="md-nav__button md-logo" aria-label="After Effects C++ SDK Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    After Effects C++ SDK Guide
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/docsforadobe/after-effects-plugin-guide/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    after-effects-plugin-guide
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Version History
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/what-can-i-do/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What Can I Do With This SDK?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/other-integration-possibilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other Integration Possibilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/sdk-audience/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDK Audience
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/whats-new/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What's New
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/how-to-start-creating-plug-ins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How To Start Creating Plug-ins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/sample-projects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sample Projects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/debugging-plug-ins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debugging Plug-ins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/compatibility-across-multiple-versions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compatibility Across Multiple Versions?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/third-party-plug-in-hosts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Third-party Plug-in Hosts?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/pipl-resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PiPL Resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/where-installers-should-put-plug-ins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Where Installers Should Put Plug-ins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/localization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Localization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/apple-silicon-support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apple Silicon Support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/symbol-export/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exporting Symbols in Effects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/next-steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Next Steps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Effect Basics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Effect Basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-basics/effect-basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Effect Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-basics/entry-point/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entry Point
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-basics/command-selectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command Selectors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-basics/PF_InData/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PF_InData
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-basics/PF_OutData/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PF_OutData
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-basics/parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-basics/PF_ParamDef/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PF_ParamDef
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-basics/PF_EffectWorld/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PF_EffectWorld / PF_LayerDef
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-basics/errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Errors
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Effect Details
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Effect Details
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Multi-Frame Rendering in AE
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Multi-Frame Rendering in AE
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Page Contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
	<a href="#multi-frame-rendering-effect-updates-with-march-2021-sdk" class="md-nav__link">
		<span class="md-ellipsis">
			Multi-Frame Rendering Effect Updates with March 2021 SDK
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#implications-to-command-selectors-with-multi-frame-rendering" class="md-nav__link">
		<span class="md-ellipsis">
			Implications to Command Selectors with Multi-Frame Rendering
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#sequence-data-in-multi-frame-rendering" class="md-nav__link">
		<span class="md-ellipsis">
			Sequence Data in Multi-Frame rendering
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#compute-cache-for-multi-frame-rendering" class="md-nav__link">
		<span class="md-ellipsis">
			Compute Cache For Multi-Frame Rendering
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="Compute Cache For Multi-Frame Rendering">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#when-would-you-use-the-compute-cache" class="md-nav__link">
		<span class="md-ellipsis">
			When would you use the Compute Cache?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#how-do-i-enable-the-compute-cache" class="md-nav__link">
		<span class="md-ellipsis">
			How do I enable the Compute Cache?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#what-does-it-mean-for-an-effect-to-be-thread-safe" class="md-nav__link">
		<span class="md-ellipsis">
			What does it mean for an effect to be thread-safe?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#how-to-locate-the-static-and-global-variables-in-your-effects" class="md-nav__link">
		<span class="md-ellipsis">
			How to locate the static and global variables in your effects
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="How to locate the static and global variables in your effects">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#on-macos" class="md-nav__link">
		<span class="md-ellipsis">
			On MacOS
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#on-windows" class="md-nav__link">
		<span class="md-ellipsis">
			On Windows
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#what-to-do-if-you-have-static-and-globals-in-your-effects" class="md-nav__link">
		<span class="md-ellipsis">
			What to do if you have static and globals in your effects
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="What to do if you have static and globals in your effects">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#could-the-data-be-easily-passed-between-functions-instead-without-a-change-in-behavior" class="md-nav__link">
		<span class="md-ellipsis">
			Could the data be easily passed between functions instead without a change in behavior?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#could-the-data-be-initialized-before-you-execute-your-code-eg-a-lookup-table-a-const-variable" class="md-nav__link">
		<span class="md-ellipsis">
			Could the data be initialized before you execute your code (e.g. a lookup table, a const variable)?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#is-the-data-initialized-once-at-runtime-based-on-data-that-doesnt-change-on-subsequent-renders" class="md-nav__link">
		<span class="md-ellipsis">
			Is the data initialized once at runtime based on data that doesn't change on subsequent renders?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#the-data-has-to-stay-staticglobal-not-being-a-const-but-each-render-thread-can-have-its-own-copy-of-the-data" class="md-nav__link">
		<span class="md-ellipsis">
			The data has to stay static/global not being a const. But each render thread can have its own copy of the data.
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#the-data-has-to-stay-staticglobal-not-being-a-const-and-each-thread-needs-to-read-and-write-from-the-most-up-to-date-state-rare" class="md-nav__link">
		<span class="md-ellipsis">
			The data has to stay static/global not being a const and each thread needs to read and write from the most up-to-date state. (rare)
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#setting-an-effect-as-thread-safe" class="md-nav__link">
		<span class="md-ellipsis">
			Setting an Effect as Thread-safe
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#how-to-test-whether-an-effect-is-thread-safe" class="md-nav__link">
		<span class="md-ellipsis">
			How to test whether an effect is Thread-Safe
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="How to test whether an effect is Thread-Safe">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#enable-multi-frame-rendering" class="md-nav__link">
		<span class="md-ellipsis">
			Enable Multi-Frame Rendering
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#test-your-effect" class="md-nav__link">
		<span class="md-ellipsis">
			Test your effect
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#thread-safe-first-party-effects" class="md-nav__link">
		<span class="md-ellipsis">
			Thread-Safe First Party Effects
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Effect Details
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accessing-function-suites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing the After Effects Function Suites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memory-allocation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memory Allocation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../image-buffer-management-functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image Buffer Management Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../iteration-suites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Iteration Suites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphics-utility-suites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graphics Utility Suites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../interaction-callback-functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interaction Callback Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pixel-aspect-ratio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pixel Aspect Ratio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parameters-floating-point-values/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parameters & Floating Point Values
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parameter-supervision/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parameter Supervision
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../global-sequence-frame-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global, Sequence, & Frame Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../arbitrary-data-parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arbitrary Data Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../useful-utility-functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Useful Utility Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../motion-blur/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Motion Blur
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../working-with-paths/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working With Paths
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accessing-camera-light-information/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing Camera & Light Information
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../color-space-conversion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Color Space Conversion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../changing-parameter-orders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changing Parameter Orders, the Nice Way
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tips-tricks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tips & Tricks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compute-cache-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compute Cache API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SmartFX
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            SmartFX
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../smartfx/smartfx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SmartFX
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Effect UI & Events
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Effect UI & Events
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-ui-events/effect-ui-events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Effect UI & Events
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-ui-events/PF_EventExtra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PF_EventExtra
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-ui-events/PF_EventUnion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PF_EventUnion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-ui-events/custom-ui-and-drawbot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom UI & Drawbot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-ui-events/ui-callbacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UI Callbacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../effect-ui-events/tips-and-tricks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tips & Tricks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Audio
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Audio
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../audio/audio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../audio/global-outflags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global Outflags
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../audio/audio-data-structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Data Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../audio/audio-specific-float-slider-variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio-Specific Float Slider Variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../audio/accessing-audio-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing Audio Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../audio/audio-considerations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Considerations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AEGPs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            AEGPs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aegps/aegps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AEGPs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aegps/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aegps/data-types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aegps/implementation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aegps/aegp-suites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AEGP Suites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aegps/cheating-effect-usage-of-aegp-suites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cheating Effect Usage of AEGP Suites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aegps/aegp-details/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AEGP Details
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Artisans
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Artisans
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../artisans/artisans/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Artisans
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../artisans/artisan-data-types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Artisan Data Types
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AEIOs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            AEIOs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aeios/aeios/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AEIOs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aeios/calling-sequence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calling Sequence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aeios/AEIO_ModuleInfo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AEIO_ModuleInfo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aeios/new-kids-on-the-function-block/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    New Kids On The Function Block
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aeios/implementation-details/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementation Details
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Premiere Pro
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Premiere Pro
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ppro/ppro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Premiere Pro & Other Hosts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ppro/plug-in-installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plug-in Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ppro/basic-host-differences/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Host Differences
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ppro/multithreading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multithreading
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ppro/bigger-differences/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bigger Differences
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ppro/plug-ins-reloaded/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plug-Ins... Reloaded
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ppro/premiere-elements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Premiere Elements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ppro/unsupported-features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unsupported Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ppro/other-hosts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other Hosts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Page Contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
	<a href="#multi-frame-rendering-effect-updates-with-march-2021-sdk" class="md-nav__link">
		<span class="md-ellipsis">
			Multi-Frame Rendering Effect Updates with March 2021 SDK
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#implications-to-command-selectors-with-multi-frame-rendering" class="md-nav__link">
		<span class="md-ellipsis">
			Implications to Command Selectors with Multi-Frame Rendering
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#sequence-data-in-multi-frame-rendering" class="md-nav__link">
		<span class="md-ellipsis">
			Sequence Data in Multi-Frame rendering
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#compute-cache-for-multi-frame-rendering" class="md-nav__link">
		<span class="md-ellipsis">
			Compute Cache For Multi-Frame Rendering
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="Compute Cache For Multi-Frame Rendering">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#when-would-you-use-the-compute-cache" class="md-nav__link">
		<span class="md-ellipsis">
			When would you use the Compute Cache?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#how-do-i-enable-the-compute-cache" class="md-nav__link">
		<span class="md-ellipsis">
			How do I enable the Compute Cache?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#what-does-it-mean-for-an-effect-to-be-thread-safe" class="md-nav__link">
		<span class="md-ellipsis">
			What does it mean for an effect to be thread-safe?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#how-to-locate-the-static-and-global-variables-in-your-effects" class="md-nav__link">
		<span class="md-ellipsis">
			How to locate the static and global variables in your effects
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="How to locate the static and global variables in your effects">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#on-macos" class="md-nav__link">
		<span class="md-ellipsis">
			On MacOS
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#on-windows" class="md-nav__link">
		<span class="md-ellipsis">
			On Windows
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#what-to-do-if-you-have-static-and-globals-in-your-effects" class="md-nav__link">
		<span class="md-ellipsis">
			What to do if you have static and globals in your effects
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="What to do if you have static and globals in your effects">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#could-the-data-be-easily-passed-between-functions-instead-without-a-change-in-behavior" class="md-nav__link">
		<span class="md-ellipsis">
			Could the data be easily passed between functions instead without a change in behavior?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#could-the-data-be-initialized-before-you-execute-your-code-eg-a-lookup-table-a-const-variable" class="md-nav__link">
		<span class="md-ellipsis">
			Could the data be initialized before you execute your code (e.g. a lookup table, a const variable)?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#is-the-data-initialized-once-at-runtime-based-on-data-that-doesnt-change-on-subsequent-renders" class="md-nav__link">
		<span class="md-ellipsis">
			Is the data initialized once at runtime based on data that doesn't change on subsequent renders?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#the-data-has-to-stay-staticglobal-not-being-a-const-but-each-render-thread-can-have-its-own-copy-of-the-data" class="md-nav__link">
		<span class="md-ellipsis">
			The data has to stay static/global not being a const. But each render thread can have its own copy of the data.
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#the-data-has-to-stay-staticglobal-not-being-a-const-and-each-thread-needs-to-read-and-write-from-the-most-up-to-date-state-rare" class="md-nav__link">
		<span class="md-ellipsis">
			The data has to stay static/global not being a const and each thread needs to read and write from the most up-to-date state. (rare)
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#setting-an-effect-as-thread-safe" class="md-nav__link">
		<span class="md-ellipsis">
			Setting an Effect as Thread-safe
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#how-to-test-whether-an-effect-is-thread-safe" class="md-nav__link">
		<span class="md-ellipsis">
			How to test whether an effect is Thread-Safe
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="How to test whether an effect is Thread-Safe">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#enable-multi-frame-rendering" class="md-nav__link">
		<span class="md-ellipsis">
			Enable Multi-Frame Rendering
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#test-your-effect" class="md-nav__link">
		<span class="md-ellipsis">
			Test your effect
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#thread-safe-first-party-effects" class="md-nav__link">
		<span class="md-ellipsis">
			Thread-Safe First Party Effects
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/docsforadobe/after-effects-plugin-guide/edit/master/docs/effect-details/multi-frame-rendering-in-ae.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/docsforadobe/after-effects-plugin-guide/raw/master/docs/effect-details/multi-frame-rendering-in-ae.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="multi-frame-rendering-in-ae">Multi-Frame Rendering in AE<a class="headerlink" href="#multi-frame-rendering-in-ae" title="Permanent link">&para;</a></h1>
<p>In order to take advantage of modern hardware with more CPU cores and threads, After Effects 2022 and above now supports Multi-Frame Rendering. Multi-Frame rendering (MFR) allows multiple frames to be rendered concurrently thereby speeding up rendering and export of AE compositions.</p>
<p>Third-party effects can enable support of Multi-Frame Rendering through the AE Effects SDK by setting the following PF_OutFlag:</p>
<div class="highlight"><pre><span></span><code><span class="n">PF_OutFlag2_SUPPORTS_THREADED_RENDERING</span>
</code></pre></div>
<p>This flag indicates the effect supports rendering on multiple threads concurrently. Single or multiple applications of this effect on a layer can be called to render at the same time on multiple threads. Effects must be thread-safe before this flag is set. Please see the <a href="#what-does-it-mean-for-an-effect-to-be-thread-safe">What does it mean for an effect to be thread-safe?</a> section below for more information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When After Effects uses Multi-Frame Rendering, an effect that is not thread-safe and does not set this flag will force each render thread to enter and exit the effect code one thread at a time. This will significantly reduce the performance improvements that MFR provides and as such a warning icon will be shown in the Effects Control Window alongside the effect to warn the user of the performance impact.</p>
</div>
<hr />
<p>For effects that require writing to sequence_data during Render, a flag is available for backwards compatibility:</p>
<div class="highlight"><pre><span></span><code><span class="n">PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</span>
</code></pre></div>
<p>Each rendering thread will have its own instance of sequence_data that is not shared nor synchronized with other rendering threads. If the data stored in sequence_data is time-consuming to compute, the new <a href="#compute-cache-for-multi-frame-rendering">Compute Cache For Multi-Frame Rendering</a> should be utilized.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use of the <code>PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</code> flag requires compiling against the March 2021 SDK or later.</p>
</div>
<hr />
<h2 id="multi-frame-rendering-effect-updates-with-march-2021-sdk">Multi-Frame Rendering Effect Updates with March 2021 SDK<a class="headerlink" href="#multi-frame-rendering-effect-updates-with-march-2021-sdk" title="Permanent link">&para;</a></h2>
<p>The March 2021 SDK introduces new <code>sequence_data</code> behavior that is enabled starting with AE beta builds 22.0x6 (released on June 29th 2021). Any effects compiled with the June 2020 SDK must be recompiled with the March 2021 SDK to support Multi-Frame Rendering. The effects must also report to AE that they were compiled with at least version 13.25 though it is recommended to use the SDK constants PF_AE_PLUG_IN_VERSION and PF_AE_PLUG_IN_SUBVERS to automatically set the associated SDK.</p>
<p>The table below outlines the changes an effect will need to make to support the new behavior:</p>
<table>
<thead>
<tr>
<th>MFR &amp; Sequence Data Usage</th>
<th>Changes Needed with March 2021 SDK</th>
</tr>
</thead>
<tbody>
<tr>
<td>Plugin does not set PF_OutFlag2_SUPPORTS_THREADED_RENDERING</td>
<td>No changes needed. Effect and sequence_data will continue to work as it did in the past.</td>
</tr>
<tr>
<td>Plugin sets PF_OutFlag2_SUPPORTS_THREADED_RENDERING but neither reads nor writes to sequence_data during Render</td>
<td>Recompile the plugin with the March 2021 SDK, no other code changes are required.<br/><br/>If the plugin is not compiled with the March 2021 SDK, the plugin will stop utilizing MFR starting with AE 22.0x6.</td>
</tr>
<tr>
<td>Plugin sets PF_OutFlag2_SUPPORTS_THREADED_RENDERING but only reads sequence_data during Render</td>
<td>Recompile the plugin with the March 2021 SDK, update reading sequence_data via <code>PF_EffectSequenceDataSuite1</code> for thread-safe access. See <a href="../global-sequence-frame-data/#accessing-sequence_data-at-render-time-with-multi-frame-rendering">Accessing sequence_data at Render Time with Multi-Frame Rendering</a> for more information.</td>
</tr>
<tr>
<td>Plugin sets PF_OutFlag2_SUPPORTS_THREADED_RENDERING and reads and writes to sequence_data during Render</td>
<td>Recompile the plugin with the March 2021 SDK and modify the plugin to:<br/><br/>1. Utilize the <a href="../compute-cache-api/#compute-cache-api">Compute Cache API</a> for thread-safe cache access instead of reading/writing to sequence_data directly.  See <a href="#compute-cache-for-multi-frame-rendering">Compute Cache For Multi-Frame Rendering</a> for more information.<br/><br/>AND / OR<br/><br/>2. Add the <code>PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</code> to the effect to restore direct read/write access to sequence_data.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Effects compiled with the March 2021 SDK and using the PF_OutFlag2_SUPPORTS_THREADED_RENDERING flag and, optionally, the PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER flag will work with After Effects beta builds starting with 18.0 when the <code>PF_EffectSequeceDataSuite1</code> was introduced. Check for the presence of this suite if you need to support both sequence_data behaviors.</p>
</div>
<hr />
<h2 id="implications-to-command-selectors-with-multi-frame-rendering">Implications to Command Selectors with Multi-Frame Rendering<a class="headerlink" href="#implications-to-command-selectors-with-multi-frame-rendering" title="Permanent link">&para;</a></h2>
<p>UI selectors are still sent on the main thread, however <code>PF_Cmd_SEQUENCE_SETUP</code>, <code>PF_Cmd_SEQUENCE_RESETUP</code>, <code>PF_Cmd_SEQUENCE_SETDOWN</code>, <code>PF_Cmd_SMART_PRE_RENDER</code>, <code>PF_Cmd_RENDER</code> and <code>PF_Cmd_SMART_RENDER</code> may be sent on multiple threads at the same time as the UI selectors are being handled so all of these selectors must be thread safe.</p>
<p><code>PF_Cmd_GLOBAL_SETUP</code> and <code>PF_Cmd_GLOBAL_SETDOWN</code> selectors will only be sent on the main thread and will not be sent at the same time as any other selectors.</p>
<hr />
<h2 id="sequence-data-in-multi-frame-rendering">Sequence Data in Multi-Frame rendering<a class="headerlink" href="#sequence-data-in-multi-frame-rendering" title="Permanent link">&para;</a></h2>
<p>The <code>sequence_data</code> object and related Sequence Selectors have been used over the years to provide a way to store data during the effect's lifetime. Multi-Frame Rendering introduces some changes to be aware of:</p>
<p><strong>Changes as of June 2020</strong></p>
<ul>
<li>Multi-Frame rendering requires that After Effects marshal <code>sequence_data</code> to the render threads. In order to make this efficient for effects with <code>sequence_data</code> that require flattening with the <code>PF_OutFlag_SEQUENCE_DATA_NEEDS_FLATTENING</code> flag, these effects must now also set the <code>PF_OutFlag2_SUPPORTS_GET_FLATTENED_SEQUENCE_DATA</code> flag.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In a future version of After Effects, the requirement to set the <code>PF_OutFlag2_SUPPORTS_GET_FLATTENED_SEQUENCE_DATA</code> flag and handle the associated selector in the plugin will be enforced. A warning dialog will be added on load of any effect that does not meet this requirement.</p>
</div>
<p><strong>Changes as of March 2021</strong></p>
<ul>
<li>The <code>sequence_data</code> object is now const when read at Render time and should be accessed through the <code>PF_EffectSequenceDataSuite</code> interface.</li>
<li>Writing to <code>seqeunce_data</code> at render time is disabled by default and results will be undefined if <code>sequence_data</code> is attempted to be written to at render time.</li>
<li>If an effect must write to sequence_data at render time, it must set the <code>PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</code> flag which will tell After Effects to allow writes to <code>sequence_data</code> but it will be at the expense of performance. The <code>sequence_data</code> object will be duplicated to each render thread when the render begins, and each render thread will have its own independent copy of <code>sequence_data</code> to manage for the lifetime of the render. For performance reasons, it is preferred that the <a href="#compute-cache-for-multi-frame-rendering">Compute Cache For Multi-Frame Rendering</a> is utilized for writing any data required by the effect.</li>
</ul>
<hr />
<h2 id="compute-cache-for-multi-frame-rendering">Compute Cache For Multi-Frame Rendering<a class="headerlink" href="#compute-cache-for-multi-frame-rendering" title="Permanent link">&para;</a></h2>
<p>The Compute Cache provides a thread-safe cache as a replacement or supplement to Sequence Data where effects can compute, store and read data before or during Render.</p>
<h3 id="when-would-you-use-the-compute-cache">When would you use the Compute Cache?<a class="headerlink" href="#when-would-you-use-the-compute-cache" title="Permanent link">&para;</a></h3>
<ul>
<li>You should use the Compute Cache if your effect uses <code>sequence_data</code> and needs to write to or update <code>sequence_data</code> during Render, especially if the computation of needed data is time-consuming to calculate.</li>
<li>Without the Compute Cache, the effect will need to add the <code>PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</code> flag which will create unique copies of sequence_data per render thread. Each render thread may then need to perform the time-consuming calculations independently and won't be able to share the results between the render threads.</li>
<li>By using the Compute Cache, render threads can share the task of computing the data and reap the benefits of already computed data.</li>
<li>The Compute Cache API supports both single and multi-checkout computation tasks depending upon the needs of the effect. See the <a href="../compute-cache-api/#compute-cache-api">Compute Cache API</a> documentation for more information.</li>
</ul>
<h3 id="how-do-i-enable-the-compute-cache">How do I enable the Compute Cache?<a class="headerlink" href="#how-do-i-enable-the-compute-cache" title="Permanent link">&para;</a></h3>
<p>The Compute Cache API is available starting in the March 2021 SDK and the suite is enabled by default in After Effects 2022 and above builds.</p>
<p>See the <a href="../compute-cache-api/#compute-cache-api">Compute Cache API</a> documentation for implementation details and sample code.</p>
<hr />
<h2 id="what-does-it-mean-for-an-effect-to-be-thread-safe">What does it mean for an effect to be thread-safe?<a class="headerlink" href="#what-does-it-mean-for-an-effect-to-be-thread-safe" title="Permanent link">&para;</a></h2>
<p><strong>An effect is thread-safe when the implementation and shared data is guaranteed to be free of race conditions and is always in a correct state when accessed concurrently.</strong></p>
<p>To be more specific, the effect:</p>
<ol>
<li>Has no static or global variables OR, has static or global variables that are free of race conditions.</li>
<li>Does not write to <code>in_data-&gt;global_data</code> at render time. Reading can be done. Write in <code>PF_Cmd_GLOBAL_SETUP</code> and <code>PF_Cmd_GLOBAL_SETDOWN</code> only.</li>
<li>Does not write to <code>in_data-&gt;sequence_data</code> at render time or during <code>PF_Cmd_UPDATE_PARAMS_UI</code> event. Reading can be done via the PF_EffectSequenceDataSuite interface.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If an effect uses any blocking synchronization mechanisms, such as mutexes or gates, these must not be held when calling back into the host. Common calls would be when using a suite or making a checkout call. Failing to do so will very likely result in deadlocks.</p>
</div>
<hr />
<h2 id="how-to-locate-the-static-and-global-variables-in-your-effects">How to locate the static and global variables in your effects<a class="headerlink" href="#how-to-locate-the-static-and-global-variables-in-your-effects" title="Permanent link">&para;</a></h2>
<p>To help you locate the static and global variables in your effect, we've developed a <strong>Static Analyzer tool</strong> for you to use.
You can find the tool in this Git Repo: <a href="https://github.com/adobe/ae-plugin-thread-safety">https://github.com/adobe/ae-plugin-thread-safety</a></p>
<h3 id="on-macos">On MacOS<a class="headerlink" href="#on-macos" title="Permanent link">&para;</a></h3>
<ol>
<li>Clone/Download the Git Repo at the URL provided above</li>
<li>Find the bash script <code>check_symbols_for_thread_safety.sh</code> in the <strong>Mac</strong> folder</li>
<li>Navigate inside the package content of a plugin or effect and locate the binary files. (For example, the <strong>Curves.plugin</strong> has its binary file here: <code>/Applications/Adobe After Effects [your AE version]/Plug-ins/Effects/Curves.plugin/Contents/MacOS/Curves</code>)</li>
<li>To analyze the binary, run:
    <div class="highlight"><pre><span></span><code>check_symbols_for_thread_safety.sh<span class="w"> </span><span class="o">[</span>Binary<span class="w"> </span>location<span class="o">]</span>
For<span class="w"> </span>example,<span class="w"> </span>check_symbols_for_thread_safety.sh<span class="w"> </span>/Applications/Adobe<span class="w"> </span>After<span class="w"> </span>Effects<span class="w"> </span><span class="o">[</span>your<span class="w"> </span>AE<span class="w"> </span>version<span class="o">]</span>/Plug-ins/Effects/Curves.plugin/Contents/MacOS/Curves<span class="o">)</span>
</code></pre></div></li>
<li>You will see output from the tool in this format:
    <div class="highlight"><pre><span></span><code><span class="o">[</span>symbol<span class="w"> </span>type<span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="o">[</span>symbol<span class="w"> </span>name<span class="o">]</span>
</code></pre></div></li>
<li><code>[symbol type]</code> is an one case-sensitive letter that indicates the type of the variable. You can find all the type information here: <a href="https://linux.die.net/man/1/nm">https://linux.die.net/man/1/nm</a></li>
<li>Here is an example of the output:
    <div class="highlight"><pre><span></span><code><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="n">Deform</span><span class="o">::</span><span class="n">FindSilEdges</span><span class="p">()</span><span class="o">::</span><span class="n">new_kInfinite</span>
</code></pre></div><ul>
<li><code>b</code> shows this symbol is in the uninitialized data section, which indicates it might be a static variable.</li>
<li><code>Deform::FindSilEdges()::new_kInfinite</code> is the symbol name where <code>Deform</code> is name of the namespace that the variable is located at.</li>
<li><code>FindSilEdges()</code> is the function name the variable is in.</li>
<li><code>new_kInfinite</code> is the actual variable name. Namespace and function names might not be shown based on where the variable is.</li>
</ul>
</li>
<li>Search for each symbol in your code, fix it (see <a href="#how-to-locate-the-static-and-global-variables-in-your-effects">here</a> on how) and repeat for every binary file in your solution</li>
</ol>
<h3 id="on-windows">On Windows<a class="headerlink" href="#on-windows" title="Permanent link">&para;</a></h3>
<h4 id="preparation">Preparation<a class="headerlink" href="#preparation" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>In order to run this tool, you need a working installation of Visual Studio</strong></li>
<li>Clone/Download the Git Repo at the URL provided above</li>
<li>Find the <code>register_msdia.cmd</code> script in the <strong>Win</strong> folder</li>
<li>Search for <strong>"x64 Native Tools Command Prompt for VS...."</strong> from the <strong>Start Menu</strong></li>
<li>Right click -&gt; Run as an Administrator</li>
<li>In the terminal, <code>cd</code> to the directory where your <code>register_msdia.cmd</code> is located at</li>
<li>Run <code>.\register_msdia.cmd</code></li>
<li>This script will register the <strong>DIA SDK</strong> and some other required dependencies for you</li>
<li>The Static Analyzer should be ready to work</li>
</ol>
<h4 id="using-the-windows-static-analyzer">Using the Windows Static Analyzer<a class="headerlink" href="#using-the-windows-static-analyzer" title="Permanent link">&para;</a></h4>
<ol>
<li>Find the executable <code>CheckThreadSafeSymbols.exe</code> in the <strong>Win</strong> folder</li>
<li>Compile your effect in <strong>Debug</strong> mode and find its <strong>.pdb</strong> file</li>
<li>You should also find some <strong>.obj</strong> files in the same build directory if you haven't modified your project build settings</li>
<li>You have <strong>two options</strong> on what to scan through: binaries or source files, using <code>-objfile</code> or <code>-source</code> flag.<ul>
<li>Note: You can get the same symbols out of either option.<ul>
<li>Use the <code>-source</code> option if you don't know exactly what binaries your source code is ending up in, or if you'd like to keep track of thread safety on a per-source-file basis.</li>
<li>Use the <code>-objfile</code> option if you want more fine-grained control over what parts of your project you're scanning.</li>
</ul>
</li>
</ul>
</li>
<li>To analyze the symbols in an object file, run:
    <div class="highlight"><pre><span></span><code>CheckThreadSafeSymbols.exe -objfile [absolute path to the binary you want analyzed] [absolute path to .pdb]
</code></pre></div></li>
<li>To analyze the symbols in a source file, run:
    <div class="highlight"><pre><span></span><code>CheckThreadSafeSymbols.exe -source [absolute path to the source file you want analyzed] [absolute path to .pdb]
</code></pre></div></li>
<li>Global variables aren't limited to the scope of one file or binary in pdbs, so you'll have to check over the list of all project globals without filtering. Use the -g output to get a list of all of them:
    <div class="highlight"><pre><span></span><code>CheckThreadSafeSymbols.exe -g [absolute path to .pdb]
</code></pre></div></li>
<li>If you're unsure of what binaries your effect is outputting, the tool can also output a <strong>(noisy)</strong> list of binaries, along with the source files each pulls data from. Files you've changed are likely to be near the top. To see the list, run:
    <div class="highlight"><pre><span></span><code>CheckThreadSafeSymbols.exe -sf [absolute path to .pdb]
</code></pre></div></li>
<li>Output symbols will take the form:
    <div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">Symbol</span><span class="w"> </span><span class="n">name</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">Symbol</span><span class="w"> </span><span class="n">type</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">Datakind</span><span class="p">],</span><span class="w"> </span><span class="p">([</span><span class="n">Section</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">location</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">Binary</span><span class="w"> </span><span class="n">Address</span><span class="p">][</span><span class="n">Binary</span><span class="w"> </span><span class="n">Address</span><span class="w"> </span><span class="n">Offset</span><span class="p">])</span>
</code></pre></div></li>
<li>Here is an example of the output:
    <div class="highlight"><pre><span></span><code><span class="n">menuBuf</span><span class="p">,</span><span class="w"> </span><span class="n">Type</span><span class="o">:</span><span class="w"> </span><span class="kt">char</span><span class="p">[</span><span class="mh">0x1000</span><span class="p">],</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="n">Static</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">static</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">0008F</span><span class="n">CD0</span><span class="p">][</span><span class="mo">0003</span><span class="o">:</span><span class="mo">00001</span><span class="n">CD0</span><span class="p">])</span>
</code></pre></div><ul>
<li><code>menuBuf</code> is the actual variable name.</li>
<li><code>Type: char[0x1000]</code> shows what type of the variable it is. The data here is a <code>char</code>.</li>
<li><code>File Static</code> shows what kind of that data it is. The data here is a <strong>File-scoped static variable.</strong> You can find all the data kinds and what they mean on this page <a href="https://docs.microsoft.com/en-us/visualstudio/debugger/debug-interface-access/datakind?view=vs-2019">https://docs.microsoft.com/en-us/visualstudio/debugger/debug-interface-access/datakind?view=vs-2019</a></li>
<li><code>static</code> shows that the data is in the static section of the memory.</li>
<li><code>[0008FCD0][0003:00001CD0]</code> shows the Binary Address and the Binary Address offset of the data.</li>
</ul>
</li>
<li>Search for each symbol in your code, fix it (see <a href="#how-to-locate-the-static-and-global-variables-in-your-effects">here</a> on how) and repeat for every binary/source file in your solution</li>
</ol>
<hr />
<h2 id="what-to-do-if-you-have-static-and-globals-in-your-effects">What to do if you have static and globals in your effects<a class="headerlink" href="#what-to-do-if-you-have-static-and-globals-in-your-effects" title="Permanent link">&para;</a></h2>
<p>When you see a static or global variable, it would be the best to make it a local variable if possible. But what if that variable has to be static or global?</p>
<p>Here are some standard approaches for treating statics or globals:</p>
<h3 id="could-the-data-be-easily-passed-between-functions-instead-without-a-change-in-behavior">Could the data be easily passed between functions instead without a change in behavior?<a class="headerlink" href="#could-the-data-be-easily-passed-between-functions-instead-without-a-change-in-behavior" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// Example of a non Thread-Safe code</span>
<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">should_just_be_local</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">should_just_be_local</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SetAndUseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">should_just_be_local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DoComputation</span><span class="p">();</span>
<span class="w">    </span><span class="n">UseState</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>Either add it to a struct or expand function arguments to include it:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// We can fix the above code by passing the should_just_be_local variable through function arguments</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">should_just_be_local</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">should_just_be_local</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SetAndUseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">should_just_be_local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DoComputation</span><span class="p">();</span>
<span class="w">    </span><span class="n">UseState</span><span class="p">(</span><span class="n">should_just_be_local</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="could-the-data-be-initialized-before-you-execute-your-code-eg-a-lookup-table-a-const-variable">Could the data be initialized before you execute your code (e.g. a lookup table, a const variable)?<a class="headerlink" href="#could-the-data-be-initialized-before-you-execute-your-code-eg-a-lookup-table-a-const-variable" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// Example of a non Thread-Safe code</span>

<span class="c1">// Many places in the code need to read this table but won&#39;t be writing to it</span>
<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">state_with_initializer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
<span class="k">static</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">state_was_initialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">InitializeState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">64</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">state_with_initializer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">state_was_initialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">state_was_initialized</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">InitializeState</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">state_with_initializer</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Make it <code>const</code> or replace it with a macro:</p>
<div class="highlight"><pre><span></span><code><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="o">&gt;</span><span class="w"> </span><span class="n">InitializeState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="o">&gt;</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">64</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// We can fix the above code by making this table a const and initialize it before using it</span>
<span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="o">&gt;</span><span class="w"> </span><span class="n">state_with_initializer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InitializeState</span><span class="p">();</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">Main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">state_with_initializer</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="is-the-data-initialized-once-at-runtime-based-on-data-that-doesnt-change-on-subsequent-renders">Is the data initialized once at runtime based on data that doesn't change on subsequent renders?<a class="headerlink" href="#is-the-data-initialized-once-at-runtime-based-on-data-that-doesnt-change-on-subsequent-renders" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// Example of a non Thread-Safe code</span>
<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">depends_on_unchanging_runtime_state</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">depends_on_unchanging_runtime_state</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SetAndUseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">depends_on_unchanging_runtime_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DoComputationThatNeedsStateOnlyOnce</span><span class="p">();</span>
<span class="w">    </span><span class="n">UseState</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>Double-check that this state isn't known before your code executes (case 2), but if you have to initialize at runtime use a const static local. (Note that thread-safe initialization of static local objects is part of the C++ spec):</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">depends_on_unchanging_runtime_state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">depends_on_unchanging_runtime_state</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SetAndUseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// We can fix the above code by making the variable a const static local</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">depends_on_unchanging_runtime_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DoComputationThatNeedsStateOnlyOnce</span><span class="p">();</span>

<span class="w">    </span><span class="n">UseState</span><span class="p">(</span><span class="n">depends_on_unchanging_runtime_state</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="the-data-has-to-stay-staticglobal-not-being-a-const-but-each-render-thread-can-have-its-own-copy-of-the-data">The data has to stay static/global not being a const. But each render thread can have its own copy of the data.<a class="headerlink" href="#the-data-has-to-stay-staticglobal-not-being-a-const-but-each-render-thread-can-have-its-own-copy-of-the-data" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// This variable has to be static and not a const</span>
<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">this_thread_needs_access</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SetState</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">new_state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">this_thread_needs_access</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_state</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">this_thread_needs_access</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Just make the variable thread_local:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Make this variable a thread_local variable</span>
<span class="k">thread_local</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">this_thread_needs_access</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SetState</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">new_state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">this_thread_needs_access</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_state</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">this_thread_needs_access</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="the-data-has-to-stay-staticglobal-not-being-a-const-and-each-thread-needs-to-read-and-write-from-the-most-up-to-date-state-rare">The data has to stay static/global not being a const and each thread needs to read and write from the most up-to-date state. (rare)<a class="headerlink" href="#the-data-has-to-stay-staticglobal-not-being-a-const-and-each-thread-needs-to-read-and-write-from-the-most-up-to-date-state-rare" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// This variable has to be static and not a const</span>
<span class="c1">// It also needs to be shared across several threads</span>
<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">every_thread_needs_latest_state</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SetState</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">new_state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">every_thread_needs_latest_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_state</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">every_thread_needs_latest_state</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>In this case, protect access with a mutex:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Add a mutex (lock)</span>
<span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="w"> </span><span class="n">ex_lock</span><span class="p">;</span>

<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">every_thread_needs_latest_state</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">SetState</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">new_state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Protect the access with the mutex (lock)</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">ex_lock</span><span class="p">);</span>
<span class="w">        </span><span class="n">every_thread_needs_latest_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_state</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">state_capture</span><span class="p">;</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Protect the access with the mutex (lock)</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">ex_lock</span><span class="p">);</span>
<span class="w">        </span><span class="n">state_capture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">every_thread_needs_latest_state</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">state_capture</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The above examples are the common cases we've seen in our effects. You can always come up other methods to treat your statics and globals that best suits your needs.</p>
</div>
<hr />
<h2 id="setting-an-effect-as-thread-safe">Setting an Effect as Thread-safe<a class="headerlink" href="#setting-an-effect-as-thread-safe" title="Permanent link">&para;</a></h2>
<ul>
<li>Set the <code>PF_OutFlag2_SUPPORTS_THREADED_RENDERING</code> flag in GlobalSetup to tell After Effects that your effect is Thread-Safe and supports Multi-Frame Rendering.</li>
<li>If required, add the <code>PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</code> to allow sequence_data to be written at the Render stage.</li>
<li>Update the <code>AE_Effect_Global_OutFlags_2</code> magic number. Launch AE with your effect without changing the magic number for the first time, apply your effect and AE will give you the correct number to put in.</li>
<li>If you are using the <code>PF_OutFlag_SEQUENCE_DATA_NEEDS_FLATTENING</code> flag, remember to also set the <code>PF_OutFlag2_SUPPORTS_GET_FLATTENED_SEQUENCE_DATA</code> flag.</li>
</ul>
<hr />
<h2 id="how-to-test-whether-an-effect-is-thread-safe">How to test whether an effect is Thread-Safe<a class="headerlink" href="#how-to-test-whether-an-effect-is-thread-safe" title="Permanent link">&para;</a></h2>
<p>Once you have completed the above steps to make your effect Thread-Safe, you should now be ready to do some testing.</p>
<h3 id="enable-multi-frame-rendering">Enable Multi-Frame Rendering<a class="headerlink" href="#enable-multi-frame-rendering" title="Permanent link">&para;</a></h3>
<ul>
<li>Multi-Frame Rendering is enabled by default in After Effects 2022.</li>
<li>To toggle MFR on and off, navigate to Preferences &gt; Memory &amp; Performance &gt; Performance and toggle the Multi-Frame Rendering checkbox.</li>
</ul>
<h3 id="test-your-effect">Test your effect<a class="headerlink" href="#test-your-effect" title="Permanent link">&para;</a></h3>
<p>Once you have completed the above preparation steps, test your effect thoroughly. You should be able to test simple and complex compositions and see performance improvements as the effect utilizes multi-frame rendering.</p>
<ul>
<li>Go through all your existing manual and automated testing plans.</li>
<li>Test all the effect parameters and make sure they are working properly.</li>
<li>Add in some of the AE effects that have already been made thread-safe as appropriate. See the <a href="#thread-safe-first-party-effects">Thread-Safe First Party Effects</a> section.</li>
<li>Make sure there are no crashes, hangs, render differences or other unexpected changes when rendering with multi-frame rendering enabled.</li>
</ul>
<hr />
<h2 id="thread-safe-first-party-effects">Thread-Safe First Party Effects<a class="headerlink" href="#thread-safe-first-party-effects" title="Permanent link">&para;</a></h2>
<p>Visit <a href="https://helpx.adobe.com/after-effects/user-guide.html/after-effects/using/effect-list.ug.html">https://helpx.adobe.com/after-effects/user-guide.html/after-effects/using/effect-list.ug.html</a> for a full list of MFR supported effects. More are being added every week.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 5, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      All content is copyright Adobe Systems Incorporated.
    </div>
  
  
    Made with
    <a
      href="https://squidfunk.github.io/mkdocs-material/"
      target="_blank" rel="noopener"
    >
      Material for MkDocs
    </a>
  
</div>

<!-- Print button -->
<div class="md-copyright">
  
  <a href="../../print_page/" title="Print Site" class="md-content__button md-icon">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 3H6v4h12m1 5a1 1 0 0 1-1-1 1 1 0 0 1 1-1 1 1 0 0 1 1 1 1 1 0 0 1-1 1m-3 7H8v-5h8m3-6H5a3 3 0 0 0-3 3v6h4v4h12v-4h4v-6a3 3 0 0 0-3-3"/></svg>
  </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "search.highlight", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../js/print-site.js"></script>
      
        <script src="../../_static/extra.js"></script>
      
        <script src="../../docs/_global/js/global.js"></script>
      
    
  </body>
</html>