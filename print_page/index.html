
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ae-plugins.docsforadobe.dev/print_page/">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>Offline Docs - After Effects C++ SDK Guide</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.d7758b05.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../_static/extra.css">
    
      <link rel="stylesheet" href="../docs/_global/css/global.css">
    
      <link rel="stylesheet" href="../docs/_global/css/global-syntax-highlight.css">
    
    <script>__md_scope=new URL("/",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
  Welcome to the new docsforadobe guide!

  This is a work in progress.

  Please provide all feedback via
  <a ref="me" href="https://github.com/orgs/docsforadobe/discussions">
    <span class="twemoji">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 1h8.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 10.25 10H7.061l-2.574 2.573A1.458 1.458 0 0 1 2 11.543V10h-.25A1.75 1.75 0 0 1 0 8.25v-5.5C0 1.784.784 1 1.75 1M1.5 2.75v5.5c0 .138.112.25.25.25h1a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.75.75 0 0 1 .53-.22h3.5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25m13 2a.25.25 0 0 0-.25-.25h-.5a.75.75 0 0 1 0-1.5h.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 14.25 12H14v1.543a1.458 1.458 0 0 1-2.487 1.03L9.22 12.28a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l2.22 2.22v-2.19a.75.75 0 0 1 .75-.75h1a.25.25 0 0 0 .25-.25Z"/></svg>
    </span>
    <strong>the org's discussion forum</strong>
  </a>.

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://docsforadobe.dev" title="After Effects C++ SDK Guide" class="md-header__button md-logo" aria-label="After Effects C++ SDK Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            After Effects C++ SDK Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Offline Docs
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/docsforadobe/after-effects-plugin-guide/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    after-effects-plugin-guide
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://docsforadobe.dev" title="After Effects C++ SDK Guide" class="md-nav__button md-logo" aria-label="After Effects C++ SDK Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    After Effects C++ SDK Guide
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/docsforadobe/after-effects-plugin-guide/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    after-effects-plugin-guide
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Version History
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/what-can-i-do/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What Can I Do With This SDK?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/other-integration-possibilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other Integration Possibilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/sdk-audience/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDK Audience
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/whats-new/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What's New
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/how-to-start-creating-plug-ins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How To Start Creating Plug-ins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/sample-projects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sample Projects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/debugging-plug-ins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debugging Plug-ins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/compatibility-across-multiple-versions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compatibility Across Multiple Versions?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/third-party-plug-in-hosts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Third-party Plug-in Hosts?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/pipl-resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PiPL Resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/where-installers-should-put-plug-ins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Where Installers Should Put Plug-ins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/localization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Localization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/apple-silicon-support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apple Silicon Support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/symbol-export/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exporting Symbols in Effects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/next-steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Next Steps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Effect Basics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Effect Basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-basics/effect-basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Effect Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-basics/entry-point/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entry Point
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-basics/command-selectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command Selectors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-basics/PF_InData/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PF_InData
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-basics/PF_OutData/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PF_OutData
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-basics/parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-basics/PF_ParamDef/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PF_ParamDef
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-basics/PF_EffectWorld/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PF_EffectWorld / PF_LayerDef
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-basics/errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Errors
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Effect Details
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Effect Details
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/multi-frame-rendering-in-ae/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-Frame Rendering in AE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/effect-details/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Effect Details
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/accessing-function-suites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing the After Effects Function Suites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/memory-allocation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memory Allocation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/image-buffer-management-functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image Buffer Management Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/iteration-suites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Iteration Suites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/graphics-utility-suites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graphics Utility Suites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/interaction-callback-functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interaction Callback Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/pixel-aspect-ratio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pixel Aspect Ratio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/parameters-floating-point-values/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parameters & Floating Point Values
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/parameter-supervision/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parameter Supervision
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/global-sequence-frame-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global, Sequence, & Frame Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/arbitrary-data-parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arbitrary Data Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/useful-utility-functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Useful Utility Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/motion-blur/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Motion Blur
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/working-with-paths/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working With Paths
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/accessing-camera-light-information/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing Camera & Light Information
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/color-space-conversion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Color Space Conversion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/changing-parameter-orders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changing Parameter Orders, the Nice Way
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/tips-tricks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tips & Tricks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-details/compute-cache-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compute Cache API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SmartFX
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            SmartFX
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../smartfx/smartfx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SmartFX
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Effect UI & Events
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Effect UI & Events
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-ui-events/effect-ui-events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Effect UI & Events
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-ui-events/PF_EventExtra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PF_EventExtra
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-ui-events/PF_EventUnion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PF_EventUnion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-ui-events/custom-ui-and-drawbot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom UI & Drawbot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-ui-events/ui-callbacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UI Callbacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effect-ui-events/tips-and-tricks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tips & Tricks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Audio
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Audio
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../audio/audio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../audio/global-outflags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global Outflags
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../audio/audio-data-structures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Data Structures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../audio/audio-specific-float-slider-variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio-Specific Float Slider Variables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../audio/accessing-audio-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing Audio Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../audio/audio-considerations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audio Considerations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AEGPs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            AEGPs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aegps/aegps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AEGPs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aegps/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aegps/data-types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aegps/implementation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aegps/aegp-suites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AEGP Suites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aegps/cheating-effect-usage-of-aegp-suites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cheating Effect Usage of AEGP Suites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aegps/aegp-details/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AEGP Details
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Artisans
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Artisans
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../artisans/artisans/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Artisans
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../artisans/artisan-data-types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Artisan Data Types
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AEIOs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            AEIOs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aeios/aeios/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AEIOs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aeios/calling-sequence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calling Sequence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aeios/AEIO_ModuleInfo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AEIO_ModuleInfo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aeios/new-kids-on-the-function-block/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    New Kids On The Function Block
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aeios/implementation-details/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Implementation Details
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Premiere Pro
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Premiere Pro
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ppro/ppro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Premiere Pro & Other Hosts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ppro/plug-in-installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plug-in Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ppro/basic-host-differences/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Host Differences
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ppro/multithreading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multithreading
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ppro/bigger-differences/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bigger Differences
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ppro/plug-ins-reloaded/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plug-Ins... Reloaded
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ppro/premiere-elements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Premiere Elements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ppro/unsupported-features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unsupported Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ppro/other-hosts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other Hosts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Page Contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
	<a href="#" class="md-nav__link">
		<span class="md-ellipsis">
			1. Home
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#history" class="md-nav__link">
		<span class="md-ellipsis">
			2. Version History
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#section-introduction" class="md-nav__link">
		<span class="md-ellipsis">
			I. Introduction
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="I. Introduction">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#intro-what-can-i-do" class="md-nav__link">
		<span class="md-ellipsis">
			3. What Can I Do With This SDK?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-other-integration-possibilities" class="md-nav__link">
		<span class="md-ellipsis">
			4. Other Integration Possibilities
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-sdk-audience" class="md-nav__link">
		<span class="md-ellipsis">
			5. SDK Audience
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-whats-new" class="md-nav__link">
		<span class="md-ellipsis">
			6. What's New
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-how-to-start-creating-plug-ins" class="md-nav__link">
		<span class="md-ellipsis">
			7. How To Start Creating Plug-ins
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-sample-projects" class="md-nav__link">
		<span class="md-ellipsis">
			8. Sample Projects
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-debugging-plug-ins" class="md-nav__link">
		<span class="md-ellipsis">
			9. Debugging Plug-ins
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-compatibility-across-multiple-versions" class="md-nav__link">
		<span class="md-ellipsis">
			10. Compatibility Across Multiple Versions?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-third-party-plug-in-hosts" class="md-nav__link">
		<span class="md-ellipsis">
			11. Third-party Plug-in Hosts?
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-pipl-resources" class="md-nav__link">
		<span class="md-ellipsis">
			12. PiPL Resources
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-exceptions" class="md-nav__link">
		<span class="md-ellipsis">
			13. Exceptions
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-where-installers-should-put-plug-ins" class="md-nav__link">
		<span class="md-ellipsis">
			14. Where Installers Should Put Plug-ins
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-localization" class="md-nav__link">
		<span class="md-ellipsis">
			15. Localization
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-apple-silicon-support" class="md-nav__link">
		<span class="md-ellipsis">
			16. Apple Silicon Support
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-symbol-export" class="md-nav__link">
		<span class="md-ellipsis">
			17. Exporting Symbols in Effects
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#intro-next-steps" class="md-nav__link">
		<span class="md-ellipsis">
			18. Next Steps
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#section-effect-basics" class="md-nav__link">
		<span class="md-ellipsis">
			II. Effect Basics
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="II. Effect Basics">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#effect-basics-effect-basics" class="md-nav__link">
		<span class="md-ellipsis">
			19. Effect Basics
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-basics-entry-point" class="md-nav__link">
		<span class="md-ellipsis">
			20. Entry Point
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-basics-command-selectors" class="md-nav__link">
		<span class="md-ellipsis">
			21. Command Selectors
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-basics-pf_indata" class="md-nav__link">
		<span class="md-ellipsis">
			22. PF_InData
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-basics-pf_outdata" class="md-nav__link">
		<span class="md-ellipsis">
			23. PF_OutData
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-basics-parameters" class="md-nav__link">
		<span class="md-ellipsis">
			24. Parameters
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-basics-pf_paramdef" class="md-nav__link">
		<span class="md-ellipsis">
			25. PF_ParamDef
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-basics-pf_effectworld" class="md-nav__link">
		<span class="md-ellipsis">
			26. PF_EffectWorld / PF_LayerDef
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-basics-errors" class="md-nav__link">
		<span class="md-ellipsis">
			27. Errors
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#section-effect-details" class="md-nav__link">
		<span class="md-ellipsis">
			III. Effect Details
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="III. Effect Details">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#effect-details-multi-frame-rendering-in-ae" class="md-nav__link">
		<span class="md-ellipsis">
			28. Multi-Frame Rendering in AE
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-effect-details" class="md-nav__link">
		<span class="md-ellipsis">
			29. Effect Details
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-accessing-function-suites" class="md-nav__link">
		<span class="md-ellipsis">
			30. Accessing the After Effects Function Suites
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-memory-allocation" class="md-nav__link">
		<span class="md-ellipsis">
			31. Memory Allocation
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-image-buffer-management-functions" class="md-nav__link">
		<span class="md-ellipsis">
			32. Image Buffer Management Functions
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-iteration-suites" class="md-nav__link">
		<span class="md-ellipsis">
			33. Iteration Suites
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-graphics-utility-suites" class="md-nav__link">
		<span class="md-ellipsis">
			34. Graphics Utility Suites
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-interaction-callback-functions" class="md-nav__link">
		<span class="md-ellipsis">
			35. Interaction Callback Functions
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-pixel-aspect-ratio" class="md-nav__link">
		<span class="md-ellipsis">
			36. Pixel Aspect Ratio
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-parameters-floating-point-values" class="md-nav__link">
		<span class="md-ellipsis">
			37. Parameters & Floating Point Values
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-parameter-supervision" class="md-nav__link">
		<span class="md-ellipsis">
			38. Parameter Supervision
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-global-sequence-frame-data" class="md-nav__link">
		<span class="md-ellipsis">
			39. Global, Sequence, & Frame Data
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-arbitrary-data-parameters" class="md-nav__link">
		<span class="md-ellipsis">
			40. Arbitrary Data Parameters
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-useful-utility-functions" class="md-nav__link">
		<span class="md-ellipsis">
			41. Useful Utility Functions
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-motion-blur" class="md-nav__link">
		<span class="md-ellipsis">
			42. Motion Blur
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-working-with-paths" class="md-nav__link">
		<span class="md-ellipsis">
			43. Working With Paths
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-accessing-camera-light-information" class="md-nav__link">
		<span class="md-ellipsis">
			44. Accessing Camera & Light Information
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-color-space-conversion" class="md-nav__link">
		<span class="md-ellipsis">
			45. Color Space Conversion
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-changing-parameter-orders" class="md-nav__link">
		<span class="md-ellipsis">
			46. Changing Parameter Orders, the Nice Way
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-tips-tricks" class="md-nav__link">
		<span class="md-ellipsis">
			47. Tips & Tricks
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-details-compute-cache-api" class="md-nav__link">
		<span class="md-ellipsis">
			48. Compute Cache API
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#section-smartfx" class="md-nav__link">
		<span class="md-ellipsis">
			IV. SmartFX
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="IV. SmartFX">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#smartfx-smartfx" class="md-nav__link">
		<span class="md-ellipsis">
			49. SmartFX
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#section-effect-ui-events" class="md-nav__link">
		<span class="md-ellipsis">
			V. Effect UI & Events
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="V. Effect UI & Events">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#effect-ui-events-effect-ui-events" class="md-nav__link">
		<span class="md-ellipsis">
			50. Effect UI & Events
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-ui-events-pf_eventextra" class="md-nav__link">
		<span class="md-ellipsis">
			51. PF_EventExtra
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-ui-events-pf_eventunion" class="md-nav__link">
		<span class="md-ellipsis">
			52. PF_EventUnion
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-ui-events-custom-ui-and-drawbot" class="md-nav__link">
		<span class="md-ellipsis">
			53. Custom UI & Drawbot
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-ui-events-ui-callbacks" class="md-nav__link">
		<span class="md-ellipsis">
			54. UI Callbacks
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#effect-ui-events-tips-and-tricks" class="md-nav__link">
		<span class="md-ellipsis">
			55. Tips & Tricks
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#section-audio" class="md-nav__link">
		<span class="md-ellipsis">
			VI. Audio
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="VI. Audio">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#audio-audio" class="md-nav__link">
		<span class="md-ellipsis">
			56. Audio
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#audio-global-outflags" class="md-nav__link">
		<span class="md-ellipsis">
			57. Global Outflags
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#audio-audio-data-structures" class="md-nav__link">
		<span class="md-ellipsis">
			58. Audio Data Structures
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#audio-audio-specific-float-slider-variables" class="md-nav__link">
		<span class="md-ellipsis">
			59. Audio-Specific Float Slider Variables
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#audio-accessing-audio-data" class="md-nav__link">
		<span class="md-ellipsis">
			60. Accessing Audio Data
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#audio-audio-considerations" class="md-nav__link">
		<span class="md-ellipsis">
			61. Audio Considerations
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#section-aegps" class="md-nav__link">
		<span class="md-ellipsis">
			VII. AEGPs
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="VII. AEGPs">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#aegps-aegps" class="md-nav__link">
		<span class="md-ellipsis">
			62. AEGPs
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#aegps-overview" class="md-nav__link">
		<span class="md-ellipsis">
			63. Overview
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#aegps-data-types" class="md-nav__link">
		<span class="md-ellipsis">
			64. Data Types
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#aegps-implementation" class="md-nav__link">
		<span class="md-ellipsis">
			65. Implementation
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#aegps-aegp-suites" class="md-nav__link">
		<span class="md-ellipsis">
			66. AEGP Suites
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#aegps-cheating-effect-usage-of-aegp-suites" class="md-nav__link">
		<span class="md-ellipsis">
			67. Cheating Effect Usage of AEGP Suites
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#aegps-aegp-details" class="md-nav__link">
		<span class="md-ellipsis">
			68. AEGP Details
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#section-artisans" class="md-nav__link">
		<span class="md-ellipsis">
			VIII. Artisans
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="VIII. Artisans">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#artisans-artisans" class="md-nav__link">
		<span class="md-ellipsis">
			69. Artisans
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#artisans-artisan-data-types" class="md-nav__link">
		<span class="md-ellipsis">
			70. Artisan Data Types
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#section-aeios" class="md-nav__link">
		<span class="md-ellipsis">
			IX. AEIOs
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="IX. AEIOs">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#aeios-aeios" class="md-nav__link">
		<span class="md-ellipsis">
			71. AEIOs
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#aeios-calling-sequence" class="md-nav__link">
		<span class="md-ellipsis">
			72. Calling Sequence
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#aeios-aeio_moduleinfo" class="md-nav__link">
		<span class="md-ellipsis">
			73. AEIO_ModuleInfo
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#aeios-new-kids-on-the-function-block" class="md-nav__link">
		<span class="md-ellipsis">
			74. New Kids On The Function Block
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#aeios-implementation-details" class="md-nav__link">
		<span class="md-ellipsis">
			75. Implementation Details
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#section-premiere-pro" class="md-nav__link">
		<span class="md-ellipsis">
			X. Premiere Pro
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="X. Premiere Pro">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#ppro-ppro" class="md-nav__link">
		<span class="md-ellipsis">
			76. Premiere Pro & Other Hosts
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#ppro-plug-in-installation" class="md-nav__link">
		<span class="md-ellipsis">
			77. Plug-in Installation
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#ppro-basic-host-differences" class="md-nav__link">
		<span class="md-ellipsis">
			78. Basic Host Differences
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#ppro-multithreading" class="md-nav__link">
		<span class="md-ellipsis">
			79. Multithreading
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#ppro-bigger-differences" class="md-nav__link">
		<span class="md-ellipsis">
			80. Bigger Differences
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#ppro-plug-ins-reloaded" class="md-nav__link">
		<span class="md-ellipsis">
			81. Plug-Ins... Reloaded
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#ppro-premiere-elements" class="md-nav__link">
		<span class="md-ellipsis">
			82. Premiere Elements
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#ppro-unsupported-features" class="md-nav__link">
		<span class="md-ellipsis">
			83. Unsupported Features
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#ppro-other-hosts" class="md-nav__link">
		<span class="md-ellipsis">
			84. Other Hosts
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section id="print-site-cover-page">
            <div>

    
        <h1>After Effects C++ SDK Guide</h1>
    

    
        by <h3><a href="https://docsforadobe.dev">https://docsforadobe.dev</a></h3>
    

</div>


<table>

    

    
    <tr>
        <td>Hosted at</td>
        <td>https://ae-plugins.docsforadobe.dev/</td>
    </tr>
    

    
    <tr>
        <td>Repository</td>
        <td><a href="https://github.com/docsforadobe/after-effects-plugin-guide/">https://github.com/docsforadobe/after-effects-plugin-guide/</a></td>
    </tr>
    

    
    <tr>
        <td>Copyright</td>
        <td>All content is copyright Adobe Systems Incorporated.</td>
    </tr>
    

</table>
        </section>
        
        <div id="print-site-banner">
            <style>
    #print-site-banner {
        border: 0px;
    }
</style>

<div class="admonition info">

    <p class="admonition-title">Note – This box will disappear during export!</p>

    <p>This page has combined all site pages into one, and can be exported using native browser features.</p>

    <p>You can export to PDF using <b>File > Print > Save as PDF</b>, or save as a single-page HTML file via <b>File > Save As</b>.</p>

    <div class="admonition warning">
        <p class="admonition-title">Warning</p>

        <p>Note that users may have issues <a href="https://github.com/timvink/mkdocs-print-site-plugin/issues/56">printing to PDF on Firefox</a>.</p>
    </div>

</div>
        </div>
        
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1 id="index-introduction">Introduction<a class="headerlink" href="#index-introduction" title="Permanent link">&para;</a></h1>
<p>Welcome to the Adobe® After Effects® Software Development Kit!</p>
<p>This is a living document and is constantly being updated and edited. The latest public version of the SDK is available at: <a href="https://www.adobe.io/after-effects/">https://www.adobe.io/after-effects/</a></p>
<p>If you need more information, your question may already be answered on the After Effects SDK forum: <a href="https://community.adobe.com/t5/after-effects/bd-p/after-effects?page=1&amp;sort=latest_replies&amp;filter=all&amp;topics=label-sdk">After Effects SDK Forum</a></p>
<p>Use the search box there, and post a new question if your question hasn’t already been answered.</p>
<hr />
<h2 id="index-about">About<a class="headerlink" href="#index-about" title="Permanent link">&para;</a></h2>
<p>This document has changed much over the years. Part encyclopedia, part how-to guide, with multiple sedimentary layers of accreted information from more than two decades of API development and refinement.</p>
<p>Yes, there does need to be one source of information about every last niggling detail of the After Effects APIs. However, since no human in their right mind would ever want to <em>read</em> such a document, we've tried to keep it involving and interesting.</p>
<p>As opportunity allows, we'll try to include more diagrams, illustrations, and purdy pickshurs explaining API intricacies.</p>
<p>As always, your input is valued and appreciated.</p>
<hr />
<h2 id="index-organization">Organization<a class="headerlink" href="#index-organization" title="Permanent link">&para;</a></h2>
<p>The <a href="#intro-what-can-i-do">What Can I Do With This SDK?</a> provides an overview of the integration possibilities with After Effects. It explains what plug-ins are, and how they work with After Effects. It describes the sample projects, and how to modify them. It explains where to install plug-ins, and what resources they use.</p>
<p>The basics of effect plug-ins are discussed in <a href="#effect-basics-effect-basics">Effect Basics</a>. This overview provides information on the function parameters passed to and from an effect plug-in's entry point. It describes capability flags, effect parameters, and image buffers.</p>
<p><a href="#effect-details-effect-details">Effect Details</a> dives into the details of developing a complete effect plug-in using the many provided callback functions. It also provides many testing ideas to ensure the plug-in is stabile.</p>
<p><a href="#smartfx-smartfx">SmartFX</a> is the extension to the effect plug-in API to support 32-bit floating point images.</p>
<p><a href="#effect-ui-events-effect-ui-events">Effect UI &amp; Events</a> covers events sent to effect plug-ins, how to incorporate custom user interface elements, parameter supervision, and the reliance of custom data parameter types on Custom UI messaging.</p>
<p><a href="#audio-audio">Audio</a> effects are covered in... <a href="#audio-audio">Audio</a>.</p>
<p><a href="#aegps-aegps">AEGPs</a> details the After Effects General Plug-in (AEGP) API. Provided callback functions, hooking into internal messaging, manipulating the current contents of open projects and handling menu commands are all covered at length.</p>
<p><a href="#artisans-artisans">Artisans</a> covers specialized plug-in 3D renderer AEGPs.</p>
<p><a href="#aeios-aeios">AEIOs</a>, specialized AEGPs which handle file input and output.</p>
<p><a href="#ppro-ppro">Premiere Pro &amp; Other Hosts</a> discusses issues related to compatibility with Premiere Pro and other applications that support a subset of After Effects plug-ins.</p>
<hr />
<h2 id="index-documentation-conventions">Documentation Conventions<a class="headerlink" href="#index-documentation-conventions" title="Permanent link">&para;</a></h2>
<p>Functions, structure names and general C/C++ code are in Courier; MyStruct and MyFunction();</p>
<p>Text in blue is hyperlinked.</p>
<p>Command selectors are italicized; <em>PF_Cmd_RENDER</em>.</p>
<hr />
<h2 id="index-a-note-about-coding-style">A Note About Coding Style<a class="headerlink" href="#index-a-note-about-coding-style" title="Permanent link">&para;</a></h2>
<p>Because we use the public APIs for our own plug-ins, our coding guidelines are apparent throughout the SDK. Here's a description of the pseudo-neo-post-Hungarian notation we use. Of course, you're welcome to code however you like. If you feel strongly that we should change our internal coding standards, please post your requests at comp.sys.programmer.better.things.to.do.with.your.time, and we'll carefully consider them before not making any changes.</p>
<h3 id="index-coding-conventions">Coding Conventions<a class="headerlink" href="#index-coding-conventions" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Type</th>
<th>Suffix</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Handle</td>
<td><code>H</code></td>
<td><code>fooH</code></td>
</tr>
<tr>
<td>pointer (to)</td>
<td><code>P</code></td>
<td><code>fooP</code></td>
</tr>
<tr>
<td>Boolean</td>
<td><code>B</code></td>
<td><code>visibleB</code></td>
</tr>
<tr>
<td>Float</td>
<td><code>F</code></td>
<td><code>degreesF</code></td>
</tr>
<tr>
<td>Long</td>
<td><code>L</code></td>
<td><code>offsetL</code></td>
</tr>
<tr>
<td>unsigned long</td>
<td><code>Lu</code></td>
<td><code>countLu</code></td>
</tr>
<tr>
<td>short</td>
<td><code>S</code></td>
<td><code>indexS</code></td>
</tr>
<tr>
<td>char</td>
<td><code>C</code></td>
<td><code>digitC</code></td>
</tr>
<tr>
<td>unsigned char</td>
<td><code>Cu</code></td>
<td><code>redCu</code></td>
</tr>
<tr>
<td>function pointer</td>
<td><code>\_func</code></td>
<td><code>sample_func</code></td>
</tr>
<tr>
<td>time value</td>
<td><code>T</code></td>
<td><code>durationT</code></td>
</tr>
<tr>
<td><code>char*</code> (NULL-terminated C string)</td>
<td><code>Z</code></td>
<td><code>nameZ</code></td>
</tr>
<tr>
<td>rectangle</td>
<td><code>R</code></td>
<td><code>boundsR</code></td>
</tr>
<tr>
<td>fixed rectangle</td>
<td><code>FiR</code></td>
<td><code>boundsFiR</code></td>
</tr>
<tr>
<td>float rectangle</td>
<td><code>FR</code></td>
<td><code>boundsFR</code></td>
</tr>
<tr>
<td>ratio</td>
<td><code>Rt</code></td>
<td><code>scale_factorRt</code></td>
</tr>
<tr>
<td><code>void*</code></td>
<td><code>PV</code></td>
<td><code>refconPV</code></td>
</tr>
<tr>
<td>optional parameter (must be passed, can be NULL)</td>
<td><code>0</code></td>
<td><code>extra_flags0</code></td>
</tr>
</tbody>
</table></section><section class="print-page" id="history"><h1 id="history-version-history">Version History<a class="headerlink" href="#history-version-history" title="Permanent link">&para;</a></h1>
<table>
<thead>
<tr>
<th>Revision Date</th>
<th>Documentor</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>5 May 2023</td>
<td>Jason Bartell</td>
<td>Update Color Settings suite to AEGP_ColorSettingsSuite5 with new OCIO calls, and added URL property to the PiPL. See <a href="#aegps-aegp-suites-aegp_colorsettingssuite5">AEGP_ColorSettingsSuite5</a> and <a href="#intro-pipl-resources">PiPL Resources</a> respectively for more details.</td>
</tr>
<tr>
<td>18 October 2022</td>
<td>Field Kuang</td>
<td>Update layer suite to AEGP_LayerSuite9 with 3 new Track Matte methods. See <a href="#aegps-aegp-suites-aegp_layersuite9">AEGP_LayerSuite9</a> for more details</td>
</tr>
<tr>
<td>26 October 2021</td>
<td>Sean Jenkin</td>
<td>After Effects 2022 (22.0) release. Updates the maxiumum threads for PF_Iterate.</td>
</tr>
<tr>
<td>31 March 2021</td>
<td>Sean Jenkin</td>
<td>Updated Multi-Frame Rendering documentation for sequence_data changes and Compute Cache system. Added information for supporting Universal Mac binaries for Apple Silicon effect plugins.</td>
</tr>
<tr>
<td>1 June 2020</td>
<td>Field Kuang</td>
<td>Multi-Frame Rendering is now supported in AE Beta builds. See <a href="#effect-details-multi-frame-rendering-in-ae">Multi-Frame Rendering in AE</a> for more details.</td>
</tr>
<tr>
<td>1 November 2018</td>
<td>Bruce Bullis</td>
<td>16.0 release</td>
</tr>
<tr>
<td>10 November 2017</td>
<td>Zac Lam</td>
<td>15.0 release</td>
</tr>
<tr>
<td>12 May 2017</td>
<td>Zac Lam</td>
<td>CC 2017.1 (14.2) release</td>
</tr>
<tr>
<td>2 November 2016</td>
<td>Zac Lam</td>
<td>CC 2017 (14.0) release.</td>
</tr>
<tr>
<td>21 July 2015</td>
<td>Zac Lam</td>
<td>CC 2015 (13.5) release.</td>
</tr>
<tr>
<td>12 June 2014</td>
<td>Zac Lam</td>
<td>CC 2014 (13.0) release. Corrections for accuracy. Removed old version references.</td>
</tr>
<tr>
<td>15 July 2013</td>
<td>Zac Lam</td>
<td>CC (12.0) release. API version changes, misc small clarifications, more details in <a href="#aeios-aeios">AEIOs</a>.</td>
</tr>
<tr>
<td>26 April 2012</td>
<td>Zac Lam</td>
<td>CS6 (11.0) release. Big reorganization of the <a href="#aegps-aegps">AEGPs</a> and <a href="#artisans-artisans">Artisans</a>. Many additions throughout.</td>
</tr>
<tr>
<td>2 May 2011</td>
<td>Zac Lam</td>
<td>CS5.5 (10.5) release.</td>
</tr>
<tr>
<td>28 April 2010</td>
<td>Zac Lam</td>
<td>CS5 (10.0) release. 64-bit porting info. Drawbot.</td>
</tr>
<tr>
<td>4 May 2009</td>
<td>Zac Lam</td>
<td>CS4 (9.0) release. Complete reorganization of first three chapters. Fleshed out documentation on Premiere Pro.</td>
</tr>
<tr>
<td>1 July 2007</td>
<td>Bruce Bullis</td>
<td>CS3 (8.0) release.</td>
</tr>
<tr>
<td>4 April 2006</td>
<td>Bruce Bullis</td>
<td>Updated to reference new development system requirements and Xcode-specific issues. Some editing.</td>
</tr>
<tr>
<td>1 December 2005</td>
<td>Bruce Bullis</td>
<td>Updated for 7.0. Added SmartFX documentation. Noted current suite version numbers throughout. Numerous editorial changes. Documented many new AEGP suite functions.</td>
</tr>
<tr>
<td>4 April 2004</td>
<td>Bruce Bullis</td>
<td>Updated for 6.5. Expanded and corrected all documentation. Added documentation of all new AEGP functions.</td>
</tr>
<tr>
<td>20 July 2003</td>
<td>Bruce Bullis</td>
<td>Major overhauls for After Effects 6.0. Added documentation for all new (and some old) suites, and many supporting details for effects.</td>
</tr>
<tr>
<td>4 March 2002</td>
<td>Bruce Bullis</td>
<td>Updated Mac OS X details, expanded AEIO and AEGP documentation.</td>
</tr>
<tr>
<td>1 December 2001</td>
<td>Bruce Bullis</td>
<td>5.5 release. Added information on new outflags, PiPL changes, and additions and changes to the AEGP API. Numerous clarifications and edits.</td>
</tr>
<tr>
<td>2 February 2001</td>
<td>Bruce Bullis</td>
<td>5.0 release. Entire document edited and reformatted. Sections on 16 bit-per-channel color and parameter supervision, as well as the entire AEGP chapter, have all substantially expanded.</td>
</tr>
<tr>
<td>9 September 1999</td>
<td>Bruce Bullis</td>
<td>Revised for 4.1; added General plug-ins and AEGP information. Added information on new selectors, resize handle.</td>
</tr>
<tr>
<td>1 January 1999</td>
<td>Bruce Bullis</td>
<td>Version 4.0 SDK Release 1 - Added information on new global flags, custom data types, utilization of PICA suites, CustomUI messaging and parameter supervision, new callbacks. many editorial changes.</td>
</tr>
<tr>
<td>1 May 1998</td>
<td>Bruce Bullis</td>
<td>Version 3.1 SDK Release 6 - Editorial changes only</td>
</tr>
<tr>
<td>17 April 1997</td>
<td>Brian Andrews</td>
<td>Version 3.1 SDK Release 3 - First public release (really a pre-release) of the SDK for Windows development.</td>
</tr>
<tr>
<td>13 Nov. 1996</td>
<td>Brian Andrews</td>
<td>Version 3.1 SDK Release 2 - Minor updates.</td>
</tr>
<tr>
<td>21 June 1996</td>
<td>Brian Andrews</td>
<td>Version 3.1 - Final 3.x release.</td>
</tr>
<tr>
<td>5 March 1996</td>
<td>Brian Andrews</td>
<td>Version 3.0 - Preliminary release for the After Effects developer kitchen.</td>
</tr>
<tr>
<td>August 1994</td>
<td>Dave Herbstman Dan Wilk</td>
<td>Version 2.0.1 - Added support for PowerPC.</td>
</tr>
<tr>
<td>January 1994</td>
<td>Dan Wilk</td>
<td>Version 2.0 - Updates.</td>
</tr>
<tr>
<td>January 1993</td>
<td>Russell Belfer</td>
<td>Version 1.0 - Initial SDK release.</td>
</tr>
</tbody>
</table></section>
                        <h1 class='nav-section-title' id='section-introduction'>
                            Introduction <a class='headerlink' href='#section-introduction' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="intro-what-can-i-do"><h1 id="intro-what-can-i-do-what-can-i-do-with-this-sdk">What Can I Do With This SDK?<a class="headerlink" href="#intro-what-can-i-do-what-can-i-do-with-this-sdk" title="Permanent link">&para;</a></h1>
<p>This SDK describes the Application Programming Interface (API) that developers use to build plug-ins. These plug-ins can extend the capabilities of After Effects and other applications that support the After Effects API. Plug-ins may also be used to bridge the gap between After Effects and another application.</p>
<hr />
<h2 id="intro-what-can-i-do-what-plug-ins-can-i-build-with-this-sdk">What Plug-Ins Can I Build With This SDK?<a class="headerlink" href="#intro-what-can-i-do-what-plug-ins-can-i-build-with-this-sdk" title="Permanent link">&para;</a></h2>
<p><em>Effect plug-ins</em> can be applied to video or audio in a composition, to process video and/or audio data. Some examples of built-in effects are Brightness and Contast, Hue/Saturation, Gaussian Blur, and Warp Stabilizer. Effect plug-ins can provide a set of parameter controls for the user to fine-tune the effect. These parameter values can vary over time, and effects may use other layers and parameters at different times to calculate the output. It's often thought that all plug-ins are effects. But effects are just one type of plug-in used by After Effects.</p>
<p>See a quickstart video on building an effect (on macOS): <a href="https://adobe.ly/2sjMDwM">adobe.ly/2sjMDwM</a></p>
<p><em>After Effects General Plug-ins (AEGPs)</em> can read and modify nearly every element of After Effects projects and preferences. They can add menu items, 'hook' (register themselves to receive) and trigger After Effects' internal commands, and add new panels that dock and resize within the After Effects UI. They can work with markers and keyframes, and manage the render queue. They can even run scripts. Some examples of built-in AEGPs are the AAF importer, and the SWF exporter. Automatic Duck Pro Import AE is another well-known AEGP.</p>
<p><em>After Effects Input/Output (AEIO) plug-ins</em> provide support for new media file types. Unless you need a custom setup dialog to specify interpretation settings, the <a href="#intro-other-integration-possibilities-premiere-pro-importers">Premiere Pro Importers</a> API provides similar functionality, and is preferable in many cases. AEIOs use the AEGP API along with certain APIs specific to AEIOs. While After Effects still supports Photoshop format plug-ins and filters, as well as Foreign Project Format (FPF) plug-ins, these APIs have been long deprecated in favor of the AEIO API.</p>
<p><em>BlitHook</em> plug-ins output video to external hardware for broadcast quality monitoring and playback to tape. The EMP sample project provides a starting point. In After Effects CC 2014 and later, <a href="#intro-other-integration-possibilities-mercury-transmit">Mercury Transmit</a> is the recommended API.</p>
<p><em>Artisans</em> provide rendered output of 3D layers, taking over 3D rendering from After Effects (which still handles all rendering of 2D layers). Artisans use the AEGP API along with certain APIs specific to Artisans.</p>
<p>Didn't see the type of integration you need described above? After Effects is very flexible, and there are several other ways to integrate with After Effects. See: <a href="#intro-other-integration-possibilities">Other Integration Possibilities</a>.</p>
<hr />
<h2 id="intro-what-can-i-do-where-do-plug-ins-appear-in-after-effects">Where Do Plug-ins Appear In After Effects?<a class="headerlink" href="#intro-what-can-i-do-where-do-plug-ins-appear-in-after-effects" title="Permanent link">&para;</a></h2>
<p>Effects plug-ins appear in both the <em>Effect</em> menu and the Effects &amp; Presets panel, in the effect category specified in their PiPL. Once they're applied, the effect's parameter controls (sliders, pop-ups, etc.) appear in the Effect Controls panel (ECP).</p>
<p>After Effects General Plug-ins (AEGPs) can add items to any After Effects menu, and additional panels listed in the Window menu. These menu items are indistinguishable from After Effects' own menu items.</p>
<p><a href="#aeios-aeios">AEIOs</a> and Photoshop Format plug-ins can appear in the <em>File &gt; Import</em> menu, or in the <em>Import File</em> dialog in the <em>Files of type</em> drop-down, depending on the type of importer. AEIOs and Format plug-ins can also appear as available output formats in the render queue.</p>
<p>BlitHook plug-ins are automatically loaded and used by AE, but do not appear in any menu or dialog. The plug-in may optionally provide a menu item that opens it's own custom settings dialog. It would register and update the menu item using the AEGP API.</p>
<p>It can registered to be called by After Effects to update the menu with <code>AEGP_RegisterUpdateMenuHook()</code>, and it can dim/activate the menu item using <code>AEGP_EnableCommand()</code>/<code>DisableCommand()</code>.</p>
<p>Artisans appear in the <em>Rendering Plug-in</em> drop-down in the <em>Advanced</em> tab of the <em>Composition Settings</em> dialog.</p>
<hr />
<h2 id="intro-what-can-i-do-how-does-after-effects-interact-with-plug-ins">How Does After Effects Interact With Plug-ins?<a class="headerlink" href="#intro-what-can-i-do-how-does-after-effects-interact-with-plug-ins" title="Permanent link">&para;</a></h2>
<p>Plug-ins, written in C or C++, are bundle packages on macOS and DLLs on Windows. They must contain a Plug-in Property List (<a href="#intro-pipl-resources">PiPL Resources</a>) resource on both platforms. The plug-ins must be located in one of a few specific folders in order to be loaded and used by After Effects.</p>
<p>For effects plug-ins, After Effects sends command selectors (and relevant information) to the plug-in <a href="#effect-basics-entry-point">Entry Point</a> designated in the effects' <a href="#intro-pipl-resources">PiPL Resources</a> resource. Selectors are sent in response to actions the user takes—applying the effect, changing parameters, scrubbing through frames in the timeline, and rendering all prompt different sequences of selectors.</p>
<p>After Effects creates multiple instances of effects, with settings and input data unique to each sequence. All instances share the same global data, and can share data between all frames within their sequence. After Effects doesn't process all image data as soon as the user applies an effect; it invokes effects only when their output is required.</p>
<p>After Effects General Plug-ins (AEGPs) have their entry point function called during application launch, and register for whatever messaging they need at that time. Further calls to the AEGP are initiated by user actions, as part of the plug-in's response to menu commands or UI events. Depending on their features, plug-ins may need to respond to OS-specific entry points as well, for UI work and thread management.</p>
<p>For BlitHook plug-ins, frames are pushed as they're displayed in the Composition panel. Users can initiate a RAM preview on an area of the timeline so that it is rendered to RAM, and then it all gets played out at full speed.</p>
<hr />
<h2 id="intro-what-can-i-do-sdk-contents">SDK Contents<a class="headerlink" href="#intro-what-can-i-do-sdk-contents" title="Permanent link">&para;</a></h2>
<p>The SDK contains headers defining the After Effects APIs, sample projects demonstrating integration features, and this SDK Guide.</p>
<p>They are compiled with the SDK header files, which expose various After Effects functionality to be used by the plug-in.</p></section><section class="print-page" id="intro-other-integration-possibilities"><h1 id="intro-other-integration-possibilities-other-integration-possibilities">Other Integration Possibilities<a class="headerlink" href="#intro-other-integration-possibilities-other-integration-possibilities" title="Permanent link">&para;</a></h1>
<p>Although this SDK describes the majority of integration possibilities with After Effects, there are other possibilities not to be overlooked.</p>
<hr />
<h2 id="intro-other-integration-possibilities-scripting">Scripting<a class="headerlink" href="#intro-other-integration-possibilities-scripting" title="Permanent link">&para;</a></h2>
<p>Scripting is a relatively nimble and lightweight means to perform automated tasks with After Effects. ScriptUI is one way you can provide UI integration with custom dialogs and panels (see <a href="#intro-other-integration-possibilities-html5-panels">HTML5 Panels</a> too). And scripting may be used in tandem with plug-in development, in the cases where a certain function is made available via scripting and not via the C APIs described in this document.</p>
<p>Scripting in After Effects is done using ExtendScript, based on JavaScript. After Effects includes the ExtendScript ToolKit, a convenient interface for creating and testing your own scripts. Scripts may be compiled into .jsxbin binary files, to protect intellectual property.</p>
<p>You can access the After Effects Scripting Guide, and find a link to the scripting forums, on the Adobe I/O website at: <a href="https://www.adobe.io/apis/creativecloud/aftereffects.html">https://www.adobe.io/apis/creativecloud/aftereffects.html</a></p>
<p>After Effects can be driven by executing scripts from the commandline. In your script, you can open the project and run script actions on it. So for example, you can execute the following statement to run a script from the command line directly:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-0-1">AfterFX<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;app.quit()&quot;</span>
</span></code></pre></div>
<p>Or you can execute this statement to run a .jsx script that includes a quit at the end:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1">AfterFX<span class="w"> </span>-r<span class="w"> </span>path_to_jsx_script
</span></code></pre></div>
<p>On Windows, AfterFX.com is the way to get feedback to the console, because AfterFX.com is a command line application.</p>
<hr />
<h2 id="intro-other-integration-possibilities-html5-panels">HTML5 Panels<a class="headerlink" href="#intro-other-integration-possibilities-html5-panels" title="Permanent link">&para;</a></h2>
<p>In CC 2014 and later, After Effects supports HTML5 panels. They are accessed in After Effects from Window &gt; Extensions &gt; (your panel name). Panels can be resized and docked just like any other panel in After Effects. Panels are built using HTML5, After Effects Scripting, and JavaScript. You may download the After Effects Panel SDK from the the Adobe I/O website at: <a href="https://www.adobe.io/apis/creativecloud/aftereffects.html">https://www.adobe.io/apis/creativecloud/aftereffects.html</a></p>
<hr />
<h2 id="intro-other-integration-possibilities-aerender">AERender<a class="headerlink" href="#intro-other-integration-possibilities-aerender" title="Permanent link">&para;</a></h2>
<p>Closely coupled with scripting is the command line interface offered by aerender. aerender is primarily suited to allow automated renders, but can be used to execute any sequence of scripting commands from the command line. An overview is available in the After Effects help documents here: <a href="https://helpx.adobe.com/after-effects/using/automated-rendering-network-rendering.html">https://helpx.adobe.com/after-effects/using/automated-rendering-network-rendering.html</a></p>
<hr />
<h2 id="intro-other-integration-possibilities-premiere-pro-importers">Premiere Pro Importers<a class="headerlink" href="#intro-other-integration-possibilities-premiere-pro-importers" title="Permanent link">&para;</a></h2>
<p>Premiere Pro importers provide support for importing media into applications across most applications in the Adobe Creative Cloud, including Premiere Pro, Media Encoder, Prelude, and Audition. Because of this broader compatibility, unless you need very specific integration with After Effects only available via the AEIO API in this SDK, we recommend developing a Premiere Pro importer. The Premiere Pro SDK is available at: <a href="https://www.adobe.io/apis/creativecloud/premierepro.html">https://www.adobe.io/apis/creativecloud/premierepro.html</a></p>
<p>One advantage of MediaCore importer plug-ins over AEIOs is its priority system: The highest priority importer gets first crack at importing a file, and if the particular imported file isn't supported, the next-highest priority importer will then have the opportunity to try importing it, and so on.</p>
<hr />
<h2 id="intro-other-integration-possibilities-mercury-transmit">Mercury Transmit<a class="headerlink" href="#intro-other-integration-possibilities-mercury-transmit" title="Permanent link">&para;</a></h2>
<p>Mercury Transmit plug-ins are used for sending video to output hardware for broadcast-quality monitoring. Transmitters are supported across most applications in the Adobe Creative Cloud, including Premiere Pro, After Effects, Prelude, and Character Animator. The Mercury Transmit API is documented in the Premiere Pro SDK, available at: <a href="https://www.adobe.io/apis/creativecloud/premierepro.html">https://www.adobe.io/apis/creativecloud/premierepro.html</a></p></section><section class="print-page" id="intro-sdk-audience"><h1 id="intro-sdk-audience-sdk-audience">SDK Audience<a class="headerlink" href="#intro-sdk-audience-sdk-audience" title="Permanent link">&para;</a></h1>
<p>You must be a proficient C/C++ programmer to write After Effects plug-ins. While we'll help with issues specific to the After Effects API, we can't help you learn your IDE or basic programming concepts.</p>
<p>This SDK guide assumes you understand After Effects from a user's perspective, and basic motion graphics terminology. If you don't, get the <a href="http://www.adobepress.com/store/adobe-after-effects-cc-classroom-in-a-book-2017-release-9780134665320">Adobe After Effects Classroom in a Book</a>, or any of the other fine instructional books on the market. It will help you understand necessary</p>
<p>topics such as alpha channels, pixel aspect ratio, interlacing, color spaces, and more for After Effects.</p>
<hr />
<h2 id="intro-sdk-audience-development-requirements">Development Requirements<a class="headerlink" href="#intro-sdk-audience-development-requirements" title="Permanent link">&para;</a></h2>
<p>The system requirements for After Effects are here: <a href="https://helpx.adobe.com/after-effects/system-requirements.html">https://helpx.adobe.com/after-effects/system-requirements.html</a></p>
<p>The SDK samples have been tested on Xcode 11.3.1 and Xcode 12.4 (for universal binary support with Apple Silicon) on macOS 10.15/11.0, and Microsoft Visual Studio 2019 on Windows 10.</p></section><section class="print-page" id="intro-whats-new"><h1 id="intro-whats-new-whats-new">What's New<a class="headerlink" href="#intro-whats-new-whats-new" title="Permanent link">&para;</a></h1>
<p>If this is your first time developing an After Effects plug-in, you can skip the What's New section and go directly to <a href="#intro-how-to-start-creating-plug-ins">How To Start Creating Plug-ins</a>.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-after-effects-2022">What's New In After Effects 2022<a class="headerlink" href="#intro-whats-new-whats-new-in-after-effects-2022" title="Permanent link">&para;</a></h2>
<p>After Effects 2022 contains the first full public release with Multi-Frame Rendering support. The associated AE Effects SDK released in October 2021 includes one change for increasing the maximum number of PF_Iterate threads.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-the-after-effects-sdk-in-march-2021">What's New in the After Effects SDK in March 2021<a class="headerlink" href="#intro-whats-new-whats-new-in-the-after-effects-sdk-in-march-2021" title="Permanent link">&para;</a></h2>
<h3 id="intro-whats-new-multi-frame-rendering-changes">Multi-Frame Rendering Changes<a class="headerlink" href="#intro-whats-new-multi-frame-rendering-changes" title="Permanent link">&para;</a></h3>
<ol>
<li>The final behavior for the <code>PF_OutFlag2_SUPPORTS_THREADED_RENDERING</code> flag is now in place. Setting this flag to indicate support for Multi-Frame Rendering will also enforce the data stored in <code>sequence_data</code> to be const/read-only at Render time and access to <code>sequence_data</code> is now through a suite, <code>PF_EffectSequenceDataSuite1</code>.</li>
<li>A new flag, <code>PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</code> is now available to set alongside <code>PF_OutFlag2_SUPPORTS_THREADED_RENDERING</code> if your plugin cannot be updated to work with the new sequence_data behavior. After Effects won't be able to apply as much rendering concurrency and therefore performance improvements to effects that set this flag (hence the _SLOWER flag name).</li>
<li>A new suite, the Compute Cache (previously referred to as the 3-way checkout cache) is now available. This suite provides a thread-safe cache that plugins can use as a replacement or supplement to sequence_data to support multiple render threads computing and caching data needed to render frames.</li>
</ol>
<p>Due to these changes, you must update to, and compile with, the March 2021 SDK to maintain Multi-Frame Rendering compatibility with AE Beta builds moving forward. Plugins compiled with the June 2020 SDK will cease to support Multi-Frame Rendering, even if <code>PF_OutFlag2_SUPPORTS_THREADED_RENDERING</code> is set, starting with AE 22.0x6 (released on June 29th 2021).</p>
<p>Please see <a href="#effect-details-multi-frame-rendering-in-ae">Multi-Frame Rendering in AE</a> for more information.</p>
<h3 id="intro-whats-new-apple-silicon-support">Apple Silicon Support<a class="headerlink" href="#intro-whats-new-apple-silicon-support" title="Permanent link">&para;</a></h3>
<ul>
<li>The AE SDK now supports building effects for Apple Silicon natively. While After Effects itself is not yet running on Apple Silicon, Adobe as a company is moving forward with native support across many of our products. Applications such as Premiere Pro now have native versions available, and your effects may be loaded in Premiere Pro by features such as Motion Graphic Templates. When running the native version of Premiere Pro only natively compiled effects will work so it's important to update your effects with Apple Silicon support soon. Please see the <a href="#intro-apple-silicon-support">Apple Silicon Support</a> section for more information.</li>
</ul>
<h3 id="intro-whats-new-exporting-symbols-from-effects">Exporting Symbols from Effects<a class="headerlink" href="#intro-whats-new-exporting-symbols-from-effects" title="Permanent link">&para;</a></h3>
<ul>
<li>The SDK samples have been updated on not export symbols by default on MacOS. Please see <a href="#intro-symbol-export">Exporting Symbols in Effects</a> for more information.</li>
</ul>
<h3 id="intro-whats-new-downloading-the-march-2021-sdk">Downloading the March 2021 SDK<a class="headerlink" href="#intro-whats-new-downloading-the-march-2021-sdk" title="Permanent link">&para;</a></h3>
<p>The SDK can be downloaded from the Adobe Developer Console at <a href="https://adobe.io/after-effects/">https://adobe.io/after-effects/</a></p>
<h3 id="intro-whats-new-after-effects-beta-builds">After Effects Beta Builds<a class="headerlink" href="#intro-whats-new-after-effects-beta-builds" title="Permanent link">&para;</a></h3>
<p>To gain access to the AE host-side changes for this SDK, you will need to download a new After Effects beta build from the Creative Cloud Desktop App. Builds 18.2x11 and above are supported with the March 2021 SDK.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-after-effects-beta-builds-after-june-2020">What's New In After Effects Beta builds after June 2020<a class="headerlink" href="#intro-whats-new-whats-new-in-after-effects-beta-builds-after-june-2020" title="Permanent link">&para;</a></h2>
<p>AE (currently only in Beta builds) now supports Multi-Frame rendering. See <a href="#effect-details-multi-frame-rendering-in-ae">Multi-Frame Rendering in AE</a> for more details.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-cc-2019-160">What's New In CC 2019 (16.0)?<a class="headerlink" href="#intro-whats-new-whats-new-in-cc-2019-160" title="Permanent link">&para;</a></h2>
<p>We've made some changes to how GPU effects are handled. See "GPU Effects Changes" for details.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-150">What's New In 15.0?<a class="headerlink" href="#intro-whats-new-whats-new-in-150" title="Permanent link">&para;</a></h2>
<p>After Effects now supports the <em>GPU effect rendering</em> previously supported in Premiere Pro. Note that unknown effects with a match name that includes "ADBE " will be excluded from GPU rendering, so make sure any of your GPU effects have your own custom match name. Effects that support GPU rendering will receive the GPU badge in the Effect panel.</p>
<p>The GPU effect sample projects in the Premiere Pro SDK have been updated to register as GPU effects in AE, although the render output still needs work.</p>
<p>A new entry point has been defined, to allow effects to register basic information with the host at runtime, without relying on legacy PiPL resources. An effect can register multiple entry points in a single binary this way. Premiere Pro is the first host to support this entry point, and After Effects will support this in a future release.</p>
<p>The effect sample projects have been updated to use this approach, while maintaining the PiPL for backwards compatibility.</p>
<p><code>AEGP_StreamSuite</code> is now at version 5, where <a href="#aegps-aegp-suites-aegp_streamsuite5">AEGP_GetExpression()</a> and <a href="#aegps-aegp-suites-aegp_streamsuite5">AEGP_SetExpression()</a> have been upgraded to support Unicode.</p>
<p><code>PF_AdvTimeSuite</code> is now at version 4, with a new call <a href="#effect-details-useful-utility-functions-pf_advtimesuite4">PF_TimeCountFrames()</a>, that returns the index of the frame in the current comp.</p>
<p>The new AEGP Math Suite provides helpful calls for matrix multiplication.</p>
<p>The application font is now Adobe Clean. Previously, the fonts used in After Effects' UI were Tahoma on Windows and Lucida Grande on macOS X. This is a proprietary font, and we can not make it available for use in your UI.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-cc-20171-142">What's New In CC 2017.1 (14.2)?<a class="headerlink" href="#intro-whats-new-whats-new-in-cc-20171-142" title="Permanent link">&para;</a></h2>
<ul>
<li>Layer Params can include Masks and Effects</li>
</ul>
<p>Effects that use layers as an input, such as Set Matte and Displacement Map, can now target the input layer's masks and effects, instead of only the source of the layer. This means that for there is no need to pre-compose layers just so that they can be referenced by an effect.</p>
<p>Where an effect includes a layer parameter, a new menu to the right of the layer selector allows you to choose whether to target the input layer from its source, masks, or effects:</p>
<ul>
<li>Source: targets only the source of the layer. Masks and effects are ignored.</li>
<li>Masks: targets the layer after its masks are applied. Effects are ignored.</li>
<li>Effects &amp; Masks: targets the layer after its masks and effects are applied.</li>
</ul>
<p>This control is similar to the View menu at the bottom of the Layer viewer panel, which allows you to render the layer from different positions in the rendering order: from its source, from its masks, or from its individual effects.</p>
<p>As this is a user-facing option, the design is intended to be transparent to the effect. From the effect's perspective, the input simply just includes the upstream effects and masks without any change to the effect. For any effect that uses layer params, here are some testing recommendations:</p>
<ul>
<li>Effect continues to work as expected.</li>
<li>Using new control in the layer param for Source/Mask/Effects works with effect.</li>
<li>Opening old projects or saving back to a previous version project does not break effect.</li>
<li>Confirm that effect cannot self-reference; meaning cannot use the effects on the layer as input for the same layer.</li>
<li>Suite Enhancements</li>
</ul>
<p>PF_AdvTimeSuite is now at version 3, providing a revised <a href="#effect-details-useful-utility-functions-pf_advtimesuite4">PF_GetTimeDisplayPref()</a> call that uses a revised <code>PF_TimeDisplayPrefVersion</code> parameter, that supports higher frame rates.
The previous version 2 of the call can now return an error if there is a problem with the values exceeding the range supported by the structure.</p>
<p>Comp Suite is now at version 11, with a new call, <a href="#aegps-aegp-suites-aegp_compsuite11">AEGP_ReorderCompSelection()</a>, to move a selection to a certain layer index.
It should be used along with <code>AEGP_SetSelection()</code>.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-cc-2017-141">What's New In CC 2017 (14.1)?<a class="headerlink" href="#intro-whats-new-whats-new-in-cc-2017-141" title="Permanent link">&para;</a></h2>
<p>Unicode support for <a href="#aegps-aegp-suites-aegp_itemsuite9">AEGP Item Suite</a> and <a href="#aegps-aegp-suites-render-queue-item-suite">AEGP Render Queue Item Suite</a>.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-cc-2017-140">What's New In CC 2017 (14.0)?<a class="headerlink" href="#intro-whats-new-whats-new-in-cc-2017-140" title="Permanent link">&para;</a></h2>
<p>The GLator sample is back! It has been updated to demonstrate proper OpenGL context management in an effect plug-in.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-cc-20153-138">What's New In CC 2015.3 (13.8)?<a class="headerlink" href="#intro-whats-new-whats-new-in-cc-20153-138" title="Permanent link">&para;</a></h2>
<p>PF_OutFlag_I_AM_OBSOLETE is now supported in Premiere Pro. Also, effect custom UI in Premiere Pro now supports high DPI displays, such as Retina Displays.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-cc-2015-136">What's New In CC 2015 (13.6)?<a class="headerlink" href="#intro-whats-new-whats-new-in-cc-2015-136" title="Permanent link">&para;</a></h2>
<p>New AEGP Item View Suite. This provides a way to get playback time for item view. Only the composition case is implemented in this release. The time passed back should be the playback time of the view when playing and the current (needle) time otherwise.</p>
<p>AEGP_RenderNewItemSoundData() has been reworked and provides functionality similar to 13.2.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-cc-2015-1351">What's New In CC 2015 (13.5.1)?<a class="headerlink" href="#intro-whats-new-whats-new-in-cc-2015-1351" title="Permanent link">&para;</a></h2>
<p>This release fixes some audio APIs that broke in 13.5 due to threading changes. In 13.5, when called on the UI thread, AEGP_RenderNewItemSoundData() would return A_Err_GENERIC. This restores the functionality when called on the UI thread.</p>
<p>To avoid a deadlock, in PF_Cmd_UPDATE_PARAMS_UI only, AEGP_RenderNewItemSoundData() will now return silence. This will no longer function as before in this context, but it will continue to work properly elsewhere.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-cc-2015-135">What's New In CC 2015 (13.5)?<a class="headerlink" href="#intro-whats-new-whats-new-in-cc-2015-135" title="Permanent link">&para;</a></h2>
<ul>
<li>Separate UI and Render Threads</li>
</ul>
<p>This release of After Effects includes major architectural changes to separate the UI (main) thread from the render thread. The render thread sends selectors such as PF_Cmd_RENDER, PF_Cmd_SMART_PRERENDER, and PF_Cmd_SMART_RENDER to effect plug-ins. The UI thread sends selectors such as PF_Cmd_SEQUENCE_SETUP, PF_Cmd_USER_CHANGED_PARAM, PF_Cmd_DO_DIALOG, and PF_EVENT_DRAW. PF_Cmd_SEQUENCE_RESETUP is</p>
<p>sent on both render and UI threads.</p>
<p>These changes are to improve interactive performance and responsiveness. At the same time, the new design introduces some new requirements and may break assumptions that existing plug-ins relied on. Here are some of the major changes:</p>
<ol>
<li>The project can no longer be modified by the render thread (and in fact the render thread now has its own local copy of the project)</li>
<li>Rendering cannot pass modified sequence data back to the UI thread for custom UI updates</li>
<li>In general the UI thread should no longer do time-consuming operations such as synchronously rendering frames</li>
</ol>
<p>Is your plug-in affected? Test for these problems:</p>
<ol>
<li>Render not updating after UI parameter change because it depends on sequence_data, which may not be currently copied to render</li>
<li>Render not updating during click/drag in the Composition Window (similar reasons)</li>
<li>Custom Effect UI not updating because it depends on sequence_data generated in render (which is no longer available to the UI because it is in a different project, the render project is immutable, and cache contains previously-rendered frames)</li>
<li>Errors telling you an operation on the render thread (or UI thread) is not expected</li>
</ol>
<p>Generally, calculations that will persist or update the UI will now have to be pulled from the UI thread rather than pushed from the render thread. These cases can require use of new</p>
<p>13.5 APIs or different solutions than in past releases.</p>
<ul>
<li>The Need For More Efficient Sequence Data Handling</li>
</ul>
<p>PF_OutFlag2_SUPPORTS_GET_FLATTENED_SEQUENCE_DATA</p>
<p>PF_Cmd_GET_FLATTENED_SEQUENCE_DATA</p>
<p>Up to version 13.2, serializing/flattening sequence_data always involved deallocating and reallocating any data structures. Starting in 13.5, as effect changes are made, serializing/ flattening happens even more often. Why? AE needs to serialize/flatten project changes to send from the UI thread to the render thread, to keep them both synchronized.</p>
<p>To make this process more efficient, starting in 13.5, AE can send PF_Cmd_GET_FLATTENED_SEQUENCE_DATA to request sequence data without requiring the existing data to be deallocated and reallocated. The main difference between this selector and PF_Cmd_SEQUENCE_FLATTEN is that a copy of the correct flattened state is returned without disposing the original structure(s) the effect is currently using. For a code example, refer to the PathMaster sample project.</p>
<p>This will eventually become required for plug-ins that are rebuilt to be thread-safe (see PF_OutFlag2_AE13_5_THREADSAFE below). The venerable PF_Cmd_SEQUENCE_FLATTEN will eventually be unsupported in future versions.</p>
<ul>
<li>PF_OutFlag_FORCE_RERENDER Changes</li>
</ul>
<p>Where possible, we recommend triggering rerenders using one of the following: GuidMixInPtr() (described in the next section), arb data, or PF_ChangeFlag_CHANGED_VALUE. All of these allow cached frames to be reused after an Undo.</p>
<p>Note: As of 14.0, setting PF_ChangeFlag_CHANGED_VALUE for layer or path params is not triggering a rerender. Instead, you may change set the value using AEGP_StreamSuite-</p>
<blockquote>
<p>AEGP_SetStreamValue().</p>
</blockquote>
<p>FORCE_RERENDER is still needed for situations where sequence_data needs to be copied from the UI thread to the render project/effect clone to keep them matched.</p>
<p>FORCE_RERENDER is the trigger for this whether the render request uses the cache or not. Once we have the full set of APIs in place needed to manage render state, we will be able to deprecate FORCE_RERENDER.</p>
<p>FORCE_RERENDER doesn't work in every situation it did before, because it needs to synchronize the UI copy of sequence_data with the render thread copy.</p>
<p>FORCE_RERENDER works when set during PF_Cmd_USER_CHANGED_PARAM. It also works in CLICK and DRAG events, but only if PF_Cmd_GET_FLATTENED_SEQUENCE_DATA is implemented. This is required to prevent flattening and loss of UI state in the middle of mouse operations. Without GET_FLATTENED, the new FORCE_RERENDER behavior will NOT be turned on.</p>
<ul>
<li>GUIDs for Cached Frames</li>
</ul>
<p>PF_OutFlag2_I_MIX_GUID_DEPENDENCIES</p>
<p>GuidMixInPtr()</p>
<p>Used by SmartFX only. Use this if custom UI or PF_Cmd_DO_DIALOG changes sequence data, or if the render result depends on anything else not factored in, and rerendering may be needed. During PF_Cmd_SMART_PRERENDER, the effect can call GuidMixInPtr() to mix any additional state that affects the render into our internal GUID for the cached frame. Using this GUID, AE can tell whether the frame already exists or if it needs to be rendered. See an example in SmartyPants sample project.</p>
<p>This is an improvement over the older mechanisms PF_OutFlag_FORCE_RERENDER and PF_Cmd_DO_DIALOG, which would remove the frame from the cache because the host didn't know what else the plug-in was factoring into the rendering. This can also be used rather than PF_OutFlag2_OUTPUT_IS_WATERMARKED.</p>
<ul>
<li>Request Frames Asynchronously Without Blocking the UI</li>
</ul>
<p>PF_OutFlag2_CUSTOM_UI_ASYNC_MANAGER</p>
<p>PF_GetContextAsyncManager() AEGP_CheckoutOrRender_ItemFrame_AsyncManager() AEGP_CheckoutOrRender_LayerFrame_AsyncManager()</p>
<p>For cases where such renders formerly were triggered by side-effect or cancelled implicity</p>
<p>(such as custom UI histogram drawing), and lifetime is less clear from inside the plug-in, use the new "Async Manager" which can handle multiple simultaneous async requests for effect Custom UI and will automatically support interactions with other AE UI behavior.</p>
<p>Note: Async retrieval of frames is preferred for handling passive drawing situations, but not when a user action will update the project state. If you are (1) responding to a specific user click, AND 2) you need to update the project as a result, the synchronous AEGP_RenderAndCheckoutLayerFrame() is recommended.</p>
<p>The new HistoGrid sample in the SDK shows how to do completely asynchronous custom UI DRAW event handling on the UI thread when 1 or more frame renders are needed. e.g. for calculating histograms that are shown in the effect pane. Please note there is still a known bug where drag-changing an upstream param may not refresh the histogram draw until the mouse hovers over it.</p>
<ul>
<li>Get Rendered Output of an Effect from its UI</li>
</ul>
<p>Effects such as keyers or those that draw histograms of post-processed video can retrieve the needed AEGP_LayerRenderOptionsH using the new function AEGP_NewFromDownstreamOfEffect() in AEGP_LayerRenderOptionsSuite. This function may only be called from the UI thread.</p>
<ul>
<li>AEGP Usage on Render Thread</li>
</ul>
<p>We've tightened validation of when AEGP calls could be used dangerously (such as from the wrong thread or making a change to the project state in render). You may see new errors if code is hitting such cases. For example, making these calls on the render thread will result in an error:</p>
<p>suites.UtilitySuite5()-&gt;AEGP_StartUndoGroup() suites.StreamSuite2()-&gt;AEGP_GetStreamName() suites.StreamSuite2()-&gt;AEGP_SetExpressionState() suites.StreamSuite2()-&gt;AEGP_SetExpression() suites.StreamSuite2()-&gt;AEGP_GetNewLayerStream() suites.StreamSuite2()-&gt;AEGP_DisposeStream() suites.EffectSuite3()-&gt;AEGP_DisposeEffect() suites.UtilitySuite5()-&gt;AEGP_EndUndoGroup()</p>
<p>The solution is to move these calls to the UI thread. Selectors for passive UI updates (such as PF_EVENT_DRAW) are not a place to make changes to project state.</p>
<p>Another example of more strict requirements is AEGP_RegisterWithAEGP(). The documentation has always noted that this function must be called on PF_Cmd_GLOBAL_SETUP. However in previous versions, plug-ins were able to call this function at other times without running into trouble. Not anymore in 13.5! Calling this function at other times can cause crashes!</p>
<ul>
<li>PF_Cmd_SEQUENCE_RESETUP Called on UI or Render Thread?</li>
</ul>
<p>There is now a PF_InFlag_PROJECT_IS_RENDER_ONLY flag that is only valid in PF_Cmd_SEQUENCE_RESETUP that will tell you if the effect instance is for render-only purposes. If so, the project should be treated as completely read-only, and you will not be receiving UI related selectors on that effect instance. This can be used to optimize away any UI-only initialization that render does not need. If this flag is false, you should setup UI as normal. This should not be used to avoid reporting errors in render. Errors in render should be reported as usual via existing SDK mechanisms.</p>
<ul>
<li>Changes to Avoid Deadlocks</li>
</ul>
<p>During development, it was noticed that deadlocks could occur in specific call usage. Seatbelts have been introduced to avoid this. The cases occur in PF_Cmd_UPDATE_PARAMS_UI when using particular calls because of deprecated synchronous behavior in these calls when used in the UI:</p>
<p>In PF_Cmd_UPDATE_PARAMS_UI only, PF_PARAM_CHECKOUT() for layer parameters will behave as before except that it will return a black frame of the same size, etc., rather than actual rendered pixels. Code that used this for enable/disable detection of parameters should still work as before. Code that used this for getting analysis frames, etc. outside of PF_Cmd_UPDATE_PARAMS_UI will work as before.</p>
<p>In PF_Cmd_UPDATE_PARAMS_UI only, PF_GetCurrentState() will now return a random GUID. This will no longer function as before in this context, but it will continue to work properly elsewhere.</p>
<p>The above uses should be rare, but if this affects you please contact us about workarounds.</p>
<ul>
<li>Deprecated</li>
</ul>
<p>AEGP_RenderAndCheckoutFrame() (on the UI Thread). This call should generally not be used on the UI thread since synchronous renders block interactivity.</p>
<p>Use in the render thread is fine. The one case where this may still be useful on the UI thread is a case like a UI button that requires a frame to calculate a parameter which then updates the AE project.</p>
<p>For example, an "Auto Color" button that takes a frame and then adjusts effect params as a result.</p>
<p>A beta of a progress dialog for this blocking operation if it is slow has been implemented, but using this call on the UI thread should be limited to this special cases. The dialog design is not final.</p>
<ul>
<li>Flag for Thread-Safe Effects</li>
</ul>
<p>PF_OutFlag2_AE13_5_THREADSAFE</p>
<p>Plug-ins updated for threading should use this flag to tell AE that the plug-in is expected to be UI thread &lt;&gt; Render thread safe.</p>
<p>This flag tells AE that different threads on different AE project copies can be in the effect at the same time but not accessing the same instance. While multiple render threads are not yet in use, this will be useful in future releases.</p>
<ul>
<li>Support for Effect Version greater than 7 (new max is MAJOR version 127)</li>
</ul>
<p>Effects greater than version 7 will now report properly in 13.5 if built with the current SDK headers. It is possible to use these recompiled effects in AE versions older than 13.5, but internally the version number will wrap modulo 8 (e.g. AE will internally see effect version 8 as version 0).</p>
<p>This can affect the version shown in error dialog display by older AE and affect usage reporting.</p>
<p>Since many older plug-ins were made unloadable in AE with the shift to 64-bit, it should be unlikely this wrapping would cause ambiguity with actual plug-ins in current use (unless these plug-ins have been rapidly increasing version number over the last few years).</p>
<p>However, building with an older SDK and using an 8 or higher version will result in the plug-in reporting an incorrect version to AE, which will then cause mismatch with the PiPL version check for the effect which will have the higher bits set. This is not supported.</p>
<p>If built with an older SDK, you will need to keep the effect version at 7 or below. Increase in version max has been accomplished by adding 4 new higher significant bits to the version that only AE 13.5 and above "sees". These new high version bits are not contiguous with the original, preexisting MAJOR version bits - just ignore the intermediate bits. The new version layout looks like this in hexadecimal or binary.</p>
<p>0x 3C38 0000</p>
<p>^^ original MAJOR version bits as a hex mask 0-7</p>
<p>^^ new HIGH bits extending the original MAJOR version bits 8-127</p>
<p>0b 0011 1100 0011 1000 0000 0000 0000 0000</p>
<p>^^ ^ original MAJOR version bits as a hex mask 0-7</p>
<p>^^ ^^ ignore / do not use</p>
<p>^^ ^^ new HIGH bits extend the original MAJOR version bits 8-127.</p>
<p>These bits are ignored in AE versions older than 13.5.</p>
<ul>
<li>New Installer Hints for macOS</li>
</ul>
<p>Developers can find paths to the default location of plug-ins, scripts, and presets on macOS X in a new plist file (same as the paths in the Windows registry): /Library/Preferences/ com.Adobe.After Effects.paths.plist</p>
<p>You can use the values in this plist to direct where your installers or scripts write files, in the same way that you would use the paths keys in the registry on Windows: HKEY_LOCAL_MACHINESOFTWAREAdobeAfter Effects13.5</p>
<ul>
<li>Work In Progress</li>
</ul>
<p>AEGP_RenderAndCheckoutLayerFrame_Async() AEGP_CancelAsyncRequest()</p>
<p>This APIs are in progress, and should not be used yet.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-cc-20141-131">What's New In CC 2014.1 (13.1)?<a class="headerlink" href="#intro-whats-new-whats-new-in-cc-20141-131" title="Permanent link">&para;</a></h2>
<p>PF_CreateNewAppProgressDialog()</p>
<p>It won't open the dialog unless it detects a slow render. (2 seconds timeout).</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-cc-2014-130">What's New In CC 2014 (13.0)?<a class="headerlink" href="#intro-whats-new-whats-new-in-cc-2014-130" title="Permanent link">&para;</a></h2>
<p>Starting in CC 2014, After Effects will now honor a change to a custom UI height made using <a href="#effect-details-parameter-supervision-pf_paramutilsuite3">PF_UpdateParamUI</a>.</p>
<p><a href="#aegps-aegp-suites-aegp_effectsuite4">AEGP Effect Suite</a> is now at version 4, adding new functions to work with effect masks. <a href="#aegps-aegp-suites-aegp_rendersuite4">AEGP_RenderSuite</a> is now at version 4, adding a new function <code>AEGP_RenderAndCheckoutLayerFrame</code>, which allows frame checkout of the current</p>
<p>layer with effects applied at non-render time. This is useful for an operation that requires the frame, for example, when a button is clicked and it is acceptable to wait for a moment while it is rendering.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since it is not asynchronous, it will not solve the general problem where custom UI needs to draw based on the frame.</p>
</div>
<p>The layer render options are specified using the new <a href="#aegps-aegp-suites-aegp_renderoptionssuite4">AEGP_LayerRenderOptionsSuite</a>.</p>
<p><a href="#intro-other-integration-possibilities-mercury-transmit">Mercury Transmit</a> plug-ins and <a href="#intro-other-integration-possibilities-html5-panels">HTML5 Panels</a> are now supported.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-cc-120">What's New In CC (12.0)?<a class="headerlink" href="#intro-whats-new-whats-new-in-cc-120" title="Permanent link">&para;</a></h2>
<p>Effect names can now be up to 47 characters long, up from 31 characters previously.</p>
<p>We added the <a href="#effect-details-parameters-floating-point-values-pf_angleparamsuite1">PF_AngleParamSuite</a>, providing a way to get floating point values for angle parameters. <a href="#effect-details-useful-utility-functions">PF App Suite</a> version 5 adds <code>PF_AppGetLanguage</code> to query the current language so that a plug-in can use the correct language string, as well as several new PF_App_ColorType enum values for new elements whose colors can be queried.</p>
<p><a href="#aegps-aegp-suites-persistent-data-suite">AEGP Persistent Data Suite</a> is now at version 4, adding a new parameter to AEGP_GetApplicationBlob to choose between retrieving several different application blobs. There are also new functions to get/set time and ARGB values.</p>
<p><a href="#aegps-aegp-suites-aegp_compositesuite2">AEGP Composition Suite</a> is now at version 10, adding new functions to check/modify whether layer names or source names are shown, and whether the blend modes column is shown or not. Also added are new functions to get and set the Motion Blur Adaptive Sample Limit.</p>
<p><a href="#aegps-aegp-suites-aegp_layersuite9">AEGP Layer Suite</a> is now at version 8, adding new functions to set/get the layer sampling quality. <a href="#artisans-artisan-data-types-aegp_canvassuite8">AEGP_CanvasSuite</a> is also now at version 8. The new function <code>AEGP_MapCompToLayerTime</code> handles time remapping with collapsed or nested comps, unlike AEGP_ConvertCompToLayerTime.</p>
<p><a href="#aegps-aegp-suites-aegp_utilitysuite6">AEGP_UtilitySuite</a> is now at version 6, adding a new Unicode-aware function: <code>AEGP_ReportInfoUnicode</code>. Another new function, <code>AEGP_GetPluginPaths</code>, provides some useful paths related to the plug-in and the After Effects executable itself.</p>
<p>The behavior for <code>AEGP_NewPlaceholderFootageWithPath</code> has been updated, so that the file_type should now be properly set, otherwise a warning will appear.</p>
<p><code>AEGP_InsertMenuCommand</code> can now insert menu items in the File&gt;New submenu.</p>
<p><a href="#aeios-new-kids-on-the-function-block-aegp_ioinsuite5">AEGP_IOInSuite</a> is now at version 5, adding new functions to get/set/clear the native start time, and to get/set the drop-frame setting of footage.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-cs601-1101">What's New In CS6.0.1 (11.0.1)?<a class="headerlink" href="#intro-whats-new-whats-new-in-cs601-1101" title="Permanent link">&para;</a></h2>
<p>New in 11.0.1, the AE effect API version has been incremented to 13.3.</p>
<p>This allows effects to distinguish between 11.0 and 11.0.1.</p>
<p>There is a bug in 11.0 with the Global Performance Cache, when a SmartFX effect uses both <code>PF_OutFlag2_AUTOMATIC_WIDE_TIME_INPUT</code> &amp; <code>PF_OutFlag_NON_PARAM_VARY</code>.</p>
<p>Calling <code>checkout_layer</code> during <code>PF_Cmd_SMART_PRE_RENDER</code> returns empty rects in <code>PF_CheckoutResult</code>.</p>
<p>The workaround is to simply make the call again. This workaround is no longer needed in 11.0.1.</p>
<hr />
<h2 id="intro-whats-new-whats-new-in-cs6-110">What's New In CS6 (11.0)?<a class="headerlink" href="#intro-whats-new-whats-new-in-cs6-110" title="Permanent link">&para;</a></h2>
<p>We've made several refinements for better parameter UI handling. <code>PF_PUI_INVISIBLE</code> parameter UI flag is now supported in After Effects, which is useful if your plug-in needs hidden parameters that affect rendering. Now when a plug-in disables a parameter using <a href="#effect-details-parameter-supervision-pf_paramutilsuite3">PF_UpdateParamUI</a>, we now save that state in the UI flags so that the plug-in can check the flag in the future to see if it is disabled. A new flag, <code>PF_ParamFlag_SKIP_REVEAL_WHEN_UNHIDDEN</code>, allows a parameter to be unhidden without twirling open any parents and without scrolling the parameter into view in the Effect Controls panel and the Timeline panel.</p>
<p>Effects that render a watermark over the output when the plug-in is in trial mode can now tell After Effects whether watermark rendering mode is on or off, using the new <code>PF_OutFlag2_OUTPUT_IS_WATERMARKED</code>.</p>
<p>The new Global Performance Cache means you must tell After Effects to discard old cached frames <a href="#effect-details-tips-tricks-caching-behavior">when changing your effect's rendering</a>.</p>
<p>We've removed <code>PF_HasParamChanged</code> and <code>PF_HaveInputsChangedOverTimeSpan</code>, providing <a href="#effect-details-parameter-supervision-pf_paramutilsuite3">PF_AreStatesIdentical</a> instead.</p>
<p>Effects that provide custom UI can now receive <code>PF_Event_MOUSE_EXITED</code>, to gain notification that the mouse exited the layer or comp panel. <code>PF_ParamUtilsSuite</code> is now at version 3.</p>
<p><code>PF_GET_PLATFORM_DATA</code> now has new selectors for getting the wide character path of the executable and resource file: <code>PF_PlatData_EXE_FILE_PATH_W</code> and <code>PF_PlatData_RES_FILE_PATH_W</code>. The previous non-wide selectors are now deprecated.</p>
<p>3D is a major theme of AE CS6. A new <code>AEGP_LayerFlag_ENVIRONMENT_LAYER</code> has been added. Many new <a href="#aegps-aegp-suites-aegp_streamsuite5">layer streams</a> were added.</p>
<p>Additionally, <code>AEGP_LayerStream_SPECULAR_COEFF</code> was renamed to <code>AEGP_LayerStream_SPECULAR_INTENSITY</code>, <code>AEGP_LayerStream_SHININESS_COEFF</code> was renamed to <code>AEGP_LayerStream_SPECULAR_SHININESS</code>, and <code>AEGP_LayerStream_METAL_COEFF</code> was renamed to just <code>AEGP_LayerStream_METAL</code>.</p>
<p>A new suite, <a href="#aegps-aegp-suites-render-queue-monitor-suite">AEGP_RenderQueueMonitorSuite</a>, provides all the info a render queue manager needs to figure out what is happening at any point in a render.</p>
<p><a href="#aegps-aegp-suites-aegp_masksuite6">AEGP Mask Suite</a> is now at version 6, and provides functions to get and set the mask feather falloff type. <a href="#aegps-aegp-suites-aegp_maskoutlinesuite3">AEGP Mask Outline Suite</a> is now at version 3, and provides access to get and set mask outline feather information.</p>
<p>Effects that depend on masks now have a new flag available, <code>PF_OutFlag2_DEPENDS_ON_UNREFERENCED_MASKS</code>.</p>
<p><a href="#aegps-aegp-suites-aegp_compositesuite2">AEGP Composition Suite</a> is now at version 9. AEGP_CreateTextLayerInComp and</p>
<p>AEGP_CreateBoxTextLayerInComp now have a new parameter, select_new_layerB.</p>
<p><a href="#aegps-aegp-suites-aegp_rendersuite4">AEGP Render Suite</a> is now at version 3, adding a new function to get the GUID for a render receipt.</p>
<p>Finally, we have added two new read-only <a href="#aegps-aegp-suites-aegp_dynamicstreamsuite4">Dynamic Stream</a> flags: <code>AEGP_DynStreamFlag_SHOWN_WHEN_EMPTY</code> and <code>AEGP_DynStreamFlag_SKIP_REVEAL_WHEN_UNHIDDEN</code>.</p>
<p>For effects running in Premiere Pro CS6, we have added the ability to get 32-bit float and YUV frames from <code>PF_CHECKOUT_PARAM</code>.</p>
<hr />
<h2 id="intro-whats-new-and-what-was-new-before-cs6">...and what was new before CS6?<a class="headerlink" href="#intro-whats-new-and-what-was-new-before-cs6" title="Permanent link">&para;</a></h2>
<p>For history this far back, see obsolete copies of the SDK (which we don't provide; if someone wants you do develop for antique software, they'd best provide the SDK).</p></section><section class="print-page" id="intro-how-to-start-creating-plug-ins"><h1 id="intro-how-to-start-creating-plug-ins-how-to-start-creating-plug-ins">How To Start Creating Plug-ins<a class="headerlink" href="#intro-how-to-start-creating-plug-ins-how-to-start-creating-plug-ins" title="Permanent link">&para;</a></h1>
<h2 id="intro-how-to-start-creating-plug-ins-play">Play!<a class="headerlink" href="#intro-how-to-start-creating-plug-ins-play" title="Permanent link">&para;</a></h2>
<p>Before you write a line of code, Spend some significant time playing with After Effects, and with the <a href="#intro-sample-projects">Sample Projects</a>. Build the plug-ins into the right folder. Set lots of breakpoints, read the amusing and informative comments.</p>
<p>See a quickstart video on building an effect (on macOS): <a href="https://assets.adobe.com/public/08c43fb7-4633-4007-5201-b3b77405d770?scid=social_20180227_75678337">quickstart video</a></p>
<hr />
<h2 id="intro-how-to-start-creating-plug-ins-plan">Plan!<a class="headerlink" href="#intro-how-to-start-creating-plug-ins-plan" title="Permanent link">&para;</a></h2>
<p>Be clear on what your plug-in will attempt to do.</p>
<hr />
<h2 id="intro-how-to-start-creating-plug-ins-hack">Hack!<a class="headerlink" href="#intro-how-to-start-creating-plug-ins-hack" title="Permanent link">&para;</a></h2>
<p>After experimenting with the samples, find one that does something <em>like</em> what you want to do. The temptation to start from scratch may be strong; fight it! For effects, use the Skeleton template project. Avoid the headache of reconstructing projects (including the troublesome custom build steps for Windows PiPL resource generation) by grafting your code into an existing project.</p>
<hr />
<h2 id="intro-how-to-start-creating-plug-ins-steal">Steal!<a class="headerlink" href="#intro-how-to-start-creating-plug-ins-steal" title="Permanent link">&para;</a></h2>
<p>To make the Skeleton sample your own, copy the entire \Skeleton directory, renaming it to (for example) \WhizBang. Using your text editor of choice, search \WhizBang*.* (yes, that includes .NET and Xcode project files) for occurrences of Skeleton and SKELETON, and replace them with WhizBang and WHIZBANG.</p>
<p>You now have a compiling and running plug-in that responds to common commands, handles 8 and 16-bpc color, uses our AEGP_SuiteHandler utility code, and responds to 3D light and camera information. There, was that so hard?</p>
<p>AEGP developers will do well to start with Projector (for After Effects project creation support), Easy Cheese for a keyframe assistant, IO for media file format support, and Persisto for a simple menu command and working with preferences.</p>
<hr />
<h2 id="intro-how-to-start-creating-plug-ins-test">Test!<a class="headerlink" href="#intro-how-to-start-creating-plug-ins-test" title="Permanent link">&para;</a></h2>
<p>If only for testing convenience, you should have a project saved with your effect applied, and all its parameters keyframed to strange values. Between these projects which stress your plug-in, and the tools provided by your development environment, you're well on your way to shipping some tested code.</p>
<hr />
<h2 id="intro-how-to-start-creating-plug-ins-blame">Blame!<a class="headerlink" href="#intro-how-to-start-creating-plug-ins-blame" title="Permanent link">&para;</a></h2>
<p>If you run into behavior that seems wrong, see if you can reproduce the behavior using one of the unmodified sample projects. This can save you a lot of time, if you can determine whether the bug behavior was introduced by your modifications, or was already there to begin with.</p>
<hr />
<h2 id="intro-how-to-start-creating-plug-ins-developers-matter">Developers Matter<a class="headerlink" href="#intro-how-to-start-creating-plug-ins-developers-matter" title="Permanent link">&para;</a></h2>
<p>Third party developers drive API and SDK improvement and expansion. Your products enable After Effects to do things we'd never considered. Your efforts make After Effects better; keep it up!</p>
<p>We work hard on the SDK, and welcome your comments and feedback. Almost every change we make to the API is suggested by developers like you. <a href="https://community.adobe.com/t5/after-effects/bd-p/after-effects?page=1&amp;sort=latest_replies&amp;filter=all&amp;topics=label-sdkcom">Give us feedback</a></p></section><section class="print-page" id="intro-sample-projects"><h1 id="intro-sample-projects-sample-projects">Sample Projects<a class="headerlink" href="#intro-sample-projects-sample-projects" title="Permanent link">&para;</a></h1>
<p>There is at least one sample of every type of plug-in supported by the current API, as well as projects to illustrate particular concepts.</p>
<p>In the sample projects, we've kept the code as simple as possible. A showy implementation might get us good grades in a programming class, but won't help you understand how to use API features.</p>
<p>After the break, we explain how to build the sample projects, so keep reading below!</p>
<hr />
<h2 id="intro-sample-projects-sample-project-descriptions">Sample Project Descriptions<a class="headerlink" href="#intro-sample-projects-sample-project-descriptions" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Project</p>
</th>
<th colspan="1" rowspan="1">
<p>Description</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p>AEGPs</p>
</td>
<td colspan="1" rowspan="1">
<p>AEGPs hook directly into After Effects' menus and other areas in the UI.</p>
<p>See below for specifics on where the AEGP appears in the UI.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Artie</p>
</td>
<td colspan="1" rowspan="1">
<p>Artie the Artisan takes over rendering of all 3D layers in a given composition.</p>
<p>This is the same API used by our internal 3D renderers; it is very complex, and exposes a great deal of tacit information about the After Effects rendering pipeline.</p>
<p>Unless you have a compelling reason to replace the way After Effects handles 3D rendering, you need never work with this sample.</p>
<p>Artisans appear in Composition &gt; Composition Settings, in the Advanced tab, in the Rendering Plug-in drop-down.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Easy Cheese</p>
</td>
<td colspan="1" rowspan="1">
<p>A keyframer (which shows up on the Animation &gt; Keyframe Assistant submenu), Easy Cheese shows how to manipulate various characteristics of keyframes (in a way that, uncannily, resembles our shipping plug-in, Easy Ease...)</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>FBIO</p>
</td>
<td colspan="1" rowspan="1">
<p>Exercises the After Effects Input/Output (AEIO) API. Similar to the IO sample, but supports the frame-based .ffk file format.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We now recommend developing a <a href="#intro-other-integration-possibilities-premiere-pro-importers">Premiere Pro Importers</a> instead.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Grabba</p>
</td>
<td colspan="1" rowspan="1">
<p>Gets frames (formatted as the plug-in requests) from any composition in the project.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>IO</p>
</td>
<td colspan="1" rowspan="1">
<p>Exercises the After Effects Input/Output (AEIO) API. Supports the fictitious .fak file format, and handles all requests from After Effects for retrieving data from or outputting to such files.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We now recommend developing a <a href="#intro-other-integration-possibilities-premiere-pro-importers">Premiere Pro Importers</a> instead.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Mangler</p>
</td>
<td colspan="1" rowspan="1">
<p>Mangler is a keyframer demonstrating the use of an ADM palette, just like our own.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Panelator</p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a panel that can be docked along with the rest of the standard panels.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is far more work to create a panel this way than using the HTML5 Panel SDK.</p>
<p>We recommend starting with that SDK instead.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Persisto</p>
</td>
<td colspan="1" rowspan="1">
<p>Shows how to read and write information from the After Effects preferences file.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>ProjDumper</p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a text file representing every element in an After Effects project.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Projector</p>
</td>
<td colspan="1" rowspan="1">
<p>Imports the (fictitious) .sdk file format, and creates a project using AEGP API calls.</p>
<p>Whenever you're wondering how to get or set some characteristic of a project element, look here first.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are some hardcoded paths in Projector.h. If you don't set these to refer to actual media on disk, you WILL get errors while running this plug-in. Don't blame us; change them!</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>QueueBert</p>
</td>
<td colspan="1" rowspan="1">
<p>Pronounced "Cue-BARE!", QueueBert manipulates all aspects of render queue items and the output modules associated with them.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Streamie</p>
</td>
<td colspan="1" rowspan="1">
<p>Manipulates streams, both dynamic and fixed.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Sweetie</p>
</td>
<td colspan="1" rowspan="1">
<p>Sweetie uses the PICA (or "Suite Pea") API to provide a function Suite, for use by other plug-ins.</p>
<p>If you're writing multiple plug-ins that rely on the same image processing library, you could provide the library functionality using such a suite.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Text Twiddler</p>
</td>
<td colspan="1" rowspan="1">
<p>Manipulates text layers and their contents.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Effects</p>
</td>
<td colspan="1" rowspan="1">
<p>All effects appear in the Effects &amp; Presets panel, and in the Effect menu.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Checkout</p>
</td>
<td colspan="1" rowspan="1">
<p>Checks out (of After Effects' frame cache) a frame of input from another layer, at a specified time.</p>
<p>This is an important concept for all effects with layer parameters. Premiere Pro compatible.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Convolutrix</p>
</td>
<td colspan="1" rowspan="1">
<p>Exercises our image convolution callbacks. Premiere Pro compatible.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Gamma Table</p>
</td>
<td colspan="1" rowspan="1">
<p>Shows how to manage sequence data, and uses our iteration callbacks.</p>
<p>For nostalgia's sake, we're leaving this one sample in C; it's also compatible with many third-party plug-in hosts, due to its reliance on version 3.x API features.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>GLator</p>
</td>
<td colspan="1" rowspan="1">
<p>New for CC 2017. Demonstrates proper OpenGL context management in an effect plug-in.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Paramarama</p>
</td>
<td colspan="1" rowspan="1">
<p>Exercises wayward param types not used in other sample. Premiere Pro compatible.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>PathMaster</p>
</td>
<td colspan="1" rowspan="1">
<p>Shows how to access paths from within an effect.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Portable</p>
</td>
<td colspan="1" rowspan="1">
<p>Shows how to detect and respond to several different plug-in hosts. Premiere Pro compatible.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Resizer</p>
</td>
<td colspan="1" rowspan="1">
<p>Resizer resizes (surprise!) the output buffer. This is useful for effects like glows and drop shadows, which would be truncated at the layer's edges if they didn't expand the output buffer.</p>
<p>Premiere Pro compatible.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>SDK Backwards</p>
</td>
<td colspan="1" rowspan="1">
<p>Reverses a layer's audio, and mixes it with a keyframe-able sine wave.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>SDK Noise</p>
</td>
<td colspan="1" rowspan="1">
<p>Premiere Pro compatible, demonstrates 32-bit and YUV rendering in Premiere Pro.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Shifter</p>
</td>
<td colspan="1" rowspan="1">
<p>Shifts an image in the output buffer, and exercises our transform_world and subpixel sampling functions.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>SmartyPants</p>
</td>
<td colspan="1" rowspan="1">
<p>Demonstrates the SmartFX API, required for support of floating point pixels.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Transformer</p>
</td>
<td colspan="1" rowspan="1">
<p>Exercises our image transformation callbacks.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Effect Template</p>
</td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Skeleton</p>
</td>
<td colspan="1" rowspan="1">
<p>Skeleton is the starting point for developing effects. Premiere Pro compatible.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Effects with Custom UI</p>
</td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>CCU</p>
</td>
<td colspan="1" rowspan="1">
<p>Implements a custom user interface in the composition and layer windows, supporting pixel aspect ratio and downsample ratios. Premiere Pro compatible.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>ColorGrid</p>
</td>
<td colspan="1" rowspan="1">
<p>Shows how to use arbitrary data type parameters. Also has a nice custom UI. Premiere Pro compatible.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Custom ECW UI</p>
</td>
<td colspan="1" rowspan="1">
<p>Implements a very boring custom user interface in the effect controls window, and shows how to respond to numerous UI events.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Histogrid</p>
</td>
<td colspan="1" rowspan="1">
<p>New for CC 2015 (13.5). An example of how custom UI can access asynchronously-rendered upstream frames for lightweight processing in CC 2015 and later.</p>
<p>This effect calculates a sampled 10x10 color grid from the upstream frame, and displays a preview of that color grid.</p>
<p>In render, a higher-quality grid is calculated and used to modify the output image, creating a blend of a color grid with the original image.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Supervisor</p>
</td>
<td colspan="1" rowspan="1">
<p>Shows how to control parameters (both values and UI) based on the value of other parameters. Premiere Pro compatible.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>BlitHook</p>
</td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>EMP</p>
</td>
<td colspan="1" rowspan="1">
<p>External Monitor Preview. Use this as a starting point for adding support to output video from the composition panel to video hardware.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="intro-sample-projects-building-the-sample-projects">Building The Sample Projects<a class="headerlink" href="#intro-sample-projects-building-the-sample-projects" title="Permanent link">&para;</a></h2>
<p>We've combined the sample projects into a single master project, stored in the Examples folder of the SDK. For macOS, it is Buildall.xcodeproj; for Windows, it is BuildAll.sln.</p>
<p>In your IDE, you'll need to change the output folder of your project to build into After Effects' plug-in folder.</p>
<p>For development, we recommend using the following path for macOS: <code>/Library/Application Support/Adobe/Common/Plug-ins/[version]/MediaCore/</code></p>
<p>Version is locked at 7.0 for all CC versions, or CSx for earlier versions.</p>
<p>for example: <code>/Library/Application Support/Adobe/Common/Plug-ins/7.0/MediaCore/</code></p>
<p>or: <code>/Library/Application Support/Adobe/Common/Plug-ins/CS6/MediaCore/</code></p>
<p>and the following path for Windows: <code>[Program Files]\Adobe\Common\Plug-ins\[version]\MediaCore\</code></p>
<p>for example: <code>C:\Program Files\Adobe\Common\Plug-ins\7.0\MediaCore\</code></p>
<p>or: <code>C:\Program Files\Adobe\Common\Plug-ins\CS6\MediaCore\</code></p>
<p>Note that this Windows path is only recommended for development purposes. Windows installers should follow the guidelines here: <a href="#intro-where-installers-should-put-plug-ins">Where Installers Should Put Plug-ins</a>.</p>
<p>In Xcode, you can set this path once for all projects in the Xcode Preferences &gt; Locations &gt; Derived Data &gt; Advanced. Under <em>Build Location</em> choose <em>Custom</em>, and fill in the path.</p>
<p>In Visual Studio, for convenience, we have specified the output path for all sample projects using the environment variable AE_PLUGIN_BUILD_DIR. You'll need to set this as a user environment variable for your system. On Windows 7, right-click <em>My Computer</em> &gt; <em>Properties</em> &gt; and in the left sidebar choose <em>Advanced System Settings</em>. In the new dialog, hit the <em>Environment Variables</em> button. In the User variables area, create a New variable named AE_PLUGIN_BUILD_DIR, and with the path described above. Log out of Windows and log back in so that the variable will be set.</p>
<p>Alternatively, you can set output path for each project individually in Visual Studio by right-clicking a project in the Solution Explorer, choosing Properties, and then in Configuration Properties &gt; Linker &gt; General, set the Output File.</p>
<p>When compiling the plug-ins, if you see a link error such as:</p>
<p>"Cannot open file "[MediaCore plug-ins path]plugin.prm", make sure to launch Visual Studio in administrator mode. In your Visual Studio installation, right-click devenv.exe, Properties &gt; Compatibility &gt; Privilege Level, click "Run this program as an administrator".</p></section><section class="print-page" id="intro-debugging-plug-ins"><h1 id="intro-debugging-plug-ins-debugging-plug-ins">Debugging Plug-ins<a class="headerlink" href="#intro-debugging-plug-ins-debugging-plug-ins" title="Permanent link">&para;</a></h1>
<p>The best way to learn the interaction(s) between After Effects and plug-ins is running the samples in your debugger. Spending some quality time in your compiler's debugger, and a sample project that closely resembles your plug-in, can really pay off.</p>
<p>Once you've got the plug-in building directly into the plug-ins folder as explained above, here's how to specify After Effects as the application to run during debug sessions:</p>
<h3 id="intro-debugging-plug-ins-windows">Windows:<a class="headerlink" href="#intro-debugging-plug-ins-windows" title="Permanent link">&para;</a></h3>
<ol>
<li>In the Visual Studio solution, in the Solution Explorer panel, choose the project you want to debug</li>
<li>Right-click it and choose Set as StartUp Project</li>
<li>Right-click it again and choose Properties</li>
<li>In Configuration Properties &gt; Debugging &gt; Command, provide the path to the executable file of the host application the plug-ins will be running in (this may be After Effects or Premiere Pro)</li>
<li>From there you can either hit the Play button, or you can launch the application and later at any point choose Debug &gt; Attach to Process...</li>
</ol>
<h3 id="intro-debugging-plug-ins-macos">macOS:<a class="headerlink" href="#intro-debugging-plug-ins-macos" title="Permanent link">&para;</a></h3>
<ol>
<li>In Xcode, in the Project Navigator, choose the xcodeproj you want to debug</li>
<li>Choose Product &gt; Scheme &gt; Edit Scheme...</li>
<li>Under Run, in the Info tab, for Executable, choose the host application the plug-ins will be running in (this may be After Effects or Premiere Pro)</li>
<li>From there you can either hit the Play button to build and run the current scheme, or you can launch the application and later at any point choose Debug &gt; Attach to Process.</li>
</ol>
<hr />
<h2 id="intro-debugging-plug-ins-deleting-preferences">Deleting Preferences<a class="headerlink" href="#intro-debugging-plug-ins-deleting-preferences" title="Permanent link">&para;</a></h2>
<p>During the course of developing a plug-in, your plug-in may pass settings information to After Effects, which is then stored in its preferences file.</p>
<p>You may delete the preferences and restart After Effects with a clean slate by holding down Ctrl-Alt-Shift / Cmd-Opt-Shift during launch.</p>
<p>On Windows, the preferences are stored here: <code>[user folder]\AppData\Roaming\Adobe\After Effects\[version]\Adobe After Effects [version]-x64 Prefs.txt</code></p>
<p>On macOS, they are stored here: <code>~/Library/Preferences/Adobe/After Effects/[version]/Adobe After Effects [version]-x64 Prefs</code></p></section><section class="print-page" id="intro-compatibility-across-multiple-versions"><h1 id="intro-compatibility-across-multiple-versions-compatibility-across-multiple-versions">Compatibility Across Multiple Versions?<a class="headerlink" href="#intro-compatibility-across-multiple-versions-compatibility-across-multiple-versions" title="Permanent link">&para;</a></h1>
<p>Generally, you should compile your plug-ins with the latest After Effects SDK headers. This makes the latest suites and API functionality available to your plug-ins. When a new version of After Effects is released, you generally will not need to provide a new version unless you wish to take advantage of new functionality exposed through the new SDK. However, you should always test your plug-in in new versions of After Effects before claiming compatibility with new versions.</p>
<p>You should test your plug-in thoroughly in each version of After Effects supported by your plug-in. If you need to add a conditional block of code to be run only in specific versions of After Effects, you can always check the API version in <a href="#effect-basics-pf_indata">PF_InData</a>.version for effects, or in the major and minor_versionL passed into your AEGP in the <a href="#aegps-implementation-entry-point">Entry Point</a>.</p>
<p>For even more precise version checking, a plug-in can run a script using <code>AEGP_ExecuteScript</code> (<a href="#aegps-aegp-suites-aegp_utilitysuite6">AEGP_UtilitySuite6</a>), querying one of the following attributes:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">app</span><span class="p">.</span><span class="n">version</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="w"> </span><span class="mf">11.0.1</span><span class="n">x12</span>
</span><span id="__span-0-2"><span class="n">app</span><span class="p">.</span><span class="n">buildNumber</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="w"> </span><span class="mf">12.</span>
</span></code></pre></div>
<hr />
<h2 id="intro-compatibility-across-multiple-versions-api-versions">API Versions<a class="headerlink" href="#intro-compatibility-across-multiple-versions-api-versions" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Release</th>
<th>Effect API Version</th>
<th>AEGP API Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>22.0</td>
<td>13.27</td>
<td></td>
</tr>
<tr>
<td>18.2</td>
<td>13.25</td>
<td></td>
</tr>
<tr>
<td>18.0</td>
<td>13.24</td>
<td></td>
</tr>
<tr>
<td>17.7</td>
<td>13.23</td>
<td></td>
</tr>
<tr>
<td>17.6</td>
<td>13.22</td>
<td></td>
</tr>
<tr>
<td>17.5</td>
<td>13.21</td>
<td></td>
</tr>
<tr>
<td>17.3</td>
<td>13.20</td>
<td></td>
</tr>
<tr>
<td>17.1</td>
<td>13.19</td>
<td></td>
</tr>
<tr>
<td>17.0</td>
<td>13.18</td>
<td></td>
</tr>
<tr>
<td>16.1</td>
<td>13.17</td>
<td></td>
</tr>
<tr>
<td>16.0</td>
<td>13.16</td>
<td></td>
</tr>
<tr>
<td>15.0</td>
<td>13.15</td>
<td></td>
</tr>
<tr>
<td>CC 2017.1 (14.2)</td>
<td>13.14</td>
<td></td>
</tr>
<tr>
<td>CC 2017 (14.0)</td>
<td>13.13</td>
<td>114.0</td>
</tr>
<tr>
<td>CC 2015.3 (13.8)</td>
<td>13.11</td>
<td>113.8</td>
</tr>
<tr>
<td>CC 2015 (13.7)</td>
<td>13.10</td>
<td>113.7</td>
</tr>
<tr>
<td>CC 2015 (13.6)</td>
<td>13.10</td>
<td></td>
</tr>
<tr>
<td>CC 2015 (13.5, 13.5.1)</td>
<td>13.9</td>
<td>113.5</td>
</tr>
<tr>
<td>CC 2014 (13.0-13.2)</td>
<td>13.7</td>
<td>113</td>
</tr>
<tr>
<td>CC (12.2)</td>
<td>13.6</td>
<td>112.2</td>
</tr>
<tr>
<td>CC (12.1)</td>
<td>13.5</td>
<td>112.1</td>
</tr>
<tr>
<td>CC (12.0)</td>
<td>13.4</td>
<td>112.0</td>
</tr>
<tr>
<td>CS6.0.1 (11.0.1)</td>
<td>13.3</td>
<td>111.0</td>
</tr>
<tr>
<td>CS6 (11.0)</td>
<td>13.2</td>
<td>111.0</td>
</tr>
<tr>
<td>CS5.5 (10.5)</td>
<td>13.1</td>
<td>17.0</td>
</tr>
<tr>
<td>CS5 (10.0)</td>
<td>13.0</td>
<td>17.0</td>
</tr>
<tr>
<td>CS4 (9.0)</td>
<td>12.14</td>
<td>16.24</td>
</tr>
<tr>
<td>CS3 (8.0)</td>
<td>12.13</td>
<td>16.24</td>
</tr>
<tr>
<td>7.0</td>
<td>12.12</td>
<td></td>
</tr>
<tr>
<td>6.5, 6.0</td>
<td>12.10 (Check for the presence of updated AEGP suites, should you need to differentiate between 6.0 and 6.5.)</td>
<td></td>
</tr>
<tr>
<td>5.0</td>
<td>12.5</td>
<td></td>
</tr>
<tr>
<td>4.1</td>
<td>12.2</td>
<td></td>
</tr>
<tr>
<td>3.1</td>
<td>11.6</td>
<td></td>
</tr>
</tbody>
</table></section><section class="print-page" id="intro-third-party-plug-in-hosts"><h1 id="intro-third-party-plug-in-hosts-third-party-plug-in-hosts">Third-party Plug-in Hosts?<a class="headerlink" href="#intro-third-party-plug-in-hosts-third-party-plug-in-hosts" title="Permanent link">&para;</a></h1>
<p>Some developers are wary of using each After Effects release's new API features, to maintain compatibility with hosts with partial implementations. You can distinguish between host applications by checking <a href="#effect-basics-pf_indata">PF_InData</a>&gt;appl_id. After Effects uses the appl_id 'FXTC'.</p>
<p>Premiere Pro uses 'PrMr'. As of this writing, no third party hosts support SmartFX, or our AEGP functions.</p>
<p>Also, see the <a href="#ppro-ppro">Premiere Pro &amp; Other Hosts</a> section.</p></section><section class="print-page" id="intro-pipl-resources"><h1 id="intro-pipl-resources-pipl-resources">PiPL Resources<a class="headerlink" href="#intro-pipl-resources-pipl-resources" title="Permanent link">&para;</a></h1>
<p>Originating in Adobe Photoshop over two decades ago, Plug-In Property Lists, or PiPLs, are resources which provide basic information about a plug-in's behavior, without executing the plug-in. PiPLs have been largely supplanted within After Effects by <code>PF_Cmd_GLOBAL_SETUP</code> (see <a href="#effect-basics-command-selectors">Global Selectors</a>) and dynamic outflags. However, for archaeological reasons, the behaviors indicated during <code>PF_Cmd_GLOBAL_SETUP</code> must agree with those in the PiPL.</p>
<p>In the interest of cross-platform compatibility, use a single .r file for both macOS and Windows versions of your plug-in, like the samples do. PiPL properties must always be in macOS-specific byte order. On Windows, PiPLs are compiled by processing a .r file through pipltool.exe, which converts the .r file into a binary .rc file. The Windows sample projects all contain custom build steps which generate a .rc file, using a cross-platform .r file and our cnvtpipl.exe command line utility. Base your development on an existing sample plug-in and the build step will be correctly implemented.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>PiPL Property</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p>Kind</p>
</td>
<td colspan="1" rowspan="1">
<p>Plug-in type. AEEffect for an Effect.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Name</p>
</td>
<td colspan="1" rowspan="1">
<p>Display name which can be up to 47 characters long.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Category</p>
</td>
<td colspan="1" rowspan="1">
<p>Effect category for menus and the Effects and Presets panel</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Entry Point (one for each platform)</p>
</td>
<td colspan="1" rowspan="1">
<p>Your plug-in's entry point is exported through the PiPL on Windows and macOS. If the plug-in supports multiple platforms, then multiple entry points must be defined in the PiPL. There is no need for a Windows .def file or manual exports, unless you're also designating some other OS-specific entry point.</p>
<p>The macros defined in entry.h (in the \SDKExamplesHeaders directory) take care of exporting each sample's entry point function. All the sample project entry point functions are <code>EffectMain()</code> for effects, or <code>EntryPointFunc()</code> for AEGPs.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>AE_PiPL_Version</p>
</td>
<td colspan="1" rowspan="1">
<p>Unused</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>AE_Effect_Spec_Version</p>
</td>
<td colspan="1" rowspan="1">
<p>SDK version the effect was built with</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>AE_Effect_Version</p>
</td>
<td colspan="1" rowspan="1">
<p>The version of the effect</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>AE_Effect_Info_Flags</p>
</td>
<td colspan="1" rowspan="1">
<p>Unused</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>AE_Effect_Global_OutFlags</p>
</td>
<td colspan="1" rowspan="1">
<p>Must match the <code>out_flags</code> set in GlobalSetup</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>AE_Effect_Global_OutFlags_2</p>
</td>
<td colspan="1" rowspan="1">
<p>Must match the <code>out_flags2</code> set in GlobalSetup</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>AE_Effect_Match_Name</p>
</td>
<td colspan="1" rowspan="1">
<p>A unique, constant identifier, unlike a plug-in's display name, which may be changed dynamically.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>AE_Reserved_Info</p>
</td>
<td colspan="1" rowspan="1">
<p>Unused.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>AE_Effect_Support_URL</p>
</td>
<td colspan="1" rowspan="1">
<p><strong>New in AE 23.5!</strong> URL for the effect. Shown in the Effects Manager. A user might click the link for more information about the effect or to find a newer version.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="intro-pipl-resources-pipl-resources-and-microsoft-visual-studio">PiPL Resources And Microsoft Visual Studio<a class="headerlink" href="#intro-pipl-resources-pipl-resources-and-microsoft-visual-studio" title="Permanent link">&para;</a></h2>
<p>To use resources from Microsoft Visual Studio .NET with pipltool-generated resources,</p>
<h1 id="intro-pipl-resources-include-the-output-of-the-custom-build-steps-into-the-microsoft-generated-rc-file">include the output of the custom build steps into the Microsoft-generated .rc file.<a class="headerlink" href="#intro-pipl-resources-include-the-output-of-the-custom-build-steps-into-the-microsoft-generated-rc-file" title="Permanent link">&para;</a></h1>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="c1">// in file WhizBang.rc, generated by .NET.</span>
</span><span id="__span-0-2"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;WhizBang_PiPL_temp.rc&quot;</span><span class="c1"> // pipltool.exe&#39;s output</span>
</span></code></pre></div>
<p>If modifying a sample plug-in, change the name of the file generated by pipltool.exe to something like WhizBang_PiPL_temp.rc, or it will overwrite the Microsoft resources each time you build; not good.</p>
<hr />
<h2 id="intro-pipl-resources-multiple-pipls">Multiple PiPLs<a class="headerlink" href="#intro-pipl-resources-multiple-pipls" title="Permanent link">&para;</a></h2>
<p>It is possible, but not recommended, to include multiple plug-ins (both AEGPs and effects) in the same file, using multiple PiPLs. If there are PiPLs for both AEGPs and effects in the same file, the AEGPs must come first!</p>
<p>No other hosts (not even Premiere Pro) support multiple PiPLs pointing to multiple effects within the same .dll or code fragment. Also, if you need to update one plug-in, do you really want to ship a new build of all your plug-ins? We recommend one PiPL, and one plug-in, per code fragment.</p>
<hr />
<h2 id="intro-pipl-resources-why-do-i-need-to-know-all-this">Why Do I Need To Know All This?<a class="headerlink" href="#intro-pipl-resources-why-do-i-need-to-know-all-this" title="Permanent link">&para;</a></h2>
<p>You don't; After Effects does. If you follow our advice and base your projects on the SDK samples, you can simply change the .r file containing your PiPL definition(s), and your plug-in's resources will be automagically updated the next time you build. Feel the love. Or, if you ever tinker with the custom build steps, feel the pain.</p></section><section class="print-page" id="intro-exceptions"><h1 id="intro-exceptions-exceptions">Exceptions<a class="headerlink" href="#intro-exceptions-exceptions" title="Permanent link">&para;</a></h1>
<p>Handle all exceptions generated by your plug-in's code, <em>within</em> your plug-in. Pass those which didn't originate in your plug-in's code to After Effects.</p>
<p>After Effects' APIs are designed for plug-ins written in C, and don't expect exceptions. After Effects will crash immediately if one is thrown from within a plug-in.</p>
<p>The effect samples use a firewall around the switch statement in the <code>main()</code> function, and the AEGPs wrap their function hooks in try/catch blocks.</p></section><section class="print-page" id="intro-where-installers-should-put-plug-ins"><h1 id="intro-where-installers-should-put-plug-ins-where-installers-should-put-plug-ins">Where Installers Should Put Plug-ins<a class="headerlink" href="#intro-where-installers-should-put-plug-ins-where-installers-should-put-plug-ins" title="Permanent link">&para;</a></h1>
<p>Installing your plug-ins in the common location will allow them to be loaded by Premiere Pro, if installed.</p>
<p>On Windows, the common plug-ins folder can be found (as an explicit path) in the following registry entry: <code>HKLM\SOFTWARE\Adobe\After Effects\[version]\CommonPluginInstallPath</code></p>
<p>On Mac, the common plug-ins folder is at: <code>/Library/Application Support/Adobe/Common/Plug-ins/[version]/MediaCore</code></p>
<p>Version is locked at 7.0 for all CC versions, or CSx for earlier versions. For example: <code>/Library/Application Support/Adobe/Common/Plug-ins/7.0/MediaCore/</code></p>
<p>Do not use macOS aliases or Windows shortcuts, as these are not traversed by Premiere Pro.</p>
<hr />
<h2 id="intro-where-installers-should-put-plug-ins-do-i-have-to-install-the-plug-ins-to-the-common-folder">Do I Have To Install The Plug-ins To The Common Folder?<a class="headerlink" href="#intro-where-installers-should-put-plug-ins-do-i-have-to-install-the-plug-ins-to-the-common-folder" title="Permanent link">&para;</a></h2>
<p>You may have good reason to install your plug-in for only After Effects, for example, if your plug-in depends on suites and functionality not available in Premiere Pro. We strongly recommend that you use the common folder whenever possible, but for certain cases, the AE-specific plug-in folder is still available.</p>
<p>On Windows, the app-specific plug-ins folder can be found (as an explicit path) in the following registry entry: <code>\\HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\After Effects\(version)\PluginInstallPath</code></p>
<p>On macOS, the app-specific plug-ins folder is at: <code>/Applications/Adobe After Effects [version]/Plug-ins/</code></p>
<p>When launched, After Effects recursively descends 10 levels deep into subdirectories of its path. macOS aliases are traversed, but Windows shortcuts are not. Directories terminated by parentheses or preceded by the symbols ¬ (macOS) or ~ (Windows) are not scanned.</p>
<p>Try as you might to build a fence between AE and Premiere Pro, users will still find ways to get across using our lovely integration goodness - Your effects will still be available to Premiere Pro users who create a dynamically linked AE composition with your effect, and put it in a Premiere Pro sequence.</p></section><section class="print-page" id="intro-localization"><h1 id="intro-localization-localization">Localization<a class="headerlink" href="#intro-localization-localization" title="Permanent link">&para;</a></h1>
<p>Starting in CC, PF App Suite (<a href="#effect-details-useful-utility-functions">Useful Utility Functions</a>) adds <code>PF_AppGetLanguage()</code> to query the current language so that a plug-in can use the correct language string.</p>
<p>When passing strings to AE, some parts of the API accept Unicode. In other areas, for example when specifying effect parameter names during <code>PF_Cmd_PARAM_SETUP</code>, you'll need to pass the names in a char string. For these non-Unicode strings, AE interprets strings as being multi-byte encoded using the application's current locale. To build these strings, on Windows you can use the <code>WideCharToMultiByte()</code> function, specifying <code>CP_OEMCP</code> as the first argument. On macOS, use the encoding returned by <code>GetApplicationTextEncoding()</code>.</p>
<p>Testing with different languages in AE doesn't require an OS reinstallation, but it does require a reinstallation of AE:</p>
<h3 id="intro-localization-windows">Windows<a class="headerlink" href="#intro-localization-windows" title="Permanent link">&para;</a></h3>
<ul>
<li>Change the system locale to the targeted language (control panel &gt; region and language &gt; administrative tab &gt; change system locale)</li>
<li>Restart machine</li>
<li>Install AE in the according language.</li>
</ul>
<h3 id="intro-localization-macos">MacOS<a class="headerlink" href="#intro-localization-macos" title="Permanent link">&para;</a></h3>
<ul>
<li>Set targeted language to the primary language in the preferred language list</li>
<li>Install AE in the according language.</li>
</ul></section><section class="print-page" id="intro-apple-silicon-support"><h1 id="intro-apple-silicon-support-apple-silicon-support">Apple Silicon Support<a class="headerlink" href="#intro-apple-silicon-support-apple-silicon-support" title="Permanent link">&para;</a></h1>
<p>Adobe now supports Apple Silicon effect plugins in some products running natively on Apple Silicon. For instance, After Effects effect plugins are also available in Adobe Premiere Pro and Adobe Media Encoder.</p>
<p>Not all Adobe products have native Apple Silicon versions yet, but in those that do, only effect plugins with Apple Silicon implementations will be available. We recommend adding the Apple Silicon target soon in anticipation of rapid adoption of these new M1 machines.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to build a Mac Universal binary, you will need Xcode 12.2 or greater. Adobe is currently using Xcode 12.4.</p>
</div>
<p>To learn more about Universal binaries, please visit <a href="https://developer.apple.com/documentation/apple-silicon/building-a-universal-macos-binary">https://developer.apple.com/documentation/apple-silicon/building-a-universal-macos-binary</a></p>
<hr />
<h2 id="intro-apple-silicon-support-how-to-add-universal-binary-support-for-your-plugins">How to add Universal Binary Support for your Plugins<a class="headerlink" href="#intro-apple-silicon-support-how-to-add-universal-binary-support-for-your-plugins" title="Permanent link">&para;</a></h2>
<ol>
<li>Open your plugins Xcode project in 12.2 or above and Xcode will automatically add an Apple Silicon target for you.</li>
</ol>
<p><img alt="Mac Universal Build" src="../_static/mac_universal_build.png" title="Mac Universal Build" />
<em>Mac Universal Build</em></p>
<ol>
<li>Tell After Effects what the main entry point is for Apple Silicon builds.</li>
</ol>
<blockquote>
<ul>
<li>Find the .r resource file for your plugin.</li>
<li>Add <code>CodeMacARM64 {"EffectMain"}</code> next to your existing Intel Mac entry point definition.
  <div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="cp">#if defined(AE_OS_MAC)</span>
</span><span id="__span-0-2"><span class="w">  </span><span class="n">CodeMacARM64</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;EffectMain&quot;</span><span class="p">},</span>
</span><span id="__span-0-3"><span class="w">  </span><span class="n">CodeMacIntel64</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;EffectMain&quot;</span><span class="p">},</span>
</span><span id="__span-0-4"><span class="cp">#endif</span>
</span></code></pre></div></li>
<li>If for some reason you need different entry points on x64 and ARM just provide a different entry point name and string.</li>
</ul>
</blockquote>
<ol>
<li>Compile the Universal binary by building for the Any Mac (Apple Silicon, Intel) Target, or by using Product -&gt; Archive.</li>
</ol>
<p>Assuming there are no compile time issues with the Apple Silicon build, you can now use the single Universal binary for both Intel and Apple Silicon applications.</p>
<hr />
<h2 id="intro-apple-silicon-support-exception-behavior-with-apple-silicon-across-c-functions">Exception Behavior with Apple Silicon Across "C" Functions<a class="headerlink" href="#intro-apple-silicon-support-exception-behavior-with-apple-silicon-across-c-functions" title="Permanent link">&para;</a></h2>
<p>Extra care should be taken when using exceptions on Apple Silicon. In many environments throwing exceptions that propagate through traditional "C" functions worked fine. It was bad practice, with undefined behavior, but generally "worked".</p>
<p>On Apple Silicon, rather than undefined behavior the ABI has changed so terminate() is called when this occurs.</p>
<p>Since the main entry point of a plugin is always an extern "C" calling convention, this code should be wrapped in a try/catch block to prevent program termination. For example:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-1-1"><span class="n">PF_Err</span><span class="w"> </span><span class="nf">EffectMain</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">PF_Cmd</span><span class="w"> </span><span class="n">cmd</span><span class="p">,</span>
</span><span id="__span-1-2"><span class="w">    </span><span class="n">PF_InData</span><span class="w"> </span><span class="o">*</span><span class="n">in_data</span><span class="p">,</span>
</span><span id="__span-1-3"><span class="w">    </span><span class="n">PF_OutData</span><span class="w"> </span><span class="o">*</span><span class="n">out_data</span><span class="p">,</span>
</span><span id="__span-1-4"><span class="w">    </span><span class="n">PF_ParamDef</span><span class="w"> </span><span class="o">*</span><span class="n">params</span><span class="p">[],</span>
</span><span id="__span-1-5"><span class="w">    </span><span class="n">PF_LayerDef</span><span class="w"> </span><span class="o">*</span><span class="n">output</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-1-6"><span class="p">{</span>
</span><span id="__span-1-7"><span class="w">    </span><span class="k">try</span>
</span><span id="__span-1-8"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-1-9"><span class="w">        </span><span class="cm">/* Your code here */</span>
</span><span id="__span-1-10"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-11"><span class="w">    </span><span class="k">catch</span>
</span><span id="__span-1-12"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-1-13"><span class="w">        </span><span class="cm">/* return most appropriate PF_Err */</span>
</span><span id="__span-1-14"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-15"><span class="p">}</span>
</span></code></pre></div></section><section class="print-page" id="intro-symbol-export"><h1 id="intro-symbol-export-exporting-symbols-in-effects">Exporting Symbols in Effects<a class="headerlink" href="#intro-symbol-export-exporting-symbols-in-effects" title="Permanent link">&para;</a></h1>
<p>The After Effects team recently became aware of an issue with conflicting symbols that violate the C++ language One Definition Rule (ODR).</p>
<p>In early 2021, the version of the Boost library used by After Effects was upgraded to 1.74. Over the last few months we've identified a number of plugins that are also using Boost but are exporting symbols in such a way that After Effects or the plugin may end up calling the incorrect version of Boost leading to hangs and crashes for users. We also identified a number of the AE SDK samples were setup to export all symbols by default which may have been contributing to the problem, assuming they were used as the starting point for other plugins. These have been fixed as part of the March 2021 SDK.</p>
<p><strong>The only symbol that After Effects requires to be exported is the entry point of the plugin.</strong></p>
<p>An example can be found in the SDK samples in entry.h:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="cp">#ifdef AE_OS_WIN</span>
</span><span id="__span-0-2"><span class="w">        </span><span class="cp">#define DllExport   __declspec( dllexport )</span>
</span><span id="__span-0-3"><span class="cp">#elif defined AE_OS_MAC</span>
</span><span id="__span-0-4"><span class="w">        </span><span class="cp">#define DllExport   __attribute__ ((visibility (&quot;default&quot;)))</span>
</span><span id="__span-0-5"><span class="cp">#endif</span>
</span></code></pre></div>
<p>and then this is applied to the entry point function, for example:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-1-1"><span class="k">extern</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="n">DllExport</span>
</span><span id="__span-1-2"><span class="n">PF_Err</span><span class="w"> </span><span class="n">PluginDataEntryFunction</span><span class="p">(</span>
</span><span id="__span-1-3"><span class="w">    </span><span class="n">PF_PluginDataPtr</span><span class="w"> </span><span class="n">inPtr</span><span class="p">,</span>
</span><span id="__span-1-4"><span class="w">    </span><span class="n">PF_PluginDataCB</span><span class="w"> </span><span class="n">inPluginDataCallBackPtr</span><span class="p">,</span>
</span><span id="__span-1-5"><span class="w">    </span><span class="n">SPBasicSuite</span><span class="o">*</span><span class="w"> </span><span class="n">inSPBasicSuitePtr</span><span class="p">,</span>
</span><span id="__span-1-6"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">inHostName</span><span class="p">,</span>
</span><span id="__span-1-7"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">inHostVersion</span><span class="p">)</span>
</span><span id="__span-1-8"><span class="p">{</span>
</span><span id="__span-1-9"><span class="w">    </span><span class="n">PF_Err</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PF_Err_INVALID_CALLBACK</span><span class="p">;</span>
</span><span id="__span-1-10">
</span><span id="__span-1-11"><span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PF_REGISTER_EFFECT</span><span class="p">(</span>
</span><span id="__span-1-12"><span class="w">        </span><span class="n">inPtr</span><span class="p">,</span>
</span><span id="__span-1-13"><span class="w">        </span><span class="n">inPluginDataCallBackPtr</span><span class="p">,</span>
</span><span id="__span-1-14"><span class="w">        </span><span class="s">&quot;ColorGrid&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Name</span>
</span><span id="__span-1-15"><span class="w">        </span><span class="s">&quot;ADBE ColorGrid&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Match Name</span>
</span><span id="__span-1-16"><span class="w">        </span><span class="s">&quot;Sample Plug-ins&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// Category</span>
</span><span id="__span-1-17"><span class="w">        </span><span class="n">AE_RESERVED_INFO</span><span class="p">);</span><span class="w"> </span><span class="c1">// Reserved Info</span>
</span><span id="__span-1-18">
</span><span id="__span-1-19"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-1-20"><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="intro-symbol-export-disabling-xcode-symbol-export">Disabling Xcode Symbol Export<a class="headerlink" href="#intro-symbol-export-disabling-xcode-symbol-export" title="Permanent link">&para;</a></h2>
<p>To disable symbol export in Xcode:</p>
<ol>
<li>Find the <strong>Apple Clang - Code Generation</strong> section in the <strong>Build</strong> settings for your project.</li>
<li>Set the <strong>Symbols Hidden By Default</strong> to <strong>YES</strong></li>
</ol>
<p><img alt="Apple Clang Symbols" src="../_static/appleclang-symbols.png" title="Apple Clang Symbols" />
<em>Apple Clang Symbols</em></p>
<p>For any specific symbols that must be made public, use the <code>__attribute__((visibility("default")))</code> in code.</p>
<p>More information can be found in Apple's Xcode documentation <a href="https://help.apple.com/xcode/mac/11.4/#/itcaec37c2a6">https://help.apple.com/xcode/mac/11.4/#/itcaec37c2a6</a> (excerpt below):</p>
<blockquote>
<p>Symbols Hidden by Default (GCC_SYMBOLS_PRIVATE_EXTERN)</p>
<p>When enabled, all symbols are declared private extern unless explicitly marked to be exported using <strong>attribute</strong>((visibility("default"))) in code. If not enabled, all symbols are exported unless explicitly marked as private extern.</p>
</blockquote>
<hr />
<h2 id="intro-symbol-export-disabling-visual-studio-export">Disabling Visual Studio Export<a class="headerlink" href="#intro-symbol-export-disabling-visual-studio-export" title="Permanent link">&para;</a></h2>
<p>By default, builds from Visual Studio automatically disable symbol exports. To export symbols, you must either supply a module definition file or set the __declspec(dllexport) keyword in the functions definition.</p>
<p>More information can be found in Microsoft's Visual Studio documentation <a href="https://docs.microsoft.com/en-us/cpp/build/exporting-from-a-dll?view=msvc-160">https://docs.microsoft.com/en-us/cpp/build/exporting-from-a-dll?view=msvc-160</a> (excerpt below):</p>
<blockquote>
<p>You can export functions from a DLL using two methods:</p>
<ol>
<li>Create a module definition (.def) file and use the .def file when building the DLL. Use this approach if you want to export functions from your DLL by ordinal rather than by name.</li>
<li>Use the keyword __declspec(dllexport) in the function's definition.</li>
</ol>
<p>When exporting functions with either method, make sure to use the __stdcall calling convention.</p>
</blockquote></section><section class="print-page" id="intro-next-steps"><h1 id="intro-next-steps-next-steps">Next Steps<a class="headerlink" href="#intro-next-steps-next-steps" title="Permanent link">&para;</a></h1>
<p>You now have an understanding of what plug-ins are, what they can do, and how After Effects communicates with them.</p>
<p>Next, we will cover the <a href="#effect-basics-effect-basics">basics of effects plug-ins</a>.</p></section><h1 class='nav-section-title-end'>Ended: Introduction</h1>
                        <h1 class='nav-section-title' id='section-effect-basics'>
                            Effect Basics <a class='headerlink' href='#section-effect-basics' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="effect-basics-effect-basics"><h1 id="effect-basics-effect-basics-effect-basics">Effect Basics<a class="headerlink" href="#effect-basics-effect-basics-effect-basics" title="Permanent link">&para;</a></h1>
<p>This chapter will provide all the information you need to know to understand how a basic effect plug-in works.</p>
<p>These details are fundamental to every effect plug-in.</p>
<p>By the time you finish this chapter, you'll be ready for the fun stuff; modifying pixels!</p></section><section class="print-page" id="effect-basics-entry-point"><h1 id="effect-basics-entry-point-entry-point">Entry Point<a class="headerlink" href="#effect-basics-entry-point-entry-point" title="Permanent link">&para;</a></h1>
<p>All communication between After Effects and an effect plug-in is initiated by After Effects, and it all happens by the host (After Effects) calling a single entry point function.</p>
<p>For all effect plug-ins, the entry point function must have the following signature:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">PF_Err</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-0-2"><span class="w">    </span><span class="n">PF_Cmd</span><span class="w">       </span><span class="n">cmd</span><span class="p">,</span>
</span><span id="__span-0-3"><span class="w">    </span><span class="n">PF_InData</span><span class="w">    </span><span class="o">*</span><span class="n">in_data</span><span class="p">,</span>
</span><span id="__span-0-4"><span class="w">    </span><span class="n">PF_OutData</span><span class="w">   </span><span class="o">*</span><span class="n">out_data</span><span class="p">,</span>
</span><span id="__span-0-5"><span class="w">    </span><span class="n">PF_ParamDef</span><span class="w">  </span><span class="o">*</span><span class="n">params</span><span class="p">[],</span>
</span><span id="__span-0-6"><span class="w">    </span><span class="n">PF_LayerDef</span><span class="w">  </span><span class="o">*</span><span class="n">output</span><span class="p">,</span>
</span><span id="__span-0-7"><span class="w">    </span><span class="kt">void</span><span class="w">         </span><span class="o">*</span><span class="n">extra</span><span class="p">)</span>
</span></code></pre></div>
<p>The name of the entry point function above is "main", but it can be whatever is specified in <a href="#intro-pipl-resources">PiPL Resources</a>.</p>
<p>Before each call to the entry point function, After Effects updates <a href="#effect-basics-pf_indata">PF_InData</a> and the plug- in's parameter array PF_ParamDef[] (except as noted).</p>
<p>After the plug-in returns from its call, After Effects checks <a href="#effect-basics-pf_outdata">PF_OutData</a> for changes and, when appropriate, uses the PF_LayerDef the effect has rendered.</p>
<hr />
<h2 id="effect-basics-entry-point-entry-point-function-parameters">Entry Point Function Parameters<a class="headerlink" href="#effect-basics-entry-point-entry-point-function-parameters" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Argument</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#effect-basics-command-selectors">cmd</a></p>
</td>
<td colspan="1" rowspan="1">
<p>After Effects sets the <a href="#effect-basics-command-selectors">Command Selectors</a> to tell the plug-in what to do.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#effect-basics-pf_indata">in_data</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Information about the application's state and the data the plug-in is being told to act upon.</p>
<p>Pointers to numerous interface and image manipulation functions are also provided.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#effect-basics-pf_outdata">out_data</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Pass back information to After Effects by setting fields within out_data.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#effect-basics-parameters">params</a></p>
</td>
<td colspan="1" rowspan="1">
<p>An array of the plug-in's parameters at the time provided in in_data&gt; current_time.</p>
<p><code>params[0]</code> is the input image (a <a href="#effect-basics-pf_effectworld">PF_EffectWorld / PF_LayerDef</a>) to which the effect should be applied.</p>
<p>These values are only valid during certain selectors (this is noted in the <a href="#effect-basics-command-selectors-calling-sequence">selector descriptions</a>).</p>
<p>Parameters are discussed at length here: <a href="#effect-basics-pf_paramdef">PF_ParamDef</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#effect-basics-pf_effectworld">output</a></p>
</td>
<td colspan="1" rowspan="1">
<p>The output image, to be rendered by the effect plug-in and passed back to After Effects.</p>
<p>Only valid during certain selectors.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#effect-ui-events-pf_eventextra">extra</a></p>
</td>
<td colspan="1" rowspan="1">
<p>The extra parameter varies with the command sent or (in the case of <a href="#effect-basics-command-selectors-messaging">PF_Cmd_EVENT</a>, the <a href="#effect-ui-events-effect-ui-events">event type</a>).</p>
<p>Used primarily for event management and <a href="#effect-details-parameter-supervision">Parameter Supervision</a>.</p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-basics-command-selectors"><h1 id="effect-basics-command-selectors-command-selectors">Command Selectors<a class="headerlink" href="#effect-basics-command-selectors-command-selectors" title="Permanent link">&para;</a></h1>
<p>Commands are, simply, what After Effects wants your effect to do.</p>
<p>Responses to some selectors are required; most are optional, though recall that we did add them for a <em>reason</em>...</p>
<p>With each command selector sent, effects receive information from After Effects in <a href="#effect-basics-pf_indata-pf_indata">PF_InData</a>, input and parameter values in PF_ParamDef[] (an array of parameter descriptions including the input layer), and access to callbacks and function suites.</p>
<p>They send information back to After Effects in <a href="#effect-basics-pf_outdata-pf_outdata">PF_OutData</a>, and (when appropriate) render output to a PF_LayerDef, also called a <a href="#effect-basics-pf_effectworld">PF_EffectWorld</a>.</p>
<p>During events, they receive event-specific information in <a href="#effect-ui-events-pf_eventextra">PF_EventExtra</a>.</p>
<hr />
<h2 id="effect-basics-command-selectors-calling-sequence">Calling Sequence<a class="headerlink" href="#effect-basics-command-selectors-calling-sequence" title="Permanent link">&para;</a></h2>
<p>Only the first few command selectors are predictable; the rest of the calling sequence is dictated by user action.</p>
<p>When first applied, a plug-in receives <code>PF_Cmd_GLOBAL_SETUP</code>, then <code>PF_Cmd_PARAM_SETUP</code>. Each time the user adds the effect to a layer, <code>PF_Cmd_SEQUENCE_SETUP</code> is sent.</p>
<p>For each frame rendered by a basic non-SmartFX effect, After Effects sends <code>PF_Cmd_FRAME_SETUP</code>, then <code>PF_Cmd_RENDER</code>, then <code>PF_Cmd_FRAME_SETDOWN</code>.</p>
<p>All effect plug-ins must respond to <code>PF_Cmd_RENDER</code></p>
<p>For SmartFX, <code>PF_Cmd_SMART_PRE_RENDER</code> may be sent any number of times, before a single <code>PF_Cmd_SMART_RENDER</code> is sent.</p>
<p><code>PF_Cmd_SEQUENCE_SETDOWN</code> is sent on exit, when the user removes an effect or closes the project. <code>PF_Cmd_SEQUENCE_RESETUP</code> is sent when a project is loaded or when the layer to which it's applied changes. <code>PF_Cmd_SEQUENCE_FLATTEN</code> is sent when the After Effects project is written out to disk.</p>
<p><code>PF_Cmd_ABOUT</code> is sent when the user chooses <em>About...</em> from the Effect Controls Window (ECW).</p>
<p><code>PF_Cmd_GLOBAL_SETDOWN</code> is sent when After Effects closes, or when the last instance of the effect is removed. Do not rely on this message to determine when your plug-in is being removed from memory; use OS-specific entry points.</p>
<hr />
<h2 id="effect-basics-command-selectors-command-selectors-table">Command Selectors Table<a class="headerlink" href="#effect-basics-command-selectors-command-selectors-table" title="Permanent link">&para;</a></h2>
<h3 id="effect-basics-command-selectors-global-selectors">Global Selectors<a class="headerlink" href="#effect-basics-command-selectors-global-selectors" title="Permanent link">&para;</a></h3>
<p>All plug-ins must respond to these selectors.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Selector</p>
</th>
<th colspan="1" rowspan="1">
<p>Response</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_ABOUT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Display a dialog describing the plug-in. Populate out_data&gt;return_msg and After Effects will display it in a simple modal dialog.</p>
<p>Include your plug- in's version information in the dialog. On macOS, the current resource file will be set to your effects module during this selector.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_GLOBAL_SETUP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set any required flags and <code>PF_OutData</code> fields (including out_data&gt;my_version) to describe your plug-in's behavior.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_GLOBAL_SETDOWN</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Free all global data (only required if you allocated some).</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_PARAM_SETUP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Describe your parameters and register them using <a href="#effect-details-interaction-callback-functions-interaction-callbacks">PF_ADD_PARAM</a>.</p>
<p>Also, register custom user interface elements.</p>
<p>Set <a href="#effect-basics-pf_outdata-pf_outdata">PF_OutData&gt;num_params</a> to match your parameter count.</p>
</td>
</tr>
</tbody>
</table>
<h3 id="effect-basics-command-selectors-sequence-selectors">Sequence Selectors<a class="headerlink" href="#effect-basics-command-selectors-sequence-selectors" title="Permanent link">&para;</a></h3>
<p>These control sequence data handling.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Selector</p>
</th>
<th colspan="1" rowspan="1">
<p>Response</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_SEQUENCE_SETUP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Allocate and initialize any sequence-specific data. Sent when the effect is first applied. <a href="#effect-basics-pf_indata">PF_InData</a> is initialized at this time.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_SEQUENCE_RESETUP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Re-create (usually unflatten) sequence data. Sent after sequence data is read from disk, during pre-composition, or when the effect is copied;</p>
<p>After Effects flattens sequence data before duplication. During duplication, <code>PF_Cmd_SEQUENCE_RESETUP</code> is sent for both the old and new sequences.</p>
<p>Don't expect a <code>PF_Cmd_SEQUENCE_FLATTEN</code> between <code>PF_Cmd_SEQUENCE_RESETUPs</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_SEQUENCE_FLATTEN</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sent when saving and when duplicating the sequence. Flatten sequence data containing pointers or handles so it can be written to disk.</p>
<p>This will saved with the project file. Free the unflat data and set the <code>out_data&gt;sequence_data</code> to point to the new flattened data. Flat data must be correctly byte-ordered for file storage.</p>
<p>As of 6.0, if an effect's sequence data has recently been flattened, the effect may be deleted without receiving an additional <code>PF_Cmd_SEQUENCE_SETDOWN</code>.</p>
<p>In this case, After Effects will dispose of your flat sequence data.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_SEQUENCE_SETDOWN</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Free all sequence data.</p>
</td>
</tr>
</tbody>
</table>
<h3 id="effect-basics-command-selectors-frame-selectors">Frame Selectors<a class="headerlink" href="#effect-basics-command-selectors-frame-selectors" title="Permanent link">&para;</a></h3>
<p>Passed for each frame (or set of audio samples) to be rendered by your plug-in.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Selector</p>
</th>
<th colspan="1" rowspan="1">
<p>Response</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_FRAME_SETUP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Allocate any frame-specific data. This is sent immediately before each frame is rendered, to allow for frame-specific setup data.</p>
<p>If your effect changes the size of its output buffer, specify the new output height, width, and relative origin. All parameters except the input layer are valid.</p>
<p>If you set width and height to 0, After Effects ignores your response to the following <code>PF_Cmd_RENDER</code>.</p>
<p>NOTE: If <a href="#effect-basics-pf_outdata-pf_outflags">PF_Outflag_I_EXPAND_BUFFER</a> is set, you will receive this selector (and <code>PF_Cmd_FRAME_SETDOWN</code>) twice, once without <code>PF_Cmd_RENDER</code> between them.</p>
<p>This is so we know whether or not the given layer will be visible.</p>
<p>Frame data dates from the days when machines might have 8MB of RAM. Given the calling sequence (above), it's much more efficient to just allocate during <code>PF_Cmd_RENDER</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_RENDER</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Render the effect into the output, based on the input frame and any parameters.</p>
<p>This render call can only support 8-bit or 16-bit per channel rendering. 32-bit per channel rendering must be handled in <code>PF_Cmd_SMART_RENDER</code>.</p>
<p>All fields in <code>PF_InData</code> are valid.</p>
<p>If your response to this selector is interrupted (your calls to <code>PF_ABORT</code> or <code>PF_PROGRESS</code> returns an error code), your results will not be used.</p>
<p>You cannot delete <code>frame_data</code> during this selector; you must wait until <code>PF_Cmd_FRAME_SETDOWN</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_FRAME_SETDOWN</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Free any frame data allocated during <code>PF_Cmd_FRAME_SETUP</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_AUDIO_SETUP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sent before every audio render. Request a time span of input audio. Allocate and initialize any sequence-specific data.</p>
<p>If your effect requires input from a time span other than the output time span, update the <code>startsampL</code> and <code>endsampL</code> field in <code>PF_OutData</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_AUDIO_RENDER</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Populate <a href="#effect-basics-pf_outdata-pf_outdata">PF_OutData.dest_snd</a> with effect-ed audio. All fields in <code>PF_InData</code> are valid.</p>
<p>If your response to this selector is interrupted (your calls to <code>PF_ABORT</code> or <code>PF_PROGRESS</code> returns an error code), your results will not be used.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_AUDIO_SETDOWN</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Free memory allocated during <code>PF_Cmd_AUDIO_SETUP</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_SMART_PRE_RENDER</code></p>
</td>
<td colspan="1" rowspan="1">
<p>SmartFX only. Identify the area(s) of input the effect will need to produce its output, based on whatever criteria the effect implements.</p>
<p>May be sent up to twice when MediaCore is hosting. The first will come during GetFrameDependencies to collect the inputs.</p>
<p>The source checkouts can return full frame dimensions here. Once the sources are rendered, if they are different in size than the first call then this selector will be emitted a second time with the actual source sizes in order to get a correct output size.</p>
<p>Note that MediaCore wants all of the output, so <code>PF_PreRenderOutput::max_result_rect</code> will be used.</p>
<p><strong>New in 16.0</strong></p>
<p>Set <code>PF_RenderOutputFlag_GPU_RENDER_POSSIBLE</code> in <code>PF_PreRenderOutput</code> to render on the GPU.</p>
<p>If this flag is not set the requested render is not possible with the requested GPU, because of parameters or render settings.</p>
<p>The host may re-call PreRender with another what_gpu option (or PF_GPU_Framework_None).</p>
<p><pre lang="cpp">typedef struct {<br/>  PF_RenderRequest  output_request; // what the effect is being asked to render<br/>  short             bitdepth;       // bitdepth the effect is being driven in (in bpc)<br/>  const             void *gpu_data; // (new AE 16.0)<br/>  PF_GPU_Framework  what_gpu;       // (new AE 16.0)<br/>  A_u_long          device_index;   // (new AE 16.0) For use in conjunction with PrSDKGPUDeviceSuite<br/>} PF_PreRenderInput;</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_SMART_RENDER</code></p>
</td>
<td colspan="1" rowspan="1">
<p>SmartFX only. Perform rendering and provide output for the area(s) the effect was asked to render.</p>
</td>
</tr>
</tbody>
</table>
<h3 id="effect-basics-command-selectors-messaging">Messaging<a class="headerlink" href="#effect-basics-command-selectors-messaging" title="Permanent link">&para;</a></h3>
<p>The communication channel between After Effects and your plug-in.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Selector</p>
</th>
<th colspan="1" rowspan="1">
<p>Response</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_EVENT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This selector makes use of the extra parameter; the type of event to be handled is indicated by the e_type field, a member of the structure pointed to by extra.</p>
<p>See <a href="#effect-ui-events-effect-ui-events">Effect UI &amp; Events</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_USER_CHANGED_PARAM</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The user changed a parameter value. You will receive this command only if you've set the <code>PF_ParamFlag_SUPERVISE</code> flag.</p>
<p>You modify the parameter to control values, or make one parameter's value affect others. A parameter can be modified by different actions.</p>
<p><code>in_data.current_time</code> is set to the time of the frame that the user is looking at in the UI (internally, the current time of the comp converted into layer time) while they are changing the param that triggered the <code>PF_Cmd_USER_CHANGED_PARAM</code>.</p>
<p>It's also the time of a keyframe that is added automatically (if there isn't one already, and the stopwatch is enabled).</p>
<p>This is usually the same as the value passed for the PF_Cmd_RENDER that follows immediately after (unless caps lock is down), but not necessarily - there could be other comp windows open that cause a render at a different time in response to the changed param.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_UPDATE_PARAMS_UI</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The effect controls palette (ECP) needs to be updated. This might occur after opening the ECP or moving to a new time within the composition.</p>
<p>You can modify parameter characteristics (enabling or disabling them, for example) by calling <code>PF_UpdateParamUI()</code>.</p>
<p>Only cosmetic changes may be made in response to this command. Don't change parameter values while responding to <code>PF_Cmd_UPDATE_PARAMS_UI</code>; do so during <code>PF_Cmd_USER_CHANGED_PARAM</code> instead.</p>
<p>This command will only be sent regularly if <code>PF_OutFlag_SEND_UPDATE_PARAMS_UI</code> was set in the PiPL, and during <code>PF_Cmd_GLOBAL_SETUP</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Never check out parameters during this selector. Recursive badness is almost guaranteed to result.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_DO_DIALOG</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Display an options dialog. this is sent when the Options button is clicked (or a menu command has been selected).</p>
<p>This selector will only be sent if the effect has previously indicated that it has a dialog (by setting the global <code>PF_OutFlag_I_DO_DIALOG</code> flag in response to <code>PF_Cmd_GLOBAL_SETUP</code>).</p>
<p>In version 3.x, the params passed with <code>PF_Cmd_DO_DIALOG</code> were invalid.</p>
<p>This is no longer the case; plug-ins can access non-layer parameters, check out parameters at other times, and perform UI updates during <code>PF_Cmd_DO_DIALOG</code>.</p>
<p>They still may not change the parameter's values.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_ARBITRARY_CALLBACK</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Manage your arbitrary data type. You'll only receive this if you've registered a custom data type parameter.</p>
<p>The extra parameter indicates which handler function is being called.</p>
<p>Custom data types are discussed further in <a href="#effect-details-arbitrary-data-parameters">Implementing Arbitrary Data</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_GET_EXTERNAL_DEPENDENCIES</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Only sent if <code>PF_OutFlag_I_HAVE_EXTERNAL_DEPENDENCIES</code> was set during <code>PF_Cmd_GLOBAL_SETUP</code>.</p>
<p>Populate a string handle (in the PF_ExtDependenciesExtra pointed to by extra) with a description of your plug-in's dependencies, making sure to allocate space for the terminating NULL character.</p>
<p>Return just a <code>NULL</code> pointer for the string handle if there are no dependencies to report.</p>
<p>If the check type is <code>PF_DepCheckType_ALL_DEPENDENCIES</code>, report everything that might be required for your plug-in to render.</p>
<p>Report only missing items (or a null string if nothing's missing) if the check type is <code>PF_DepCheckType_MISSING_DEPENDENCIES</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_COMPLETELY_GENERAL</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Respond to an AEGP. The extra parameter points to whatever parameter the AEGP sent.</p>
<p>AEGPs can only communicate with effects which respond to this selector.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_QUERY_DYNAMIC_FLAGS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sent only to plug-ins which have specified <code>PF_OutFlag2_SUPPORTS_QUERY_DYNAMIC_FLAGS</code> in <code>PF_OutFlags2</code>, in their PiPL and during <code>PF_Cmd_GLOBAL_SETUP</code>.</p>
<p>With all of the dynamic flags, if you will ever change them during this command, you must have set the flag on during <code>PF_Cmd_GLOBAL_SETUP</code>.</p>
<p>This selector will be sent at arbitrary times.</p>
<p>In response, the effect should access its (non-layer) parameters using <code>PF_CHECKOUT_PARAM</code>, and decide whether any of the flags that support <code>PF_Cmd_QUERY_DYNAMIC_FLAGS</code> should be set, such as:</p>
<ul>
<li><code>PF_OutFlag_WIDE_TIME_INPUT</code></li>
<li><code>PF_OutFlag_NON_PARAM_VARY</code></li>
<li><code>PF_OutFlag_PIX_INDEPENDENT</code></li>
<li><code>PF_OutFlag_I_USE_SHUTTER_ANGLE</code></li>
<li><code>PF_OutFlag2_I_USE_3D_CAMERA</code></li>
<li><code>PF_OutFlag2_I_USE_3D_LIGHTS</code></li>
<li><code>PF_OutFlag2_DOESNT_NEED_EMPTY_PIXELS</code></li>
<li><code>PF_OutFlag2_REVEALS_ZERO_ALPHA</code></li>
<li><code>PF_OutFlag2_DEPENDS_ON_UNREFERENCED_MASKS</code></li>
<li><code>PF_OutFlag2_OUTPUT_IS_WATERMARKED</code></li>
</ul>
<p>After Effects uses this information for caching and optimization purposes, so try to respond as quickly as possible.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_GPU_DEVICE_SETUP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This selector can be called at any time by the host. It will be called not more than once for each GPU device.</p>
<p>Multiple GPU devices may be in the setup state at one time.</p>
<p>It will be called after GlobalSetup and before SequenceSetup.</p>
<p>The intent is for the effect to do GPU initialization if necessary and to give the effect an opportunity to opt out of a GPU device based solely on the properties of that device, and not any render context (frame size, etc).</p>
<p>If the effect rejects the GPU device it will get called for CPU render.</p>
<p><code>PF_InData::what_gpu != PF_GPU_Framework_None</code> is expected.</p>
<p>Effect is expected to set one or both of the <code>PF_OutFlag2_SUPPORTS_GPU_RENDER_Fxx</code> flags in <code>PF_OutData::out_flags2</code> if the device and framework in what_gpu is supported.</p>
<p>Note that only <code>PF_OutFlag2_SUPPORTS_GPU_RENDER_F32</code> will be in AE 16.0.</p>
<p>Effects that do not set flags here will NOT be considered to support GPU rendering for any of these devices.</p>
<p><code>PF_GPUDeviceSetupOutput::gpu_data</code> is a plug-in owned pointer that must be released with a the <code>PF_Cmd_GPU_DEVICE_SETDOWN</code> selector.</p>
<p>This pointer is also available at render time.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_GPU_DEVICE_SETDOWN</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Release any resources associated with gpu_data. In AE this will be called just before GPU device release.</p>
<p><pre lang="cpp">typedef struct {<br/>  void              *gpu_data;  // effect must dispose.<br/>  PF_GPU_Framework  what_gpu;<br/>  A_u_long          device_index; // For use in conjunction with PrSDKGPUDeviceSuite<br/>} PF_GPUDeviceSetdownInput;<br/><br/>typedef struct {<br/>  PF_GPUDeviceSetdownInput  input;<br/>} PF_GPUDeviceSetdownExtra;</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Cmd_GPU_SMART_RENDER_GPU</code></p>
</td>
<td colspan="1" rowspan="1">
<p>GPU equivalent to the existing <code>PF_Cmd_SMART_RENDER</code> selector.</p>
<p>At render time, either the <code>PF_Cmd_SMART_RENDER</code> or the <code>PF_Cmd_SMART_RENDER_GPU</code> selector will be called, depending on whether the effect is expected to produce a CPU or GPU frame as output.</p>
<p><code>PF_Cmd_SMART_RENDER_GPU</code> will only be called when <code>what_gpu != PF_GPU_Framework_None</code>, and has effects on any input / output <code>PF_LayerDef</code>'s.</p>
<p>All frame check-ins and check-outs will operate on GPU frames when this selector is in progress. Note <code>PF_Cmd_SMART_RENDER</code> shares the <code>Extra</code> structs.</p>
<p><pre lang="cpp">typedef struct {<br/>  PF_RenderRequest  output_request;   // what the effect is being asked to render<br/>  short             bitdepth;         // bitdepth the effect is being driven in (in bpc)<br/>  void              *pre_render_data; // passed back from value placed in extra-&gt;output-&gt;pre_render_data during PF_Cmd_PRE_RENDER<br/>  const void        *gpu_data;        // (new AE 16.0)<br/>  PF_GPU_Framework  what_gpu;         // (new AE 16.0)<br/>  A_u_long          device_index;     // (new AE 16.0)<br/>} PF_SmartRenderInput;<br/><br/>typedef struct {<br/>  PF_SmartRenderInput *input;<br/>  PF_SmartRenderCallbacks *cb;<br/>} PF_SmartRenderExtra;</pre></p>
<p>The <code>what_gpu</code> and <code>device_index</code> fields are in the extra input for GPU-related selectors indicates to the plug-in the GPU framework to be used for rendering.</p>
<p>Input and output buffers will be prepared on this framework and device.</p>
<p>The device, context, command queue, and other associated GPU state can be queried with <code>PrSDKGPUDeviceSuite::GetDeviceInfo</code>.</p>
<p><code>what_gpu</code> will be the same between <code>PF_Cmd_SMART_PRE_RENDER</code> and <code>PF_Cmd_SMART_RENDER_GPU</code> selector calls.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-basics-command-selectors-whats-the-difference">What's The Difference?<a class="headerlink" href="#effect-basics-command-selectors-whats-the-difference" title="Permanent link">&para;</a></h2>
<p>There is a subtle difference between <code>PF_Cmd_USER_CHANGED_PARAM</code> and <code>PF_Cmd_UPDATE_PARAMS_UI</code>.</p>
<p>Effects need to distinguish between the user actually changing a parameter value (<code>PF_Cmd_USER_CHANGED_PARAM</code>), and just scrubbing around the timeline (<code>PF_Cmd_UPDATE_PARAMS_UI</code>), which is also sent when the plug-in is first loaded).</p>
<p>Only the first few command selectors are predictable; the rest of the calling sequence is dictated by user action.</p>
<p>When first applied, a plug-in receives <code>PF_Cmd_GLOBAL_SETUP</code>, then <code>PF_Cmd_PARAM_SETUP</code>. Each time the user adds the effect to a layer, <code>PF_Cmd_SEQUENCE_SETUP</code> is sent.</p>
<p>For each frame rendered by a basic non-SmartFX effect, After Effects sends <code>PF_Cmd_FRAME_SETUP</code>, then <code>PF_Cmd_RENDER</code>, then <code>PF_Cmd_FRAME_SETDOWN</code>. All effect plug-ins must respond to <code>PF_Cmd_RENDER</code> <em>.</em></p>
<p>For SmartFX, <code>PF_Cmd_SMART_PRE_RENDER</code> may be sent any number of times, before a single <code>PF_Cmd_SMART_RENDER</code> is sent.</p>
<p><code>PF_Cmd_SEQUENCE_SETDOWN</code> is sent on exit, when the user removes an effect or closes the project. <code>PF_Cmd_SEQUENCE_RESETUP</code> is sent when a project is loaded or when the layer to which it's applied changes. <code>PF_Cmd_SEQUENCE_FLATTEN</code> is sent when the After Effects project is written out to disk.</p>
<p><code>PF_Cmd_ABOUT</code> is sent when the user chooses <em>About...</em> from the Effect Controls Window (ECW).</p>
<p><code>PF_Cmd_GLOBAL_SETDOWN</code> is sent when After Effects closes, or when the last instance of the effect is removed. Do not rely on this message to determine when your plug-in is being removed from memory; use OS-specific entry points.</p></section><section class="print-page" id="effect-basics-pf_indata"><h1 id="effect-basics-pf_indata-pf_indata">PF_InData<a class="headerlink" href="#effect-basics-pf_indata-pf_indata" title="Permanent link">&para;</a></h1>
<p>After Effects communicates system, project, layer and audio information using <code>PF_InData</code>. This structure is updated before each command selector is sent to a plug-in.</p>
<p>Fields valid only during specific <a href="#effect-basics-command-selectors">PF_Cmds</a> are noted.</p>
<p>Also, don't worry; although <code>PF_InData</code> is dauntingly large, you need not memorize each member's purpose; you'll use some of the fields some of the time.</p>
<hr />
<h2 id="effect-basics-pf_indata-pf_indata-members">PF_InData Members<a class="headerlink" href="#effect-basics-pf_indata-pf_indata-members" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Name</p>
</th>
<th colspan="1" rowspan="1">
<p>Description</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>inter</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Callbacks used for user interaction, adding parameters, checking whether the user has interrupted the effect, displaying a progress bar, and obtaining source frames and parameter values at times other than the current time being rendered.</p>
<p>This very useful function suite is described in <a href="#effect-details-interaction-callback-functions">Interaction Callback Functions</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>utils</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Graphical and mathematical callbacks. This pointer is defined at all times.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>effect_ref</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Opaque data that must be passed to most of the various callback routines.</p>
<p>After Effects uses this to identify your plug-in.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>quality</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The current quality setting, either <code>PF_Quality_HI</code> or <code>PF_Quality_LO</code>.</p>
<p>Effects should perform faster in LO, and more accurately in HI.</p>
<p>The graphics utility callbacks perform differently between LO and HI quality; so should your effect!</p>
<p>This field is defined during all frame and sequence selectors.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>version</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Effects specification version, Indicate the version you need to run successfully during <code>PF_Cmd_GLOBAL_SETUP</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>serial_num</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The serial number of the invoking application.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>appl_id</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The identifier of the invoking application.</p>
<p>If your plug-in is running in After Effects, <code>appl_id</code> contains the application creator code 'FXTC'.</p>
<p>If it is running in <a href="#ppro-ppro">Premiere Pro &amp; Other Hosts</a> it will be 'PrMr'.</p>
<p>Use this to test whether your plug-in, licensed for use with one application, is being used with another.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>num_params</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Input parameter count.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>what_cpu</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Under macOS this contains the Gestalt value for CPU type (see Inside Macintosh, volume 6). Undefined on Windows.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>what_fpu</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Under macOS this contains the Gestalt value for FPU type. Undefined on Windows.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>current_time</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The time of the current frame being rendered, valid during <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_RENDER</a>.</p>
<p>This is the current time in the layer, not in any composition.</p>
<p>If a layer starts at other than time 0 or is time-stretched, layer time and composition time are distinct.</p>
<p>The current frame number is <code>current_time</code> divided by <code>time_step</code>.</p>
<p>The current time in seconds is <code>current_time</code> divided by time_scale.</p>
<p>To handle time stretching, composition frame rate changes, and time remapping, After Effects may ask effects to render at non-integral times (between two frames).</p>
<p>Be prepared for this; don't assume that you'll only be asked for frames on frame boundaries.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of CS3 (8.0), effects may be asked to render at negative current times. Deal!</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>time_step</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The duration of the current source frame being rendered.</p>
<p>In several situations with nested compositions, this source frame duration may be different than the time span between frames in the layer (<code>local_time_step</code>).</p>
<p>This value can be converted to seconds by dividing by time_scale.</p>
<p>When calculating other source frame times, such as for <a href="#effect-details-interaction-callback-functions-interaction-callbacks">PF_CHECKOUT_PARAM</a>, use this value rather than <code>local_time_step</code>.</p>
<p>Can be negative if the layer is time-reversed. Can vary from one frame to the next if time remapping is applied on a nested composition.</p>
<p>Can differ from local_time_step when source material is stretched or remapped in a nested composition.</p>
<p>For example, this could occur when an inner composition is nested within an outer composition with a different frame rate, or time remapping is applied to the outer composition.</p>
<p>This value will be 0 during <a href="#effect-basics-command-selectors-sequence-selectors">PF_Cmd_SEQUENCE_SETUP</a> if it is not constant for all frames.</p>
<p>It will be set correctly during <code>PF_Cmd_FRAME_SETUP</code> and <code>PF_Cmd_FRAME_SETDOWN</code> selectors.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This can be zero, so check it before you divide.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>total_time</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Duration of the layer.</p>
<p>If the layer is time-stretched longer than 100%, the value will be adjusted accordingly; but if the layer is time-stretched shorter, the value will not be affected.</p>
<p>If time remapping is enabled, this value will be the duration of the composition.</p>
<p>This value can be converted to seconds by dividing by <code>time_scale</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>local_time_step</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Time difference between frames in the layer.</p>
<p>Affected by any time stretch applied to a layer.</p>
<p>Can be negative if the layer is time-reversed.</p>
<p>Unlike <code>time_step</code>, this value is constant from one frame to the next.</p>
<p>This value can be converted to seconds by dividing by <code>time_scale</code>.</p>
<p>For a step value that is constant over the entire frame range of the layer, use <code>local_time_step</code>, which is based on the composition's framerate and layer stretch.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>time_scale</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The units per second that <code>current_time</code>, <code>time_step</code>, <code>local_time_step</code> and <code>total_time</code> are in.</p>
<p>If <code>time_scale</code> is 30, then the units of <code>current_time</code>, <code>time_step</code>, <code>local_time_step</code> and <code>total_time</code> are in 30ths of a second.</p>
<p>The <code>time_step</code> might then be 3, indicating that the sequence is actually being rendered at 10 frames per second. <code>total_time</code> might be 105, indicating that the sequence is 3.5 seconds long.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>field</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Valid only if <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlag_PIX_INDEPENDENT</a> was set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
<p>Check this field to see if you can process just the upper or lower field.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>shutter_angle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Motion blur shutter angle. Values range from 0 to 1, which represents 360 degrees.</p>
<p>Will be zero unless motion blur is enabled and checked for the target layer.</p>
<p><code>shutter_angle == 180</code> means the time interval between <code>current_time</code> and <code>current_time + 1/2 time_step</code>.</p>
<p>Valid only if <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlag_I_USE_SHUTTER_ANGLE</a> was set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
<p>See the section on <a href="#effect-details-motion-blur">Motion Blur</a> for details on how to implement motion blur in your effect.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>width</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Dimensions of the source layer, which are not necessarily the same as the width and height fields in the input image parameter.</p>
<p>Buffer resizing effects can cause this difference. Not affected by downsampling.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>height</code></p>
</td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>extent_hint</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The intersection of the visible portions of the input and output layers; encloses the composition rectangle transformed into layer coordinates.</p>
<p>Iterating over only this rectangle of pixels can speed your effect dramatically. See <a href="#effect-basics-pf_indata-extent_hint-usage">extent_hint Usage</a> later in this chapter regarding proper usage.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>output_origin_x</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The origin of the output buffer in the input buffer. Non-zero only when the effect changes the origin.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>output_origin_y</code></p>
</td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>downsample_x</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Point control parameters and layer parameter dimensions are automatically adjusted to compensate for a user telling After Effects to render only every nth pixel.</p>
<p>Effects need the downsampling factors to interpret scalar parameters representing pixel distances in the image (like sliders).</p>
<p>For example, a blur of 4 pixels should be interpreted as a blur of 2 pixels if the downsample factor is 1/2 in each direction (downsample factors are represented as ratios.)</p>
<p>Valid only during:</p>
<ul>
<li><a href="#effect-basics-command-selectors-sequence-selectors">PF_Cmd_SEQUENCE_SETUP</a></li>
<li><a href="#effect-basics-command-selectors-sequence-selectors">PF_Cmd_SEQUENCE_RESETUP</a></li>
<li><a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_FRAME_SETUP</a></li>
<li><a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_RENDER</a></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>downsample_y</code></p>
</td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>pixel_aspect_ratio</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Pixel aspect ratio (width over height).</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>in_flags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Unused.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>global_data</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Data stored by your plug-in during other selectors. Locked and unlocked by After Effects before and after calling the plug-in.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>sequence_data</code></p>
</td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>frame_data</code></p>
</td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>start_sampL</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Starting sample number, relative to the start of the audio layer.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>dur_sampL</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Duration of audio, expressed as the number of samples. Audio-specific.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>total_sampL</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Samples in the audio layer; equivalent to total_time expressed in samples.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>src_snd</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_SoundWorld</code> describing the input sound. Audio-specific.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>pica_basicP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Pointer to the PICA Basic suite, used to acquire other suites.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>pre_effect_source_origin_x</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Origin of the source image in the input buffer. Valid only when sent with a frame selector.</p>
<p>Non-zero only if one or more effects that preceded this effect on the same layer resized the output buffer and moved the origin.</p>
<p>Check for both the resize and the new origin to determine output area.</p>
<p>This is useful for effects which have implicit spatial operations (other than point controls), like flipping a file around an image's center.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Checked-out point parameters are adjusted for the pre-effect origin at the current time, not the time being checked out.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>pre_effect_source_origin_y</code></p>
</td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>shutter_phase</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Offset from frame time to shutter open time as a percentage of a frame duration.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-basics-pf_indata-extent_hint-usage">extent_hint Usage<a class="headerlink" href="#effect-basics-pf_indata-extent_hint-usage" title="Permanent link">&para;</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Hint rectangles are much more effective...and complicated...for <a href="#smartfx-smartfx">SmartFX</a>.</p>
</div>
<p>Use <code>extent_hint</code> to process only those pixels for which output is required; this is one of the simplest optimizations you can make.</p>
<p>Tell After Effects you use <code>in_data&gt;extent_hint</code> by setting <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlag_USE_OUTPUT_EXTENT</a> in <a href="#effect-basics-pf_outdata-pf_outdata">PF_OutData</a> during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a> (and in your PiPL).</p>
<p>Disable caching from the preferences menu before testing <code>extent_hint</code> code, so After Effects renders your effect whenever anything in your composition changes.</p>
<p>Otherwise, the caching mechanism would obscure your plug-in's (possibly incorrect) output.</p>
<p>Move the layer within the composition so it's cropped. The <code>output&gt;extent_hint</code> is the portion of the layer which is visible in the composition.</p>
<p>Add a mask to your layer and move it around.</p>
<p>This changes the <code>extent_hint</code>, which encloses all of the non-zero alpha areas of the image.</p>
<p>The <code>in_data&gt;extent_hint</code> is the intersection of these two rectangles (the composition and the mask), and changes whenever they do.</p>
<p>Extent rectangles are computed in the coordinate space of the original input layer, before resizing and origin shifting, to simplify rectangle intersection between the input and output extents for effects which set <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlag_PIX_INDEPENDENT</a>.</p>
<p>To get the output extent in the coordinate system of the output buffer, offset the <code>extent_hint</code> by the <code>PF_InData-&gt;output_origin_x</code> and <code>y</code> fields.</p>
<p>Account for downsampling when computing output size; users must be able to render at full resolution.</p>
<p>If the output buffer exceeds 30,000 by 30,000, clamp it to that size, and consider displaying an alert dialog.</p>
<p>Once your code behaves correctly, enable the cache and see how frequently the effect needs to re-render.</p>
<p>Consider a drop shadow; users frequently apply a static drop shadow to a still image.</p>
<p>The <code>output&gt;extent_hint</code> is ignored, so the cache is used more often.</p>
<p>For buffer-expanding effects, intersect the <code>output&gt;extent_hint</code> with your plug-in's transformed bounds and sets the size accordingly during <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_FRAME_SETUP</a>.</p>
<hr />
<h2 id="effect-basics-pf_indata-now-with-20-more-pixels">Now with 20% More Pixels!<a class="headerlink" href="#effect-basics-pf_indata-now-with-20-more-pixels" title="Permanent link">&para;</a></h2>
<p>As of 6.0, the extent_hints passed are 20% larger than the layer itself, to help with our predictive rendering decisions.</p>
<p>Numerous effects expand the buffer "just a touch", and After Effects often uses the hint rectangles later.</p>
<hr />
<h2 id="effect-basics-pf_indata-point-controls-and-buffer-expansion">Point Controls And Buffer Expansion<a class="headerlink" href="#effect-basics-pf_indata-point-controls-and-buffer-expansion" title="Permanent link">&para;</a></h2>
<p>Effects which expand the output buffer position the original layer's upper left corner by setting set <code>output_origin_x/y</code> in <code>PF_InData</code> during <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_FRAME_SETUP</a>.</p>
<p>This shift is reported to subsequent effects in the <code>pre_effect_source_origin_x/y</code>. Point parameters are adjusted for this shift automatically.</p>
<p>Apply a buffer expander such as Gaussian Blur or the Resizer SDK sample, <em>before</em> your effect, and use a large resize value.</p>
<p>If your effect is not handling <code>pre_effect_source_origin_x/y</code> correctly, turning the blur on and off will shift the position of the output.</p>
<p>All point parameter values (at any time) have shift values described by <code>pre_effect_source_origin_x/y</code>. For most effects this works transparently.</p>
<p>However, if a buffer expansion changes over time (as with an animated blur amount), the origin shift will move non-animated points.</p>
<p>Consider this when designing effects which cache point parameter values between frames.</p></section><section class="print-page" id="effect-basics-pf_outdata"><h1 id="effect-basics-pf_outdata-pf_outdata">PF_OutData<a class="headerlink" href="#effect-basics-pf_outdata-pf_outdata" title="Permanent link">&para;</a></h1>
<p>Communicate changes made by your plug-in to After Effects using <code>PF_OutData</code>. Valid times for altering these fields are noted.</p>
<hr />
<h2 id="effect-basics-pf_outdata-pf_outdata-members">PF_OutData Members<a class="headerlink" href="#effect-basics-pf_outdata-pf_outdata-members" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Field</p>
</th>
<th colspan="1" rowspan="1">
<p>Description</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>my_version</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set this flag (using the PF_VERSION macro) to the version of your plug-in code.</p>
<p>After Effects uses this data to decide which of duplicate effects to load.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>name</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Unused.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>global_data</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Handle which will be returned to you in <a href="#effect-basics-pf_indata">PF_InData</a> with every call.</p>
<p>Use After Effects' memory allocation functions.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>num_params</code></p>
</td>
<td colspan="1" rowspan="1">
<p>After Effects checks this field against the number of calls made to <code>PF_ADD_PARAM</code>, as well as the implicit input layer.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>sequence_data</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Allocatable upon receiving <a href="#effect-basics-command-selectors-sequence-selectors">PF_Cmd_SEQUENCE_SETUP</a>, this handle will be passed back to you in <a href="#effect-basics-pf_indata">PF_InData</a> during all subsequent calls.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>flat_sdata_size</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Unused (After Effects knows the size, because you used its allocation functions to get the memory in the first place).</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>frame_data</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Handle you (might have) allocated during <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_FRAME_SETUP</a>.</p>
<p>This is never written to disk; it was used to pass information from your <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_FRAME_SETUP</a> response to your <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_RENDER</a> or <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_FRAME_SETDOWN</a> (which you must do if you resize the output buffer).</p>
<p>Otherwise, this memory is rarely used.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>width</code>, <code>height</code>, <code>origin</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set during <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_FRAME_SETUP</a> if the output image size differs from the input.</p>
<p><code>width</code> and <code>height</code> are the size of the output buffer, and <code>origin</code> is the point the input should map to in the output.</p>
<p>To create a 5-pixel drop shadow up and left, set origin to (5, 5).</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#effect-basics-pf_outdata-pf_outflags">out_flags</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Send messages to After Effects. OR together multiple values.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>return_msg</code></p>
</td>
<td colspan="1" rowspan="1">
<p>After Effects displays any C string you put here (checked and cleared after every command selector).</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>start_sampL</code>, <code>dur_sampL</code>, <code>dest_snd</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Used only for <a href="#audio-audio">Audio</a> commands</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#effect-basics-pf_outdata-pf_outflags2">out_flags2</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Send messages to After Effects. OR together multiple values.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-basics-pf_outdata-pf_outflags">PF_OutFlags<a class="headerlink" href="#effect-basics-pf_outdata-pf_outflags" title="Permanent link">&para;</a></h2>
<p>These flags communicate capability and status information to After Effects. In previous versions they were also used to send rudimentary messages, e.g. refresh the UI, send an error message.</p>
<p>These capabilities have been supplanted by function suites, and all new messaging functions will come in that format. However, capability flags are still contained in the <a href="#intro-pipl-resources">PiPL</a>.</p>
<p>Update both the PiPL and your source code when you make a change. Many of these flags can be changed during an After Effects session.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Flag</p>
</th>
<th colspan="1" rowspan="1">
<p>Indicates</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_KEEP_RESOURCE_OPEN</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The plug-in's resources must be available during all commands.</p>
<p>During <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>, the plug-in's resources are always open, but unavailable at all other times (except during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_ABOUT</a> and <a href="#effect-basics-command-selectors-messaging">PF_Cmd_DO_DIALOG</a>), unless this flag has been set.</p>
<p>Set if you need access to resources at any time other than during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We recommend the plug-in load and store the necessary resources in global data, rather than keeping the file's resources open.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_WIDE_TIME_INPUT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The effect checks out a parameter at a time other than <code>current_time</code>.</p>
<p>If you use a parameter (including layer parameters) from another time, set this flag.</p>
<p>Otherwise, After Effects won't correctly invalidate cached frames used by your effect.</p>
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
<p>If you set this flag, we strongly recommend you also set <code>PF_OutFlag2_AUTOMATIC_WIDE_TIME_INPUT</code> for better performance.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_NON_PARAM_VARY</code></p>
</td>
<td colspan="1" rowspan="1">
<p>With this flag set, After Effects will not cache output when the effect is applied to a still.</p>
<p>Otherwise, After Effects will cache your output to be used to render other frames, if possible.</p>
<p>Set this flag if output varies based on something besides a parameter value.</p>
<p>If the effect produces changing frames when applied to a still image and all parameters are constant, that's a sure sign that this bit should be set (e.g. Wave Warp).</p>
<p>Particle effects, for example, will need this.</p>
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
<p>Can be overridden dynamically if needed during <a href="#effect-basics-command-selectors-messaging">PF_Cmd_QUERY_DYNAMIC_FLAGS</a>.</p>
<p>Turn this off whenever possible to improve performance.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_RESERVED6</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Unused. Formerly <code>PF_OutFlag_SEND_PARAMS_UPDATE</code>. Replaced by <code>PF_OutFlag_REFRESH_UI</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_SEQUENCE_DATA_NEEDS_FLATTENING</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Both After Effects and Premiere Pro assume this flag is set.</p>
<p>Flattening is necessary when sequence data contains referencing items (pointers, handles), which must be flattened for storage and unflattened for use.</p>
<p>See <a href="#effect-basics-command-selectors-sequence-selectors">PF_Cmd_SEQUENCE_RESETUP</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_I_DO_DIALOG</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Effect displays a dialog in response to <a href="#effect-basics-command-selectors-messaging">PF_Cmd_DO_DIALOG</a>.</p>
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>, checked during <a href="#effect-basics-command-selectors-sequence-selectors">PF_Cmd_SEQUENCE_SETUP</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The effect's response to <code>PF_OutFlag_I_DO_DIALOG</code> is not undoable. You can use arbitrary data with a custom UI, should such changes become necessary.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_USE_OUTPUT_EXTENT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Effect honors the output <code>extent_rect</code>. Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
<p>See details at the end of the chapter for proper usage.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Obsolete for SmartFX.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_SEND_DO_DIALOG</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Effect must show dialog to function (added for compatibility with Photoshop plug-ins).</p>
<p>After Effects sends <a href="#effect-basics-command-selectors-messaging">PF_Cmd_DO_DIALOG</a> after <a href="#effect-basics-command-selectors-sequence-selectors">PF_Cmd_SEQUENCE_SETUP</a>.</p>
<p>Set during <a href="#effect-basics-command-selectors-sequence-selectors">PF_Cmd_SEQUENCE_RESETUP</a>, not during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_DISPLAY_ERROR_MESSAGE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Display the contents of <code>return_msg</code> in an error dialog.</p>
<p>Whenever return_msg is non-NULL, After Effects displays the contents in a dialog, which will be an error dialog if this flag is set.</p>
<p>Set after any command, and can be used during debugging.</p>
<p>This is also a good way to implement nag messages for tryout versions.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_I_EXPAND_BUFFER</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Effect expands the output buffer.</p>
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
<p>Set this flag and <code>PF_OutFlag_USE_OUTPUT_EXTENT</code> to use the intersection of the output <code>extent_rect</code> and your new buffer size during <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_FRAME_SETUP</a>.</p>
<p>Use <code>pre_effect_source_origin</code> fields to detect other transformations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only set this flag if you need to; it drastically reduces caching efficiency.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Obsolete for SmartFX.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_PIX_INDEPENDENT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A given pixel is independent of the pixels around it.</p>
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a> or <a href="#effect-basics-command-selectors-messaging">PF_Cmd_QUERY_DYNAMIC_FLAGS</a>.</p>
<p>As an example, color correction effects are typically pixel independent, distortions are not.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your effect doesn't use the color values of one pixel to affect those of adjacent pixels, set this outflag!</p>
<p>It can provide dramatic performance improvements.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_I_WRITE_INPUT_BUFFER</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The effect writes into the input buffer.</p>
<p>This is of limited use; while saving an allocation, it invalidates some pipeline caching. Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_I_SHRINK_BUFFER</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The effect shrinks its buffer based on the <code>extent_rect</code> in order to be more memory efficient.</p>
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a> whenever possible.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Obsolete for SmartFX.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_WORKS_IN_PLACE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Unused.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_SQUARE_PIX_ONLY</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Unused.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_CUSTOM_UI</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The effect has a custom user interface and requires <a href="#effect-basics-command-selectors-messaging">PF_Cmd_EVENT</a> messages.</p>
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_RESERVED5</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Unused.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_REFRESH_UI</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Refresh the entire effect controls, composition, and layer windows.</p>
<p>Set during <a href="#effect-basics-command-selectors-messaging">PF_Cmd_EVENT</a>, <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_RENDER</a>, and <a href="#effect-basics-command-selectors-messaging">PF_Cmd_DO_DIALOG</a>.</p>
<p>If refreshing custom UI during <code>PF_Cmd_EVENT</code>, we recommend using the <a href="#effect-ui-events-custom-ui-and-drawbot">new redraw mechanism</a> with finer granularity.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_NOP_RENDER</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set this flag during <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_FRAME_SETUP</a> to invalidate the current render.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_I_USE_SHUTTER_ANGLE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Indicates rendered images depend upon the value of <code>shutter_angle</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_I_USE_AUDIO</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Effect's parameters depend on audio data, obtained using <a href="#effect-details-interaction-callback-functions-interaction-callbacks">PF_CHECKOUT_LAYER_AUDIO</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_I_AM_OBSOLETE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Effect is available for use when working with an old project in which it was originally applied, but doesn't appear in the effect menu.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_FORCE_RERENDER</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Effect made a change that requires a re-render. PF_ChangeFlag_CHANGED_VALUE also forces a re-render.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_PiPL_OVERRIDES_OUTDATA_OUTFLAGS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>After Effects will use PiPL outflags, and ignore those set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_I_HAVE_EXTERNAL_DEPENDENCIES</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Effect depends on an external file (or external font).</p>
<p>If set, After Effects sends <a href="#effect-basics-command-selectors-messaging">PF_Cmd_GET_EXTERNAL_DEPENDENCIES</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_DEEP_COLOR_AWARE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The effect handles 16-bpc color.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_SEND_UPDATE_PARAMS_UI</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set this flag during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a> to receive <a href="#effect-basics-command-selectors-messaging">PF_Cmd_UPDATE_PARAMS_UI</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_AUDIO_FLOAT_ONLY</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Effect requires audio data in PF_SIGNED_FLOAT format.</p>
<p>After Effects will perform any required format conversion.</p>
<p>You must also set either <code>PF_OutFlag_AUDIO_EFFECT_TOO</code> or <code>PF_OutFlag_AUDIO_EFFECT_ONLY</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_AUDIO_IIR</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a> if the (audio) effect is an Infinite Impulse Response filter.</p>
<p>This is true if output at a given time depends on output from previous times.</p>
<p>When an IIR filter receives <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_AUDIO_RENDER</a>, the input audio time span is the same as the output audio time span (when they intersect with the output time span requested in <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_AUDIO_SETUP</a>).</p>
<p>In response to <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_AUDIO_SETUP</a>, the filter can request audio from earlier times (as for delay effects).</p>
<p>The filter can access parameters from that earlier time, and should cache them (along with interim audio) in sequence data.</p>
<p>If the audio generated does not correspond to the requested output audio's time, the output audio duration should be set to zero.</p>
<p>The filter can update its delay line using the parameters and the input audio.</p>
<p>Having cached its delay line, request more input audio during <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_AUDIO_SETUP</a> based on the last cached delay line. Use <a href="#effect-details-parameter-supervision-pf_paramutilsuite3">PF_HasParamChanged</a> to determine whether or not your cache is valid.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_I_SYNTHESIZE_AUDIO</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a> time if the effect generates audio, even when passed silence.</p>
<p>You must also set either <code>PF_OutFlag_AUDIO_EFFECT_TOO</code> or <code>PF_OutFlag_AUDIO_EFFECT_ONLY</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_AUDIO_EFFECT_TOO</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a> if the effect alters audio.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag_AUDIO_EFFECT_ONLY</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a> if the effect alters only audio output.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-basics-pf_outdata-pf_outflags2">PF_OutFlags2<a class="headerlink" href="#effect-basics-pf_outdata-pf_outflags2" title="Permanent link">&para;</a></h2>
<p>We added a second set of outflags in After Effects 5.0; partly for room to expand in the future, and partly to break ourselves of the bad habit of repurposing existing flags.</p>
<p>As with <code>PF_OutFlags</code>, many of these flags can be changed during an After Effects session.</p>
<p>And don't forget to update both the <a href="#intro-pipl-resources">PiPL</a> and your source code when you make a change.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Flag</p>
</th>
<th colspan="1" rowspan="1">
<p>Indicates</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_NONE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Nothing.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_SUPPORTS_QUERY_DYNAMIC_FLAGS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The effect responds to <a href="#effect-basics-command-selectors-messaging">PF_Cmd_QUERY_DYNAMIC_FLAGS</a>. Must be set in the PiPL and during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_I_USE_3D_CAMERA</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The effect accesses 3D camera information.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_I_USE_3D_LIGHTS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The effect accesses 3D lighting information.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_PARAM_GROUP_START_COLLAPSED_FLAG</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This flag in itself doesn't control the state of the param group twirlies.</p>
<p>The initial collapse state of each individual parameter group is set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_PARAM_SETUP</a>, by setting the <a href="#effect-basics-pf_paramdef-parameter-flags">PF_ParamFlag_START_COLLAPSED</a> flag in <a href="#effect-basics-pf_paramdef-parameter-flags">PF_ParamFlags</a>, but those individual settings will not be honored unless the effect sets this bit.</p>
<p>Otherwise, all parameter groups will be collapsed by default.</p>
<p>Remember to set this flag in both the PiPL and here during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP.</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_I_AM_THREADSAFE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Currently this does nothing. If this sounds interesting to you, you may be interested in <code>PF_OutFlag2_PPRO_DO_NOT_CLONE_SEQUENCE_DATA_FOR_RENDER</code>, described below.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_CAN_COMBINE_WITH_DESTINATION</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Originally added for Premiere usage, but no longer used.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_DOESNT_NEED_EMPTY_PIXELS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Added for render optimizations; shrinks the input buffer passed to the effect to exclude any empty pixels (where empty means "zero alpha" unless <code>PF_OutFlag2_REVEALS_ZERO_ALPHA</code> is set, in which case RGB must be zero as well).</p>
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a> or <a href="#effect-basics-command-selectors-messaging">PF_Cmd_QUERY_DYNAMIC_FLAGS</a>.</p>
<p>The origin of the trimmed buffer can be found in <code>in_data&gt;pre_effect_source_origin</code>.</p>
<p>Effects with both this flag and <code>PF_OutFlag_I_EXPAND_BUFFER</code> set may get called with a null input buffer if their input is completely empty, and must be able to handle this case without crashing.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this flag can cause the size of the output buffer to change.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Obsolete for SmartFX.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_REVEALS_ZERO_ALPHA</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This is the one flag implementors need to pay most attention to since it represents a change in the default behavior.</p>
<p>Set this flag if the effect can take pixels with zero alpha and reveal the RGB data in them (like our Set Channels effect).</p>
<p>This tells After Effects not to trim such pixels when determining the input for the effect.</p>
<p>This flag can be changed during <a href="#effect-basics-command-selectors-messaging">PF_Cmd_QUERY_DYNAMIC_FLAGS</a>.</p>
<p>Note that, while this flag can cause changes to the size of the <code>extent_hint</code>, it will not change the image buffer size.</p>
<p>As of 6.0, pixels outside the mask's bounding box are zeroed.</p>
<p>If your effect can reveal such pixels, tell AE not to throw away these RGB values by setting this flag.</p>
<p>If your effect does not always reveal such pixels, set this bit dynamically.</p>
<p>To see if your effect needs this bit set, apply a mask significantly smaller than the layer to a solid, then apply the effect and set it to its alpha-modifying state.</p>
<p>If the rectangular bounding box of the mask becomes visible, this bit needs to be set.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_PRESERVES_FULLY_OPAQUE_PIXELS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Preserve those pixels!</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_SUPPORTS_SMART_RENDER</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The effect uses the SmartFX API.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_FLOAT_COLOR_AWARE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The effect supports 32-bpc floating point color representation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>PF_OutFlag2_SUPPORTS_SMART_RENDER</code> must also be set.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_I_USE_COLORSPACE_ENUMERATION</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This is for effects which optimized for different color spaces in Premiere Pro. See the Premiere Pro SDK for more details.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_I_AM_DEPRECATED</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Setting this during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a> puts the effect in the localized "Obsolete" folder in the Effects panel.</p>
<p>Compare to <code>PF_OutFlag_I_AM_OBSOLETE</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_PPRO_DO_NOT_CLONE_SEQUENCE_DATA_FOR_RENDER</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Supported in Premiere Pro, and not in After Effects.</p>
<p>This affects how Premiere Pro drives the plug-in using <a href="#ppro-multithreading">Multithreading</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_AUTOMATIC_WIDE_TIME_INPUT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
<p>Requires setting of <code>PF_OutFlag_WIDE_TIME_INPUT</code> (which allows you to support old hosts), but effectively overrides that flag.</p>
<p>When set, all parameter checkouts are tracked so over-time dependencies are known by the host, and much more efficient.</p>
<p>For example, if you set only the old <code>PF_OutFlag_WIDE_TIME_INPUT</code>, anytime anything changes at any time upstream from your effect, you will be called to re-render.</p>
<p>With this flag set, if a given frame 17 has checked out things from times 0-17, AE will know that any changes at frames 18+ will not affect that cached frame.</p>
<p>Note that if you use this new flag, you must not cache any time-dependent data in your sequence data (or anywhere else), unless you also <a href="#effect-details-global-sequence-frame-data-validating-sequence-data">validate that cache</a> using <code>PF_GetCurrentState()</code> / <code>PF_AreStatesIdentical()</code> from <a href="#effect-details-parameter-supervision-pf_paramutilsuite3">PF_ParamUtilSuite3</a> before using the time-dependent data.</p>
<p>This only works for SmartFX (those that set <code>PF_OutFlag2_SUPPORTS_SMART_RENDER</code>).</p>
<p>If you haven't set that, After Effects will silently treat this as <code>PF_OutFlag_WIDE_TIME_INPUT</code> instead.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_I_USE_COMP_TIMECODE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a>.</p>
<p>This lets AE know it should rerender an effect if the composition start time and/ or drop-frame setting has been modified.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_DEPENDS_ON_UNREFERENCED_MASKS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CS6. Set this if you are going to look at paths that aren't directly referenced by a path param, e.g. if you are going to draw a stroke on all masks.</p>
<p>This is needed so After Effects knows to invalidate your output when a mask is modified that doesn't appear to be referenced by your effect.</p>
<p>Set during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a> or <a href="#effect-basics-command-selectors-messaging">PF_Cmd_QUERY_DYNAMIC_FLAGS</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_OUTPUT_IS_WATERMARKED</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CS6. Set this during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_GLOBAL_SETUP</a> if your output is going to be watermarked in some way that makes it unsuitable for final use, probably because the user is using an unlicensed demo version.</p>
<p>It is ok to change this state during the course of app session during <a href="#effect-basics-command-selectors-messaging">PF_Cmd_QUERY_DYNAMIC_FLAGS</a>, if e.g. a floating license status changes.</p>
<p>Plug-in authors that actually do have this state changing asynchronously must be careful to have the next render match the last state returned from <a href="#effect-basics-command-selectors-messaging">PF_Cmd_QUERY_DYNAMIC_FLAGS</a> otherwise race conditions could cause incorrect frames to be cached.</p>
<p>(This is a non-issue if you only change this in response to <code>DO_DIALOG</code>.)</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_SUPPORTS_GPU_RENDER_F32</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in 16.0 Set during PF_Cmd_GLOBAL_SETUP, this indicates GPU support.</p>
<p>The effect will be called with GPU selectors, and will be badged as GPU-supporting in the GUI.</p>
<p>At <code>PF_Cmd_GPU_DEVICE_SETUP</code> time, these flags indicate rendering capabilities for a specific device and framework.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_SUPPORTS_THREADED_RENDERING</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Available in After Effects Beta builds starting June 2020, After Effects 2022.</p>
<p>Set during <code>PF_Cmd_GLOBAL_SETUP</code>, this indicates the effect supports rendering on multiple threads at the same time. Single or multiple applications of this effect on a layer can be called to render at the same time on multiple threads.</p>
<p>This flag indicates the effect supports rendering on multiple threads at the same time. Single or multiple applications of this effect on a layer can be called to render at the same time on multiple threads.</p>
<p>If you are using the <code>PF_OutFlag_SEQUENCE_DATA_NEEDS_FLATTENING</code> flag, remember to also set the <code>PF_OutFlag2_SUPPORTS_GET_FLATTENED_SEQUENCE_DATA</code> flag. See <a href="#effect-details-multi-frame-rendering-in-ae-sequence-data-in-multi-frame-rendering">Sequence Data in Multi-Frame rendering</a> for more information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This flag should only be set on plugins that have been tested to be thread-safe with multi-frame rendering enabled in AE.</p>
</div>
<p>For more information on how to use this flag, please see <a href="#effect-details-multi-frame-rendering-in-ae">Multi-Frame Rendering in AE</a> under Effect Details.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Available in After Effects Beta builds starting March 2021, After Effects 2022.</p>
<p>Indicates the effect needs sequence_data replicated for each render thread, thus allowing each render to have sequence_data which can be written to. Note that changes to sequence_data will be discarded regularly, currently after each span of frames is rendered such as single RAM Preview or Render Queue export.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This flag should only be set on plugins that have been tested to be thread-safe with multi-frame rendering enabled in AE.</p>
</div>
<p>For more information on how to use this flag, please see <a href="#effect-details-multi-frame-rendering-in-ae">Multi-Frame Rendering in AE</a> under Effect Details.</p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-basics-parameters"><h1 id="effect-basics-parameters-parameters">Parameters<a class="headerlink" href="#effect-basics-parameters-parameters" title="Permanent link">&para;</a></h1>
<p>Parameters are streams of values that vary with time; the source image, sliders, angles, points, colors, paths, and any arbitrary data types the user can manipulate.</p>
<p>They are passed to the plug-in as an array of PF_ParamDefs, though the values in the array are only valid during certain selectors.</p>
<p>One of the best aspects of the After Effects effect API is the parameter interpolation and management.</p>
<p>How much does the shutter angle change during one-fourth of a 29.97 fps frame? Not your problem; leave it to After Effects.</p>
<p>Describe your plug-in's parameters during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_PARAM_SETUP</a>, using <a href="#effect-details-interaction-callback-functions-interaction-callbacks">PF_ADD_PARAM</a>.</p>
<p>You may have up to (approximately) 38 kajillion parameters, or as many as your users are willing to sift through before demanding a refund. Choose wisely.</p>
<p>Avoid countless problems by clearing PF_ParamDefs with AEFX_CLR_STRUCT (defined in AE_Macros.h) before registering them.</p>
<hr />
<h2 id="effect-basics-parameters-parameter-types">Parameter Types<a class="headerlink" href="#effect-basics-parameters-parameter-types" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Parameter Type</p>
</th>
<th colspan="1" rowspan="1">
<p>Parameter Type</p>
</th>
<th colspan="1" rowspan="1">
<p>PF_ParamDefUnion Member</p>
</th>
<th colspan="1" rowspan="1">
<p>Param Value Data Type</p>
</th>
<th colspan="1" rowspan="1">
<p>Description</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_LAYER</code></p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#effect-basics-pf_effectworld">PF_LayerDef</a></p>
</td>
<td colspan="1" rowspan="1">
<p><code>ld</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>A_long</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Image and audio layers in the composition. All effects automatically have at least 1 layer parameter, param[0], the layer to which they are applied.</p>
<p>When used as effect parameters, these appear as a pull-down menu with which the user selects a layer within the current composition.</p>
<p>The pull-down menu contents are generated by After Effects.</p>
<p>NOTE: This is a reference to a layer which contains pixels and audio samples, not actual pixels and audio samples.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_SLIDER</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_SliderDef</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>sd</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>long</code></p>
</td>
<td colspan="1" rowspan="1">
<p>No longer used.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_FIX_SLIDER</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_FixedSliderDef</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>fd</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_Fixed</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Deprecated. For many years, we promoted fixed sliders. We now recommend <code>PF_Param_FLOAT_SLIDERs</code>.</p>
<p>The additional precision helps in many situations, and isn't as expensive as it once was. Plus, we're just tired of low byte / high byte silliness.</p>
<p><code>FIX_SLIDERs</code> provide higher precision than <code>PF_Param_SLIDER</code>. Specify the UI decimal places independently.</p>
<p>Ignore the low word of the <code>PF_Fixed</code> to get integral results.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_FLOAT_SLIDER</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_FloatSliderDef</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>fs_d</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_FPLong</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sliders represent numerical values. <code>FLOAT_SLIDERs</code> contain values for phase, precision, and curve tolerance for use by audio filters.</p>
<p>Specify a minimum and maximum value, and the user can move a slider or types a number to specify the setting.</p>
<p><code>PF_Param_FLOAT_SLIDERs</code> also respond to slider flags discussed in <a href="#audio-audio-considerations-audio-considerations">Audio Filters</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_ANGLE</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_AngleDef</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>ad</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_Fixed</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Angles in (fixed point) degrees, accurate to small fractions of a degree.</p>
<p>Users can specify multiple revolutions, resulting in values greater than 360.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_CHECKBOX</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_CheckBoxDef</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>bd</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_Boolean</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_ParamFlag_CANNOT_INTERP</code> is forced on for all checkboxes.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_COLOR</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_ColorDef</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>cd</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_Pixel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>RGB value (alpha is not used) that the user can choose either with the standard color picker or with an eye dropper tool.</p>
<p>For floating point accuracy, use <a href="#effect-details-parameters-floating-point-values-pf_colorparamsuite1">PF_ColorParamSuite1</a> to retrieve the values.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_POINT</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_PointDef</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>td</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_Fixed</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A two-dimensional point. The point provides x and y values in destination layer space.</p>
<p>The origin of the layer is the upper-left hand corner, with x increasing to the right, y increasing down.</p>
<p>Starting in CS5.5, for floating point accuracy, use <a href="#effect-details-parameters-floating-point-values-pf_pointparamsuite1">PF_PointParamSuite1</a> to retrieve the values.</p>
<p>Dusty history lesson to follow: Prior to API specification version 12.1 (After Effects 4.0), the default value for the point was between 0 and 100 in fixed point with the radix point at bit 16 (i.e. standard fixed point).</p>
<p>Specifying (50,50) in fixed point yields the center of the image. The value you are returned for a point control is in absolute pixels with some number of bits of fixed point accuracy.</p>
<p>Thus, if you gave (50,50) as the default position and the user applied the effect to a 640 by 480 layer, the default value you would be sent would be (320, 240) in Fixed point.</p>
<p>Plug-ins which specify API versions before 12.1 will still get the old behavior.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_POPUP</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_PopupDef</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>pd</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>A_long</code></p>
</td>
<td colspan="1" rowspan="1">
<p>List of choices. Build a string in namesptr containing a list of (read-only) pop-up entries ("Entry1 / Entry2 / Entry3").</p>
<p>After Effects copies the data and creates a pop-up menu.</p>
<p>These entries cannot be modified once the parameter is added.</p>
<p>An entry of "(-" will result in a separator being drawn between previous and subsequent entries.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_ARBITRARY_DATA</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_ArbitraryDef</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>arb_d</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>???</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Custom data type.</p>
<p><a href="#effect-details-arbitrary-data-parameters">Arbitrary Data Parameters</a> contain an ID (you can use more than one custom data type in a given effect), a default value (so After Effects knows what your data type should start as), and a handle to your actual parameter.</p>
<p>In AE, must specify either <code>PF_PUI_TOPIC</code> / <code>PF_PUI_CONTROL</code> or <code>PF_PUI_NO_ECW</code>.</p>
<p>In PPro 8.0 and later, it's okay to set none of those flags, which allows you to see the parameter's keyframe track on the right side of Effect Controls without creating a custom control.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_PATH</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_PathDef</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>path_d</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_PathID</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Path parameters are references to masks applied to the same layer as the effect.</p>
<p>Path parameter data cannot be accessed directly; use <a href="#effect-details-working-with-paths-pf_pathquerysuite1">PF_PathQuerySuite1</a> and <a href="#effect-details-working-with-paths-pf_pathdatasuite">PF_PathDataSuite</a> to manage and inquire about paths.</p>
<p><code>PF_PathDef.path_id</code> contains the index of the mask selected by the user.</p>
<p>A corresponding <code>AEGP_MaskRefH</code> can be obtained using <code>AEGP_GetLayerMaskByIndex</code> from <a href="#aegps-aegp-suites-aegp_masksuite6">AEGP_MaskSuite6</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_GROUP_START</code></p>
<p><code>PF_Param_GROUP_END</code></p>
</td>
<td colspan="1" rowspan="1">
<p>(none)</p>
<p>(none)</p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1">
<p>Parameter groups (topics) organize parameters into sets.</p>
<p>Each group receives its own twirly and will be indented in the ECP relative to the neighboring parameters or groups.</p>
<p>One group can be nested within another.</p>
<p>Each twirly can be spun open or closed by the user, or programatically by the effect.</p>
<p>The effect may choose to have certain groups initialized with the twirly spun open, and others with the twirly spun closed.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_BUTTON</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_Button</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>button_d</code></p>
</td>
<td colspan="1" rowspan="1">
<p>(no value)</p>
</td>
<td colspan="1" rowspan="1">
<p>A simple push button. Use <a href="#effect-details-parameter-supervision">Parameter Supervision</a> to detect when the button is pressed.</p>
<p>New in CS5.5 to After Effects.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Param_POINT_3D</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_Point3D</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>point3d_d</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_FpLong (3)</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A three-dimensional point.</p>
<p>New in CS5.5. Unsupported in Premiere Pro.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-basics-parameters-slider-range-issues">Slider Range Issues?<a class="headerlink" href="#effect-basics-parameters-slider-range-issues" title="Permanent link">&para;</a></h2>
<p>If your slider seems disabled but not grayed out, check the valid_min, slider_min, valid_max and slider_max fields. Is the param a <code>PF_Param_FIX_SLIDER</code>? If so, did you convert your mins and maxs to reasonable fixed values? If you're using the macros provided in AE_Macros.h, they're expecting to receive ints; passing fixed point values won't work.</p>
<hr />
<h2 id="effect-basics-parameters-point-parameter-origin">Point Parameter Origin<a class="headerlink" href="#effect-basics-parameters-point-parameter-origin" title="Permanent link">&para;</a></h2>
<p>After Effects modifies any point parameter to account for origin offset, introduced by "upstream" effects that modify the output dimensions. Even if the ECP UI indicates the value of the point parameter is (0,0), the offset has already been factored in.</p></section><section class="print-page" id="effect-basics-pf_paramdef"><h1 id="effect-basics-pf_paramdef-pf_paramdef">PF_ParamDef<a class="headerlink" href="#effect-basics-pf_paramdef-pf_paramdef" title="Permanent link">&para;</a></h1>
<p>After Effects passes effects an array of PF_ParamDefs with each selector, describing the plug-in's parameters at the current time. The values in the params array are only valid during some selectors (this is noted in the <a href="#effect-basics-command-selectors-calling-sequence">selector descriptions</a>).</p>
<hr />
<h2 id="effect-basics-pf_paramdef-param-zero">Param Zero<a class="headerlink" href="#effect-basics-pf_paramdef-param-zero" title="Permanent link">&para;</a></h2>
<p>The first parameter, params[0], is the input image (a <a href="#effect-basics-pf_effectworld">PF_EffectWorld / PF_LayerDef</a>) to which the effect should be applied.</p>
<hr />
<h2 id="effect-basics-pf_paramdef-the-rest-of-the-parameters">The Rest Of The Parameters<a class="headerlink" href="#effect-basics-pf_paramdef-the-rest-of-the-parameters" title="Permanent link">&para;</a></h2>
<p>All parameter types are represented by a PF_ParamDef. Unions are used, so that only the pertinent parts of the PF_ParamDef need be (or should be) populated.</p>
<h2 id="effect-basics-pf_paramdef-pf_paramdef-members">PF_ParamDef Members<a class="headerlink" href="#effect-basics-pf_paramdef-pf_paramdef-members" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Data Type</p>
</th>
<th colspan="1" rowspan="1">
<p>Name</p>
</th>
<th colspan="1" rowspan="1">
<p>Description</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_long</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>id</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The ID of this parameter. You can re-order parameters in future versions of your plug-in and not cause users to re-apply your effect, if you maintain the parameter's ID across versions.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ChangeFlags</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>change_flags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set if you've changed a parameter value. Only valid during drag (not click!) events, <a href="#effect-basics-command-selectors-messaging">PF_Cmd_USER_CHANGED_PARAM</a> or <a href="#effect-basics-command-selectors-messaging">PF_Cmd_UPDATE_PARAMS_UI</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#effect-basics-pf_paramdef-parameter-ui-flags">PF_ParamUIFlags</a></p>
</td>
<td colspan="1" rowspan="1">
<p><code>ui_flags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specify a parameter's UI behavior before adding; only <code>PF_PUI_DISABLED</code> may be set during event handling.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_short</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>ui_width</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Width of the parameter's user interface (for non-standard parameters only).</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_short</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>ui_height</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Height of the parameter's user interface (for non-standard parameters only).</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#effect-basics-parameters-parameter-types">PF_ParamType</a></p>
</td>
<td colspan="1" rowspan="1">
<p><code>param_type</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Type of parameter.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_char[32]</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>name</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Name of parameter. Can be changed during event handling.</p>
<p>Yes, longer parameter names have been requested since After Effects 1.0.</p>
<p>Think of adequately describing your world-altering effect in 31 mere characters as a language challenge, like haiku.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#effect-basics-pf_paramdef-parameter-flags">PF_ParamFlags</a></p>
</td>
<td colspan="1" rowspan="1">
<p><code>flags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specify a parameter's UI behavior before adding; only <code>PF_ParamFlag_COLLAPSE_TWIRLY</code> may be set during event handling.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ParamDefUnion</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>u</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A union of all possible <a href="#effect-basics-parameters-parameter-types">Parameter Types</a>.</p>
<p>Only the type specified by <code>param_type</code> contains meaningful data.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-basics-pf_paramdef-parameter-ui-flags">Parameter UI Flags<a class="headerlink" href="#effect-basics-pf_paramdef-parameter-ui-flags" title="Permanent link">&para;</a></h2>
<p>Control a parameter's user interface with these flags.</p>
<p>Don't confuse UI flags with behavior flags; they reside in different fields within your parameter's definition, and will cause unpredictable behavior if misapplied.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Flag</p>
</th>
<th colspan="1" rowspan="1">
<p>Description</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PUI_TOPIC</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set this flag if you handle <code>PF_Cmd_EVENTs</code> for the "topic" of the parameter.</p>
<p>The "topic" is the portion of the param UI in the Effect Controls Window (ECW) that is still visible when the twirly-arrow is twirled up for that param.</p>
<p>If you set this flag, you must also set <code>PF_OutFlag_CUSTOM_UI</code> at PF_Cmd_GLOBAL_SETUP time.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PUI_CONTROL</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set this flag if you handle <code>PF_Cmd_EVENTs</code> for the control area (area that becomes invisible when you twirl up a parameter's spinner) in the ECP.</p>
<p>If you set this flag, you must also set <code>PF_OutFlag_CUSTOM_UI</code> at <code>PF_Cmd_GLOBAL_SETUP</code> time.</p>
<p>See <a href="#effect-ui-events-effect-ui-events">Effect UI &amp; Events</a> for more details.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PUI_STD_CONTROL_ONLY</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set this flag if you want the standard control only - No data stream will be associated with this parameter, and thus no keyframes will be available in the Timeline panel.</p>
<p>You might want to do this to control something in your sequence data with a standard control.</p>
<p>Or in your arb data, or custom UI in the comp window, or to group-set multiple other controls.</p>
<p>This flag cannot be used with:</p>
<ul>
<li><code>PF_Param_CUSTOM</code></li>
<li><code>PF_Param_NO_DATA</code></li>
<li><code>PF_Param_LAYER</code></li>
<li><code>PF_Param_ARBITRARY_DATA</code></li>
<li><code>PF_Param_PATH</code></li>
</ul>
<p>If you set this flag, you must also set <code>PF_ParamFlag_SUPERVISE</code> (otherwise you would never find out about value changes, and the setting would never be used for anything).</p>
<p>This flag does not require that the <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlag_CUSTOM_UI</a> flag be set.</p>
<p>If you want a standard control for <code>PF_Param_ARBITRARY_DATA</code>, just add one (or more) using <code>PF_PUI_STD_CONTROL_ONLY</code> with the supported param types, and then when handling <a href="#effect-basics-command-selectors-messaging">PF_Cmd_USER_CHANGED_PARAM</a> you can modify your arb data.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PUI_NO_ECW_UI</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set this flag if you want no UI to appear in the Effect Controls Window.</p>
<p>Presumably, you are setting the value of the parameter through some other method (e.g. custom UI in the comp window, or while handling <code>PF_Cmd_USER_CHANGED_PARAM</code> for a different param with <code>PF_ParamFlag_SUPERVISE</code> set).</p>
<p>In AE, this doesn't affect keyframe visibility in the timeline. In PPro it does remove the entire row, so you won't see keyframes.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PUI_ECW_SEPARATOR</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Not used in After Effects, but used in Premiere. Set this flag if you'd like a thick line above this parameter in the effect control window.</p>
<p>This is provided so that parameters can be grouped visually, if needed (without adding groups). This flag can be changed at runtime through the <code>PF_UpdateParamUI()</code> method.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PUI_DISABLED</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Disables (grays out) the parameter, usually in response to <a href="#effect-basics-command-selectors-messaging">PF_Cmd_USER_CHANGED_PARAM</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PUI_DONT_ERASE_TOPIC</code></p>
</td>
<td colspan="1" rowspan="1">
<p>After Effects won't erase parameter's topic.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PUI_DONT_ERASE_CONTROL</code></p>
</td>
<td colspan="1" rowspan="1">
<p>After Effects won't erase parameter's control.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PUI_RADIO_BUTTON</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Not used in After Effects, but used in Premiere. Display parameter as a radio-button group. Only valid for <code>PF_Param_POPUP</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PUI_INVISIBLE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>First supported in Premiere, and now supported in After Effects CS6 and later. This hides the parameter UI in both the Effect Controls and Timeline.</p>
<p>Premiere only: The flag is dynamic and parameter visibility can be toggled during the <a href="#effect-details-parameter-supervision-pf_paramutilsuite3">PF_UpdateParamUI</a> callback.</p>
</td>
</tr>
</tbody>
</table>
<p>In addition to these flags, an effect parameter may be hidden or shown by using <a href="#aegps-aegp-suites-aegp_dynamicstreamsuite4">AEGP_GetDynamicStreamFlags</a>.</p>
<hr />
<h2 id="effect-basics-pf_paramdef-parameter-flags">Parameter Flags<a class="headerlink" href="#effect-basics-pf_paramdef-parameter-flags" title="Permanent link">&para;</a></h2>
<p>Behavior flags and UI flags describe different qualities of a parameter. Set them <em>before</em> adding the parameter during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_PARAM_SETUP</a>. Flags which may be set during events are noted.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Flag</p>
</th>
<th colspan="1" rowspan="1">
<p>Meaning</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ParamFlag_CANNOT_TIME_VARY</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Parameter does not vary with time; no keyframe control will be provided in the Timeline panel.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ParamFlag_CANNOT_INTERP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Values are not algebraically interpolated.</p>
<p>You can still use discontinuous (hold) interpolation. Useful for parameters which are either on or off. Accelerates rendering.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ParamFlag_COLLAPSE_TWIRLY</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set this flag during <a href="#effect-basics-command-selectors-messaging">PF_Cmd_USER_CHANGED_PARAM</a>.</p>
<p>This bit can now be set &amp; cleared when handling <a href="#effect-basics-command-selectors-messaging">PF_Cmd_UPDATE_PARAMS_UI</a> and <a href="#effect-basics-command-selectors-messaging">PF_Cmd_USER_CHANGED_PARAM</a> messages, so as to twirl your parameters and groups up and down at will.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ParamFlag_SUPERVISE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set to receive <a href="#effect-basics-command-selectors-messaging">PF_Cmd_USER_CHANGED_PARAM</a> messages for this parameter.</p>
<p>See <a href="#effect-details-parameter-supervision">Parameter Supervision</a> for more information.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ParamFlag_START_COLLAPSED</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Controls the twirl-state of a topic spinner.</p>
<p>Can be changed during parameter supervision, not just during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_PARAM_SETUP</a>.</p>
<p>This flag will not be honored unless <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlag2_PARAM_GROUP_START_COLLAPSED</a> is set.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ParamFlag_USE_VALUE_FOR_OLD_PROJECTS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This only affects the loading of projects saved with an older version of the effect which lacks parameters added later.</p>
<p>When set, the <code>PF_ParamDef.value</code> field set in <code>PF_ADD_PARAM()</code> will be used to initialize the missing parameter, but the dephault field will still be used for initial value of the parameter when the effect is newly applied or reset.</p>
<p>This is useful for when you want a parameter to default to one value but need it set to something else to preserve rendering behavior for older projects.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ParamFlag_LAYER_PARAM_IS_TRACKMATTE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Premiere Pro only: Only valid for layer parameters. Indicates that a layer param is used as a track-matte with applied filters.</p>
<p>Ignored in After Effects.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ParamFlag_EXCLUDE_FROM_HAVE_INPUTS_CHANGED</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Only relevant if the effect sets <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlag2_AUTOMATIC_WIDE_TIME_INPUT</a> and will call <a href="#effect-details-parameter-supervision-pf_paramutilsuite3">PF_AreStatesIdentical</a> or <a href="#effect-details-parameter-supervision-pf_paramutilsuite3">PF_HaveInputsChangedOverTimeSpan</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ParamFlag_SKIP_REVEAL_WHEN_UNHIDDEN</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CS6. If this parameter is unhidden, then this flag tells After Effects to not twirl open any parents and to not scroll the parameter into view in the Effect Controls panel and the Timeline panel.</p>
<p>After Effects uses this behavior internally when paint strokes are made, so as not to distract the user by revealing the parameter.</p>
<p>However, in another case, when turning on Time Remapping, that parameter is revealed.</p>
<p>So we provide you the same control over parameters in your own effects.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-basics-pf_paramdef-pf_valuedisplayflags">PF_ValueDisplayFlags<a class="headerlink" href="#effect-basics-pf_paramdef-pf_valuedisplayflags" title="Permanent link">&para;</a></h2>
<p>Within PF_ParamDefUnion, PF_FloatSliderDef and PF_FixedSliderDef both have a member variable, PF_ValueDisplayFlags, which allows them to respond to the user's pixel value display preference (which they set in the info palette). If this is set, the parameter's value will be displayed as 0-1, 0-255, 0-32768, or 0.0 to 1.0, depending on the preference. You can also set the first bit (PF_ValueDisplayFlag_PERCENT) to append a percent sign to the parameter's displayed value.</p>
<p>We know you'd never do anything like this, but if you create a parameter which displays as a percentage, don't confuse the user by allowing any range other than 0 to 100. Please. Percent means 'out of one hundred'.</p></section><section class="print-page" id="effect-basics-pf_effectworld"><h1 id="effect-basics-pf_effectworld-pf_effectworld-pf_layerdef">PF_EffectWorld / PF_LayerDef<a class="headerlink" href="#effect-basics-pf_effectworld-pf_effectworld-pf_layerdef" title="Permanent link">&para;</a></h1>
<p>After Effects represents images using PF_EffectWorlds, also called PF_LayerDefs.</p>
<hr />
<h2 id="effect-basics-pf_effectworld-pf_effectworld-structure">PF_EffectWorld Structure<a class="headerlink" href="#effect-basics-pf_effectworld-pf_effectworld-structure" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Item</p>
</th>
<th colspan="1" rowspan="1">
<p>Description</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>world_flags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Currently, the only flags are:</p>
<ul>
<li><code>PF_WorldFlag_DEEP</code> - set if the world is 16-bpc</li>
<li><code>PF_WorldFlag_WRITEABLE</code> - indicates that you are allowed to alter the image data of the world.</li>
</ul>
<p>Normally effects cannot alter input image data; only output.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>data</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Pointer to image data, stored as a <code>PF_PixelPtr</code>.</p>
<p>Do not access directly; use the <a href="#effect-basics-pf_effectworld-pf_pixelptr-accessor-macros">PF_PixelPtr Accessor Macros</a>.</p>
<p>Image data in After Effects is always organized in sequential words each containing Alpha, Red, Green, Blue from the low byte to the high byte.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>rowbytes</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The length, in bytes, of each row in the image's block of pixels.</p>
<p>The block of pixels contains height lines each with width pixels followed by some bytes of padding.</p>
<p>The width pixels (times four, because each pixel is four bytes long) plus optional extra padding adds up to rowbytes bytes.</p>
<p>Use this value to traverse the image data.</p>
<p>Platform-specific padding at the end of rows makes it unwise to traverse the entire buffer.</p>
<p>Instead, find the beginning of each row using height and rowbytes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This value does not vary based on whether field rendering is active.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Input and output worlds with the same dimensions can use different rowbytes values.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>width</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Width and height of the pixel buffer.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>height</code></p>
</td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>extent_hint</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The smallest rectangle encompassing all opaque (non-zero alpha) pixels in the layer.</p>
<p>This defines the area which needs to be output.</p>
<p>If your plug-in varies with extent (like a diffusion dither), ignore this and render the full frame each time.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>pix_aspect_ratio</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The pixel aspect ratio expressed as a <code>PF_Rational</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Effects can use this value for checked out layers, but must use <code>PF_InData.pixel_aspect_ratio</code> for the layer to which they're applied. Sorry.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>platform_ref</code></p>
</td>
<td colspan="1" rowspan="1">
<p>No longer used in CS5.</p>
<p>Platform-specific reference information.</p>
<p>On Windows, this contains an opaque value.</p>
<p>On macOS, <code>PF_GET_PLATFORM_REFS</code> provides a <code>CGrafPtr</code> and a <code>GDeviceHandle</code> from a <code>PF_EffectWorld</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You cannot acquire a <code>platform_ref</code> during <code>PF_Cmd_GLOBAL_SETUP</code>, as there isn't any output context yet. Patience, my pet.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>dephault</code></p>
</td>
<td colspan="1" rowspan="1">
<p>For layer parameters only.</p>
<p>Either <code>PF_LayerDefault_MYSELF</code> or <code>PF_LayerDefault_NONE</code>.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-basics-pf_effectworld-new-in-160">New In 16.0<a class="headerlink" href="#effect-basics-pf_effectworld-new-in-160" title="Permanent link">&para;</a></h2>
<p>During PF_Cmd_SMART_RENDER_GPU, PF_LayerDef will be filled out the same as it is for regular CPU renders, but PF_LayerDef.data will be null; all other fields will be valid.</p>
<hr />
<h2 id="effect-basics-pf_effectworld-rowbytes-in-pf_effectworlds">Rowbytes In PF_EffectWorlds<a class="headerlink" href="#effect-basics-pf_effectworld-rowbytes-in-pf_effectworlds" title="Permanent link">&para;</a></h2>
<p>Don't assume that you can get to the next scanline of a <code>PF_EffectWorld</code> using <code>(width * sizeof(current_pixel_type)) + 4</code>, or whatever; use the PF_EffectWorld's <code>rowbytes</code> instead.</p>
<p>Never write outside the indicated region of a PF_EffectWorld; this can corrupt cached image buffers that don't belong to you.</p>
<p>To test whether your effects are honoring the <code>PF_EffectWorld&gt;rowbytes</code>, apply the Grow Bounds effect <em>after</em> your effect.</p>
<p>The output buffer will have larger rowbytes than the input (though it will still have the same logical size).</p>
<hr />
<h2 id="effect-basics-pf_effectworld-byte-alignment">Byte Alignment<a class="headerlink" href="#effect-basics-pf_effectworld-byte-alignment" title="Permanent link">&para;</a></h2>
<p>The pixels in a <code>PF_EffectWorld</code> are not guaranteed to be 16-byte-aligned. An effect may get a subregion of a larger PF_EffectWorld. Users of Apple's sample code for pixel processing optimization, you have been warned.</p>
<p>Beyond 8-bit per channel color, After Effects supports 16 bit and 32-bit float per-channel color.</p>
<p>Effects will never receive input and output worlds with differing bit depths, nor will they receive worlds with higher bit depth than they have claimed to be able to handle.</p>
<hr />
<h2 id="effect-basics-pf_effectworld-accessor-macros-for-opaque-data-type-pixels">Accessor Macros For Opaque (Data Type) Pixels<a class="headerlink" href="#effect-basics-pf_effectworld-accessor-macros-for-opaque-data-type-pixels" title="Permanent link">&para;</a></h2>
<p>Use the following macros to access the data within (opaque) PF_PixelPtrs.</p>
<p>It is, emphatically, <em>not</em> safe to simply cast pointers of one type into another! To make it work at all requires a cast, and there's nothing that prevents you from casting it incorrectly. We may change its implementation at a later date (at which time you'll thank us for forcing this level of abstraction).</p>
<hr />
<h2 id="effect-basics-pf_effectworld-pf_pixelptr-accessor-macros">PF_PixelPtr Accessor Macros<a class="headerlink" href="#effect-basics-pf_effectworld-pf_pixelptr-accessor-macros" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Macro</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GET_PIXEL_DATA16</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtain a pointer to a 16-bpc pixel within the specified world.</p>
<p>The returned pixel pointer will be NULL if the world is not 16-bpc.</p>
<p>The second parameter is optional; if it is not NULL, the returned pixel will be an interpretation of the values in the passed-in pixel, as if it were in the specified PF_EffectWorld.</p>
<p><pre lang="cpp">PF_GET_PIXEL_DATA16 (<br/>  PF_EffectWorld wP,<br/>  PF_PixelPtr    pP0,<br/>  PF_Pixel16     *outPP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GET_PIXEL_DATA8</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtain a pointer to a 8-bpc pixel within the specified world.</p>
<p>The returned pixel pointer will be NULL if the world is not 8- bpc.</p>
<p>The second parameter is optional; if it is not NULL, the returned pixel will be an interpretation of the values in the passed-in pixel, as if it were in the specified PF_EffectWorld.</p>
<p><pre lang="cpp">PF_GET_PIXEL_DATA8 (<br/>  PF_EffectWorld wP,<br/>  PF_PixelPtr    pP0,<br/>  PF_Pixel8      *outPP);</pre></p>
</td>
</tr>
</tbody>
</table>
<p>Think of <code>PF_GET_PIXEL_DATA16</code> and <code>PF_GET_PIXEL_DATA8</code> as safe (ahem) casting routines.</p>
<p>The code required is actually very simple to get a <code>PF_Pixel16*</code> out of the PF_EffectWorld output:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="p">{</span>
</span><span id="__span-0-2"><span class="w">    </span><span class="n">PF_Pixel16</span><span class="w"> </span><span class="o">*</span><span class="n">deep_pixelP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
</span><span id="__span-0-3"><span class="w">    </span><span class="n">PF_Err</span><span class="w">     </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PF_Err_NONE</span><span class="p">;</span>
</span><span id="__span-0-4"><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PF_GET_PIXEL_DATA16</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">deep_pixelP</span><span class="p">);</span>
</span><span id="__span-0-5"><span class="p">}</span>
</span></code></pre></div>
<p>This returns deep_pixelP as NULL if the world does not have deep pixels.</p>
<p>The second parameter is not used very often and should be passed as NULL; pass a PF_PixelPtr that is <em>not</em> contained in a PF_EffectWorld to coerce it to the depth of that PF_EffectWorld).</p></section><section class="print-page" id="effect-basics-errors"><h1 id="effect-basics-errors-errors">Errors<a class="headerlink" href="#effect-basics-errors-errors" title="Permanent link">&para;</a></h1>
<p>Always, always, <em>always</em> (always!) return a <code>PF_Err</code> from <code>main()</code>. Plug-ins must pass all errors back to After Effects.</p>
<p>It is vitally important that you pass any errors (returned to you by callbacks and PICA suites) to After Effects, unless you've handled them.</p>
<p>Be vigilant about returning the right error code, and disposing of any memory you've allocated.</p>
<p>Really. We're serious.</p>
<hr />
<h2 id="effect-basics-errors-error-codes">Error Codes<a class="headerlink" href="#effect-basics-errors-error-codes" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Error</p>
</th>
<th colspan="1" rowspan="1">
<p>Meaning</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Err_NONE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Success.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Err_OUT_OF_MEMORY</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Memory allocation failed.</p>
<p>Note that RAM preview will cause this condition, so After Effects will be expecting to receive this error from your plug-in.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Err_INTERNAL_STRUCT_DAMAGED</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Problems using a data structure.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Err_INVALID_INDEX</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Problems finding/using array member.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Err_UNRECOGNIZED_PARAM_TYPE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Problem with parameter data.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Err_INVALID_CALLBACK</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Problems accessing function through pointer.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Err_BAD_CALLBACK_PARAM</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Problems using a parameter passed to a callback.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Interrupt_CANCEL</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Both effect and AEGP callbacks can return this to effects, if a user action aborts a render.</p>
<p>If the effect gets this error from a callback, it should stop processing the frame and return the error to the host.</p>
<p>Failure to pass the error back may result in misrendered frames being cached.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Err_CANNOT_PARSE_KEYFRAME_TEXT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Return this from <code>PF_Arbitrary_SCAN_FUNC</code> when problems occur parsing the clipboard into keyframe data.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-basics-errors-error-reporting-policy">Error Reporting Policy<a class="headerlink" href="#effect-basics-errors-error-reporting-policy" title="Permanent link">&para;</a></h2>
<p>After Effects has a consistent policy for error handling; follow it.</p>
<p>If you encounter an error in your plug-in's code, report it to the user immediately, before returning from your plug-in to After Effects.</p>
<p>After Effects considers errors from the operating system, encountered during your plug-in's execution, to be yours.</p>
<p>If you get an error code back from one of our callback functions, pass it back to After Effects; we've already reported it.</p>
<p>Out-of-memory errors are never reported by After Effects. Error reporting is always suppressed during RAM preview, and when After Effects is running in - noui mode.</p>
<p>To report an error from within a plug-in, set <code>PF_OutFlag_DISPLAY_ERROR_MESSAGE</code>, and describe the error in <a href="#effect-basics-pf_outdata-pf_outdata">PF_OutData&gt;return_msg</a>.</p>
<p>Doing so will enter your error into the render log, and prevent system hangs in renders driven by a render engine or scripting.</p>
<hr />
<h2 id="effect-basics-errors-dig-in">Dig In!<a class="headerlink" href="#effect-basics-errors-dig-in" title="Permanent link">&para;</a></h2>
<p>Now you have a basic understanding of effect plug-ins, and are ready to start experimenting with some real code. Go ahead and get started!</p>
<p>After getting the basics of your plug-in setup, you may have some questions about reuseable code, advanced functionality, and how to optimize your code to make it faster.</p>
<p>To this end, After Effects exposes a tremendous amount of its internal functionality via function suites.</p>
<p>By relying on After Effects code for utility functions, you should be able to get your image processing algorithms implemented quickly.</p>
<p>This will discussed in <a href="#effect-details-effect-details">Effect Details</a>.</p></section><h1 class='nav-section-title-end'>Ended: Effect Basics</h1>
                        <h1 class='nav-section-title' id='section-effect-details'>
                            Effect Details <a class='headerlink' href='#section-effect-details' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="effect-details-multi-frame-rendering-in-ae"><h1 id="effect-details-multi-frame-rendering-in-ae-multi-frame-rendering-in-ae">Multi-Frame Rendering in AE<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-multi-frame-rendering-in-ae" title="Permanent link">&para;</a></h1>
<p>In order to take advantage of modern hardware with more CPU cores and threads, After Effects 2022 and above now supports Multi-Frame Rendering. Multi-Frame rendering (MFR) allows multiple frames to be rendered concurrently thereby speeding up rendering and export of AE compositions.</p>
<p>Third-party effects can enable support of Multi-Frame Rendering through the AE Effects SDK by setting the following PF_OutFlag:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">PF_OutFlag2_SUPPORTS_THREADED_RENDERING</span>
</span></code></pre></div>
<p>This flag indicates the effect supports rendering on multiple threads concurrently. Single or multiple applications of this effect on a layer can be called to render at the same time on multiple threads. Effects must be thread-safe before this flag is set. Please see the <a href="#effect-details-multi-frame-rendering-in-ae-what-does-it-mean-for-an-effect-to-be-thread-safe">What does it mean for an effect to be thread-safe?</a> section below for more information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When After Effects uses Multi-Frame Rendering, an effect that is not thread-safe and does not set this flag will force each render thread to enter and exit the effect code one thread at a time. This will significantly reduce the performance improvements that MFR provides and as such a warning icon will be shown in the Effects Control Window alongside the effect to warn the user of the performance impact.</p>
</div>
<hr />
<p>For effects that require writing to sequence_data during Render, a flag is available for backwards compatibility:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-1-1"><span class="n">PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</span>
</span></code></pre></div>
<p>Each rendering thread will have its own instance of sequence_data that is not shared nor synchronized with other rendering threads. If the data stored in sequence_data is time-consuming to compute, the new <a href="#effect-details-multi-frame-rendering-in-ae-compute-cache-for-multi-frame-rendering">Compute Cache For Multi-Frame Rendering</a> should be utilized.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use of the <code>PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</code> flag requires compiling against the March 2021 SDK or later.</p>
</div>
<hr />
<h2 id="effect-details-multi-frame-rendering-in-ae-multi-frame-rendering-effect-updates-with-march-2021-sdk">Multi-Frame Rendering Effect Updates with March 2021 SDK<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-multi-frame-rendering-effect-updates-with-march-2021-sdk" title="Permanent link">&para;</a></h2>
<p>The March 2021 SDK introduces new <code>sequence_data</code> behavior that is enabled starting with AE beta builds 22.0x6 (released on June 29th 2021). Any effects compiled with the June 2020 SDK must be recompiled with the March 2021 SDK to support Multi-Frame Rendering. The effects must also report to AE that they were compiled with at least version 13.25 though it is recommended to use the SDK constants PF_AE_PLUG_IN_VERSION and PF_AE_PLUG_IN_SUBVERS to automatically set the associated SDK.</p>
<p>The table below outlines the changes an effect will need to make to support the new behavior:</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>MFR &amp; Sequence Data Usage</p>
</th>
<th colspan="1" rowspan="1">
<p>Changes Needed with March 2021 SDK</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p>Plugin does not set PF_OutFlag2_SUPPORTS_THREADED_RENDERING</p>
</td>
<td colspan="1" rowspan="1">
<p>No changes needed. Effect and sequence_data will continue to work as it did in the past.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Plugin sets PF_OutFlag2_SUPPORTS_THREADED_RENDERING but neither reads nor writes to sequence_data during Render</p>
</td>
<td colspan="1" rowspan="1">
<p>Recompile the plugin with the March 2021 SDK, no other code changes are required.</p>
<p>If the plugin is not compiled with the March 2021 SDK, the plugin will stop utilizing MFR starting with AE 22.0x6.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Plugin sets PF_OutFlag2_SUPPORTS_THREADED_RENDERING but only reads sequence_data during Render</p>
</td>
<td colspan="1" rowspan="1">
<p>Recompile the plugin with the March 2021 SDK, update reading sequence_data via <code>PF_EffectSequenceDataSuite1</code> for thread-safe access. See <a href="#effect-details-global-sequence-frame-data-accessing-sequence_data-at-render-time-with-multi-frame-rendering">Accessing sequence_data at Render Time with Multi-Frame Rendering</a> for more information.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p>Plugin sets PF_OutFlag2_SUPPORTS_THREADED_RENDERING and reads and writes to sequence_data during Render</p>
</td>
<td colspan="1" rowspan="1">
<p>Recompile the plugin with the March 2021 SDK and modify the plugin to:</p>
<ol>
<li>Utilize the <a href="#effect-details-compute-cache-api-compute-cache-api">Compute Cache API</a> for thread-safe cache access instead of reading/writing to sequence_data directly.  See <a href="#effect-details-multi-frame-rendering-in-ae-compute-cache-for-multi-frame-rendering">Compute Cache For Multi-Frame Rendering</a> for more information. AND / OR</li>
<li>Add the <code>PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</code> to the effect to restore direct read/write access to sequence_data.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Effects compiled with the March 2021 SDK and using the PF_OutFlag2_SUPPORTS_THREADED_RENDERING flag and, optionally, the PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER flag will work with After Effects beta builds starting with 18.0 when the <code>PF_EffectSequeceDataSuite1</code> was introduced. Check for the presence of this suite if you need to support both sequence_data behaviors.</p>
</div>
<hr />
<h2 id="effect-details-multi-frame-rendering-in-ae-implications-to-command-selectors-with-multi-frame-rendering">Implications to Command Selectors with Multi-Frame Rendering<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-implications-to-command-selectors-with-multi-frame-rendering" title="Permanent link">&para;</a></h2>
<p>UI selectors are still sent on the main thread, however <code>PF_Cmd_SEQUENCE_SETUP</code>, <code>PF_Cmd_SEQUENCE_RESETUP</code>, <code>PF_Cmd_SEQUENCE_SETDOWN</code>, <code>PF_Cmd_SMART_PRE_RENDER</code>, <code>PF_Cmd_RENDER</code> and <code>PF_Cmd_SMART_RENDER</code> may be sent on multiple threads at the same time as the UI selectors are being handled so all of these selectors must be thread safe.</p>
<p><code>PF_Cmd_GLOBAL_SETUP</code> and <code>PF_Cmd_GLOBAL_SETDOWN</code> selectors will only be sent on the main thread and will not be sent at the same time as any other selectors.</p>
<hr />
<h2 id="effect-details-multi-frame-rendering-in-ae-sequence-data-in-multi-frame-rendering">Sequence Data in Multi-Frame rendering<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-sequence-data-in-multi-frame-rendering" title="Permanent link">&para;</a></h2>
<p>The <code>sequence_data</code> object and related Sequence Selectors have been used over the years to provide a way to store data during the effect's lifetime. Multi-Frame Rendering introduces some changes to be aware of:</p>
<p><strong>Changes as of June 2020</strong></p>
<ul>
<li>Multi-Frame rendering requires that After Effects marshal <code>sequence_data</code> to the render threads. In order to make this efficient for effects with <code>sequence_data</code> that require flattening with the <code>PF_OutFlag_SEQUENCE_DATA_NEEDS_FLATTENING</code> flag, these effects must now also set the <code>PF_OutFlag2_SUPPORTS_GET_FLATTENED_SEQUENCE_DATA</code> flag.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In a future version of After Effects, the requirement to set the <code>PF_OutFlag2_SUPPORTS_GET_FLATTENED_SEQUENCE_DATA</code> flag and handle the associated selector in the plugin will be enforced. A warning dialog will be added on load of any effect that does not meet this requirement.</p>
</div>
<p><strong>Changes as of March 2021</strong></p>
<ul>
<li>The <code>sequence_data</code> object is now const when read at Render time and should be accessed through the <code>PF_EffectSequenceDataSuite</code> interface.</li>
<li>Writing to <code>seqeunce_data</code> at render time is disabled by default and results will be undefined if <code>sequence_data</code> is attempted to be written to at render time.</li>
<li>If an effect must write to sequence_data at render time, it must set the <code>PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</code> flag which will tell After Effects to allow writes to <code>sequence_data</code> but it will be at the expense of performance. The <code>sequence_data</code> object will be duplicated to each render thread when the render begins, and each render thread will have its own independent copy of <code>sequence_data</code> to manage for the lifetime of the render. For performance reasons, it is preferred that the <a href="#effect-details-multi-frame-rendering-in-ae-compute-cache-for-multi-frame-rendering">Compute Cache For Multi-Frame Rendering</a> is utilized for writing any data required by the effect.</li>
</ul>
<hr />
<h2 id="effect-details-multi-frame-rendering-in-ae-compute-cache-for-multi-frame-rendering">Compute Cache For Multi-Frame Rendering<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-compute-cache-for-multi-frame-rendering" title="Permanent link">&para;</a></h2>
<p>The Compute Cache provides a thread-safe cache as a replacement or supplement to Sequence Data where effects can compute, store and read data before or during Render.</p>
<h3 id="effect-details-multi-frame-rendering-in-ae-when-would-you-use-the-compute-cache">When would you use the Compute Cache?<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-when-would-you-use-the-compute-cache" title="Permanent link">&para;</a></h3>
<ul>
<li>You should use the Compute Cache if your effect uses <code>sequence_data</code> and needs to write to or update <code>sequence_data</code> during Render, especially if the computation of needed data is time-consuming to calculate.</li>
<li>Without the Compute Cache, the effect will need to add the <code>PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</code> flag which will create unique copies of sequence_data per render thread. Each render thread may then need to perform the time-consuming calculations independently and won't be able to share the results between the render threads.</li>
<li>By using the Compute Cache, render threads can share the task of computing the data and reap the benefits of already computed data.</li>
<li>The Compute Cache API supports both single and multi-checkout computation tasks depending upon the needs of the effect. See the <a href="#effect-details-compute-cache-api-compute-cache-api">Compute Cache API</a> documentation for more information.</li>
</ul>
<h3 id="effect-details-multi-frame-rendering-in-ae-how-do-i-enable-the-compute-cache">How do I enable the Compute Cache?<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-how-do-i-enable-the-compute-cache" title="Permanent link">&para;</a></h3>
<p>The Compute Cache API is available starting in the March 2021 SDK and the suite is enabled by default in After Effects 2022 and above builds.</p>
<p>See the <a href="#effect-details-compute-cache-api-compute-cache-api">Compute Cache API</a> documentation for implementation details and sample code.</p>
<hr />
<h2 id="effect-details-multi-frame-rendering-in-ae-what-does-it-mean-for-an-effect-to-be-thread-safe">What does it mean for an effect to be thread-safe?<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-what-does-it-mean-for-an-effect-to-be-thread-safe" title="Permanent link">&para;</a></h2>
<p><strong>An effect is thread-safe when the implementation and shared data is guaranteed to be free of race conditions and is always in a correct state when accessed concurrently.</strong></p>
<p>To be more specific, the effect:</p>
<ol>
<li>Has no static or global variables OR, has static or global variables that are free of race conditions.</li>
<li>Does not write to <code>in_data-&gt;global_data</code> at render time. Reading can be done. Write in <code>PF_Cmd_GLOBAL_SETUP</code> and <code>PF_Cmd_GLOBAL_SETDOWN</code> only.</li>
<li>Does not write to <code>in_data-&gt;sequence_data</code> at render time or during <code>PF_Cmd_UPDATE_PARAMS_UI</code> event. Reading can be done via the PF_EffectSequenceDataSuite interface.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If an effect uses any blocking synchronization mechanisms, such as mutexes or gates, these must not be held when calling back into the host. Common calls would be when using a suite or making a checkout call. Failing to do so will very likely result in deadlocks.</p>
</div>
<hr />
<h2 id="effect-details-multi-frame-rendering-in-ae-how-to-locate-the-static-and-global-variables-in-your-effects">How to locate the static and global variables in your effects<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-how-to-locate-the-static-and-global-variables-in-your-effects" title="Permanent link">&para;</a></h2>
<p>To help you locate the static and global variables in your effect, we've developed a <strong>Static Analyzer tool</strong> for you to use.
You can find the tool in this Git Repo: <a href="https://github.com/adobe/ae-plugin-thread-safety">https://github.com/adobe/ae-plugin-thread-safety</a></p>
<h3 id="effect-details-multi-frame-rendering-in-ae-on-macos">On MacOS<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-on-macos" title="Permanent link">&para;</a></h3>
<ol>
<li>Clone/Download the Git Repo at the URL provided above</li>
<li>Find the bash script <code>check_symbols_for_thread_safety.sh</code> in the <strong>Mac</strong> folder</li>
<li>Navigate inside the package content of a plugin or effect and locate the binary files. (For example, the <strong>Curves.plugin</strong> has its binary file here: <code>/Applications/Adobe After Effects [your AE version]/Plug-ins/Effects/Curves.plugin/Contents/MacOS/Curves</code>)</li>
<li>To analyze the binary, run:
    <div class="language-sh highlight"><pre><span></span><code><span id="__span-2-1">check_symbols_for_thread_safety.sh<span class="w"> </span><span class="o">[</span>Binary<span class="w"> </span>location<span class="o">]</span>
</span><span id="__span-2-2">For<span class="w"> </span>example,<span class="w"> </span>check_symbols_for_thread_safety.sh<span class="w"> </span>/Applications/Adobe<span class="w"> </span>After<span class="w"> </span>Effects<span class="w"> </span><span class="o">[</span>your<span class="w"> </span>AE<span class="w"> </span>version<span class="o">]</span>/Plug-ins/Effects/Curves.plugin/Contents/MacOS/Curves<span class="o">)</span>
</span></code></pre></div></li>
<li>You will see output from the tool in this format:
    <div class="language-sh highlight"><pre><span></span><code><span id="__span-3-1"><span class="o">[</span>symbol<span class="w"> </span>type<span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="o">[</span>symbol<span class="w"> </span>name<span class="o">]</span>
</span></code></pre></div></li>
<li><code>[symbol type]</code> is an one case-sensitive letter that indicates the type of the variable. You can find all the type information here: <a href="https://linux.die.net/man/1/nm">https://linux.die.net/man/1/nm</a></li>
<li>Here is an example of the output:
    <div class="language-cpp highlight"><pre><span></span><code><span id="__span-4-1"><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="n">Deform</span><span class="o">::</span><span class="n">FindSilEdges</span><span class="p">()</span><span class="o">::</span><span class="n">new_kInfinite</span>
</span></code></pre></div><ul>
<li><code>b</code> shows this symbol is in the uninitialized data section, which indicates it might be a static variable.</li>
<li><code>Deform::FindSilEdges()::new_kInfinite</code> is the symbol name where <code>Deform</code> is name of the namespace that the variable is located at.</li>
<li><code>FindSilEdges()</code> is the function name the variable is in.</li>
<li><code>new_kInfinite</code> is the actual variable name. Namespace and function names might not be shown based on where the variable is.</li>
</ul>
</li>
<li>Search for each symbol in your code, fix it (see <a href="#effect-details-multi-frame-rendering-in-ae-how-to-locate-the-static-and-global-variables-in-your-effects">here</a> on how) and repeat for every binary file in your solution</li>
</ol>
<h3 id="effect-details-multi-frame-rendering-in-ae-on-windows">On Windows<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-on-windows" title="Permanent link">&para;</a></h3>
<h4 id="effect-details-multi-frame-rendering-in-ae-preparation">Preparation<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-preparation" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>In order to run this tool, you need a working installation of Visual Studio</strong></li>
<li>Clone/Download the Git Repo at the URL provided above</li>
<li>Find the <code>register_msdia.cmd</code> script in the <strong>Win</strong> folder</li>
<li>Search for <strong>"x64 Native Tools Command Prompt for VS...."</strong> from the <strong>Start Menu</strong></li>
<li>Right click -&gt; Run as an Administrator</li>
<li>In the terminal, <code>cd</code> to the directory where your <code>register_msdia.cmd</code> is located at</li>
<li>Run <code>.\register_msdia.cmd</code></li>
<li>This script will register the <strong>DIA SDK</strong> and some other required dependencies for you</li>
<li>The Static Analyzer should be ready to work</li>
</ol>
<h4 id="effect-details-multi-frame-rendering-in-ae-using-the-windows-static-analyzer">Using the Windows Static Analyzer<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-using-the-windows-static-analyzer" title="Permanent link">&para;</a></h4>
<ol>
<li>Find the executable <code>CheckThreadSafeSymbols.exe</code> in the <strong>Win</strong> folder</li>
<li>Compile your effect in <strong>Debug</strong> mode and find its <strong>.pdb</strong> file</li>
<li>You should also find some <strong>.obj</strong> files in the same build directory if you haven't modified your project build settings</li>
<li>You have <strong>two options</strong> on what to scan through: binaries or source files, using <code>-objfile</code> or <code>-source</code> flag.<ul>
<li>Note: You can get the same symbols out of either option.<ul>
<li>Use the <code>-source</code> option if you don't know exactly what binaries your source code is ending up in, or if you'd like to keep track of thread safety on a per-source-file basis.</li>
<li>Use the <code>-objfile</code> option if you want more fine-grained control over what parts of your project you're scanning.</li>
</ul>
</li>
</ul>
</li>
<li>To analyze the symbols in an object file, run:
    <div class="language-bat highlight"><pre><span></span><code><span id="__span-5-1">CheckThreadSafeSymbols.exe -objfile [absolute path to the binary you want analyzed] [absolute path to .pdb]
</span></code></pre></div></li>
<li>To analyze the symbols in a source file, run:
    <div class="language-bat highlight"><pre><span></span><code><span id="__span-6-1">CheckThreadSafeSymbols.exe -source [absolute path to the source file you want analyzed] [absolute path to .pdb]
</span></code></pre></div></li>
<li>Global variables aren't limited to the scope of one file or binary in pdbs, so you'll have to check over the list of all project globals without filtering. Use the -g output to get a list of all of them:
    <div class="language-bat highlight"><pre><span></span><code><span id="__span-7-1">CheckThreadSafeSymbols.exe -g [absolute path to .pdb]
</span></code></pre></div></li>
<li>If you're unsure of what binaries your effect is outputting, the tool can also output a <strong>(noisy)</strong> list of binaries, along with the source files each pulls data from. Files you've changed are likely to be near the top. To see the list, run:
    <div class="language-bat highlight"><pre><span></span><code><span id="__span-8-1">CheckThreadSafeSymbols.exe -sf [absolute path to .pdb]
</span></code></pre></div></li>
<li>Output symbols will take the form:
    <div class="language-cpp highlight"><pre><span></span><code><span id="__span-9-1"><span class="p">[</span><span class="n">Symbol</span><span class="w"> </span><span class="n">name</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">Symbol</span><span class="w"> </span><span class="n">type</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">Datakind</span><span class="p">],</span><span class="w"> </span><span class="p">([</span><span class="n">Section</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">location</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">Binary</span><span class="w"> </span><span class="n">Address</span><span class="p">][</span><span class="n">Binary</span><span class="w"> </span><span class="n">Address</span><span class="w"> </span><span class="n">Offset</span><span class="p">])</span>
</span></code></pre></div></li>
<li>Here is an example of the output:
    <div class="language-cpp highlight"><pre><span></span><code><span id="__span-10-1"><span class="n">menuBuf</span><span class="p">,</span><span class="w"> </span><span class="n">Type</span><span class="o">:</span><span class="w"> </span><span class="kt">char</span><span class="p">[</span><span class="mh">0x1000</span><span class="p">],</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="n">Static</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">static</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">0008F</span><span class="n">CD0</span><span class="p">][</span><span class="mo">0003</span><span class="o">:</span><span class="mo">00001</span><span class="n">CD0</span><span class="p">])</span>
</span></code></pre></div><ul>
<li><code>menuBuf</code> is the actual variable name.</li>
<li><code>Type: char[0x1000]</code> shows what type of the variable it is. The data here is a <code>char</code>.</li>
<li><code>File Static</code> shows what kind of that data it is. The data here is a <strong>File-scoped static variable.</strong> You can find all the data kinds and what they mean on this page <a href="https://docs.microsoft.com/en-us/visualstudio/debugger/debug-interface-access/datakind?view=vs-2019">https://docs.microsoft.com/en-us/visualstudio/debugger/debug-interface-access/datakind?view=vs-2019</a></li>
<li><code>static</code> shows that the data is in the static section of the memory.</li>
<li><code>[0008FCD0][0003:00001CD0]</code> shows the Binary Address and the Binary Address offset of the data.</li>
</ul>
</li>
<li>Search for each symbol in your code, fix it (see <a href="#effect-details-multi-frame-rendering-in-ae-how-to-locate-the-static-and-global-variables-in-your-effects">here</a> on how) and repeat for every binary/source file in your solution</li>
</ol>
<hr />
<h2 id="effect-details-multi-frame-rendering-in-ae-what-to-do-if-you-have-static-and-globals-in-your-effects">What to do if you have static and globals in your effects<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-what-to-do-if-you-have-static-and-globals-in-your-effects" title="Permanent link">&para;</a></h2>
<p>When you see a static or global variable, it would be the best to make it a local variable if possible. But what if that variable has to be static or global?</p>
<p>Here are some standard approaches for treating statics or globals:</p>
<h3 id="effect-details-multi-frame-rendering-in-ae-could-the-data-be-easily-passed-between-functions-instead-without-a-change-in-behavior">Could the data be easily passed between functions instead without a change in behavior?<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-could-the-data-be-easily-passed-between-functions-instead-without-a-change-in-behavior" title="Permanent link">&para;</a></h3>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-11-1"><span class="c1">// Example of a non Thread-Safe code</span>
</span><span id="__span-11-2"><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">should_just_be_local</span><span class="p">;</span>
</span><span id="__span-11-3">
</span><span id="__span-11-4"><span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-5"><span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">should_just_be_local</span><span class="p">);</span>
</span><span id="__span-11-6"><span class="p">}</span>
</span><span id="__span-11-7">
</span><span id="__span-11-8"><span class="kt">void</span><span class="w"> </span><span class="nf">SetAndUseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-9"><span class="w">    </span><span class="n">should_just_be_local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DoComputation</span><span class="p">();</span>
</span><span id="__span-11-10"><span class="w">    </span><span class="n">UseState</span><span class="p">();</span>
</span><span id="__span-11-11"><span class="p">}</span>
</span></code></pre></div>
<p>Either add it to a struct or expand function arguments to include it:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-12-1"><span class="c1">// We can fix the above code by passing the should_just_be_local variable through function arguments</span>
</span><span id="__span-12-2">
</span><span id="__span-12-3"><span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">should_just_be_local</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-4"><span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">should_just_be_local</span><span class="p">);</span>
</span><span id="__span-12-5"><span class="p">}</span>
</span><span id="__span-12-6">
</span><span id="__span-12-7"><span class="kt">void</span><span class="w"> </span><span class="nf">SetAndUseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-8"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">should_just_be_local</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DoComputation</span><span class="p">();</span>
</span><span id="__span-12-9"><span class="w">    </span><span class="n">UseState</span><span class="p">(</span><span class="n">should_just_be_local</span><span class="p">);</span>
</span><span id="__span-12-10"><span class="p">}</span>
</span></code></pre></div>
<h3 id="effect-details-multi-frame-rendering-in-ae-could-the-data-be-initialized-before-you-execute-your-code-eg-a-lookup-table-a-const-variable">Could the data be initialized before you execute your code (e.g. a lookup table, a const variable)?<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-could-the-data-be-initialized-before-you-execute-your-code-eg-a-lookup-table-a-const-variable" title="Permanent link">&para;</a></h3>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-13-1"><span class="c1">// Example of a non Thread-Safe code</span>
</span><span id="__span-13-2">
</span><span id="__span-13-3"><span class="c1">// Many places in the code need to read this table but won&#39;t be writing to it</span>
</span><span id="__span-13-4"><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">state_with_initializer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
</span><span id="__span-13-5"><span class="k">static</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">state_was_initialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
</span><span id="__span-13-6">
</span><span id="__span-13-7"><span class="kt">void</span><span class="w"> </span><span class="nf">InitializeState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-8"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">64</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-9"><span class="w">        </span><span class="n">state_with_initializer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
</span><span id="__span-13-10"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-13-11"><span class="w">    </span><span class="n">state_was_initialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
</span><span id="__span-13-12"><span class="p">}</span>
</span><span id="__span-13-13">
</span><span id="__span-13-14"><span class="kt">void</span><span class="w"> </span><span class="nf">Main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-15"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">state_was_initialized</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-16"><span class="w">        </span><span class="n">InitializeState</span><span class="p">();</span>
</span><span id="__span-13-17"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-13-18"><span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">state_with_initializer</span><span class="p">);</span>
</span><span id="__span-13-19"><span class="p">}</span>
</span></code></pre></div>
<p>Make it <code>const</code> or replace it with a macro:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-14-1"><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="o">&gt;</span><span class="w"> </span><span class="n">InitializeState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-2"><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="o">&gt;</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>
</span><span id="__span-14-3">
</span><span id="__span-14-4"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">64</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-5"><span class="w">        </span><span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
</span><span id="__span-14-6"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-14-7"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>
</span><span id="__span-14-8"><span class="p">}</span>
</span><span id="__span-14-9">
</span><span id="__span-14-10"><span class="c1">// We can fix the above code by making this table a const and initialize it before using it</span>
</span><span id="__span-14-11"><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="o">&gt;</span><span class="w"> </span><span class="n">state_with_initializer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InitializeState</span><span class="p">();</span>
</span><span id="__span-14-12">
</span><span id="__span-14-13"><span class="kt">void</span><span class="w"> </span><span class="nf">Main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-14"><span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">state_with_initializer</span><span class="p">);</span>
</span><span id="__span-14-15"><span class="p">}</span>
</span></code></pre></div>
<h3 id="effect-details-multi-frame-rendering-in-ae-is-the-data-initialized-once-at-runtime-based-on-data-that-doesnt-change-on-subsequent-renders">Is the data initialized once at runtime based on data that doesn't change on subsequent renders?<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-is-the-data-initialized-once-at-runtime-based-on-data-that-doesnt-change-on-subsequent-renders" title="Permanent link">&para;</a></h3>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-15-1"><span class="c1">// Example of a non Thread-Safe code</span>
</span><span id="__span-15-2"><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">depends_on_unchanging_runtime_state</span><span class="p">;</span>
</span><span id="__span-15-3">
</span><span id="__span-15-4"><span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-5"><span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">depends_on_unchanging_runtime_state</span><span class="p">);</span>
</span><span id="__span-15-6"><span class="p">}</span>
</span><span id="__span-15-7">
</span><span id="__span-15-8"><span class="kt">void</span><span class="w"> </span><span class="nf">SetAndUseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-9"><span class="w">    </span><span class="n">depends_on_unchanging_runtime_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DoComputationThatNeedsStateOnlyOnce</span><span class="p">();</span>
</span><span id="__span-15-10"><span class="w">    </span><span class="n">UseState</span><span class="p">();</span>
</span><span id="__span-15-11"><span class="p">}</span>
</span></code></pre></div>
<p>Double-check that this state isn't known before your code executes (case 2), but if you have to initialize at runtime use a const static local. (Note that thread-safe initialization of static local objects is part of the C++ spec):</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-16-1"><span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">depends_on_unchanging_runtime_state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-2"><span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">depends_on_unchanging_runtime_state</span><span class="p">);</span>
</span><span id="__span-16-3"><span class="p">}</span>
</span><span id="__span-16-4">
</span><span id="__span-16-5"><span class="kt">void</span><span class="w"> </span><span class="nf">SetAndUseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-6"><span class="w">    </span><span class="c1">// We can fix the above code by making the variable a const static local</span>
</span><span id="__span-16-7"><span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">depends_on_unchanging_runtime_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DoComputationThatNeedsStateOnlyOnce</span><span class="p">();</span>
</span><span id="__span-16-8">
</span><span id="__span-16-9"><span class="w">    </span><span class="n">UseState</span><span class="p">(</span><span class="n">depends_on_unchanging_runtime_state</span><span class="p">);</span>
</span><span id="__span-16-10"><span class="p">}</span>
</span></code></pre></div>
<h3 id="effect-details-multi-frame-rendering-in-ae-the-data-has-to-stay-staticglobal-not-being-a-const-but-each-render-thread-can-have-its-own-copy-of-the-data">The data has to stay static/global not being a const. But each render thread can have its own copy of the data.<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-the-data-has-to-stay-staticglobal-not-being-a-const-but-each-render-thread-can-have-its-own-copy-of-the-data" title="Permanent link">&para;</a></h3>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-17-1"><span class="c1">// This variable has to be static and not a const</span>
</span><span id="__span-17-2"><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">this_thread_needs_access</span><span class="p">;</span>
</span><span id="__span-17-3">
</span><span id="__span-17-4"><span class="kt">void</span><span class="w"> </span><span class="nf">SetState</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">new_state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-5"><span class="w">    </span><span class="n">this_thread_needs_access</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_state</span><span class="p">;</span>
</span><span id="__span-17-6"><span class="p">}</span>
</span><span id="__span-17-7">
</span><span id="__span-17-8"><span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-9"><span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">this_thread_needs_access</span><span class="p">);</span>
</span><span id="__span-17-10"><span class="p">}</span>
</span></code></pre></div>
<p>Just make the variable thread_local:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-18-1"><span class="c1">// Make this variable a thread_local variable</span>
</span><span id="__span-18-2"><span class="k">thread_local</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">this_thread_needs_access</span><span class="p">;</span>
</span><span id="__span-18-3">
</span><span id="__span-18-4"><span class="kt">void</span><span class="w"> </span><span class="nf">SetState</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">new_state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-5"><span class="w">    </span><span class="n">this_thread_needs_access</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_state</span><span class="p">;</span>
</span><span id="__span-18-6"><span class="p">}</span>
</span><span id="__span-18-7">
</span><span id="__span-18-8"><span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-9"><span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">this_thread_needs_access</span><span class="p">);</span>
</span><span id="__span-18-10"><span class="p">}</span>
</span></code></pre></div>
<h3 id="effect-details-multi-frame-rendering-in-ae-the-data-has-to-stay-staticglobal-not-being-a-const-and-each-thread-needs-to-read-and-write-from-the-most-up-to-date-state-rare">The data has to stay static/global not being a const and each thread needs to read and write from the most up-to-date state. (rare)<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-the-data-has-to-stay-staticglobal-not-being-a-const-and-each-thread-needs-to-read-and-write-from-the-most-up-to-date-state-rare" title="Permanent link">&para;</a></h3>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-19-1"><span class="c1">// This variable has to be static and not a const</span>
</span><span id="__span-19-2"><span class="c1">// It also needs to be shared across several threads</span>
</span><span id="__span-19-3"><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">every_thread_needs_latest_state</span><span class="p">;</span>
</span><span id="__span-19-4">
</span><span id="__span-19-5"><span class="kt">void</span><span class="w"> </span><span class="nf">SetState</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">new_state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-6"><span class="w">    </span><span class="n">every_thread_needs_latest_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_state</span><span class="p">;</span>
</span><span id="__span-19-7"><span class="p">}</span>
</span><span id="__span-19-8">
</span><span id="__span-19-9"><span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-10"><span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">every_thread_needs_latest_state</span><span class="p">);</span>
</span><span id="__span-19-11"><span class="p">}</span>
</span></code></pre></div>
<p>In this case, protect access with a mutex:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-20-1"><span class="c1">// Add a mutex (lock)</span>
</span><span id="__span-20-2"><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="w"> </span><span class="n">ex_lock</span><span class="p">;</span>
</span><span id="__span-20-3">
</span><span id="__span-20-4"><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">every_thread_needs_latest_state</span><span class="p">;</span>
</span><span id="__span-20-5">
</span><span id="__span-20-6"><span class="kt">void</span><span class="w"> </span><span class="nf">SetState</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">new_state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-7"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-20-8"><span class="w">        </span><span class="c1">// Protect the access with the mutex (lock)</span>
</span><span id="__span-20-9"><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">ex_lock</span><span class="p">);</span>
</span><span id="__span-20-10"><span class="w">        </span><span class="n">every_thread_needs_latest_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_state</span><span class="p">;</span>
</span><span id="__span-20-11"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-12"><span class="p">}</span>
</span><span id="__span-20-13">
</span><span id="__span-20-14"><span class="kt">void</span><span class="w"> </span><span class="nf">UseState</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-15"><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">state_capture</span><span class="p">;</span>
</span><span id="__span-20-16"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-20-17"><span class="w">        </span><span class="c1">// Protect the access with the mutex (lock)</span>
</span><span id="__span-20-18"><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">ex_lock</span><span class="p">);</span>
</span><span id="__span-20-19"><span class="w">        </span><span class="n">state_capture</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">every_thread_needs_latest_state</span><span class="p">;</span>
</span><span id="__span-20-20"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-21"><span class="w">    </span><span class="n">DoComputation</span><span class="p">(</span><span class="n">state_capture</span><span class="p">);</span>
</span><span id="__span-20-22"><span class="p">}</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The above examples are the common cases we've seen in our effects. You can always come up other methods to treat your statics and globals that best suits your needs.</p>
</div>
<hr />
<h2 id="effect-details-multi-frame-rendering-in-ae-setting-an-effect-as-thread-safe">Setting an Effect as Thread-safe<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-setting-an-effect-as-thread-safe" title="Permanent link">&para;</a></h2>
<ul>
<li>Set the <code>PF_OutFlag2_SUPPORTS_THREADED_RENDERING</code> flag in GlobalSetup to tell After Effects that your effect is Thread-Safe and supports Multi-Frame Rendering.</li>
<li>If required, add the <code>PF_OutFlag2_MUTABLE_RENDER_SEQUENCE_DATA_SLOWER</code> to allow sequence_data to be written at the Render stage.</li>
<li>Update the <code>AE_Effect_Global_OutFlags_2</code> magic number. Launch AE with your effect without changing the magic number for the first time, apply your effect and AE will give you the correct number to put in.</li>
<li>If you are using the <code>PF_OutFlag_SEQUENCE_DATA_NEEDS_FLATTENING</code> flag, remember to also set the <code>PF_OutFlag2_SUPPORTS_GET_FLATTENED_SEQUENCE_DATA</code> flag.</li>
</ul>
<hr />
<h2 id="effect-details-multi-frame-rendering-in-ae-how-to-test-whether-an-effect-is-thread-safe">How to test whether an effect is Thread-Safe<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-how-to-test-whether-an-effect-is-thread-safe" title="Permanent link">&para;</a></h2>
<p>Once you have completed the above steps to make your effect Thread-Safe, you should now be ready to do some testing.</p>
<h3 id="effect-details-multi-frame-rendering-in-ae-enable-multi-frame-rendering">Enable Multi-Frame Rendering<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-enable-multi-frame-rendering" title="Permanent link">&para;</a></h3>
<ul>
<li>Multi-Frame Rendering is enabled by default in After Effects 2022.</li>
<li>To toggle MFR on and off, navigate to Preferences &gt; Memory &amp; Performance &gt; Performance and toggle the Multi-Frame Rendering checkbox.</li>
</ul>
<h3 id="effect-details-multi-frame-rendering-in-ae-test-your-effect">Test your effect<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-test-your-effect" title="Permanent link">&para;</a></h3>
<p>Once you have completed the above preparation steps, test your effect thoroughly. You should be able to test simple and complex compositions and see performance improvements as the effect utilizes multi-frame rendering.</p>
<ul>
<li>Go through all your existing manual and automated testing plans.</li>
<li>Test all the effect parameters and make sure they are working properly.</li>
<li>Add in some of the AE effects that have already been made thread-safe as appropriate. See the <a href="#effect-details-multi-frame-rendering-in-ae-thread-safe-first-party-effects">Thread-Safe First Party Effects</a> section.</li>
<li>Make sure there are no crashes, hangs, render differences or other unexpected changes when rendering with multi-frame rendering enabled.</li>
</ul>
<hr />
<h2 id="effect-details-multi-frame-rendering-in-ae-thread-safe-first-party-effects">Thread-Safe First Party Effects<a class="headerlink" href="#effect-details-multi-frame-rendering-in-ae-thread-safe-first-party-effects" title="Permanent link">&para;</a></h2>
<p>Visit <a href="https://helpx.adobe.com/after-effects/user-guide.html/after-effects/using/effect-list.ug.html">https://helpx.adobe.com/after-effects/user-guide.html/after-effects/using/effect-list.ug.html</a> for a full list of MFR supported effects. More are being added every week.</p></section><section class="print-page" id="effect-details-effect-details"><h1 id="effect-details-effect-details-effect-details">Effect Details<a class="headerlink" href="#effect-details-effect-details-effect-details" title="Permanent link">&para;</a></h1>
<p>Now that we've covered the basics of effect plug-ins, we'll cover some of the finer points to polish off your effect. Not every section will be relevant to every plug-in, so feel free to use the PDF document bookmarks to skip to the sections pertinent to your current project.</p>
<hr />
<h2 id="effect-details-effect-details-free-code-good">Free Code == Good<a class="headerlink" href="#effect-details-effect-details-free-code-good" title="Permanent link">&para;</a></h2>
<p>After Effects provides effect plug-ins with as much information and supporting code as possible. Use our function suites and callbacks to obtain the value of parameters (including source footage) at different times. Use our memory allocation suite to avoid competing with the host for resources. Use our image processing suites to copy, fill, blend and convolve images, and convert between color spaces. Obtain information about the masks applied to a layer. ANSI emulation and math utility suites are also provided, as well as information about the application, user, serial number, and current drawing context.</p>
<p>Previous versions of After Effects have provided functions for many common tasks. As we moved to support deeper color, these were moved to function suites. Use the newer function suites whenever possible; things will just be better.</p>
<p>Using our function suites keeps your plug-in compact; you write and test less code. The functions are tested, optimized, and used by our own plug-ins. The functions are distributed to multiple processors and take advantage of available hardware acceleration.</p>
<p>No, really, use the provided functions. Seriously.</p></section><section class="print-page" id="effect-details-accessing-function-suites"><h1 id="effect-details-accessing-function-suites-accessing-the-after-effects-function-suites">Accessing the After Effects Function Suites<a class="headerlink" href="#effect-details-accessing-function-suites-accessing-the-after-effects-function-suites" title="Permanent link">&para;</a></h1>
<p>If you are writing C++ code, accessing the suites should be done using the AEFX_SuiteScoper which automatically acquires the suite when needed and disposes of it when done.</p>
<p>Here is an example using AEFX_SuiteScope to access the PF_GPUDeviceSuite1 suite:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">AEFX_SuiteScoper</span><span class="o">&lt;</span><span class="n">PF_GPUDeviceSuite1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">gpu_suite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AEFX_SuiteScoper</span><span class="o">&lt;</span><span class="n">PF_GPUDeviceSuite1</span><span class="o">&gt;</span><span class="p">(</span>
</span><span id="__span-0-2"><span class="w">    </span><span class="n">in_dataP</span><span class="p">,</span>
</span><span id="__span-0-3"><span class="w">    </span><span class="n">kPFGPUDeviceSuite</span><span class="p">,</span>
</span><span id="__span-0-4"><span class="w">    </span><span class="n">kPFGPUDeviceSuiteVersion1</span><span class="p">,</span>
</span><span id="__span-0-5"><span class="w">    </span><span class="n">out_dataP</span><span class="p">);</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>AEFX_SuiteScoper will throw an Exception, <code>A_Err_MISSING_SUITE</code>, if the requested suite cannot be acquired and the optional second template argument, <code>ALLOW_NO_SUITE</code>, is set to false.</p>
<p>If you set <code>ALLOW_NO_SUITE</code> to <code>false</code>, please ensure you wrap the <code>AEFX_SuiteScoper&lt;&gt;</code> call with a try/catch wrapper.</p>
<p>If <code>ALLOW_NO_SUITE</code> is set to <code>true</code>, then you should check the returned pointer is not NULL before using it.</p>
</div>
<p>Once you have the suite you may make calls to any function in the suite list so:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-1-1"><span class="n">gpu_suite</span><span class="o">-&gt;</span><span class="n">GetDeviceInfo</span><span class="p">(</span><span class="n">in_dataP</span><span class="o">-&gt;</span><span class="n">effect_ref</span><span class="p">,</span><span class="w"> </span><span class="n">extraP</span><span class="o">-&gt;</span><span class="n">input</span><span class="o">-&gt;</span><span class="n">device_index</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">device_info</span><span class="p">);</span>
</span></code></pre></div>
<p>If you must use C code, then acquire and release the suites manually using the <code>PF_Suite_Helper</code> utility files, as demonstrated in the Checkout sample project.</p>
<p>Behind the scenes, both of these methods acquire PICA function suites using <code>AcquireSuite</code>, a member function of the <code>SPBasicSuite</code> pointed to in <code>PF_InData</code>.</p>
<hr />
<h2 id="effect-details-accessing-function-suites-suite-versions">Suite Versions<a class="headerlink" href="#effect-details-accessing-function-suites-suite-versions" title="Permanent link">&para;</a></h2>
<p>WhizBangSuite1 may provide a Foobar() function which takes two arguments, and WhizBangSuite2&gt;Foobar() may take three. Though each new version of a suite supercedes the old one, feel free to acquire multiple versions of the same suite; we never remove or alter previously shipped suites.</p>
<p>When unsure of the capabilities of the plug-in host (no third party host besides Premiere supports PICA), attempt to acquire the latest version, and "fall back" to previous versions. If functionality you require isn't available, warn the user, and return an error (or fall back on other behavior when running in more "primitive" plug-in hosts). Note that support for these suites in other hosts of After Effects plug-ins is a maze of twisty caves and passages, all alike.</p>
<hr />
<h2 id="effect-details-accessing-function-suites-threading">Threading<a class="headerlink" href="#effect-details-accessing-function-suites-threading" title="Permanent link">&para;</a></h2>
<p>Unless documented otherwise, assume that any function provided by our suites is not thread-safe. For example, only your plug-in's main thread should do anything that modifies the user interface.</p></section><section class="print-page" id="effect-details-memory-allocation"><h1 id="effect-details-memory-allocation-memory-allocation">Memory Allocation<a class="headerlink" href="#effect-details-memory-allocation-memory-allocation" title="Permanent link">&para;</a></h1>
<p>Use After Effects for any memory allocations of significant size. For small allocations, you can use new and delete, but this is the exception, not the rule. In low-memory conditions (such as during RAM preview), it's very important that plug-ins deal gracefully with out-of-memory conditions, and not compete with After Effects for OS memory. By using our memory allocation functions, After Effects can know when to free cached images, to avoid memory swapping. Failing to use our functions for sizable allocations can cause lock-ups, crashes, and tech support calls. Don't do that.</p>
<p>If you're wrapping existing C++ classes, create a base class that implements new and delete for that class and derive from it. To overload the STL, we don't recommend you overload global new and delete. Instead provide an allocator as part of the template definition.</p>
<p>Handles passed to you by After Effects are locked for you before you're called, and unlocked once you return.</p>
<hr />
<h2 id="effect-details-memory-allocation-pf_handlesuite1">PF_HandleSuite1<a class="headerlink" href="#effect-details-memory-allocation-pf_handlesuite1" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
<th colspan="1" rowspan="1">
<p>Replaces</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>host_new_handle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Allocates a new handle.</p>
<p><pre lang="cpp">PF_Handle (*host_new_handle)(<br/>  A_HandleSize size);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_NEW_HANDLE</code></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>host_lock_handle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Locks a handle.</p>
<p><pre lang="cpp">void (*host_lock_handle)(<br/>  PF_Handle pf_handle);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_LOCK_HANDLE</code></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>host_unlock_handle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Unlocks a handle.</p>
<p><pre lang="cpp">void (*host_unlock_handle)(<br/>  PF_Handle pf_handle);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_UNLOCK_HANDLE</code></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>host_dispose_handle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Frees a handle.</p>
<p><pre lang="cpp">void (*host_dispose_handle)(<br/>  PF_Handle pf_handle);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_DISPOSE_HANDLE</code></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>host_get_handle_size</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the size, in bytes, of the reallocatable block whose handle is passed in.</p>
<p><pre lang="cpp">A_HandleSize (*host_get_handle_size)(<br/>  PF_Handle pf_handle);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_GET_HANDLE_SIZE</code></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>host_resize_handle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Resizes a handle.</p>
<p><pre lang="cpp">PF_Err (*host_resize_handle)(<br/>  A_HandleSize new_sizeL, PF_Handle *handlePH);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_RESIZE_HANDLE</code></p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-details-image-buffer-management-functions"><h1 id="effect-details-image-buffer-management-functions-image-buffer-management-functions">Image Buffer Management Functions<a class="headerlink" href="#effect-details-image-buffer-management-functions-image-buffer-management-functions" title="Permanent link">&para;</a></h1>
<p>Use these functions to create and destroy <a href="#effect-basics-pf_effectworld">PF_EffectWorld / PF_LayerDef</a>, and to find out their bit-depth.</p>
<hr />
<h2 id="effect-details-image-buffer-management-functions-pf_worldsuite2">PF_WorldSuite2<a class="headerlink" href="#effect-details-image-buffer-management-functions-pf_worldsuite2" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Description</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_NewWorld</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a new <code>PF_EffectWorld</code>.</p>
<p><pre lang="cpp">PF_Err PF_NewWorld(<br/>  PF_ProgPtr      effect_ref,<br/>  A_long          widthL,<br/>  A_long          heightL,<br/>  PF_Boolean      clear_pixB,<br/>  PF_PixelFormat  pixel_format,<br/>  PF_EffectWorld  *worldP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_DisposeWorld</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Disposes of a <code>PF_EffectWorld</code>.</p>
<p><pre lang="cpp">PF_Err PF_DisposeWorld(<br/>  PF_ProgPtr      effect_ref,<br/>  PF_EffectWorld  *worldP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetPixelFormat</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the pixel format for a given <code>PF_EffectWorld</code>.</p>
<p><pre lang="cpp">PF_Err PF_GetPixelFormat(<br/>  const PF_EffectWorld  *worldP,<br/>  PF_PixelFormat        *pixel_formatP);</pre></p>
<p><code>pixel_formatP</code> can be:</p>
<ul>
<li><code>PF_PixelFormat_ARGB32</code> - standard 8-bit RGB</li>
<li><code>PF_PixelFormat_ARGB64</code> - 16-bit RGB</li>
<li><code>PF_PixelFormat_ARGB128</code> - 32-bit floating point RGB</li>
</ul>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-details-iteration-suites"><h1 id="effect-details-iteration-suites-iteration-suites">Iteration Suites<a class="headerlink" href="#effect-details-iteration-suites-iteration-suites" title="Permanent link">&para;</a></h1>
<p>Effects often iterate over all pixels in an image, filtering each one. By taking advantage of After Effects' iteration suites, you make it possible for After Effects to sub-allocate your task to as many processors are present, taking advantage of hardware-specific acceleration.</p>
<p>After Effects will also manage progress reporting and user cancellation automatically.</p>
<p>Use these suites! Make sure the pixel processing functions you pass to these iterator callbacks are re-entrant.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The October 2021 SDK update increases the number of concurrent iterate threads up to the available system CPU cores instead of the previous hard-coded limit of 32.</p>
</div>
<hr />
<h2 id="effect-details-iteration-suites-pf_iterate8suite1-pf_iterate16suite1-pf_iteratefloatsuite1">PF_Iterate8Suite1, PF_Iterate16Suite1, PF_IterateFloatSuite1<a class="headerlink" href="#effect-details-iteration-suites-pf_iterate8suite1-pf_iterate16suite1-pf_iteratefloatsuite1" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>iterate</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Iterates across pixels from a source image, alters them, and populates a destination image.</p>
<p>You may specify a rectangular region of pixels across which to iterate; if you don't, After Effects will iterate over every overlapping pixel.</p>
<p>You give a refcon, and the function is invoked with that refcon, plus the x and y coordinates of the current pixel, plus pointers to that pixel in the source and destination images.</p>
<p>If you pass a NULL source, it will iterate over the dst. This function is quality independent.</p>
<p>Don't depend upon the pixels being traversed in any particular order.</p>
<p>The image may be subset to different CPUs, so consider all the parameters (except dst) to be read-only while After Effects is processing.</p>
<p>This callback automatically includes progress and abort checking, so don't do so in your pixel function.</p>
<p><pre lang="cpp">iterate(<br/>  PF_InData       *in_data,<br/>  A_long          progress_base,<br/>  A_long          progress_final,<br/>  PF_EffectWorld  *src,<br/>  const PF_Rect   *area,<br/>  void            *refcon,<br/>  PF_Err (*pix_fn)(<br/>    void      *refcon,<br/>    A_long    x,<br/>    A_long    y,<br/>    PF_Pixel  *in,<br/>    PF_Pixel  *out),<br/>  PF_EffectWorld  *dst);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>iterate_origin</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Lets you specify an offset from the input into the output.</p>
<p>For example, if your output buffer is smaller than your input buffer, pass <code>(in_- data&gt;output_origin_x, in_data&gt;output_origin_y)</code> as the origin, and NULL for area, and this function will offset the src pixel pointer appropriately for your pixel function.</p>
<p><pre lang="cpp">iterate_origin(<br/>  PF_InData       *in_data,<br/>  A_long          progress_base,<br/>  A_long          progress_final,<br/>  PF_EffectWorld  *src,<br/>  const PF_Rect   *area,<br/>  const PF_Point  *origin,<br/>  void            *refcon,<br/>  PF_Err (*pix_fn)(<br/>    void      *refcon,<br/>    A_long    x,<br/>    A_long    y,<br/>    PF_Pixel  *in,<br/>    PF_Pixel  *out),<br/>  PF_EffectWorld  *dst);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>iterate_lut</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_Iterate8Suite</code> only. Allows a Look-Up Table (LUT) to be passed for iteration; you can pass the same or different LUTs for each color channel.</p>
<p>If no LUT is passed, an identity LUT is used.</p>
<p><pre lang="cpp">iterate_lut(<br/>  PF_InData       *in_data,<br/>  A_long          prog_base,<br/>  A_long          prog_final,<br/>  PF_EffectWorld  *src,<br/>  const PF_Rect   *area,<br/>  A_u_char        *a_lut0,<br/>  A_u_char        *r_lut0,<br/>  A_u_char        *g_lut0,<br/>  A_u_char        *b_lut0,<br/>  PF_EffectWorld  *dst);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>iterate_origin_non_clip_src</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Allows for iteration across pixels outside the intersection of the source and destination layers. For these pixels, you will be passed a <code>PF_Pixel</code> with values {0,0,0,0}.</p>
<p><pre lang="cpp">iterate_origin_non_clip_src(<br/>  PF_InData       *in_data,<br/>  A_long          progress_base,<br/>  A_long          progress_final,<br/>  PF_EffectWorld  *src,<br/>  const PF_Rect   *area,<br/>  const PF_Point  *origin,<br/>  void            *refcon,<br/>  PF_Err (*pix_fn)(<br/>    void      *refcon,<br/>    A_long    x,<br/>    A_long    y,<br/>    PF_Pixel  *in,<br/>    PF_Pixel  *out),<br/>  PF_EffectWorld  *dst);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>iterate_generic</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>PF_Iterate8Suite</code> only. If you want to do something once per available CPU, this is the function to use (pass <code>PF_Iterations_ONCE_PER_PROCESSOR</code> for <code>iterationsL</code>).</p>
<p>Only call abort and progress functions from thread index 0.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can iterate over more than pixels. Internally, we use it for row-based image processing, and for once-per-entity updates of complex sequence data.</p>
</div>
<p><pre lang="cpp">iterate_generic(<br/>  A_long iterationsL,<br/>  void   *refconPV,<br/>  PF_Err (*fn_func)(<br/>    void    *refconPV,<br/>    A_long  thread_idxL,<br/>    A_long  i,<br/>    A_long  itrtL));</pre></p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-details-graphics-utility-suites"><h1 id="effect-details-graphics-utility-suites-graphics-utility-suites">Graphics Utility Suites<a class="headerlink" href="#effect-details-graphics-utility-suites-graphics-utility-suites" title="Permanent link">&para;</a></h1>
<p>After Effects exposes its internal transform and graphic utility routines through the following function suites.</p>
<hr />
<h2 id="effect-details-graphics-utility-suites-transform-worlds">Transform Worlds<a class="headerlink" href="#effect-details-graphics-utility-suites-transform-worlds" title="Permanent link">&para;</a></h2>
<p>These functions combine <code>PF_EffectWorlds</code> in interesting ways. When you use these, you're using the same code After Effects does internally.</p>
<h3 id="effect-details-graphics-utility-suites-pf_worldtransformsuite1">PF_WorldTransformSuite1<a class="headerlink" href="#effect-details-graphics-utility-suites-pf_worldtransformsuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>composite_rect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Composite a rectangle from one <code>PF_EffectWorld</code> into another, using one of After Effects' transfer modes.</p>
<p><pre lang="cpp">PF_Err composite_rect (<br/>  PF_ProgPtr      effect_ref,<br/>  PF_Rect         *src_rect,<br/>  A_long          src_opacity,<br/>  PF_EffectWorld  *src_world,<br/>  A_long          dst_x,<br/>  A_long          dst_y,<br/>  PF_Field        field_rdr,<br/>  PF_XferMode     xfer_mode,<br/>  PF_EffectWorld  *dst);</pre></p>
<p><code>field_rdr</code> can be upper, lower or both.</p>
<p><code>xfer_mode</code> is one of the following:</p>
<ul>
<li><code>PF_Xfer_COPY</code></li>
<li><code>PF_Xfer_BEHIND</code></li>
<li><code>PF_Xfer_IN_FRONT</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>blend</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Blends two images, alpha-weighted. Does not deal with different-sized sources, though the destination may be either <code>PF_EffectWorld</code>.</p>
<p><pre lang="cpp">PF_Err blend (<br/>  PF_ProgPtr            effect_ref,<br/>  const PF_EffectWorld  *src1,<br/>  const PF_EffectWorld  *src2,<br/>  PF_Fixed              ratio,<br/>  PF_EffectWorld        *dst);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>convolve</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Convolve an image with an arbitrary size kernel on each of the a, r, g, and b channels separately.</p>
<p>You can specify a rectangle to convolve (for instance, the <code>extent_hint</code> from <a href="#effect-basics-pf_effectworld-pf_effectworld-structure">PF_EffectWorld Structure</a>), or pass 0 to convolve the entire image.</p>
<p>Do not use if the source <em>is</em> the destination.</p>
<p>Describe the convolution using <a href="#effect-details-graphics-utility-suites-kernel-flags">Kernel Flags</a>.</p>
<p><pre lang="cpp">PF_Err convolve(<br/>  PF_EffectWorld  *src,<br/>  const PF_Rect   *area,<br/>  PF_KernelFlags  flags,<br/>  A_long          kernel_size,<br/>  void            *a_kernel,<br/>  void            *r_kernel,<br/>  void            *g_kernel,<br/>  void            *b_kernel,<br/>  PF_EffectWorld  *dst);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>copy</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Copies a region from one <code>PF_EffectWorld</code> to another, preserving alpha (unlike the macOS CopyBits).</p>
<p><pre lang="cpp">PF_Err copy (<br/>  PF_EffectWorld  *src,<br/>  PF_EffectWorld  *dst,<br/>  PF_Rect         *src_r,<br/>  PF_Rect         *dst_r);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>copy_hq</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A higher fidelity version of the above (using the same parameters).</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>transfer_rect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Blends using a transfer mode, with an optional mask.</p>
<p><pre lang="cpp">PF_Err transfer_rect (<br/>  PF_ProgPtr              effect_ref,<br/>  PF_Quality              quality,<br/>  PF_ModeFlags            m_flags,<br/>  PF_Field                field,<br/>  const PF_Rect           *src_rec,<br/>  const PF_EffectWorld    *src_world,<br/>  const PF_CompositeMode  *comp_mode,<br/>  const PF_MaskWorld      *mask_world0,<br/>  A_long                  dest_x,<br/>  A_long                  dest_y,<br/>  PF_EffectWorld          *dst_world);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>transform_world</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a <code>PF_EffectWorld</code> and a matrix (or array of matrices), transforms and blends using an After Effects transfer mode, with an optional mask.</p>
<p>The matrices pointer points to a matrix array used for motion-blur.</p>
<p>When is a transform not a transform? A Z-scale transform is not a transform, unless the transformed layer is a parent of other layers that do not all lie in the z=0 plane.</p>
<p><pre lang="cpp">PF_Err transform_world (<br/>  PF_InData               *in_data,<br/>  PF_Quality              quality,<br/>  PF_ModeFlags            m_flags,<br/>  PF_Field                field,<br/>  const PF_EffectWorld    *src_world,<br/>  const PF_CompositeMode  *comp_mode,<br/>  const PF_MaskWorld      *mask_world0,<br/>  const PF_FloatMatrix    *matrices,<br/>  A_long                  num_matrices,<br/>  Boolean                 src2dst_matrix,<br/>  const PF_Rect           *dest_rect,<br/>  PF_EffectWorld          *dst_world);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-graphics-utility-suites-kernel-flags">Kernel Flags<a class="headerlink" href="#effect-details-graphics-utility-suites-kernel-flags" title="Permanent link">&para;</a></h2>
<p>Functions such as <code>convolve</code> or gaussian kernel work with kernels, or matrices of filter weight values. These matrices can be in any format. The kernel flags describe how the matrices should be created and used. OR together any flags you need.</p>
<p>The flags relevant to given routines are documented along with the routine prototype.The first entry in the left column is always the default and has value 0.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Kernel Flags</p>
</th>
<th colspan="1" rowspan="1">
<p>Indicates</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_KernelFlag_2D</code></p>
<p><code>PF_KernelFlag_1D</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies a one or two dimensional kernel.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_KernelFlag_UNNORMALIZED</code></p>
<p><code>PF_KernelFlag_NORMALIZED</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>NORMALIZED</code> equalizes the kernel; the volume under the kernel surface is the same as the volume under the covered area of pixels.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_KernelFlag_CLAMP</code></p>
<p><code>PF_KernelFlag_NO_CLAMP</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>CLAMP</code> restricts values to the valid range for their data type.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_KernelFlag_USE_LONG</code></p>
<p><code>PF_KernelFlag_USE_CHAR</code></p>
<p><code>PF_KernelFlag_USE_FIXED</code></p>
<p><code>PF_KernelFlag_USE_UNDEFINED</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>USE_LONG</code> defines the kernel as an array of longs valued from 0 to 255. <code>USE_LONG</code> is the only implemented flag.</p>
<p><code>USE_CHAR</code> defines the kernel as an array of unsigned chars from 0 to 255.</p>
<p><code>USE_FIXED</code> defines the kernel as an array of fixeds from 0 to 1.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_KernelFlag_HORIZONTAL</code></p>
<p><code>PF_KernelFlag_VERTICAL</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the direction of the convolution.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_KernelFlag_TRANSPARENT_BORDERS</code></p>
<p><code>PF_KernelFlag_REPLICATE_BORDERS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Use <code>TRANSPARENT_BORDERS</code> to treat pixels off the edge as alpha zero (black).</p>
<p>Use <code>REPLICATE_BORDERS</code> to replicate border pixels when sampling off the edge.</p>
<p><code>REPLICATE_BORDERS</code> is not implemented and will be ignored.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_KernelFlag_STRAIGHT_CONVOLVE</code></p>
<p><code>PF_KernelFlag_ALPHA_WEIGHT_CONVOLVE</code>
</p>
</td>
<td colspan="1" rowspan="1">
<p>Use <code>STRAIGHT_CONVOLVE</code> to indicate straight convolution.</p>
<p>Use <code>ALPHA_WEIGHT_CONVOLVE</code> to tell the convolution code to alpha-weight the contributions of pixels to the resulting convolved output.
<code>ALPHA_WEIGHT_CONVOLVE</code> is not implemented and will be ignored.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-graphics-utility-suites-fill-em-up">Fill 'Em Up!<a class="headerlink" href="#effect-details-graphics-utility-suites-fill-em-up" title="Permanent link">&para;</a></h2>
<p>The FillMatteSuite can be used to fill a <code>PF_EffectWorld</code>, either with a specific color or premultiplied with an alpha value.</p>
<h3 id="effect-details-graphics-utility-suites-pf_fillmattesuite2">PF_FillMatteSuite2<a class="headerlink" href="#effect-details-graphics-utility-suites-pf_fillmattesuite2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>fill</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Fills a rect with a color (or, if the color pointer is null, fills with black and alpha zero).</p>
<p>If the rect is null, it fills the entire image.</p>
<p><pre lang="cpp">PF_Err fill (<br/>  PF_ProgPtr      effect_ref,<br/>  const PF_Pixel  *color,<br/>  const PF_Rect   *dst_rect,<br/>  PF_EffectWorld  *world);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>fill16</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Same as fill, but takes a pointer to a <code>PF_Pixel16</code> color.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>fill_float</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Takes a pointer to a <code>PF_PixelFloat</code> color.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>premultiply</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Converts to (and from) r, g, and b color values pre-multiplied with black to represent the alpha channel.</p>
<p>Quality independent.</p>
<ul>
<li><code>forward</code> is used as a boolean</li>
<li><code>true</code> means convert non-premultiplied to pre-multiplied</li>
<li><code>false</code> mean un-pre-multiply.</li>
</ul>
<p><pre lang="cpp">PF_Err premultiply (<br/>  A_long          forward,<br/>  PF_EffectWorld  *dst);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>premultiply_color</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Converts to (and from) having r, g, and b color values premultiplied with any color to represent the alpha channel.</p>
<p><pre lang="cpp">PF_Err premultiply_color (<br/>  PF_ProgPtr      effect_ref,<br/>  PF_EffectWorld  *src,<br/>  PF_Pixel        *color,<br/>  A_long          forward,<br/>  PF_EffectWorld  *dst);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>premultiply_color16</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Same as above, but takes a pointer to a <code>PF_Pixel16</code> color.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>premultiply_color_float</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Takes a pointer to a <code>PF_PixelFloat</code> color.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-graphics-utility-suites-sampling-images">Sampling Images<a class="headerlink" href="#effect-details-graphics-utility-suites-sampling-images" title="Permanent link">&para;</a></h2>
<p>Note: areas outside the bounds of the image being sampled are treated as zero alpha. For convenience, the functions from <code>PF_Sampling8Suite1</code>, <code>PF_Sampling16Suite1</code>, and <code>PF_SamplingFloatSuite1</code> are all listed in this table.</p>
<h3 id="effect-details-graphics-utility-suites-pf_samplingsuite-functions-multiple-suites">PF_SamplingSuite Functions (Multiple Suites)<a class="headerlink" href="#effect-details-graphics-utility-suites-pf_samplingsuite-functions-multiple-suites" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>nn_sample</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Performs nearest neighbor sampling.</p>
<p><pre lang="cpp">PF_Err nn_sample (<br/>  PF_ProgPtr       effect_ref,<br/>  PF_Fixed         x,<br/>  PF_Fixed         y,<br/>  const PF_SampPB  *params,<br/>  PF_Pixel         *dst_pixel );</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>nn_sample16</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Same as above, but takes a pointer to a <code>PF_Pixel16</code> <code>dst_pixel</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>nn_sample_float</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Takes a pointer to a <code>PF_PixelFloat</code> <code>dst_pixel</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>subpixel_sample</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Queries the appropriate alpha-weighted interpolation of colors at a non-integral point in a source image, in high quality. Nearest neighbor sampling is used in low quality.</p>
<p>Because the sampling routine, if used, will typically be called many times, it is convenient to copy the function pointer out to the callbacks structure and into a register or onto the stack to speed up your inner loop.</p>
<p>See the sample code for an example.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The sampling assumes that 0,0 is the center of the top left pixel.</p>
</div>
<p><pre lang="cpp">PF_Err subpixel_sample (<br/>  PF_ProgPtr       effect_ref,<br/>  PF_Fixed         x,<br/>  PF_Fixed         y,<br/>  const PF_SampPB  *params,<br/>  PF_Pixel         *dst_pixel);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>subpixel_sample16</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Same as above, but takes a pointer to a <code>PF_Pixel16*</code> <code>dst_pixel</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>subpixel_sample_float</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Takes a pointer to a <code>PF_PixelFloat*</code> <code>dst_pixel</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>area_sample</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Use this to calculate the appropriate alpha weighted average of an axis-aligned non-integral rectangle of color in a source image, in high quality.</p>
<p>Nearest neighbor sampling is used in low quality. Because of overflow issues, this can only average a maximum of a 256 x 256 pixel area (i.e. x and y radius &lt; 128 pixels).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The sampling radius must be at least one in both x and y.</p>
</div>
<p><pre lang="cpp">PF_Err area_sample (<br/>  PF_ProgPtr       effect_ref,<br/>  PF_Fixed         x,<br/>  PF_Fixed         y,<br/>  const PF_SampPB  *params,<br/>  PF_Pixel         *dst_pixel);</pre></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Areas outside the boundaries of the layer are considered the same as zero alpha, for sampling purposes.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>area_sample16</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Same as above, but takes a <code>PF_Pixel16*</code> <code>dst_pixel</code>.</p>
</td>
</tr>
</tbody>
</table>
<h3 id="effect-details-graphics-utility-suites-pf_batchsamplingsuite1-functions">PF_BatchSamplingSuite1 Functions<a class="headerlink" href="#effect-details-graphics-utility-suites-pf_batchsamplingsuite1-functions" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>begin_sampling</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Your effect is going to perform some batch sampling; After Effects will perform setup tasks to optimize your sampling.</p>
<p><pre lang="cpp">PF_Err (*begin_sampling)(<br/>  PF_ProgPtr    effect_ref,<br/>  PF_Quality    qual,<br/>  PF_ModeFlags  mf,<br/>  PF_SampPB     *params);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>end_sampling</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Tells After Effects you're done sampling.</p>
<p><pre lang="cpp">PF_Err (*end_sampling)(<br/>  PF_ProgPtr    effect_ref,<br/>  PF_Quality    qual,<br/>  PF_ModeFlags  mf,<br/>  PF_SampPB     *params);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>get_batch_func</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains a pointer to After Effects' batch sampling function (highly optimized).</p>
<p><pre lang="cpp">PF_Err (*get_batch_func)(<br/>  PF_ProgPtr          effect_ref,<br/>  PF_Quality          quality,<br/>  PF_ModeFlags        mode_flags,<br/>  const PF_SampPB     *params,<br/>  PF_BatchSampleFunc  *batch);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>get_batch_func16</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains a pointer to After Effects' 16-bpc batch sampling function (also highly optimized).</p>
<p><pre lang="cpp">PF_Err (*get_batch_func16)(<br/>  PF_ProgPtr            effect_ref,<br/>  PF_Quality            quality,<br/>  PF_ModeFlags          mode_flags,<br/>  const PF_SampPB       *params,<br/>  PF_BatchSample16Func  *batch);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-graphics-utility-suites-do-the-math-for-me">Do The Math For Me<a class="headerlink" href="#effect-details-graphics-utility-suites-do-the-math-for-me" title="Permanent link">&para;</a></h2>
<p>Along with the variety of graphics utilities, we also provide a block of ANSI standard routines so that plug-ins will not need to include other libraries to use standard functions.</p>
<p>We give function pointers to a large number of math functions (trig functions, square root, logs, etc.).</p>
<p>Using our suite functions provides for some (application level) error handling, and prevents problems with including different versions of multiple "standard" libraries.</p>
<p>All functions return a double. All angles are expressed in radians, use <code>PF_RAD_PER_DEGREE</code> (a constant from AE_EffectCB.h) to convert from degrees to radians if necessary.</p>
<h3 id="effect-details-graphics-utility-suites-pf_ansicallbacksuite1">PF_ANSICallbackSuite1<a class="headerlink" href="#effect-details-graphics-utility-suites-pf_ansicallbacksuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
<th>Replaces</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>acos</code></td>
<td>Returns the arc cosine of x.</td>
<td><code>PF_ACOS</code></td>
</tr>
<tr>
<td><code>asin</code></td>
<td>Returns the arc sine of x.</td>
<td><code>PF_ASIN</code></td>
</tr>
<tr>
<td><code>atan</code></td>
<td>Returns the arc tangent of x.</td>
<td><code>PF_ATAN</code></td>
</tr>
<tr>
<td><code>atan2</code></td>
<td>Returns atan(y/x).</td>
<td><code>PF_ATAN2</code></td>
</tr>
<tr>
<td><code>ceil</code></td>
<td>Returns the next integer above x.</td>
<td><code>PF_CEIL</code></td>
</tr>
<tr>
<td><code>cos</code></td>
<td>Returns the cosine of x.</td>
<td><code>PF_COS</code></td>
</tr>
<tr>
<td><code>exp</code></td>
<td>Returns e to the power of x.</td>
<td><code>PF_EXP</code></td>
</tr>
<tr>
<td><code>fabs</code></td>
<td>Returns the absolute value of x.</td>
<td><code>PF_FABS</code></td>
</tr>
<tr>
<td><code>floor</code></td>
<td>Returns the closest integer below x.</td>
<td><code>PF_FLOOR</code></td>
</tr>
<tr>
<td><code>fmod</code></td>
<td>Returns x modulus y.</td>
<td><code>PF_FMOD</code></td>
</tr>
<tr>
<td><code>hypot</code></td>
<td>Returns the hypotenuse of x and y, which is sqrt(x*x + y*y).</td>
<td><code>PF_HYPOT</code></td>
</tr>
<tr>
<td><code>log</code></td>
<td>Returns the natural log (ln) of x.</td>
<td><code>PF_LOG</code></td>
</tr>
<tr>
<td><code>log10</code></td>
<td>Returns the log (base 10) of x.</td>
<td><code>PF_LOG10</code></td>
</tr>
<tr>
<td><code>pow</code></td>
<td>Returns x to the power of y.</td>
<td><code>PF_POW</code></td>
</tr>
<tr>
<td><code>sin</code></td>
<td>Returns the sine of x.</td>
<td><code>PF_SIN</code></td>
</tr>
<tr>
<td><code>sqrt</code></td>
<td>Returns the square root of x.</td>
<td><code>PF_SQRT</code></td>
</tr>
<tr>
<td><code>tan</code></td>
<td>Returns the tangent of x.</td>
<td><code>PF_TAN</code></td>
</tr>
<tr>
<td><em>(while not strictly math functions, these emulate ANSI functionality)</em></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>sprintf</code></td>
<td>Emulates the C sprintf function.</td>
<td><code>PF_SPRINTF</code></td>
</tr>
<tr>
<td><code>strcpy</code></td>
<td>Emulates the C strcpy function.</td>
<td><code>PF_STRCPY</code></td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-details-interaction-callback-functions"><h1 id="effect-details-interaction-callback-functions-interaction-callback-functions">Interaction Callback Functions<a class="headerlink" href="#effect-details-interaction-callback-functions-interaction-callback-functions" title="Permanent link">&para;</a></h1>
<p>While the un-macro'd function pointers are provided in <a href="#effect-basics-pf_indata-pf_indata">PF_InData</a>, use the provided macros to access them. See how stringent we are about deprecating macro usage? Let's let this be our little secret.</p>
<hr />
<h2 id="effect-details-interaction-callback-functions-interaction-callbacks">Interaction Callbacks<a class="headerlink" href="#effect-details-interaction-callback-functions-interaction-callbacks" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ADD_PARAM</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Enumerate your plug-in's parameters to After Effects during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_PARAM_SETUP</a>, using multiple calls to this function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Failing to completely clear out a PF_ParamDef prior to PF_ADD_PARAM() can cause many problems.
 Always use <code>AEFX_CLR_STRUCT</code> before adding parameters.</p>
</div>
<p><pre lang="cpp">PF_Err PF_ADD_PARAM (<br/>  PF_InData       *in_data,<br/>  PF_ParamIndex   index,<br/>  PF_ParamDefPtr  def);</pre></p>
<p>We provide convenience macros for specific parameter types, in Utils/ Param_Utils.h:</p>
<ul>
<li><code>PF_ADD_COLOR</code></li>
<li><code>PF_ADD_ARBITRARY</code></li>
<li><code>PF_ADD_SLIDER</code></li>
<li><code>PF_ADD_FIXED</code></li>
<li><code>PF_ADD_FLOAT_SLIDERX</code></li>
<li><code>PF_ADD_CHECKBOXX</code></li>
<li><code>PF_ADD_BUTTON</code></li>
<li><code>PF_ADD_ANGLE</code></li>
<li><code>PF_ADD_NULL</code></li>
<li><code>PF_ADD_LAYER</code></li>
<li><code>PF_ADD_255_SLIDER</code></li>
<li><code>PF_ADD_PERCENT</code></li>
<li><code>PF_ADD_POINT</code></li>
<li><code>PF_ADD_POINT_3D</code></li>
<li><code>PF_ADD_TOPICX</code></li>
<li><code>PF_END_TOPIC</code></li>
<li><code>PF_ADD_POPUPX</code></li>
<li><code>PF_ADD_FLOAT_SLIDERX_DISABLED</code>
</li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ABORT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns non-zero if the user has cancelled; return that value to After Effects.</p>
<p>Wrap your render routine in a "while abort has not been requested" while loop.</p>
<p><pre lang="cpp">PF_Err PF_ABORT (PF_InData *in_data);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PROGRESS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Displays a progress bar during processing; current and total describe the percentage complete.</p>
<p>Returns non-zero if you should suspend or abort your current processing; return that value to After Effects.</p>
<p>Call once per scanline, unless your effect is very slow.</p>
<p>If total is <code>0</code>, <code>PF_ABORT</code> is used instead (presenting the user with different choices).</p>
<p><pre lang="cpp">PF_Err PF_PROGRESS (<br/>  PF_InData  *in_data,<br/>  A_long     current,<br/>  A_long     total );</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_CHECKOUT_PARAM</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains parameter values, or the source video layer, at a specified time. After Effects makes caching decisions based on the checkout state of parameters.</p>
<p>Allocate a new <a href="#effect-basics-pf_paramdef-pf_paramdef">PF_ParamDef</a> to hold the result; those passed to the plug-in are read-only.</p>
<p>If you check out a layer parameter that's set to <code>&lt;none&gt;</code>, the layer returned will be filled with zeros.</p>
<p>Masks are not included with checked-out layers.</p>
<p>Do not check out layer parameters during UI event handling.</p>
<p><pre lang="cpp">PF_Err PF_CHECKOUT_PARAM (<br/>  PF_InData      *in_data,<br/>  PF_ParamIndex  index,<br/>  A_long         what_time,<br/>  A_long         step,<br/>  A_long         time_scale,<br/>  PF_ParamDef    *param);</pre></p>
<p>If checking out the source layer, a deinterlaced frame will be returned. If you ask for the time that references the upper field, you will receive back the upper field with a filter used to generate the extra scanlines.</p>
<p>For example, assuming line 0 and 2 are upper fields, and line 1 is a lower field, if you check out the upper fields, line 0 and 2 will be passed back directly from the source footage, and line 1 will be calculated by averaging lines 0 and 2.</p>
<p>If you want to reassemble a full resolution source frame with both fields present, you can call <code>PF_CHECKOUT_PARAM</code> twice to get both fields, and reinterlace the footage.</p>
<p>What happens when checking out a layer at a time that is not frame-aligned? All items have essentially infinite time resolution, so when asking for a time at any value, AE renders the item at that time.</p>
<p>For a composition, that involves interpolating all of the keyframes values to the subframe time.</p>
<p>For footage, AE returns a full image that corresponds to the time asked, which is the nearest-to-left frame.</p>
<p>If the user has frame-blending on that layer, an interpolated frame is generated.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_CHECKIN_PARAM</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Balance every <code>PF_CHECKOUT_PARAM</code>, with a <code>PF_CHECKIN_PARAM</code>.</p>
<p>Not doing so causes dismal performance and leaks memory. Once checked in, the fields in the <a href="#effect-basics-pf_paramdef-pf_paramdef">PF_ParamDef</a> will no longer be valid.</p>
<p><pre lang="cpp">PF_Err PF_CHECKIN_PARAM (<br/>  PF_InData    *in_data,<br/>  PF_ParamDef  *param );</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_REGISTER_UI</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Register a custom user interface element. See <a href="#effect-ui-events-effect-ui-events">Effect UI &amp; Events</a>. Note: The PF_UIAlignment flags are not honored.</p>
<p><pre lang="cpp">PF_Err PF_REGISTER_UI (<br/>  PF_InData        *in_data,<br/>  PF_CustomUIInfo  *cust_info );</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_CHECKOUT_LAYER_AUDIO</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given an index, start_time, duration, time_scale, rate, bytes_per_sample, num_channels, and fmt_signed, After Effects will return a corresponding PF_LayerAudio.</p>
<p>After Effects will perform any necessary resampling.</p>
<p><pre lang="cpp">PF_Err PF_CHECKOUT_LAYER_AUDIO (<br/>  PF_InData      *in_data,<br/>  PF_ParamIndex  index,<br/>  A_long         start_time,<br/>  A_long         duration,<br/>  A_u_long       time_scale,<br/>  PF_UFixed      rate,<br/>  A_long         bytes_per_sample,<br/>  A_long         num_channels,<br/>  A_long         fmt_signed,<br/>  PF_LayerAudio  *audio);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_CHECKIN_LAYER_AUDIO</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Balance all calls to PF_CHECKOUT_LAYER_AUDIO, regardless of error conditions, with matching calls to <code>PF_CHECKIN_LAYER_AUDIO</code>.</p>
<p><pre lang="cpp">PF_Err PF_CHECKIN_LAYER_AUDIO (<br/>  PF_InData      *in_data,<br/>  PF_LayerAudio  audio );</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GET_AUDIO_DATA</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns information about the PF_LayerAudio.</p>
<p>All the parameters after audio are optional; pass 0 for any value in which you aren't interested. rate0 is unsigned, and fmt_signed0 should be non-zero for signed, zero for unsigned.</p>
<p>This callback is for visual effects that read audio information. To <em>alter</em> audio, write an audio filter.</p>
<p><pre lang="cpp">PF_Err PF_GET_AUDIO_DATA (<br/>  PF_InData        *in_data,<br/>  PF_LayerAudio    audio,<br/>  PF_SndSamplePtr  *data0,<br/>  A_long           *num_samples0,<br/>  PF_UFixed        *rate0,<br/>  A_long           *bytes_per_sample0,<br/>  A_long           *num_channels0,<br/>  A_long           *fmt_signed0);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-interaction-callback-functions-parameter-checkout-vs-param-zero">Parameter Checkout vs. Param Zero<a class="headerlink" href="#effect-details-interaction-callback-functions-parameter-checkout-vs-param-zero" title="Permanent link">&para;</a></h2>
<p>Effects are applied to an image in order from 0 to n within the Effect Control (and Composition) panel.</p>
<p>The output from effect[n-1] is the input (<a href="#effect-basics-pf_paramdef-param-zero">param[0]</a>) of effect[n].</p>
<p>On the other hand, when a normal effect checks out a layer using <code>PF_CHECKOUT_PARAM</code>, it receives the raw (un-effected) source layer, regardless of its order.</p>
<p>However, when a <a href="#smartfx-smartfx">SmartFX</a> effect checks out its input parameter (params[0]), previous effects <em>are</em> applied.</p>
<hr />
<h2 id="effect-details-interaction-callback-functions-parameter-checkout-behavior">Parameter Checkout Behavior<a class="headerlink" href="#effect-details-interaction-callback-functions-parameter-checkout-behavior" title="Permanent link">&para;</a></h2>
<p>Regardless of whether the layer in and out point have been trimmed, you will get valid frames from the start of the source footage to the end, and then transparent before and after that.</p>
<p>Layer params with a lower frame rate than the composition in which they're checked out are only refreshed as often as necessitated by the lower frame rate.</p>
<p>A 10fps layer checked out in a 30fps composition will only need to be refreshed every third frame. if your effect wants to change it's output every frame despite the static input layer, you'd need to set <a href="#effect-basics-pf_outdata-pf_outflags">PF_Outflag_NON_PARAM_VARY</a>.</p>
<p>When an effect checks out a continuously-rasterized Adobe Illustrator layer, After Effects renders the Illustrator layer with geometrics applied, in a composition-sized buffer.</p>
<hr />
<h2 id="effect-details-interaction-callback-functions-parameter-checkout-and-re-entrancy">Parameter Checkout And Re-Entrancy<a class="headerlink" href="#effect-details-interaction-callback-functions-parameter-checkout-and-re-entrancy" title="Permanent link">&para;</a></h2>
<p>Plug-ins that check out layers at different times can generate re-entrant behavior. Consider an instance where the Checkout sample plug-in is applied to a layer in composition B, and B is pre-composed into composition A where Checkout is applied to it as well.</p>
<p>When composition A is rendered, Checkout[A] will be sent <em>PF_Cmd_RENDER</em>, during which it checks out a layer (composition B) from a time other than the current time.</p>
<p>In order to provide that checked-out layer, After Effects sends <em>PF_Cmd_RENDER</em> to <code>Checkout[B]</code>.</p>
<p>Presto, recursion!</p>
<p>If you're going to check out parameters, your effects must handle re-entrant render requests appropriately.</p>
<p>Don't use globals, or read or write static variables...but you weren't going to anyway, right?</p>
<hr />
<h2 id="effect-details-interaction-callback-functions-progress-during-iteration">Progress During Iteration<a class="headerlink" href="#effect-details-interaction-callback-functions-progress-during-iteration" title="Permanent link">&para;</a></h2>
<p>After Effects strives to be as responsive as possible to user interaction, even while rendering. Do the same through appropriate use of PF_ITERATE(). For example, perhaps you're using a PF_ITERATE'd function three times during your response to <code>PF_Cmd_RENDER</code>.</p>
<p>In this case, you'd start off with:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">lines_per_iterateL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in_data</span><span class="o">&gt;</span><span class="n">extent_hint</span><span class="p">.</span><span class="n">top</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">in_data</span><span class="o">&gt;</span><span class="n">extent_hint</span><span class="p">.</span><span class="n">bottom</span><span class="p">;</span>
</span><span id="__span-0-2"><span class="n">total_linesL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">lines_per_iterateL</span><span class="p">;</span>
</span><span id="__span-0-3"><span class="n">lines_so_farL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span></code></pre></div>
<p>After each iteration, you'd add the already-completed lines to the current position:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-1-1"><span class="n">suites</span><span class="p">.</span><span class="n">iterate8suite</span><span class="p">()</span><span class="o">&gt;</span><span class="n">iterate</span><span class="p">(</span><span class="w"> </span><span class="n">lines_so_farL</span><span class="p">,</span>
</span><span id="__span-1-2"><span class="w">                                </span><span class="n">total_linesL</span><span class="p">,</span>
</span><span id="__span-1-3"><span class="w">                                </span><span class="n">input_worldP</span><span class="p">,</span>
</span><span id="__span-1-4"><span class="w">                                </span><span class="o">&amp;</span><span class="n">output</span><span class="o">&gt;</span><span class="n">extent_hint</span><span class="p">,</span>
</span><span id="__span-1-5"><span class="w">                                </span><span class="n">refcon</span><span class="p">,</span>
</span><span id="__span-1-6"><span class="w">                                </span><span class="n">WhizBangPreProcessFun</span><span class="p">,</span>
</span><span id="__span-1-7"><span class="w">                                </span><span class="n">output_worldP</span><span class="p">);</span>
</span><span id="__span-1-8">
</span><span id="__span-1-9"><span class="n">lines_so_farL</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">lines_per_iterateL</span><span class="p">;</span>
</span><span id="__span-1-10">
</span><span id="__span-1-11"><span class="n">ERR</span><span class="p">(</span><span class="n">PF_PROGRESS</span><span class="p">(</span><span class="n">lines_so_farL</span><span class="p">,</span><span class="w"> </span><span class="n">total_linesL</span><span class="p">));</span>
</span><span id="__span-1-12">
</span><span id="__span-1-13"><span class="n">suites</span><span class="p">.</span><span class="n">iterate8suite</span><span class="p">()</span><span class="o">&gt;</span><span class="n">iterate</span><span class="p">(</span><span class="w"> </span><span class="n">lines_so_farL</span><span class="p">,</span>
</span><span id="__span-1-14"><span class="w">                                </span><span class="n">total_linesL</span><span class="p">,</span>
</span><span id="__span-1-15"><span class="w">                                </span><span class="n">input_worldP</span><span class="p">,</span>
</span><span id="__span-1-16"><span class="w">                                </span><span class="o">&amp;</span><span class="n">output</span><span class="o">&gt;</span><span class="n">extent_hint</span><span class="p">,</span>
</span><span id="__span-1-17"><span class="w">                                </span><span class="n">refcon</span><span class="p">,</span>
</span><span id="__span-1-18"><span class="w">                                </span><span class="n">WhizBangRenderFunc</span><span class="p">,</span>
</span><span id="__span-1-19"><span class="w">                                </span><span class="n">output_worldP</span><span class="p">);</span>
</span><span id="__span-1-20">
</span><span id="__span-1-21"><span class="n">lines_so_far</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">lines_per_iterateL</span><span class="p">;</span>
</span><span id="__span-1-22">
</span><span id="__span-1-23"><span class="n">ERR</span><span class="p">(</span><span class="n">PF_PROGRESS</span><span class="p">(</span><span class="n">lines_so_farL</span><span class="p">,</span><span class="w"> </span><span class="n">total_linesL</span><span class="p">));</span>
</span><span id="__span-1-24">
</span><span id="__span-1-25"><span class="n">suites</span><span class="p">.</span><span class="n">iterate8suite</span><span class="p">()</span><span class="o">&gt;</span><span class="n">iterate</span><span class="p">(</span><span class="w"> </span><span class="n">lines_so_farL</span><span class="p">,</span>
</span><span id="__span-1-26"><span class="w">                                </span><span class="n">total_linesL</span><span class="p">,</span>
</span><span id="__span-1-27"><span class="w">                                </span><span class="n">input_worldP</span><span class="p">,</span>
</span><span id="__span-1-28"><span class="w">                                </span><span class="o">&amp;</span><span class="n">output</span><span class="o">&gt;</span><span class="n">extent_hint</span><span class="p">,</span>
</span><span id="__span-1-29"><span class="w">                                </span><span class="n">refcon</span><span class="p">,</span>
</span><span id="__span-1-30"><span class="w">                                </span><span class="n">WhizBangPostProcessFunc</span><span class="p">,</span>
</span><span id="__span-1-31"><span class="w">                                </span><span class="n">output_worldP</span><span class="p">);</span>
</span><span id="__span-1-32">
</span><span id="__span-1-33"><span class="n">ERR</span><span class="p">(</span><span class="n">PF_PROGRESS</span><span class="p">(</span><span class="n">lines_so_farL</span><span class="p">,</span><span class="w"> </span><span class="n">total_linesL</span><span class="p">));</span>
</span></code></pre></div></section><section class="print-page" id="effect-details-pixel-aspect-ratio"><h1 id="effect-details-pixel-aspect-ratio-pixel-aspect-ratio">Pixel Aspect Ratio<a class="headerlink" href="#effect-details-pixel-aspect-ratio-pixel-aspect-ratio" title="Permanent link">&para;</a></h1>
<p>Effects must respond correctly to footage with non-square pixels, and non-uniform downsampling factors. Even different layer parameters can have different pixel aspect ratios! Doing so isn't difficult once you understand the concepts involved.</p>
<p>Simple effects needn't do any work to match up <a href="#effect-basics-parameters">point parameters</a> to the actual pixels in the output. Point parameters are given to the effect scaled for downsample factor and pixel aspect ratio; they are in the coordinate system of the input buffer. This provides an implicit "pixel coordinate system." This coordinate system is handy and easy to understand. But effects that use absolute pixel measurements or geometry must take a deeper look at the relationship between the input buffer and the final rendered image.</p>
<hr />
<h2 id="effect-details-pixel-aspect-ratio-dont-assume-pixels-are-square-or-1-to-1">Don't Assume Pixels Are Square, Or 1-To-1<a class="headerlink" href="#effect-details-pixel-aspect-ratio-dont-assume-pixels-are-square-or-1-to-1" title="Permanent link">&para;</a></h2>
<p>First, it is not necessarily a square coordinate system, due to both pixel aspect ratio and non-uniform downsample factor. The final rendered image can be stretched or squashed horizontally, relative to the pixels your effect processes. Circles will appear as ellipses, squares as rectangles. The distance between two points varies based on their angle in this coordinate system; anything rotated in this system is skewed, in the final output.</p>
<p>Second, even if it <em>is</em> a square coordinate system, it's not necessarily the same size as the final output. This means that any slider which defines a size in pixels will be a problem when the image is rendered downsampled; the width of anti-aliasing filters changes based on downsample factor.</p>
<p>Sometimes these issues aren't a problem. Any effect that colors pixels based solely on a linear function of the x and y coordinates need not bother with pixel aspect ratio and downsample factor at all. Staying in the input coordinate space is an option, though you must account for pixel aspect ratio and downsample factor elsewhere.</p>
<p>Suppose you're writing a particle system effect that sprays textured sprites from a source position defined by an effect control point. Using pixel coordinates to represent the particle positions seems fine (as long as the particles don't have to rotate around a point), but when you go to actually <em>render</em> the particle textures, you'll have to scale them by pixel aspect ratio and downsample factor.</p>
<p>If an effect already has coordinate transformation machinery in its pipeline, there's an alternative that's often simpler. Many algorithms require some sort of coordinate transformation; using matrices to set up a transformation, for example. But there are other easily adaptable algorithms, for example a texture generation effect that computes the value of each pixel based solely on its position. In this case, the code must take the raw pixel position and account for pixel aspect ratio and downsample factor.</p>
<hr />
<h2 id="effect-details-pixel-aspect-ratio-suggested-approach">Suggested Approach<a class="headerlink" href="#effect-details-pixel-aspect-ratio-suggested-approach" title="Permanent link">&para;</a></h2>
<p>The simplest way to get all of this right is to work entirely in full resolution square coordinates, then scale by downsample factor and pixel aspect ratio as a final output transformation. Since point parameters are always reported in input buffer coordinates, convert them to full-resolution square coordinates before use. With this approach you don't need to worry about sliders which define a size in pixels; just interpret them as defining size in full-resolution vertical pixels.</p>
<ol>
<li>When getting your point parameters, go immediately to floating point and a full resolution square pixel system, like this.</li>
</ol>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">x</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">in_data</span><span class="o">&gt;</span><span class="n">pixel_aspect_ratio</span><span class="p">.</span><span class="n">num</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">in_data</span><span class="o">&gt;</span><span class="n">pixel_aspect_ratio</span><span class="p">.</span><span class="n">den</span><span class="p">;</span>
</span><span id="__span-0-2"><span class="n">x</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">in_data</span><span class="o">&gt;</span><span class="n">downsample_x</span><span class="p">.</span><span class="n">den</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">in_data</span><span class="o">&gt;</span><span class="n">downsample_x</span><span class="p">.</span><span class="n">num</span><span class="p">;</span>
</span><span id="__span-0-3"><span class="n">y</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">in_data</span><span class="o">&gt;</span><span class="n">downsample_y</span><span class="p">.</span><span class="n">den</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">in_data</span><span class="o">&gt;</span><span class="n">downsample_y</span><span class="p">.</span><span class="n">num</span><span class="p">;</span>
</span></code></pre></div>
<ol>
<li>Perform all setup (define transformation matrices, generate coordinates for later scan conversion, compute values based on the distance between points, rotating things, et cetera) in this coordinate space. Note that you're not actually dealing with pixels in this stage; you're just manipulating coordinates or coordinate transformations.</li>
<li>To go back to a coordinate system that corresponds directly to the pixels of the output buffer, undo the transformations from step one. Do this as late as possible, so as little code as possible needs to deal with this non-square space. If you're using matrices, this would be a final output transformation. For an effect which renders something based on the coordinate of each pixel, iterate over the output pixels and convert pixel coordinates to square coordinates before doing any processing for that pixel.</li>
</ol>
<p>This may seem like extra work, but most reasonably complex effects like this have a coordinate transformation step anyway; and if they don't, they still need one to handle pixel aspect ratio and downsample factor correctly.</p>
<hr />
<h2 id="effect-details-pixel-aspect-ratio-applying-user-input-in-pixels">Applying User Input In Pixels<a class="headerlink" href="#effect-details-pixel-aspect-ratio-applying-user-input-in-pixels" title="Permanent link">&para;</a></h2>
<p>After Effects does all of its stretching horizontally so as to not to introduce unnecessary field interpolations; when pixels are used as a unit, we think of them as vertical pixels.</p>
<hr />
<h2 id="effect-details-pixel-aspect-ratio-test-test-test">Test Test Test!<a class="headerlink" href="#effect-details-pixel-aspect-ratio-test-test-test" title="Permanent link">&para;</a></h2>
<p>Test at 1/2, 1/4, and custom resolutions and compare the output. Use an anamorphic (2:1) pixel aspect ratio composition to track down bugs in pixel aspect ratio handling (it really makes them obvious), and be sure to test with different horizontal and vertical downsample factors.</p>
<p>Some developers have reported problems with the downsample factors provided by some "After Effects compatible" plug-in hosts being zero. Check for zero before dividing.</p></section><section class="print-page" id="effect-details-parameters-floating-point-values"><h1 id="effect-details-parameters-floating-point-values-parameters-floating-point-values">Parameters &amp; Floating Point Values<a class="headerlink" href="#effect-details-parameters-floating-point-values-parameters-floating-point-values" title="Permanent link">&para;</a></h1>
<p>We have something to admit to you; for years, even though we've given you 8 bit color values, we've internally used floating point representations behind your back.</p>
<p>That's right, even with over-bright colors, we'd only ever tell you '255, 255, 255'. Yeah, right.</p>
<p>Well, we can't live the lie any longer! Given a color parameter (passed to you by After Effects in your effect's parameter array), this function returns a floating point representation, including any high dynamic range component.</p>
<hr />
<h2 id="effect-details-parameters-floating-point-values-pf_colorparamsuite1">PF_ColorParamSuite1<a class="headerlink" href="#effect-details-parameters-floating-point-values-pf_colorparamsuite1" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetFloatingPoint</code></p>
<p><code>ColorFromColorDef</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PF_Err PF_GetFloatingPointColorFromColorDef(<br/>  PF_ProgPtr         effect_ref,<br/>  const PF_ParamDef  *color_defP,<br/>  PF_PixelFloat      *fp_colorP);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-parameters-floating-point-values-pf_pointparamsuite1">PF_PointParamSuite1<a class="headerlink" href="#effect-details-parameters-floating-point-values-pf_pointparamsuite1" title="Permanent link">&para;</a></h2>
<p>We also provide a way to get floating point values for point parameters.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetFloatingPoint</code></p>
<p><code>ValueFromPointDef</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PF_Err PF_GetFloatingPointValueFromPointDef(<br/>  PF_ProgPtr         effect_ref,<br/>  const PF_ParamDef  *point_defP,<br/>  A_FloatPoint       *fp_pointP);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-parameters-floating-point-values-pf_angleparamsuite1">PF_AngleParamSuite1<a class="headerlink" href="#effect-details-parameters-floating-point-values-pf_angleparamsuite1" title="Permanent link">&para;</a></h2>
<p>New in CS6.0.2, we now provide a way to get floating point values for angle parameters.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetFloatingPoint</code></p>
<p><code>ValueFromAngleDef</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PF_Err PF_GetFloatingPointValueFromAngleDef(<br/>  PF_ProgPtr         effect_ref,<br/>  const PF_ParamDef  *angle_defP,<br/>  A_FloatLong        *fp_valueP);</pre></p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-details-parameter-supervision"><h1 id="effect-details-parameter-supervision-parameter-supervision">Parameter Supervision<a class="headerlink" href="#effect-details-parameter-supervision-parameter-supervision" title="Permanent link">&para;</a></h1>
<p>Supervision means dynamically changing the values of some parameters based on the values of others. To supervise a parameter, set <a href="#effect-basics-pf_paramdef-pf_paramdef">PF_ParamFlag_SUPERVISE</a> before adding it during <em>PF_Cmd_PARAM_SETUP</em>. Whenever it is changed, you will receive <a href="#effect-basics-command-selectors-messaging">PF_Cmd_USER_CHANGED_PARAM</a>. The index (into the plug-in's parameter array) of the changed parameter is sent in the PF_UserChangedParamExtra (extra) param. During <em>PF_Cmd_USER_CHANGED_PARAM</em>, you may change the values <em>and</em> appearance of any of your parameters.</p>
<hr />
<h2 id="effect-details-parameter-supervision-updating-parameter-ui">Updating Parameter UI<a class="headerlink" href="#effect-details-parameter-supervision-updating-parameter-ui" title="Permanent link">&para;</a></h2>
<p>If you set <code>PF_ParamFlag_SUPERVISE</code> on any parameter, After Effects will send you <em>PF_Cmd_UPDATE_PARAMS_UI</em>, just as if you had set PF_OutFlag_SEND_UPDATE_PARAMS_UI.</p>
<p>During <em>PF_Cmd_UPDATE_PARAMS_UI</em>, you may only change the appearance and enable state of parameters. Use <code>PF_UpdateParamUI()</code> from <a href="#effect-details-parameter-supervision-pf_paramutilsuite3">PF_ParamUtilSuite3</a> to update the UI, passing it a <em>copy</em> of the parameter you wish to modify. Do <em>not</em> attempt to modify the original. It is not necessary to set <code>PF_OutFlag_REFRESH_UI</code>; <code>PF_UpdateParamUI()</code> handles that for you.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the only way to update the UI of <code>PF_PUI_STD_CONTROL_ONLY</code> parameters.</p>
</div>
<hr />
<h2 id="effect-details-parameter-supervision-updating-parameter-values">Updating Parameter Values<a class="headerlink" href="#effect-details-parameter-supervision-updating-parameter-values" title="Permanent link">&para;</a></h2>
<p>A parameter's value (not just UI) can be modified during <a href="#effect-basics-command-selectors-messaging">PF_Cmd_USER_CHANGED_PARAM</a> and during <a href="#effect-basics-command-selectors-messaging">PF_Cmd_EVENT</a> (<em>PF_Event_DO_CLICK</em>, <em>PF_Event_DRAG</em>, &amp; <em>PF_Event_KEYDOWN</em>). After Effects will not honor changes made at other times.</p>
<p>When changing parameter <em>values</em> (and not just the UI), modify the original parameter, and set <code>PF_Paramdef.uu.change_flags</code> to <code>PF_ChangeFlag_CHANGED_VALUE</code>.</p>
<p>This change will be also update the UI, and will be undoable by the user. Note that <code>PF_ChangeFlag_CHANGED_VALUE</code> isn't supported for layer parameters.</p>
<p>This suite is provided to give effect plug-ins some access to their parameter streams, without requiring AEGP suite usage. At least some of these functions are provided by several third-party hosts. These functions are especially handy for effects with supervised parameters.</p>
<hr />
<h2 id="effect-details-parameter-supervision-pf_paramutilsuite3">PF_ParamUtilSuite3<a class="headerlink" href="#effect-details-parameter-supervision-pf_paramutilsuite3" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_UpdateParamUI</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PF_UpdateParamUI(<br/>  PF_ProgPtr         effect_ref,<br/>  PF_ParamIndex      param_index,<br/>  const PF_ParamDef  *defP);</pre></p>
<p>Force After Effects to refresh the parameter's UI, in the effect controls palette.</p>
<p>Starting in CC 2014, After Effects will now honor a change to a custom UI height. Simply change the ui_height of your custom UI PF_ParamDef and then call PF_UpdateParamUI.</p>
<p>The effect's custom UI height will be updated in the Effect Control Window.</p>
<p>Starting in CS6, when a plug-in disables a parameter, we now save that state in the UI flags so that the plug-in can check that flag in the future to see if it is disabled.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Never pass param[0] to this function.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetCurrentState</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PF_GetCurrentState(<br/>  PF_ProgPtr     effect_ref,<br/>  PF_ParamIndex  param_index,<br/>  const A_Time   *startPT0,<br/>  const A_Time   *durationPT0,<br/>  PF_State       *stateP);</pre></p>
<p>This API, combined with <code>PF_AreStatesIdentical</code> below, lets you determine if a set of inputs (either layers, other properties, or both) are different between when you first called <code>PF_GetCurrentState</code> and a current call, so it can be used for caching. You can specify a range of time to consider or all of time.</p>
<p>Updated in CS6 to add <code>param_index</code>, <code>startPT0</code>, and <code>durationPT0</code>. Pre-defined constants for <code>param_index</code> are as follows:</p>
<ul>
<li><code>PF_ParamIndex_CHECK_ALL</code> - check every parameter, including every layer referred to by a layer parameter.</li>
<li><code>PF_ParamIndex_CHECK_ALL_EXCEPT_LAYER_PARAMS</code> - omit all layers. Pass a specific layer parameter index to include that as the only layer parameter tested.</li>
<li><code>PF_ParamIndex_CHECK_ALL_HONOR_EXCLUDE</code> - Similar to <code>CHECK_ALL</code>, but honor <code>PF_ParamFlag_EXCLUDE_FROM_HAVE_INPUTS_CHANGED</code>.</li>
</ul>
<p>Passing in NULL for both start and duration indicates all time.</p>
<p>For effects that do simulation across time and therefore set <code>PF_OutFlag2_AUTOMATIC_WIDE_TIME_INPUT</code>, when you ask about a time range, it will be expanded to include any times needed to produce that range.</p>
<p>Populates a <code>PF_State</code>, an opaque data type used as a receipt for the current state of the effect's parameters (the PF_State is used in our internal frame caching database).</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_AreStatesIdentical</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PF_AreStatesIdentical(<br/>  PF_ProgPtr      effect_ref,<br/>  const PF_State  *state1P,<br/>  const PF_State  *state2P,<br/>  A_Boolean       *samePB);</pre></p>
<p>New in CS6. Compare two different states, retrieved using <code>PF_GetCurrentState</code>, above.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_HasParamChanged</code></p>
</td>
<td colspan="1" rowspan="1">
<p>No longer supported in <code>PFParamUtilsSuite3</code>.</p>
<p><pre lang="cpp">PF_HasParamChanged(<br/>  PF_ProgPtr     effect_ref,<br/>  const          PF_State *stateP,<br/>  PF_ParamIndex  param_index,<br/>  PF_Boolean     *changedPB);</pre></p>
<p>Given a PF_State, passes back true if any of the tested parameters differ from the saved state. Contrary to the name, the call does not provide a way to test a single parameter.</p>
<p>At a minimum, all non-layer parameters will be tested. For finer granularity to test a specific set of parameters, use <code>PF_HaveInputsChangedOverTimeSpan</code> below instead.</p>
<p>Pre-defined constants for <code>param_index</code> are as follows:</p>
<ul>
<li><code>PF_ParamIndex_CHECK_ALL</code> - check every parameter, including every layer referred to by a layer parameter.</li>
<li><code>PF_ParamIndex_CHECK_ALL_EXCEPT_LAYER_PARAMS</code> - omit all layers. Pass a specific layer parameter index to include that as the only layer parameter tested.</li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_HaveInputsChangedOverTimeSpan</code></p>
</td>
<td colspan="1" rowspan="1">
<p>No longer supported in <code>PFParamUtilsSuite3</code>. Use <code>PF_AreStatesIdentical()</code> instead.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_IsIdenticalCheckout</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PF_IsIdenticalCheckout(<br/>  PF_ProgPtr     effect_ref,<br/>  PF_ParamIndex  param_index,<br/>  A_long         what_time1,<br/>  A_long         time_step1,<br/>  A_u_long       time_scale1,<br/>  A_long         what_time2,<br/>  A_long         time_step2,<br/>  A_u_long       time_scale2,<br/>  PF_Boolean     *identicalPB);</pre></p>
<p>Returns <code>TRUE</code> if a parameter's value is the same at the two passed times. Note: the times need not be contiguous; there could be different intervening values.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_FindKeyframeTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PF_FindKeyframeTime(<br/>  PF_ProgPtr     effect_ref,<br/>  PF_ParamIndex  param_index,<br/>  A_long         what_time,<br/>  A_u_long       time_scale,<br/>  PF_TimeDir     time_dir,<br/>  PF_Boolean     *foundPB,<br/>  PF_KeyIndex    *key_indexP0,<br/>  A_long         *key_timeP0,<br/>  A_u_long       *key_timescaleP0);</pre></p>
<p>Searches (in the specified direction) for the next keyframe in the parameter's stream. The last three parameters are optional.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetKeyframeCount</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PF_GetKeyframeCount(<br/>  PF_ProgPtr     effect_ref,<br/>  PF_ParamIndex  param_index,<br/>  PF_KeyIndex    *key_countP);</pre></p>
<p>Returns the number of keyframes in the parameter's stream.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_CheckoutKeyframe</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PF_CheckoutKeyframe(<br/>  PF_ProgPtr     effect_ref,<br/>  PF_ParamIndex  param_index,<br/>  PF_KeyIndex    key_index,<br/>  A_long         *key_timeP0,<br/>  A_u_long       *key_timescaleP0,<br/>  PF_ParamDef    *paramP0);</pre></p>
<p>Checks a keyframe for the specified parameter out of our keyframe database. param_index is zero-based. You can request time, timescale, or neither; useful if you're performing your own motion blur.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_CheckinKeyframe</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PF_CheckinKeyframe(<br/>  PF_ProgPtr   effect_ref,<br/>  PF_ParamDef  *paramP);</pre></p>
<p>All calls to PF_CheckoutKeyframe must be balanced with this check-in, or pain will ensue.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_KeyIndexToTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PF_KeyIndexToTime(<br/>  PF_ProgPtr     effect_ref,<br/>  PF_ParamIndex  param_index,<br/>  PF_KeyIndex    key_indexP,<br/>  A_long         *key_timeP,<br/>  A_u_long       *key_timescaleP);</pre></p>
<p>Returns the time (and timescale) of the specified keyframe.</p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-details-global-sequence-frame-data"><h1 id="effect-details-global-sequence-frame-data-global-sequence-frame-data">Global, Sequence, &amp; Frame Data<a class="headerlink" href="#effect-details-global-sequence-frame-data-global-sequence-frame-data" title="Permanent link">&para;</a></h1>
<p>After Effects allows plug-ins to store data at three scopes: global, sequence, and frame. Consider carefully where you store information; choosing poorly can impact performance, or make your plug-in confusing to the user.</p>
<p>Use global data for information common to all instances of the effect: static variables and data, bitmaps, pointers to other DLLs or external applications. If your effect supports Multi-Frame Rendering, any static or global variables must be free of race conditions (see <a href="#effect-details-multi-frame-rendering-in-ae-what-does-it-mean-for-an-effect-to-be-thread-safe">What does it mean for an effect to be thread-safe?</a> for more information).</p>
<p>Store anything specific to this instance of your plug-in (UI settings, text strings, and any custom data not stored in parameters) in Sequence Data or in the new <a href="#effect-details-multi-frame-rendering-in-ae-compute-cache-for-multi-frame-rendering">Compute Cache For Multi-Frame Rendering</a>.</p>
<p>Frame data is used for information specific to rendering a given frame. This has fallen into disuse, as most machines are capable of loading an entire frame into memory at a time. Of course, your IMAX-generating users will still appreciate any optimizations you can make.</p>
<hr />
<h2 id="effect-details-global-sequence-frame-data-persistence">Persistence<a class="headerlink" href="#effect-details-global-sequence-frame-data-persistence" title="Permanent link">&para;</a></h2>
<p>After Effects saves sequence data in the project file, but not global or frame data. Pointers within sequence data which point to external data are, in all likelihood, invalid upon reopening the project, and must be re-connected. We call this process "flattening" and "unflattening" the sequence data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Compute Cache does not store its contents to the project file. The data stored in the cache must be recreated during render.</p>
</div>
<hr />
<h2 id="effect-details-global-sequence-frame-data-validating-sequence-data">Validating Sequence Data<a class="headerlink" href="#effect-details-global-sequence-frame-data-validating-sequence-data" title="Permanent link">&para;</a></h2>
<p>Careful sequence data validation is important for effects that do simulation across time, where frame N is dependent on frame N-1, and you use a cache of calculated data in your sequence data. If a parameter is changed, certain calculated data may no longer be valid, but it would also be wasteful to blindly recalculate everything after every change.</p>
<p>When asked to render frame N, assuming you have your cached data calculated up to frame N-1, call <code>PF_GetCurrentState()</code> / <code>PF_AreStatesIdentical()</code> from <a href="#effect-details-parameter-supervision-pf_paramutilsuite3">PF_ParamUtilSuite3</a> to see if the cache of calculated data is still valid given the current parameter settings.</p>
<p>The state of all parameters (except those with <a href="#effect-basics-pf_paramdef-parameter-flags">PF_ParamFlag_EXCLUDE_FROM_HAVE_INPUTS_CHANGED</a> set), including layer parameters (including <a href="#effect-basics-pf_paramdef-param-zero">param[0]</a>) are checked over the passed time span.</p>
<p>This is done efficiently, as the change tracking is done with timestamps.</p>
<p>If the inputs have not changed, you can safely use your cache, AND the internal caching system will assume that you have a temporal dependency on the passed range. So if something changes upstream, the host's caches will be properly invalidated automatically.</p>
<p>To test that it is working, apply your effect with one parameter keyframed on every frame. RAM Preview to fill the cache, then change one of the keyframes. The related frame and all dependent frames (e.g. later frames, in the case of a simulation) should lose their cache marks and require re-rendering. Similarly, upstream changes to sources of layer parameters should cause time-selective invalidation of the cache.</p>
<hr />
<h2 id="effect-details-global-sequence-frame-data-flattened-and-unflattened-sequence-data">Flattened And Unflattened Sequence Data<a class="headerlink" href="#effect-details-global-sequence-frame-data-flattened-and-unflattened-sequence-data" title="Permanent link">&para;</a></h2>
<p>If your sequence data references external memory (in pointers or handles), you must flatten and unflatten your data for disk-safe storage. This is analogous to creating your own miniature file format.</p>
<p>Upon receiving <a href="#effect-basics-command-selectors-sequence-selectors">PF_Cmd_SEQUENCE_FLATTEN</a>, put data referenced by pointers into one contiguous block from which you can later recover the old structure.</p>
<p>If your sequence data contains a pointer to a long, allocate 4 bytes in which to store the flattened data. You must handle platform-specific byte ordering.</p>
<p>Remember, your users (the ones who bought two copies of your plug-in, anyway) may want the same project to work on macOS and Windows.</p>
<p>After Effects sends <a href="#effect-basics-command-selectors-sequence-selectors">PF_Cmd_SEQUENCE_RESETUP</a> when the data is reloaded, for either flat or unflat data.</p>
<p>Use a flag at a common offset within both structures to indicate the data's state.</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-2"><span class="w">    </span><span class="n">A_char</span><span class="o">*</span><span class="w">    </span><span class="n">messageZ</span><span class="p">;</span>
</span><span id="__span-0-3"><span class="w">    </span><span class="n">PF_FpLong</span><span class="w">  </span><span class="n">big_numF</span><span class="p">;</span>
</span><span id="__span-0-4"><span class="w">    </span><span class="kt">void</span><span class="o">*</span><span class="w">      </span><span class="n">temp_storage</span><span class="p">;</span>
</span><span id="__span-0-5"><span class="p">}</span><span class="w"> </span><span class="n">non_flat_data</span><span class="p">;</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-8"><span class="w">    </span><span class="kt">char</span><span class="w">       </span><span class="n">message</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
</span><span id="__span-0-9"><span class="w">    </span><span class="n">PF_FpLong</span><span class="w">  </span><span class="n">big_numF</span><span class="p">;</span>
</span><span id="__span-0-10"><span class="w">    </span><span class="n">A_Boolean</span><span class="w">  </span><span class="n">big_endianB</span><span class="p">;</span>
</span><span id="__span-0-11"><span class="p">}</span><span class="w"> </span><span class="n">flat_data</span><span class="p">;</span>
</span></code></pre></div>
<hr />
<h2 id="effect-details-global-sequence-frame-data-resizing-sequence-data">Resizing Sequence Data<a class="headerlink" href="#effect-details-global-sequence-frame-data-resizing-sequence-data" title="Permanent link">&para;</a></h2>
<p>During <a href="#effect-basics-command-selectors-sequence-selectors">PF_Cmd_SEQUENCE_SETUP</a>, allocate a handle for data specific to this instance of your effect.</p>
<p>You may modify the contents, but not the size, of the sequence data during any selector.</p>
<p>You may resize the sequence data handle only during the following selectors:</p>
<ul>
<li><code>PF_Cmd_AUDIO_SETUP</code></li>
<li><code>PF_Cmd_AUDIO_SETDOWN</code></li>
<li><code>PF_Cmd_FRAME_SETUP</code></li>
<li><code>PF_Cmd_FRAME_SETDOWN</code></li>
<li><code>PF_Cmd_AUDIO_RENDER</code></li>
<li><code>PF_Cmd_RENDER</code></li>
<li><code>PF_Cmd_SEQUENCE_SETUP</code></li>
<li><code>PF_Cmd_SEQUENCE_SETDOWN</code></li>
<li><code>PF_Cmd_SEQUENCE_FLATTEN</code></li>
<li><code>PF_Cmd_SEQUENCE_RESETUP</code></li>
<li><code>PF_Cmd_DO_DIALOG</code></li>
</ul>
<hr />
<h2 id="effect-details-global-sequence-frame-data-accessing-sequence_data-at-render-time-with-multi-frame-rendering">Accessing sequence_data at Render Time with Multi-Frame Rendering<a class="headerlink" href="#effect-details-global-sequence-frame-data-accessing-sequence_data-at-render-time-with-multi-frame-rendering" title="Permanent link">&para;</a></h2>
<p>When enabling Multi-Frame Rendering on an effect, the <code>sequence_data</code> object will be read-only/const during Render and accessible on each render thread via the <code>PF_EffectSequenceDataSuite1</code> suite.</p>
<h3 id="effect-details-global-sequence-frame-data-pf_effectsequencedatasuite1">PF_EffectSequenceDataSuite1<a class="headerlink" href="#effect-details-global-sequence-frame-data-pf_effectsequencedatasuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetConstSequenceData</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the read-only const sequence_data object for a rendering thread when Multi-Frame Rendering is enabled for an effect.</p>
<p><pre lang="cpp">PF_Err(*PF_GetConstSequenceData)(<br/>  PF_ProgPtr effect_ref,<br/>  PF_ConstHandle *sequence_data);</pre></p>
</td>
</tr>
</tbody>
</table>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-1-1"><span class="k">static</span><span class="w"> </span><span class="n">PF_Err</span><span class="w"> </span><span class="nf">Render</span><span class="p">(</span>
</span><span id="__span-1-2"><span class="w">    </span><span class="n">PF_InData</span><span class="w">   </span><span class="o">*</span><span class="n">in_dataP</span><span class="p">,</span>
</span><span id="__span-1-3"><span class="w">    </span><span class="n">PF_OutData</span><span class="w">  </span><span class="o">*</span><span class="n">out_dataP</span><span class="p">,</span>
</span><span id="__span-1-4"><span class="w">    </span><span class="n">PF_ParamDef</span><span class="w"> </span><span class="o">*</span><span class="n">params</span><span class="p">[],</span>
</span><span id="__span-1-5"><span class="w">    </span><span class="n">PF_LayerDef</span><span class="w"> </span><span class="o">*</span><span class="n">output</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-1-6"><span class="p">{</span>
</span><span id="__span-1-7"><span class="w">    </span><span class="n">PF_ConstHandle</span><span class="w"> </span><span class="n">seq_handle</span><span class="p">;</span>
</span><span id="__span-1-8">
</span><span id="__span-1-9"><span class="w">    </span><span class="n">AEFX_SuiteScoper</span><span class="o">&lt;</span><span class="n">PF_EffectSequenceDataSuite1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">seqdata_suite</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-1-10"><span class="w">        </span><span class="n">AEFX_SuiteScoper</span><span class="o">&lt;</span><span class="n">PF_EffectSequenceDataSuite1</span><span class="o">&gt;</span><span class="p">(</span>
</span><span id="__span-1-11"><span class="w">            </span><span class="n">in_dataP</span><span class="p">,</span>
</span><span id="__span-1-12"><span class="w">            </span><span class="n">kPFEffectSequenceDataSuite</span><span class="p">,</span>
</span><span id="__span-1-13"><span class="w">            </span><span class="n">kPFEffectSequenceDataSuiteVersion1</span><span class="p">,</span>
</span><span id="__span-1-14"><span class="w">            </span><span class="n">out_dataP</span><span class="p">);</span>
</span><span id="__span-1-15">
</span><span id="__span-1-16"><span class="w">    </span><span class="n">PF_ConstHandle</span><span class="w"> </span><span class="n">const_seq</span><span class="p">;</span>
</span><span id="__span-1-17"><span class="w">    </span><span class="n">seqdata_suite</span><span class="o">-&gt;</span><span class="n">PF_GetConstSequenceData</span><span class="p">(</span><span class="n">in_data</span><span class="o">-&gt;</span><span class="n">effect_ref</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">const_seq</span><span class="p">);</span>
</span><span id="__span-1-18">
</span><span id="__span-1-19"><span class="w">    </span><span class="c1">// cast const_seq to the type used when storing to sequence_data</span>
</span><span id="__span-1-20">
</span><span id="__span-1-21"><span class="w">    </span><span class="c1">// rest of render function code...</span>
</span><span id="__span-1-22"><span class="p">}</span>
</span></code></pre></div></section><section class="print-page" id="effect-details-arbitrary-data-parameters"><h1 id="effect-details-arbitrary-data-parameters-arbitrary-data-parameters">Arbitrary Data Parameters<a class="headerlink" href="#effect-details-arbitrary-data-parameters-arbitrary-data-parameters" title="Permanent link">&para;</a></h1>
<p>Some values are not adequately represented by After Effects existing parameter types. You can create and register any data for interpolation by After Effects, by creating parameters of arbitrary data type, or "arb data". You can rely on our interpolation engine and parameter management, without having to force your data into a pre-defined parameter type.</p>
<p>We've created a new messaging structure for custom data types, which are easily conceptualized as member (and friend) functions of a C++ class. You must respond to all selectors detailed here if you use arb data.</p>
<p>These functions deal with custom data structure management. Your arb data will be unloaded and reloaded at the user's whim; provide disk-safe flatten and unflatten functions.</p>
<hr />
<h2 id="effect-details-arbitrary-data-parameters-arbitrary-data-selectors">Arbitrary Data Selectors<a class="headerlink" href="#effect-details-arbitrary-data-parameters-arbitrary-data-selectors" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Selector</p>
</th>
<th colspan="1" rowspan="1">
<p>Response</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Arbitrary_NEW_FUNC</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Allocate, populate, and return a handle to a new instance of your arb data.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Arbitrary_DISPOSE_FUNC</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Free and destroy an instance of your arbitrary data type.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Arbitrary_COPY_FUNC</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Make a copy of an existing instance. You will be passed two handles, but only the source handle contains a valid instance. You must create a new instance, copy the values from the source, and put it in the destination handle. If you are passed a NULL handle, create a default instance of your arb data.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Arbitrary_FLAT_SIZE_FUNC</code></p>
</td>
<td colspan="1" rowspan="1">
<p>You'll be passed a handle to an instance of your data type, and a variable in which you return the size of a flattened version of that instance.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Arbitrary_FLATTEN_FUNC</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Flatten the instance you're passed, and place it in the supplied buffer. The buffer will be the size you reported in response to <code>PF_Arbitrary_FLAT_SIZE_FUNC</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Arbitrary_UNFLATTEN_FUNC</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Unpack the buffer into an instance of your arbitrary data type, and put in the handle which you've been passed.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Arbitrary_INTERP_FUNC</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Your interpolation function is passed three handles to instances of your arbitrary data type; one containing initial values (0), one final values (1), and a third to hold your interpolated data (somewhere between 0 and 1). You are also passed a float indicating where, between 0 and 1, your interpreted value should be.</p>
<p>Allocate an instance and fill it with interpolated data. Then put the interpolated instance into the handle you've been passed. The velocity curves have already been accounted for when the normalized time value was calculated.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Never check out parameters if the <a href="#effect-basics-pf_indata-pf_indata-members">in_data&gt;effect_ref</a> is NULL.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Arbitrary_COMPARE_FUNC</code></p>
</td>
<td colspan="1" rowspan="1">
<p>You are passed two instances of your arbitrary data, and a pointer to a comparison result. Populate the result with one of the values for <code>PF_ArbCompareResult</code> (see <code>AE_Effect.h</code>) to indicate whether the first was equal to, less than, more than, or simply not equal to the second.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Arbitrary_PRINT_SIZE_FUNC</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Indicate the buffer size you require for printing your parameter's current values by setting <code>print_sizePLu</code> (member of <code>print_size_func_params</code>, part of the <code>PF_ArbParamsExtra</code> structure).</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Arbitrary_PRINT_FUNC</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Format your arbitrary data for text-based export, and copy the result to the buffer. This can be as elaborate as you would like.</p>
<p>Your plug-in should emulate the cut-and-paste behavior for pasting text representations of parameter settings (into a Microsoft Excel spreadsheet, for example) displayed by the plug-ins shipped with After Effects.</p>
<p>You have a great deal of flexibility in how you format your output.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Arbitrary_SCAN_FUNC</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a buffer of text data (often from the system clipboard), parse it into your arbitrary data format.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-arbitrary-data-parameters-implementing-arbitrary-data">Implementing Arbitrary Data<a class="headerlink" href="#effect-details-arbitrary-data-parameters-implementing-arbitrary-data" title="Permanent link">&para;</a></h2>
<p>In addition to the normal command and event selector, arb data requires another set of host interaction. This is transparent for other parameter types, as After Effects manages their representing data. Writing an arb data plug-in will give you insight into the vast amount of parameter management After Effects performs, and the sequence in which those managing actions occur. It may even cause you to rethink your implementation, and use the parameter types After Effects manages <em>for</em> you.</p>
<p>Instantiate your arb data (using After Effects' memory allocation functions, of course) and point ParamDef.u.arb_d.dephault at it. Populate it with appropriate default values. No value variable is required to set up the parameter; zero it out for safety's sake.</p>
<p>In your plug-in's entry function, include a case for handling <a href="#effect-basics-command-selectors-messaging">PF_Cmd_ARBITRARY_CALLBACK</a>.</p>
<p>Invoke a secondary event handler, <code>HandleArbitrary</code>. It receives a <code>PF_ArbParamsExtra</code> in extra, which in turn contains a <code>PF_FunctionSelector</code> identifying the command sent.</p>
<p>Perhaps After Effects has sent <code>PF_Cmd_ARBITRARY_CALLBACK</code> and the <code>PF_FunctionSelector</code> is <code>PF_Arbitrary_COPY_FUNC</code>. Pointers to a source and destination Arb are provided in <code>PF_ArbParamsExtra.copy_func_params</code>. Allocate a new Arb, and point <code>dest_arbPH</code> at it. If <code>src_arbH</code> is NULL, create a default Arb for <code>dest_arbPH</code>.</p>
<p>The user may select the arb's keyframe data in the Timeline panel, copy it, then switch to another application. You will be sent a <code>PF_Arbitrary_PRINT_SIZE_FUNC</code>; set the size of your output buffer by setting <code>print_sizePLu</code> in the <code>PF_ArbParamsExtra</code>. You'll then receive <code>PF_Arbitrary_PRINT_FUNC</code>; populate the <code>print_bufferPC</code> output buffer with a textual representation of the Arb(s) in question.</p>
<p>Users may paste keyframe data into your Arb's timeline. You will receive <code>PF_Arbitrary_SCAN_FUNC</code>. Create an Arb based on the contents of the character buffer handed to you (its size is indicated in <code>print_sizeLu</code>).</p>
<hr />
<h2 id="effect-details-arbitrary-data-parameters-arbitrary-data-re-entrancy">Arbitrary Data? Re-Entrancy!<a class="headerlink" href="#effect-details-arbitrary-data-parameters-arbitrary-data-re-entrancy" title="Permanent link">&para;</a></h2>
<p>Your plug-in code <em>must</em> be recursively re-entrant to support custom data types, since it could be called by After Effects for numerous reasons. Your plug-in could check out a layer that, in turn, depends on another instance of your effect. Your plug-in's arbitrary data handling code will be triggered by your attempt to check out a (seemingly) unrelated layer. Watch out for calls to C run-time libraries that rely on static values accessed through global variables. If you're not prepared for this eventuality, you'll hang After Effects, and users will curse and punch their monitors.</p>
<hr />
<h2 id="effect-details-arbitrary-data-parameters-when-not-to-access-arbitrary-parameters">When Not To Access Arbitrary Parameters<a class="headerlink" href="#effect-details-arbitrary-data-parameters-when-not-to-access-arbitrary-parameters" title="Permanent link">&para;</a></h2>
<p>If <code>in_data&gt;effect_ref</code> is <code>NULL</code>, do not check out arbitrary parameters.</p>
<hr />
<h2 id="effect-details-arbitrary-data-parameters-changes-during-dialogs">Changes During Dialogs<a class="headerlink" href="#effect-details-arbitrary-data-parameters-changes-during-dialogs" title="Permanent link">&para;</a></h2>
<p>After Effects ignores any changes made to arbitrary data parameters during <code>PF_Cmd_DO_DIALOG</code>.</p>
<p>This is by design; changes made during the display of the options dialog affect the entire effect stream, not just the arbitrary parameter at a given time.</p>
<p>If you must alter your arb's behavior based on these changes, save that information in sequence data and apply it later, often during <code>PF_Cmd_USER_CHANGED_PARAM</code>.</p></section><section class="print-page" id="effect-details-useful-utility-functions"><h1 id="effect-details-useful-utility-functions-useful-utility-functions">Useful Utility Functions<a class="headerlink" href="#effect-details-useful-utility-functions-useful-utility-functions" title="Permanent link">&para;</a></h1>
<h2 id="effect-details-useful-utility-functions-pf_effectuisuite">PF_EffectUISuite<a class="headerlink" href="#effect-details-useful-utility-functions-pf_effectuisuite" title="Permanent link">&para;</a></h2>
<p>Although not strictly concerned with parameters, this suite can change the name of the options button.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_SetOptionsButtonName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Changes the text on the options button in the effect controls palette.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This must be called during <a href="#effect-basics-command-selectors-global-selectors">PF_Cmd_PARAM_SETUP</a>.</p>
</div>
<p><pre lang="cpp">PF_SetOptionsButtonName(<br/>  PF_ProgPtr    effect_ref,<br/>  const A_char  *nameZ);</pre></p>
<p><code>nameZ</code> may be up to <code>A_char[31]</code> in length.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-useful-utility-functions-pf_appsuite">PF_AppSuite<a class="headerlink" href="#effect-details-useful-utility-functions-pf_appsuite" title="Permanent link">&para;</a></h2>
<p>Roughly 437 years ago, when we released After Effects 5.0, we published some useful utility callbacks in PF_AppSuite. They're as useful today as they were then. After Effects has user-controllable UI brightness.</p>
<p>In addition to the <a href="#effect-ui-events-custom-ui-and-drawbot-pf_effectcustomuioverlaythemesuite">PF_EffectCustomUIOverlayThemeSuite</a> for custom UI in effects, use these calls to integrate seamlessly into the After Effects UI.</p>
<p>What better way to shame someone into purchasing a copy of your plug-in than by putting their personal information into a watermark, eh? Or set the cursor to add mask vertices, just to confuse people? Heh heh heh. But that would be wrong.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_AppGetBgColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the current background color.</p>
<p><pre lang="cpp">PF_AppGetBgColor(<br/>  PF_App_Color  bg_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_AppGetColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the color for the specified UI element.</p>
<p>See AE_EffectSuites.h for a complete enumeration of available <code>PF_App_Color</code> values; basically any color in After Effects' UI can be retrieved.</p>
<p>CC adds several new <code>PF_App_ColorType</code> enum values for new elements that can be queried.</p>
<p>Note that in CS6, the color definitions are off from <code>FILL_LIGHT</code> downward.</p>
<p>Use following psuedocode for CS6 only:</p>
<p><pre lang="cpp">GetColor(enum e)<br/>{<br/>  if host_is_CS6 and e &gt;= FILL_LIGHT<br/>  e += 3<br/>    call real GetColor<br/>}<br/><br/>PF_AppGetColor(<br/>  PF_App_ColorType  color_type,<br/>  PF_App_Color      *app_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_AppGetLanguage</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Retrieves the active displayed language of AE UI so plug-in can match. Here are the possible language codes as of CC:</p>
<ul>
<li>Chinese - <code>zh_CN</code></li>
<li>English - <code>en_US</code></li>
<li>French - <code>fr_FR</code></li>
<li>German - <code>de_DE</code></li>
<li>Italian - <code>it_IT</code></li>
<li>Japanese - <code>ja_JP</code></li>
<li>Korean - <code>ko_KR</code></li>
<li>Spanish - <code>es_ES</code></li>
</ul>
<p><pre lang="cpp">PF_AppGetLanguage(<br/>  A_char  lang_tagZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetPersonalInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the user's registration information.</p>
<p><pre lang="cpp">PF_GetPersonalInfo(<br/>  PF_AppPersonalTextInfo  *ptiP);<br/><br/>typedef struct PF_AppPersonalTextInfo {<br/>  A_char  name[PF_APP_MAX_PERS_LEN + 1];<br/>  A_char  org[PF_APP_MAX_PERS_LEN + 1];<br/>  A_char  serial_str[PF_APP_MAX_PERS_LEN+1];<br/>} PF_AppPersonalTextInfo;</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetFontStyleSheet</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves font style sheet information for the fonts used in After Effects' UI.</p>
<p>Trivia: The font used in After Effects' UI starting in 15.0 is Adobe Clean.</p>
<p>Before that, it was Tahoma on Windows and Lucida Grande on macOS X.</p>
<p><pre lang="cpp">PF_GetFontStyleSheet(<br/>  PF_FontStyleSheet  sheet,<br/>  PF_FontName        *font_nameP0,<br/>  A_short            *font_numPS0,<br/>  A_short            *sizePS0,<br/>  A_short            *stylePS0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_SetCursor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the cursor to any of After Effects' cursors. See AE_EffectUI.h for a complete enumeration.</p>
<p>Set to:
- <code>PF_Cursor_NONE</code> to allow After Effects to set the cursor.
- <code>PF_Cursor_CUSTOM</code> if you've used OS-specific calls to change the cursor (After Effects will honor your changes).</p>
<p><pre lang="cpp">PF_SetCursor(<br/>  PF_CursorType  cursor);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_IsRenderEngine</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns TRUE if After Effects is running in watched folder mode, or is a render engine installation.</p>
<p><pre lang="cpp">PF_IsRenderEngine(<br/>  PF_Boolean  *render_enginePB);</pre></p>
<p>As of AE6.5, this function returns <code>TRUE</code> if the installation is the render engine, or if the After Effects is being run with no UI, or if After Effects is in watched folder mode.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_AppColorPickerDialog</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Displays the After Effects color picker dialog (which may be the system color picker, depending on the user's preferences).</p>
<p>Will return <code>PF_Interrupt_CANCEL</code> if user cancels dialog. Returned color is in the project's working color space.</p>
<p><pre lang="cpp">PF_AppColorPickerDialog(<br/>  const A_char         *dialog_titleZ0,<br/>  const PF_PixelFloat  *sample_colorP,<br/>  PF_PixelFloat        *result_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetMouse</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the position of the mouse in the custom UI coordinate space.</p>
<p><pre lang="cpp">PF_GetMouse(<br/>  PF_Point  *pointP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_InvalidateRect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Queue up a <a href="#effect-ui-events-custom-ui-and-drawbot-redrawing">redraw</a> of a specific area of the custom UI for an effect.</p>
<p>Only valid while handling a non-drawing event in the effect.</p>
<p>Specify <code>rectP0</code> as <code>NULL</code> to invalidate the entire window. The redraw will happen at the next available idle moment after returning from the event.</p>
<p>Set the <code>PF_EO_UPDATE_NOW</code> event outflag to update the window immediately after the event returns.</p>
<p><pre lang="cpp">PF_InvalidateRect(<br/>  const PF_ContextH  contextH,<br/>  const PF_Rect*     rectP0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ConvertLocalToGlobal</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Converts from the custom UI coordinate system to global screen coordinates. Use only during custom UI event handling.</p>
<p><pre lang="cpp">PF_ConvertLocalToGlobal(<br/>  const PF_Point  *localP,<br/>  PF_Point        *globalP);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-useful-utility-functions-advanced-appsuite-you-can-do-that">Advanced Appsuite: You Can Do That?!<a class="headerlink" href="#effect-details-useful-utility-functions-advanced-appsuite-you-can-do-that" title="Permanent link">&para;</a></h2>
<p><code>PF_AdvAppSuite</code> was originally designed for some pretty nefarious purposes; an external application was pretending to be an After Effects plug-in, and required ways to notify After Effects of the changes it had made to the project. Our API impurity is your gain.</p>
<hr />
<h2 id="effect-details-useful-utility-functions-pf_advappsuite2">PF_AdvAppSuite2<a class="headerlink" href="#effect-details-useful-utility-functions-pf_advappsuite2" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_SetProjectDirty</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Tells After Effects that the project has been changed since it was last saved.</p>
<p><pre lang="cpp">PF_SetProjectDirty(void);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_SaveProject</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Saves the project to the current path. To save the project elsewhere, use <a href="#aegps-aegp-suites-aegp_projsuite6">AEGP_SaveProjectToPath()</a>.</p>
<p><pre lang="cpp">PF_SaveProject(void);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_SaveBackgroundState</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Stores the background state (After Effects' position in the stacking order of open applications and windows).</p>
<p><pre lang="cpp">PF_SaveBackgroundState(void);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ForceForeground</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Brings After Effects to the front of all currently open applications and windows.</p>
<p><pre lang="cpp">PF_ForceForeground(void);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_RestoreBackgroundState</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Puts After Effects back where it was, in relation to other applications and windows.</p>
<p><pre lang="cpp">PF_RestoreBackgroundState(void);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_RefreshAllWindows</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Forces all After Effects windows to update.</p>
<p>Note that although the Composition panel will be refreshed, this does not guarantee a new frame will be sent to External Monitor Preview plug-ins.</p>
<p><pre lang="cpp">PF_RefreshAllWindows(void);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_InfoDrawText</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Writes text into the After Effects info palette.</p>
<p><pre lang="cpp">PF_InfoDrawText(<br/>  const A_char  *line1Z0,<br/>  const A_char  *line2Z0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_InfoDrawColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Draws the specified color in the After Effects info palette (alpha is ignored).</p>
<p><pre lang="cpp">PF_InfoDrawColor(<br/>  PF_Pixel  color);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_InfoDrawText3</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Writes three lines of text into the After Effects info palette.</p>
<p><pre lang="cpp">PF_InfoDrawText3(<br/>  const A_char  *line1Z0,<br/>  const A_char  *line2Z0,<br/>  const A_char  *line3Z0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_InfoDrawText3Plus</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Writes three lines of text into the After Effects info palette, with portions of the second and third lines left and right justified.</p>
<p><pre lang="cpp">PF_InfoDrawText3Plus(<br/>  const A_char  *line1Z0,<br/>  const A_char  *line2_jrZ0,<br/>  const A_char  *line2_jlZ0,<br/>  const A_char  *line3_jrZ0,<br/>  const A_char  *line3_jlZ0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_AppendInfoText</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Appends characters to the currently-displayed info text.</p>
<p><pre lang="cpp">PF_AppendInfoText(<br/>  const A_char  *appendZ0);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-useful-utility-functions-formatting-time">Formatting Time<a class="headerlink" href="#effect-details-useful-utility-functions-formatting-time" title="Permanent link">&para;</a></h2>
<p><code>PF_AdvTimeSuite</code> provides several functions to match how After Effects displays time. In fact, these are the same functions we use internally.</p>
<h3 id="effect-details-useful-utility-functions-pf_advtimesuite4">PF_AdvTimeSuite4<a class="headerlink" href="#effect-details-useful-utility-functions-pf_advtimesuite4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_FormatTimeActiveItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a time value and scale, returns a formatted string representing that time.</p>
<p>If durationB is <code>TRUE</code>, appropriate units will be appended.</p>
<p><pre lang="cpp">PF_FormatTimeActiveItem(<br/>  A_long      time_valueUL,<br/>  A_u_long    time_scaleL,<br/>  PF_Boolean  durationB,<br/>  A_char      *time_buf);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_FormatTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Contextualizes the formatted time string for the given PF_InData and PF_EffectWorld (i.e., layer time).</p>
<p><pre lang="cpp">PF_FormatTime(<br/>  PF_InData       *in_data,<br/>  PF_EffectWorld  *world,<br/>  A_long          time_valueUL,<br/>  A_u_long        time_scaleL,<br/>  PF_Boolean      durationB,<br/>  A_char          *time_buf);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_FormatTimePlus</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Allows you to select composition or layer time.</p>
<p><pre lang="cpp">PF_FormatTimePlus(<br/>  PF_InData       *in_data,<br/>  PF_EffectWorld  *world,<br/>  A_long          time_valueUL,<br/>  A_u_long        time_scaleL,<br/>  PF_Boolean      comp_timeB,<br/>  PF_Boolean      durationB,<br/>  A_char          *time_buf);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetTimeDisplayPref</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the starting frame number (specified by the user in composition settings), and the composition's time display preferences.</p>
<p>Updated in 14.2 to support higher frame rates.</p>
<p><pre lang="cpp">PF_GetTimeDisplayPref(<br/>  PF_TimeDisplayPref2  *tdp,<br/>  A_long               *starting_num);<br/>  typedef              struct {<br/>  A_char               display_mode;<br/>  A_long               framemax;<br/>  A_long               frames_per_foot;<br/>  A_char               frames_start;<br/>  A_Boolean            nondrop30B;<br/>  A_Boolean            honor_source_timecodeB;<br/>  A_Boolean            use_feet_framesB;<br/>  } PF_TimeDisplayPrefVersion3;</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_TimeCountFrames</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in 15.0. Returns the index of the frame in the current comp.</p>
<p><pre lang="cpp">PF_TimeCountFrames(<br/>  const A_Time  *start_timeTP,<br/>  const A_Time  *time_stepTP,<br/>  A_Boolean     include_partial_frameB,<br/>  A_long        *frame_countL);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-useful-utility-functions-affecting-the-timeline">Affecting The Timeline<a class="headerlink" href="#effect-details-useful-utility-functions-affecting-the-timeline" title="Permanent link">&para;</a></h2>
<p>Long ago, we helped a developer integrate their stand-alone tracker with After Effects by exposing a set of functions to give them some way to notify us of, and be notified of, changes to the timeline.</p>
<p>With the numerous AEGP API calls available, these aren't used much, but they're still available.</p>
<p>Don't confuse this suite with <a href="#aegps-aegp-suites-aegp_itemsuite9">AEGP_ItemSuite</a>.</p>
<hr />
<h3 id="effect-details-useful-utility-functions-pf_advitemsuite1">PF_AdvItemSuite1<a class="headerlink" href="#effect-details-useful-utility-functions-pf_advitemsuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_MoveTimeStep</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Moves current time num_stepsL in the specified direction.</p>
<p><pre lang="cpp">PF_MoveTimeStep(<br/>  PF_InData       *in_data,<br/>  PF_EffectWorld  *world,<br/>  PF_Step         time_dir,<br/>  A_long          num_stepsL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_MoveTimeStepActiveItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Moves num_stepsL in the specified direction, for the active item.</p>
<p><pre lang="cpp">PF_MoveTimeStepActiveItem(<br/>  PF_Step  time_dir,<br/>  A_long   num_stepsL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_TouchActiveItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Tells After Effects that the active item must be updated.</p>
<p><pre lang="cpp">PF_TouchActiveItem (void);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_ForceRerender</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Forces After Effects to rerender the current frame.</p>
<p><pre lang="cpp">PF_ForceRerender(<br/>  PF_InData       *in_data,<br/>  PF_EffectWorld  *world);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_EffectIsActiveOrEnabled</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether the effect which owns the <code>PF_ContextH</code> is currently active or enabled (if it isn't, After Effects won't be listening for function calls from it).</p>
<p><pre lang="cpp">PF_EffectIsActiveOrEnabled(<br/>  PF_ContextH  contextH,<br/>  PF_Boolean   *enabledPB);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-useful-utility-functions-accessing-auxiliary-channel-data">Accessing Auxiliary Channel Data<a class="headerlink" href="#effect-details-useful-utility-functions-accessing-auxiliary-channel-data" title="Permanent link">&para;</a></h2>
<p>Some file types contain more than just pixel data; use <code>PF_ChannelSuite</code> to determine whether such information is present, and the macros in AE_ChannelSuites.h to retrieve it in the format you need.</p>
<hr />
<h3 id="effect-details-useful-utility-functions-pf_channelsuite1">PF_ChannelSuite1<a class="headerlink" href="#effect-details-useful-utility-functions-pf_channelsuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetLayerChannelCount</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the number of auxiliary channels associated with the indexed layer.</p>
<p><pre lang="cpp">PF_GetLayerChannelCount(<br/>  PF_ProgPtr     effect_ref,<br/>  PF_ParamIndex  param_index,<br/>  A_long         *num_channelsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetLayerChannelIndexedRefAndDesc</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves (by index) a reference to, and description of, the specified channel.</p>
<p><pre lang="cpp">PF_GetLayerChannelIndexedRefAndDesc(<br/>  PF_ProgPtr       effect_ref,<br/>  PF_ParamIndex    param_index,<br/>  PF_ChannelIndex  channel_index,<br/>  PF_Boolean       *foundPB,<br/>  PF_ChannelRef    *channel_refP,<br/>  PF_ChannelDesc   *channel_descP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetLayerChannelTypedRefAndDesc</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves an auxiliary channel by type.</p>
<p>Returned information is valid only if <code>foundPB</code> returns <code>TRUE</code>.</p>
<p><pre lang="cpp">PF_GetLayerChannelTypedRefAndDesc(<br/>  PF_ProgPtr      effect_ref,<br/>  PF_ParamIndex   param_index,<br/>  PF_ChannelType  channel_type,<br/>  PF_Boolean      *foundPB,<br/>  PF_ChannelRef   *channel_refP,<br/>  PF_ChannelDesc  *channel_descP);</pre></p>
<p>PF_DataType will be one of the following:</p>
<ul>
<li><code>PF_DataType_FLOAT</code> - 34 bytes</li>
<li><code>PF_DataType_DOUBLE</code> - 38 bytes</li>
<li><code>PF_DataType_LONG</code> - 34 bytes</li>
<li><code>PF_DataType_SHORT</code> - 32 bytes</li>
<li><code>PF_DataType_FIXED_16_16</code> - 34 bytes</li>
<li><code>PF_DataType_CHAR</code> - 31 byte</li>
<li><code>PF_DataType_U_BYTE</code> - 31 byte</li>
<li><code>PF_DataType_U_SHORT</code> - 32 bytes</li>
<li><code>PF_DataType_U_FIXED_16_16</code> - 34 bytes</li>
<li><code>PF_DataType_RGB</code> - 3 bytes</li>
</ul>
<p>PF_ChannelType will be one of the following:</p>
<ul>
<li><code>PF_ChannelType_DEPTH</code></li>
<li><code>PF_ChannelType_NORMALS</code></li>
<li><code>PF_ChannelType_OBJECTID</code></li>
<li><code>PF_ChannelType_MOTIONVECTOR</code></li>
<li><code>PF_ChannelType_BK_COLOR</code></li>
<li><code>PF_ChannelType_TEXTURE</code></li>
<li><code>PF_ChannelType_COVERAGE</code></li>
<li><code>PF_ChannelType_NODE</code></li>
<li><code>PF_ChannelType_MATERIAL</code></li>
<li><code>PF_ChannelType_UNCLAMPED</code></li>
<li><code>PF_ChannelType_UNKNOWN</code>
</li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_CheckoutLayerChannel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the <code>PF_ChannelChunk</code> containing the data associated with the given <code>PF_ChannelRefPtr</code>.</p>
<p><pre lang="cpp">PF_CheckoutLayerChannel(<br/>  PF_ProgPtr        effect_ref,<br/>  PF_ChannelRefPtr  channel_refP,<br/>  long              what_time,<br/>  long              duration,<br/>  unsigned long     time_scale,<br/>  PF_DataType       data_type,<br/>  PF_ChannelChunk   *channel_chunkP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_CheckinLayerChannel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Checks in the <code>PF_ChannelChunk</code>. Always, always, always check the data back in.</p>
<p><pre lang="cpp">PF_CheckinLayerChannel(<br/>  PF_ProgPtr        effect_ref,<br/>  PF_ChannelRefPtr  channel_refP,<br/>  PF_ChannelChunk   *channel_chunkP);</pre></p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-details-motion-blur"><h1 id="effect-details-motion-blur-motion-blur">Motion Blur<a class="headerlink" href="#effect-details-motion-blur-motion-blur" title="Permanent link">&para;</a></h1>
<p>Effects handle their own motion blur, using <a href="#effect-basics-pf_indata-pf_indata-members">PF_InData&gt;shutter_angle</a> along with <a href="#effect-basics-pf_indata-pf_indata-members">PF_InData&gt;shutter_phase</a>.</p>
<p>The plug-in must set <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlag_I_USE_SHUTTER_ANGLE</a> so After Effects knows it needs this information.</p>
<p>They must <a href="#effect-details-interaction-callback-functions-interaction-callback-functions">check out</a> their own parameters at other times to examine their change over the shutter interval.</p>
<p>If the plug-in checks out parameters outside this interval, set <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlag_WIDE_TIME_INPUT</a>.</p>
<p>Doing so allows After Effects to compare the parameters within the sampling interval, and determine if they've changed.</p></section><section class="print-page" id="effect-details-working-with-paths"><h1 id="effect-details-working-with-paths-working-with-paths">Working With Paths<a class="headerlink" href="#effect-details-working-with-paths-working-with-paths" title="Permanent link">&para;</a></h1>
<h2 id="effect-details-working-with-paths-accessing-path-data">Accessing Path Data<a class="headerlink" href="#effect-details-working-with-paths-accessing-path-data" title="Permanent link">&para;</a></h2>
<p>Paths differ from other parameter types, in that their values are not directly accessible. In addition to checking them out and in (like layer parameters), you must use our path data function suites to obtain the details of the path at a given time. See <a href="#effect-details-working-with-paths-pf_pathquerysuite1">PF_PathQuerySuite1</a> and <a href="#effect-details-working-with-paths-pf_pathdatasuite">PF_PathDataSuite</a>. Never use the values present in a path parameter when it's passed to you, without first checking it out; while deleted paths will not be available, further updating is done "lazily" (later); your effect won't see these changes unless it checks out the path.</p>
<hr />
<h2 id="effect-details-working-with-paths-manipulating-path-data">Manipulating Path Data<a class="headerlink" href="#effect-details-working-with-paths-manipulating-path-data" title="Permanent link">&para;</a></h2>
<p>You can also use the <a href="#aegps-aegp-suites-aegp_maskoutlinesuite3">AEGP_MaskOutlineSuite3</a> to manipulate paths. See <a href="#aegps-cheating-effect-usage-of-aegp-suites">Cheating Effect Usage of AEGP Suites</a>. Path parameters are treated as opaque blobs of data; get and set functions must be used to access and manipulate them. Like layer parameters, they must be checked out (and in!) by effects which access them.</p>
<hr />
<h2 id="effect-details-working-with-paths-vertices">Vertices<a class="headerlink" href="#effect-details-working-with-paths-vertices" title="Permanent link">&para;</a></h2>
<p>Path vertices are more complex than simple points. All member variables are PF_FpLongs (doubles), and are in the layer's coordinate space.</p>
<hr />
<h2 id="effect-details-working-with-paths-pf_pathvertex">PF_PathVertex<a class="headerlink" href="#effect-details-working-with-paths-pf_pathvertex" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Member</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code></td>
<td>The location of the vertex.</td>
</tr>
<tr>
<td><code>y</code></td>
<td></td>
</tr>
<tr>
<td><code>tan_in_x</code></td>
<td>The incoming tangent point.</td>
</tr>
<tr>
<td><code>tan_in_y</code></td>
<td></td>
</tr>
<tr>
<td><code>tan_out_x</code></td>
<td>The outgoing tangent point.</td>
</tr>
<tr>
<td><code>tan_out_y</code></td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-working-with-paths-pf_pathdatasuite">PF_PathDataSuite<a class="headerlink" href="#effect-details-working-with-paths-pf_pathdatasuite" title="Permanent link">&para;</a></h2>
<p>This suite provides information about paths (sequences of vertices).</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Description</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PathIsOpen</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns <code>TRUE</code> if the path is not closed (if the beginning and end vertex are not identical).</p>
<p><pre lang="cpp">PF_PathIsOpen(<br/>  PF_ProgPtr         effect_ref0,<br/>  PF_PathOutlinePtr  pathP,<br/>  PF_Boolean         *openPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PathNumSegments</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the number of segments in the path.
N segments means there are segments <code>[0.N-1];</code> segment J is defined by vertex <code>J</code> and <code>J+1</code>.</p>
<p><pre lang="cpp">PF_PathNumSegments(<br/>  PF_ProgPtr         effect_ref0,<br/>  PF_PathOutlinePtr  pathP,<br/>  A_long             *num_segmentsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PathVertexInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the <code>PF_PathVertex</code> for the specified path.</p>
<p>The range of points is <code>[0.num_segments];</code> for closed paths, <code>vertex[0] == vertex[num_segments]</code>.</p>
<p><pre lang="cpp">PF_PathVertexInfo(<br/>  PF_ProgPtr         effect_ref0,<br/>  PF_PathOutlinePtr  pathP,<br/>  A_long             which_pointL,<br/>  PF_PathVertex      *vertexP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PathPrepareSegLength</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This fairly counter-intuitive function informs After Effects that you're going to ask for the length of a segment (using <code>PF_PathGetSegLength</code> below), and it'd better get ready.</p>
<p><code>frequencyL</code> indicates how many times you'd like us to sample the length; our internal effects use 100.</p>
<p><pre lang="cpp">PF_PathPrepareSegLength(<br/>  PF_ProgPtr         effect_ref0,<br/>  PF_PathOutlinePtr  pathP,<br/>  A_long             which_segL,<br/>  A_long             frequencyL,<br/>  PF_PathSegPrepPtr  *lengthPrepPP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PathGetSegLength</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the length of the given segment.</p>
<p><pre lang="cpp">PF_PathGetSegLength(<br/>  PF_ProgPtr         effect_ref0,<br/>  PF_PathOutlinePtr  pathP,<br/>  A_long             which_segL,<br/>  PF_PathSegPrepPtr  *lengthPrepP0,<br/>  PF_FpLong          *lengthPF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PathEvalSegLength</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the location of a point lengthF along the given path segment.</p>
<p><pre lang="cpp">PF_PathEvalSegLength(<br/>  PF_ProgPtr         effect_ref0,<br/>  PF_PathOutlinePtr  pathP,<br/>  PF_PathSegPrepPtr  *lengthPrepPP0,<br/>  A_long             which_segL,<br/>  PF_FpLong          lengthF,<br/>  PF_FpLong          *x,<br/>  PF_FpLong          *y);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PathEvalSegLengthDeriv1</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the location, and the first derivative, of a point <code>lengthF</code> along the given path segment.</p>
<p>If you're not sure why you'd ever need this, don't use it. Math is hard.</p>
<p><pre lang="cpp">PF_PathEvalSegLengthDeriv1(<br/>  PF_ProgPtr         effect_ref0,<br/>  PF_PathOutlinePtr  pathP,<br/>  PF_PathSegPrepPtr  *lengthPrepPP0,<br/>  A_long             which_segL,<br/>  PF_FpLong          lengthF,<br/>  PF_FpLong          *x,<br/>  PF_FpLong          *y,<br/>  PF_FpLong          *deriv1x,<br/>  PF_FpLong          *deriv1y);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PathCleanupSegLength</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Call this when you're finished evaluating that segment length, so After Effects can properly clean up the <code>PF_PathSegPrepPtr</code>.</p>
<p><pre lang="cpp">PF_PathCleanupSegLength(<br/>  PF_ProgPtr         effect_ref0,<br/>  PF_PathOutlinePtr  pathP,<br/>  A_long             which_segL,<br/>  PF_PathSegPrepPtr  *lengthPrepPP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PathIsInverted</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns <code>TRUE</code> if the path is inverted.</p>
<p><pre lang="cpp">PF_PathIsInverted(<br/>  PF_ProgPtr  effect_ref,<br/>  PF_PathID   unique_id,<br/>  PF_Boolean  *invertedB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PathGetMaskMode</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the mode for the given path.</p>
<p><pre lang="cpp">PF_PathGetMaskMode(<br/>  PF_ProgPtr   effect_ref,<br/>  PF_PathID    unique_id,<br/>  PF_MaskMode  *modeP);</pre></p>
<p>Mask mode is one of the following:</p>
<ul>
<li><code>PF_MaskMode_NONE</code></li>
<li><code>PF_MaskMode_ADD</code></li>
<li><code>PF_MaskMode_SUBTRACT</code></li>
<li><code>PF_MaskMode_INTERSECT</code></li>
<li><code>PF_MaskMode_LIGHTEN</code></li>
<li><code>PF_MaskMode_DARKEN</code></li>
<li><code>PF_MaskMode_DIFFERENCE</code></li>
<li><code>PF_MaskMode_ACCUM</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PathGetName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the name of the path (up to <code>PF_MAX_PATH_NAME_LEN</code> long).</p>
<p><pre lang="cpp">PF_PathGetName(<br/>  PF_ProgPtr  effect_ref,<br/>  PF_PathID   unique_id,<br/>  A_char      *nameZ);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-working-with-paths-pf_pathquerysuite1">PF_PathQuerySuite1<a class="headerlink" href="#effect-details-working-with-paths-pf_pathquerysuite1" title="Permanent link">&para;</a></h2>
<p>This suite is used to identify and access the paths associated with the effect's source layer.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_NumPaths</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the number of paths associated with the effect's source layer.</p>
<p><pre lang="cpp">PF_NumPaths(<br/>  PF_ProgPtr  effect_ref,<br/>  A_long      *num_pathsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PathInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the PF_PathID for the specified path.</p>
<p><pre lang="cpp">PF_PathInfo(<br/>  PF_ProgPtr  effect_ref,<br/>  A_long      indexL,<br/>  PF_PathID   *unique_idP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_CheckoutPath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Acquires the PF_PathOutlinePtr for the path at the specified time.</p>
<p><pre lang="cpp">PF_CheckoutPath(<br/>  PF_ProgPtr         effect_ref,<br/>  PF_PathID          unique_id,<br/>  A_long             what_time,<br/>  A_long             time_step,<br/>  A_u_long           time_scale,<br/>  PF_PathOutlinePtr  *pathPP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_CheckinPath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Releases the path back to After Effects. Always do this, regardless of any error conditions encountered.</p>
<p>Every checkout must be balanced by a checkin, or pain will ensue.</p>
<p><pre lang="cpp">PF_CheckinPath(<br/>  PF_ProgPtr         effect_ref,<br/>  PF_PathID          unique_id,<br/>  PF_Boolean         changedB,<br/>  PF_PathOutlinePtr  pathP);</pre></p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-details-accessing-camera-light-information"><h1 id="effect-details-accessing-camera-light-information-accessing-camera-light-information">Accessing Camera &amp; Light Information<a class="headerlink" href="#effect-details-accessing-camera-light-information-accessing-camera-light-information" title="Permanent link">&para;</a></h1>
<p>Using functions provided in the <a href="#aegps-aegp-suites-aegp_pfinterfacesuite1">AEGP_PFInterfaceSuite</a>, effects can access camera and lighting information for the layer to which they're applied; see the Resizer sample.</p>
<p>You can also use many of the other functions from AE_GeneralPlug.h; the possibilities are vast.</p></section><section class="print-page" id="effect-details-color-space-conversion"><h1 id="effect-details-color-space-conversion-color-space-conversion">Color Space Conversion<a class="headerlink" href="#effect-details-color-space-conversion-color-space-conversion" title="Permanent link">&para;</a></h1>
<p>Different pixel formats are useful for different operations. After Effects exposes its internal functions through PF_ColorCallbacksSuite. Here are the supported formats.</p>
<hr />
<h2 id="effect-details-color-space-conversion-pixel-types-for-different-color-spaces">Pixel Types For Different Color Spaces<a class="headerlink" href="#effect-details-color-space-conversion-pixel-types-for-different-color-spaces" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Pixel Type</th>
<th>Data Structure</th>
</tr>
</thead>
<tbody>
<tr>
<td>8 bpc ARGB</td>
<td><pre lang="cpp">typedef struct {<br/>  A_u_char alpha, red, green, blue;<br/>} PF_Pixel8;</pre></td>
</tr>
<tr>
<td>16 bpc ARGB</td>
<td><pre lang="cpp">typedef struct {<br/>  A_u_short alpha, red, green, blue;<br/>} PF_Pixel16;</pre></td>
</tr>
<tr>
<td>32 bpc ARGB</td>
<td><pre lang="cpp">typedef struct {<br/>  PF_FpShort alpha, red, green, blue;<br/>} PF_PixelFloat, PF_Pixel32;</pre></td>
</tr>
<tr>
<td>HLS (Hue, Lightness, Saturation)</td>
<td><pre lang="cpp">typedef PF_Fixed PF_HLS_PIXEL[3]</pre></td>
</tr>
<tr>
<td>YIQ (luminance, in-phase chrominance, quadrature chrominance)</td>
<td><pre lang="cpp">typedef PF_Fixed PF_YIQ_PIXEL[3]</pre></td>
</tr>
</tbody>
</table>
<hr />
<p>Plug-ins can draw on image processing algorithms written for nearly any color space by using the following callback functions.</p>
<h2 id="effect-details-color-space-conversion-color-space-conversion-callbacks">Color Space Conversion Callbacks<a class="headerlink" href="#effect-details-color-space-conversion-color-space-conversion-callbacks" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
<th>Replaces</th>
</tr>
</thead>
<tbody>
<tr>
<td>RGBtoHLS</td>
<td>Given an RGB pixel, returns an HLS (hue, lightness, saturation) pixel. HLS values are scaled from 0 to 1 in fixed point.</td>
<td><code>PF_RGB_TO_HLS</code></td>
</tr>
<tr>
<td>HLStoRGB</td>
<td>Given an HLS pixel, returns an RGB pixel.</td>
<td><code>PF_HLS_TO_RGB</code></td>
</tr>
<tr>
<td>RGBtoYIQ</td>
<td>Given an RGB pixel, returns a YIQ (luminance, inphase chrominance, quadrature chrominance) pixel. Y is 0 to 1 in fixed point, I is -0.5959 to 0.5959 in fixed point, and Q is -0.5227 to 0.5227 in fixed point.</td>
<td><code>PF_RGB_TO_YIQ</code></td>
</tr>
<tr>
<td>YIQtoRGB</td>
<td>Given a YIQ pixel, returns an RGB pixel.</td>
<td><code>PF_YIQ_TO_RGB</code></td>
</tr>
<tr>
<td>Luminance</td>
<td>Given an RGB pixel, returns 100 times its luminance value (0 to 25500).</td>
<td><code>PF_LUMINANCE</code></td>
</tr>
<tr>
<td>Hue</td>
<td>Given an RGB pixel, eturns its hue angle mapped from 0 to 255, where 0 is 0 degrees and 255 is 360 degrees.</td>
<td><code>PF_HUE</code></td>
</tr>
<tr>
<td>Lightness</td>
<td>Given an RGB pixel, returns its lightness value (0 to 255).</td>
<td><code>PF_LIGHTNESS</code></td>
</tr>
<tr>
<td>Saturation</td>
<td>Given an RGB pixel, returns its saturation value (0 to 255).</td>
<td><code>PF_SATURATION</code></td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-details-changing-parameter-orders"><h1 id="effect-details-changing-parameter-orders-changing-parameter-orders-the-nice-way">Changing Parameter Orders, the Nice Way<a class="headerlink" href="#effect-details-changing-parameter-orders-changing-parameter-orders-the-nice-way" title="Permanent link">&para;</a></h1>
<p>It is possible to add or remove parameters from a plug-in, without forcing users to re-apply all instances of that plug-in to use the updated version. However, some advance planning on your part is necessary to allow for such changes. Your users (and technical support staff) will appreciate the effort.</p>
<p>You must first create a parameter array index. During <em>PF_Cmd_PARAM_SETUP</em>, assign index values to each parameter as you add them, using a simple enumeration. The order of enumeration corresponds to the order in which the parameters are registered during <em>PF_Cmd_PARAM_SETUP</em>, which in turn determines the order in which they appear in the Effect Control and Timeline panels.</p>
<p>Create another enumeration for disk IDs. The order of this enumeration must <em>not</em> be changed, though you may add to the end of this list. Note that the order of this list need not correspond with that of the parameter array index. Parameter disk IDs should range from 1 to 9999. Why not zero? Long story...</p>
<p><em>In the early "wild west" days of After Effects plug-in programming, it was fairly common for developers not to bother with setting IDs. After Effects, realizing this, checked the ID of the first parameter added by that effect; if it was zero, it was assumed that the programmer hadn't bothered to ID params; After Effects then assigned each its own ID. This assumption works fine if you never set param IDs, but not so well if you start numbering your IDs from NULL. That's why.</em></p>
<p>Before calling PF_ADD_PARAM(), specify the disk ID in the PF_ParamDef.uu.id field. If no value is specified, After Effects makes parameters sequential starting with 1. The parameter's information is tagged with this ID when saved. In this way, After Effects can still understand that, although your "Foobarocity" slider is now the fourth parameter passed, it's the same parameter as when it was second.</p>
<p>To delete a parameter without forcing re-application, remove the code which creates it and its entry in the parameter array index list. However, <em>do not</em> remove its entry in the disk ID list. To add a new parameter, add an entry in the appropriate location in the parameter array indices list, add the parameter creation code, and append the disk ID to the end of the disk ID enumeration. To re-order, change the parameter array index list and reorder the parameter creation code appropriately.</p>
<hr />
<h2 id="effect-details-changing-parameter-orders-change-defaults-change-ids">Change defaults? Change IDs<a class="headerlink" href="#effect-details-changing-parameter-orders-change-defaults-change-ids" title="Permanent link">&para;</a></h2>
<p>If you don't, if someone saves a project with the old default and then reads it in with the new effect installed, that parameter will change to the new default value.</p>
<p>Presto! Instant support call.</p>
<p>This is another prime use case for <code>PF_ParamFlag_USE_VALUE_FOR_OLD_PROJECTS</code> from <a href="#effect-basics-pf_paramdef-parameter-flags">Parameter Flags</a>.</p></section><section class="print-page" id="effect-details-tips-tricks"><h1 id="effect-details-tips-tricks-tips-tricks">Tips &amp; Tricks<a class="headerlink" href="#effect-details-tips-tricks-tips-tricks" title="Permanent link">&para;</a></h1>
<h2 id="effect-details-tips-tricks-best-practices">Best Practices<a class="headerlink" href="#effect-details-tips-tricks-best-practices" title="Permanent link">&para;</a></h2>
<p>If your prototypes are anything like ours, the first version of your plug-in that runs without crashing differs radically from the version that actually ships.</p>
<p>How your plug-in responds to things like downsampling, errors and exceptions, pixel aspect ratio, out-of-memory situations, and being interrupted while processing determines how usable it is (and how many support requests you'll have to handle).</p>
<hr />
<h2 id="effect-details-tips-tricks-responsiveness">Responsiveness<a class="headerlink" href="#effect-details-tips-tricks-responsiveness" title="Permanent link">&para;</a></h2>
<p>Make your plug-ins as responsive as possible using <code>PF_ABORT()</code> and <code>PF_PROGRESS()</code> from <a href="#effect-details-interaction-callback-functions-interaction-callbacks">Interaction Callbacks</a>.</p>
<p>We actually test all our effects for interrupt-ability; you'd be surprised how cranky users can get waiting for your pokey effect to finish processing a film resolution sequence!</p>
<p>After Effects' iteration functions inherently provide this functionality; you don't need to worry about calling the above functions from within your pixel processing functions.</p>
<hr />
<h2 id="effect-details-tips-tricks-make-your-effect-easy-to-find">Make Your Effect Easy To Find<a class="headerlink" href="#effect-details-tips-tricks-make-your-effect-easy-to-find" title="Permanent link">&para;</a></h2>
<p>It's possible to have your effect show up in the "Effects &amp; Presets" palette when users search for something other than the plug-in's name.</p>
<p>Apply your effect (leaving the settings at default, unless you're very certain the user will want something different when they search for the given term), and select "Save selection as animation preset" from the effect controls palette.</p>
<p>Save it to the name by which you want users to find the plug-in.</p>
<p>Have your plug-in's installer put the resultant .ffx file into the \Presets directory, next to the After Effects executable.</p>
<p>Your preset will show up when users search for the name to which it was saved.</p>
<hr />
<h2 id="effect-details-tips-tricks-sampling-pixels-at-xy">Sampling Pixels At (x,y)<a class="headerlink" href="#effect-details-tips-tricks-sampling-pixels-at-xy" title="Permanent link">&para;</a></h2>
<p>Sometimes, instead of just processing every pixel, you'll want to get to a specific offset within the input frame. Below is one way to sample the pixel at a given (x,y) location; similar code could be used to write to the given location.</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">PF_Pixel</span><span class="w"> </span><span class="o">*</span><span class="nf">sampleIntegral32</span><span class="p">(</span><span class="n">PF_EffectWorld</span><span class="w"> </span><span class="o">&amp;</span><span class="n">def</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">){</span>
</span><span id="__span-0-2"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">PF_Pixel</span><span class="o">*</span><span class="p">)((</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">def</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-0-3"><span class="w">        </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">def</span><span class="p">.</span><span class="n">rowbytes</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-0-4"><span class="w">        </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">PF_Pixel</span><span class="p">)));</span>
</span><span id="__span-0-5"><span class="p">}</span>
</span><span id="__span-0-6">
</span><span id="__span-0-7"><span class="n">PF_Pixel16</span><span class="w"> </span><span class="o">*</span><span class="nf">sampleIntegral64</span><span class="p">(</span><span class="n">PF_EffectWorld</span><span class="w"> </span><span class="o">&amp;</span><span class="n">def</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">){</span>
</span><span id="__span-0-8"><span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">PF_WORLD_IS_DEEP</span><span class="p">(</span><span class="o">&amp;</span><span class="n">def</span><span class="p">));</span>
</span><span id="__span-0-9"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">PF_Pixel16</span><span class="o">*</span><span class="p">)((</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">def</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-0-10"><span class="w">        </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">def</span><span class="p">.</span><span class="n">rowbytes</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-0-11"><span class="w">        </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">PF_Pixel16</span><span class="p">)));</span>
</span><span id="__span-0-12"><span class="p">}</span>
</span></code></pre></div>
<p>Special thanks to Paul Miller for answering this question.</p>
<hr />
<h2 id="effect-details-tips-tricks-wheres-the-center-of-a-pixel">Where's The Center Of A Pixel?<a class="headerlink" href="#effect-details-tips-tricks-wheres-the-center-of-a-pixel" title="Permanent link">&para;</a></h2>
<p>Deeeeeep, man. After Effects rotates around the upper left corner of the upper left pixel when the anchor point (see User Documentation) is (0,0).</p>
<p>However, the subpixel sample and area sample callbacks actually treat (.0, .0) as a direct hit. To compensate for this, subtract 0.5 from x and y values before calling those functions.</p>
<p>The matrix functions (<code>transform_world</code> from <a href="#effect-details-graphics-utility-suites-pf_worldtransformsuite1">PF_WorldTransformSuite1</a>) don't have this problem.</p>
<p>When translating an image by a subpixel amount, make the output layer one pixel wider than its input, and leave the origin at (0,0).</p>
<hr />
<h2 id="effect-details-tips-tricks-text-layer-origin">Text Layer Origin<a class="headerlink" href="#effect-details-tips-tricks-text-layer-origin" title="Permanent link">&para;</a></h2>
<p>Almost all layer types have their origin in the upper-left corner. Not so with text layers!</p>
<p>A text layer origin by default is at the bottom-left baseline position of the first character. You can see this if you create a text item and then pick the layer so the anchor point shows up.</p>
<p>Look at where the default anchor point location is. The transform is not at the corner of the layer rectangle.</p>
<hr />
<h2 id="effect-details-tips-tricks-clean-slate">Clean Slate<a class="headerlink" href="#effect-details-tips-tricks-clean-slate" title="Permanent link">&para;</a></h2>
<p>You don't necessarily begin effect processing with a clean output slate. Our Gaussian blur filter, in an effort to do so, performs the following before rendering:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-1-1"><span class="n">src_rect</span><span class="p">.</span><span class="n">left</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">in_data</span><span class="o">&gt;</span><span class="n">output_origin_x</span><span class="p">;</span>
</span><span id="__span-1-2"><span class="n">src_rect</span><span class="p">.</span><span class="n">right</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">src_rect</span><span class="p">.</span><span class="n">left</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">input</span><span class="o">&gt;</span><span class="n">width</span><span class="p">;</span>
</span><span id="__span-1-3"><span class="n">src_rect</span><span class="p">.</span><span class="n">top</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">in_data</span><span class="o">&gt;</span><span class="n">output_origin_y</span><span class="p">;</span>
</span><span id="__span-1-4"><span class="n">src_rect</span><span class="p">.</span><span class="n">bottom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">src_rect</span><span class="p">.</span><span class="n">top</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">input</span><span class="o">&gt;</span><span class="n">height</span><span class="p">;</span>
</span><span id="__span-1-5">
</span><span id="__span-1-6"><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PF_FILL</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">);</span>
</span><span id="__span-1-7">
</span><span id="__span-1-8"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-9"><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PF_COPY</span><span class="p">(</span><span class="o">&amp;</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="n">u</span><span class="p">.</span><span class="n">ld</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">src_rect</span><span class="p">);</span>
</span><span id="__span-1-10"><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="effect-details-tips-tricks-caching-behavior">Caching Behavior<a class="headerlink" href="#effect-details-tips-tricks-caching-behavior" title="Permanent link">&para;</a></h2>
<p>After Effects provides numerous ways to specify caching behavior. <code>PF_OutFlag_NON_PARAM_VARY</code>, <code>PF_OutFlag_WIDE_TIME_INPUT</code>, <code>PF_OutFlag_I_USE_SHUTTER_ANGLE</code>, <code>PF_OutFlag_I_SYNTHESIZE_AUDIO</code>, <code>PF_OutFlag2_I_USE_3D_CAMERA</code>, and <code>PF_OutFlag2_I_USE_3D_LIGHTS</code> (all from <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlags</a>) all influence caching decisions.</p>
<p>Supporting <a href="#effect-basics-pf_outdata-pf_outflags">dynamic outflags</a> can greatly improve performance, preventing After Effects from invalidating your effect's cache as aggressively as it otherwise would.</p>
<p>Confirm that your plug-in performs well with different After Effects cache settings. Does your plug-in get called to update as often as expected, or does After Effects think it has valid pixels when you think it doesn't?</p>
<hr />
<h2 id="effect-details-tips-tricks-global-performance-cache-consideratons">Global Performance Cache Consideratons<a class="headerlink" href="#effect-details-tips-tricks-global-performance-cache-consideratons" title="Permanent link">&para;</a></h2>
<p>With the new caching in CS6, you may need to clear cached frames after changing your effect's rendering, so that frames rendered and stored in the cache prior to the change will not be reused. To do so manually during development:</p>
<ol>
<li>In Preferences &gt; Media &amp; Disk Cache, disable the Disk Cache</li>
<li>Click "Empty Disk Cache" just to be sure (disabling the Disk Cache in step 1 only disables the <em>writing</em> of disk cache, not necessarily the usage)</li>
<li>Relaunch</li>
</ol>
<p>If you ever encounter a glitch, it likely a legitimate bug in your effect, such as improper rectangle handling in SmartFX.</p>
<p>On the other hand, if you fix a rendering bug in your plug-in and ship an update, you can't expect all users will empty their disk caches. A user may have a disk cache of the buggy frame and it needs to be invalidated. What to do? Update your plug-in's effect version. This value (and the AE build number) is part of the cache key, so if you update it any frames cached containing content from your plug-in will no longer match.</p>
<hr />
<h2 id="effect-details-tips-tricks-some-thoughts-on-time-from-a-long-time-developer">Some Thoughts On Time From A Long-Time Developer<a class="headerlink" href="#effect-details-tips-tricks-some-thoughts-on-time-from-a-long-time-developer" title="Permanent link">&para;</a></h2>
<p>Stoney Ballard put together the following summary of how time works with effects; you may find it helpful.</p>
<p>There are five <code>in_data</code> parameters that describe time to a filter:</p>
<ul>
<li><code>current_time</code></li>
<li><code>time_step</code></li>
<li><code>local_time_step</code></li>
<li><code>total_time</code></li>
<li><code>time_scale</code></li>
</ul>
<p>Their values are dependent on:</p>
<ul>
<li>The frame being rendered</li>
<li>The duration of the layer and composition The frame rate of the comp</li>
<li>Any Time Stretch Any Time Remapping</li>
<li>The time behavior of an outer composition (one enclosing the composition with the layer being filtered)</li>
<li>The setting of the "Preserve frame rate when nested or in render queue" (PFR) switch</li>
</ul>
<p>The frame being rendered affects current_time. It is expressed in the local (layer) time system. If the PFR switch is off, current_time may be any non-negative value. If on, it will be restricted to a multiple of time_step and local_time_step. Layer duration affects only total_time. Comp duration is a factor only when Time Remapping (TR) is on. In that case, total_time is the larger of layer duration and composition duration. Composition frame rate affects only the time_scale. Time Stretch affects only time_step and local_time_step. If the time stretch is negative, these values are negative. Even if the layer's duration (as seen in</p>
<p>the comp) changes, total_time remains unaffected. This works as if Time Stretch was <em>above</em> a filter, but <em>below</em> an outer comp. PFR does not alter the effect of Time Stretch. Time Stretch is different than an outer comp, since it affects both step params equally, while an outer comp affects only time_step.</p>
<p>Time Remapping happens <em>below</em> the filter, so that it does not affect the time params other than the total_time. When TR is on, the layer is lengthened to the same as the comp (but never shortened), regardless of how much time it actually takes, or where in the comp the layer is. This may cause total_time to be larger. It has nothing to do with the actual time map, just whether or not it's enabled.</p>
<p>The biggest variation comes from being nested in an outer comp, unless PFR is on. When PFR is on, a filter is completely isolated from time variations in an outer comp. Of course, current_time will not necessarily move in increments of time_step in that case. It may skip frames or go backwards.</p>
<p>When PFR is off, local_time_step, total_time, and time_scale remain set to what they were for the inner comp, but time_step contains the time to the next frame in the outer comp, expressed in the local time system. This may be any value, including 0. This can be interpreted as an instantaneous time rate, rather than a duration. A 0 value can last for an arbitrary number of rendered frames, but the current_time won't change on the local layer.</p>
<p>Looked at from the other direction:</p>
<p>current_time is quantized to time_step intervals unless rendering an outer comp with PFR off for the inner comp. This is the current time in the layer, not in any comp.</p>
<p>The value of local_time_step is affected only by Time Stretch. It can never be zero, but it can be negative.</p>
<p>time_step and local_time_step are always the same value unless rendering an outer comp with PFR off. time_step is also affected by the time behavior of an outer comp (with PFR off). It can have any value, positive, negative, or zero, and can be different for every frame (of the outer comp). time_step can be used to determine the duration of the current frame (with PFR off).</p>
<p>total_time is the duration of the layer, unless Time Remapping is on, which makes it the larger of the layer duration and the duration of the comp.</p>
<p>time_scale is the scale such that total_time / time_scale is the layer duration in seconds in its comp. It is affected only by the comp frame rate, although presumably all the time values could be scaled proportionately for any reason.</p>
<p>A layer's intrinsic frame rate (if it has one) is not visible anywhere, although it's usually the same as the comp frame rate. If a filter needs to access the actual frames of a clip, it can do so</p>
<p>only by being in a comp of the same frame rate, and with no Time Stretch or Time Remapping applied to its layer. It should use local_time_step to determine where the frames are.</p>
<hr />
<h2 id="effect-details-tips-tricks-rate-x-time-pain">Rate x Time == Pain!<a class="headerlink" href="#effect-details-tips-tricks-rate-x-time-pain" title="Permanent link">&para;</a></h2>
<p>Be careful if one of your parameters is a speed or velocity parameter. Consider the ripple effect. It assumes a constant and uses the current time to determine how far along the ripple has gone (d = v * t). If the user interpolates the speed over time, you should integrate the velocity function from time zero to the current time. Ripple does <em>not</em> do this, but provides a "phase" parameter that the user can interpolate as they wish, providing correct results as long as the speed is set to zero. If you want to provide the correct behavior, you can sample (and integrate) the speed parameter from the beginning of time until the current time using PF_CHECKOUT_PARAM(), or you can provide a "phase" or "distance" parameter and warn the user about interpolating the speed. The cost of checking out many parameter values is negligible compared to rendering, and is the recommended approach.</p>
<p>If you check out parameter values at other times, or use layer parameters at all, you <em>must</em> check in those parameters when finished, even if an error has occurred. Remember, checked-out parameters are read-only.</p>
<hr />
<h2 id="effect-details-tips-tricks-testing">Testing<a class="headerlink" href="#effect-details-tips-tricks-testing" title="Permanent link">&para;</a></h2>
<p>Try using your plug-in in RAM previews to ensure you handle out-of-memory conditions gracefully. Does your plug-in handle running out of memory gracefully?</p>
<p>If you receive <code>PF_Err_OUT_OF_MEMORY</code> (from <a href="#effect-basics-errors-error-codes">Error Codes</a>) when requesting memory, do you pass it back to After Effects?</p>
<p>What happens when your video effect is applied to an audio-only layer? Test with projects created using older versions of your plug-in.</p></section><section class="print-page" id="effect-details-compute-cache-api"><h1 id="effect-details-compute-cache-api-compute-cache-api">Compute Cache API<a class="headerlink" href="#effect-details-compute-cache-api-compute-cache-api" title="Permanent link">&para;</a></h1>
<p>The Compute Cache API provides a thread-safe cache as a replacement or supplement to Sequence Data where effects can compute, store and read data before or during Render. It should be used to cache data that is time consuming to compute. For Multi-Frame Rendering effects it can have a large benefit by eliminating redundant computation across threads. The cache is unified with other caches in After Effects thus memory usage is balanced across other caches. The model also supports the user doing A/B testing with parameters and the cache state persisting for both A and B states thus speeding up workflow. These last two design characteristics benefit both single- and multi-frame rendering effects.</p>
<p>The Compute Cache is implemented in the AEGP_ComputeCache suite and is accessible via <code>AEGP_ComputeCacheSuite1</code> and <code>AEGP_ComputeCacheCallbacks</code>.</p>
<hr />
<h2 id="effect-details-compute-cache-api-aegp_computecachesuite1">AEGP_ComputeCacheSuite1<a class="headerlink" href="#effect-details-compute-cache-api-aegp_computecachesuite1" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ClassRegister</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Registers the cache type using a globally unique identifier for the compute class, such as "adobe.ae.effect.test_effect.cache_v_1".</p>
<p>An object of type <code>AEGP_ComputeCacheCallbacks</code> should be setup with function pointers to the callback methods required by <code>AEGP_ComputeCacheSuite1</code>.</p>
<p>This function will typically be called during <code>PF_Cmd_GLOBAL_SETUP</code>, but can be called any time.</p>
<p><pre lang="cpp">A_Err (*AEGP_ClassRegister)(<br/>  AEGP_CCComputeClassIdP  compute_classP,<br/>  const AEGP_ComputeCacheCallbacks  *callbacksP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ClassUnRegister</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Unregister a previously registered cache type using the globally unique identifier for the compute class.</p>
<p>All cached values will be purged at this time through calls to delete_compute_value.</p>
<p>This function will typically be called during <code>PF_Cmd_GLOBAL_SETDOWN</code>, but can be called any time.</p>
<p><pre lang="cpp">A_Err (*AEGP_ClassUnregister)(<br/>  AEGP_CCComputeClassIdP    compute_classP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ComputeIfNeededAndCheckout</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This is the main checkout call that is used to compute and/or return an <code>AEGP_CCCheckoutReceiptP</code> receipt pointer to the cache entry.</p>
<p>Pass in the <code>AEGP_CCComputeClassIdP</code> that was used in the <code>AEGP_RegisterClass</code> method.</p>
<p>The <code>AEGP_CCComputeOptionsRefconP</code> object will be passed through to the <code>AEGP_ComputeCacheCallbacks</code>, <code>generate_key</code> and <code>compute</code> method as needed. This objects type is opaque to <code>AEGP_ComputeCacheSuite1</code> and will need to be casted appropriately by the effects implementation of <code>generate_key</code> and <code>compute</code>.</p>
<p>The <code>wait_for_other_threadB bool</code> is used when the cache value needs to be computed. When set to <code>true</code>, the method will always execute the compute step or return a completed receipt to the cache. When set to <code>false</code>, this method will complete the compute step unless another thread is already computing the cache entry, in which case <code>A_Err_NOT_IN_CACHE_OR_COMPUTE_PENDING</code> will be returned.</p>
<p>See <a href="#effect-details-compute-cache-api-impact-of-wait_for_other_threadb-on-aegp_computeifneededandcheckout">Impact of wait_for_other_threadB on AEGP_ComputeIfNeededAndCheckout</a> for more information on this parameter.</p>
<p>The <code>CCCheckoutReceiptP</code> is an opaque pointer that can then be passed into <code>AEGP_GetReceiptComputeValue</code> to get a pointer to the computed value from the cache.</p>
<p><pre lang="cpp">A_Err (*AEGP_ComputeIfNeededAndCheckout)(<br/>  AEGP_CCComputeClassIdP    compute_classP,<br/>  AEGP_CCComputeOptionsRefconP  opaque_optionsP,<br/>  bool  wait_for_other_threadB,<br/>  AEGP_CCCheckoutReceiptP   *compute_receiptPP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CheckoutCached</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Use this method to check if the cache value has already been computed, returning the <code>AEGP_CCCheckoutReceiptP</code> receipt if available.</p>
<p>If the cache has not been computed, <code>A_Err_NOT_IN_CACHE_OR_COMPUTE_PENDING</code> will be returned.</p>
<p><pre lang="cpp">A_Err (*AEGP_CheckoutCached)(<br/>  AEGP_CCComputeClassIdP    compute_classP,<br/>  AEGP_CCComputeOptionsRefconP    opaque_optionsP,<br/>  AEGP_CCCheckoutReceiptP   *compute_receiptPP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetReceiptComputeValue</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Use this method to retrieve the cache value from the compute method.</p>
<p>Pass in the receipt received from <code>AEGP_ComputeIfNeededAndCheckout</code> or <code>AEGP_CheckoutCached</code>.</p>
<p>The returned <code>CCComputeValueRefconP</code> should be casted to the correct object type that was used in the <code>compute</code> method.</p>
<p><pre lang="cpp">A_Err (*AEGP_GetReceiptComputeValue)(<br/>  const AEGP_CCCheckoutReceiptP   compute_receiptP,<br/>  AEGP_CCComputeValueRefconP    *compute_valuePP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CheckinComputeReceipt</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Call this method after the effect code is done using a checked-out, computed cache value, before returning to the host, passing in the receipt returned from <code>AEGP_ComputeIfNeededAndCheckout</code> or <code>AEGP_CheckoutCached</code>.</p>
<p>If the receipt being passed in is invalid, error <code>A_Err_STRUCT</code> will be returned. A pop-up error dialog will also be shown with this message, <em>"Trying to check in invalid receipt. Please make sure you are not double checking in or checking in invalid receipts."</em></p>
<p><pre lang="cpp">A_Err (*AEGP_CheckinComputeReceipt)(<br/>  AEGP_CCCheckoutReceiptP   compute_receiptP );</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-compute-cache-api-aegp_computecachecallbacks">AEGP_ComputeCacheCallbacks<a class="headerlink" href="#effect-details-compute-cache-api-aegp_computecachecallbacks" title="Permanent link">&para;</a></h2>
<p>The effect must provide implementations for these callbacks.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>generate_key</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Called when creating a cache entry and when doing a cache lookup. Should be fast to compute. All of the inputs needed to uniquely address the cache entry must be hashed into the key. If a layer checkout is needed to calculate the cache value, such as with a histogram, then the hash of that input must be included</p>
<p>See <code>PF_ParamUtilsSuite::PF_GetCurrentState</code> to get the hash for a layer param. Note this is the hash of the inputs needed to generate the frame, not a hash the pixels in the frame, thus a render is not triggered when making this call.</p>
<p>The <code>AEGP_CCComputeOptionsRefconP</code> will contain the data passed into the <code>AEGP_ComputeIfNeededAndCheckout</code> or <code>AEGP_CheckoutCached</code> methods.</p>
<p>The <code>AEGP_CComputeKeyP</code> <code>out_keyP</code> returns the hashed key value, see the <code>AEGP_CCComputeKey</code> definition in the <code>AE_ComputeCacheSuite.h</code> for type definition.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>AEGP_CCComputeOptionsRefconP</code> parameter passed into <code>generate_key</code> and <code>compute</code> must contain all inputs to calculate the hash key for a cache value / to compute the cache value itself.</p>
<p>This will frequently include many or all of the effect parameters and any layer parameters needed to calculate the cache value. See the <a href="#effect-details-compute-cache-api-real-world-integration-example">Real-world Integration Example</a> for more details.</p>
</div>
<p><pre lang="cpp">A_Err (*generate_key)(<br/>  AEGP_CCComputeOptionsRefconP   optionsP,<br/>  AEGP_CCComputeKeyP   out_keyP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>compute</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Called by <code>AEGP_ComputeIfNeededAndCheckout</code> when a cache value needs to be computed.</p>
<p>The <code>AEGP_CCComputeOptionsRefconP</code> will contain the data passed into the <code>AEGP_ComputeIfNeededAndCheckout</code> method.</p>
<p>Set <code>out_valuePP</code> to point to the result of the computed cache value, casted to the <code>AEGP_CCComputeValueRefconP</code> type.</p>
<p>For example:</p>
<p><pre lang="cpp">*out_valuePP = reinterpret_cast<AEGP_CCComputeValueRefconP>(myComputedResultP);</pre></p>
<p><pre lang="cpp">A_Err (*compute)(<br/>  AEGP_CCComputeOptionsRefconP   optionsP,<br/>  AEGP_CCComputeValueRefconP   *out_valuePP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>approx_size_value</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Called by the cache system to determine the total footprint of memory being used by the computed cache value. The computed value is not required to be a flat structure.</p>
<p>The size is an input to the cache purging heuristic.</p>
<p>The <code>AEGP_CCComputeValueRefconP</code> is the computed cache value that can be used to generate the size value to return.</p>
<p><pre lang="cpp">size_t (*approx_size_value)(<br/>  AEGP_CCComputeValueRefconP   valueP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>delete_compute_value</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This is called to free the value when the cache entry needs to be purged. All resources owned by the cache value must be freed here.</p>
<p><pre lang="cpp">void (*delete_compute_value)(<br/>  AEGP_CCComputeValueRefconP   valueP);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-compute-cache-api-generating-a-key">Generating a Key<a class="headerlink" href="#effect-details-compute-cache-api-generating-a-key" title="Permanent link">&para;</a></h2>
<p>The <code>generate_key</code> callback must return a unique key within the Registered Class to be used as the cache key for an entry in the cache but for future-proofing, we'd strongly suggest the key is globally unique across all registered classes. The AE SDK provides the <code>AEGP_HashSuite1</code> suite to assist in generating a GUID that can be used as the key.</p>
<p>The result of <code>generate_key</code> must be provided as a <code>AEGP_CCComputeKey</code> object which is type defined from the following struct:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">AEGP_GUID</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-2"><span class="w">    </span><span class="n">A_long</span><span class="w"> </span><span class="n">bytes</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
</span><span id="__span-0-3"><span class="p">}</span><span class="w"> </span><span class="n">AEGP_GUID</span><span class="p">;</span>
</span></code></pre></div>
<hr />
<h2 id="effect-details-compute-cache-api-aegp_hashsuite1">AEGP_HashSuite1<a class="headerlink" href="#effect-details-compute-cache-api-aegp_hashsuite1" title="Permanent link">&para;</a></h2>
<p>The <code>AEGP_HashSuite1</code> can be used to generate a unique key for use within the <code>AEGP_ComputeCacheCallbacks</code> <code>generate_key()</code> callback method.</p>
<p>After the suite is acquired, call the <code>AEGP_CreateHashFromPtr()</code> method with a buffer; we suggest a character array with a recognizable string so you can easily recall what's being stored in the cache entry. Then call <code>AEGP_HashMixInPtr()</code> with any effect parameters, layer checkout hash results, etc., that should result in a different cache key and entry.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CreateHashFromPtr</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Call this to begin creating the hash which will be returned in <code>hashP</code> that can be used for returning from <code>generate_key</code>.</p>
<p><pre lang="cpp">A_Err (*AEGP_CreateHashFromPtr)(<br/>  const A_u_longlong buf_sizeLu,<br/>  const void *bufPV,<br/>  AEGP_GUID *hashP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_HashMixInPtr</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Call this for each effect parameter, layer checkout hash or other data that would be used in calculating a cache entry.</p>
<p><pre lang="cpp">A_Err(*AEGP_HashMixInPtr)(<br/>  const A_u_longlong buf_sizeLu,<br/>  const void *bufPV,<br/>  AEGP_GUID *hashP);</pre></p>
</td>
</tr>
</tbody>
</table>
<p>Here's an example of using the <code>AEGP_HashSuite1</code> where Levels2Histo_generate_key_cb() is a callback called for <code>generate_key()</code>:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-1-1"><span class="n">A_Err</span><span class="w"> </span><span class="nf">Levels2Histo_generate_key_cb</span><span class="p">(</span><span class="n">AEGP_CCComputeOptionsRefconP</span><span class="w"> </span><span class="n">opaque_optionsP</span><span class="p">,</span><span class="w"> </span><span class="n">AEGP_CCComputeKeyP</span><span class="w"> </span><span class="n">out_keyP</span><span class="p">)</span>
</span><span id="__span-1-2"><span class="p">{</span>
</span><span id="__span-1-3"><span class="w">    </span><span class="k">try</span>
</span><span id="__span-1-4"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-1-5"><span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="n">Levels2Histo_options</span><span class="o">&amp;</span><span class="w">  </span><span class="n">histo_op</span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="n">Levels2Histo_options</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">opaque_optionsP</span><span class="p">));</span>
</span><span id="__span-1-6"><span class="w">        </span><span class="n">A_Err</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Err_NONE</span><span class="p">;</span>
</span><span id="__span-1-7">
</span><span id="__span-1-8"><span class="w">        </span><span class="n">AEFX_SuiteScoper</span><span class="o">&lt;</span><span class="n">AEGP_HashSuite1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">hash_suite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AEFX_SuiteScoper</span><span class="o">&lt;</span><span class="n">AEGP_HashSuite1</span><span class="o">&gt;</span><span class="p">(</span>
</span><span id="__span-1-9"><span class="w">            </span><span class="n">in_dataP</span><span class="p">,</span>
</span><span id="__span-1-10"><span class="w">            </span><span class="n">kAEGPHashSuite</span><span class="p">,</span>
</span><span id="__span-1-11"><span class="w">            </span><span class="n">kAEGPHashSuiteVersion1</span><span class="p">,</span>
</span><span id="__span-1-12"><span class="w">            </span><span class="n">out_dataP</span><span class="p">);</span>
</span><span id="__span-1-13">
</span><span id="__span-1-14"><span class="w">        </span><span class="c1">// define a simple buffer that is easy to recognize as a starting hash</span>
</span><span id="__span-1-15"><span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">hash_buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Level2Histo&quot;</span><span class="p">;</span>
</span><span id="__span-1-16"><span class="w">        </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hash_suite</span><span class="o">-&gt;</span><span class="n">AEGP_CreateHashFromPtr</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">hash_buffer</span><span class="p">),</span><span class="w"> </span><span class="n">hash_buffer</span><span class="p">,</span><span class="w"> </span><span class="n">out_keyP</span><span class="p">);</span>
</span><span id="__span-1-17">
</span><span id="__span-1-18"><span class="w">        </span><span class="c1">// Mix in effect parameters that would create a different compute result and should generate a different cache entry and key.</span>
</span><span id="__span-1-19"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-20"><span class="w">            </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hash_suite</span><span class="o">-&gt;</span><span class="n">AEGP_HashMixInPtr</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">histo_op</span><span class="p">.</span><span class="n">depthL</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">histo_op</span><span class="p">.</span><span class="n">depthL</span><span class="p">,</span><span class="w"> </span><span class="n">out_keyP</span><span class="p">);</span>
</span><span id="__span-1-21"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-1-22">
</span><span id="__span-1-23"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-24"><span class="w">            </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hash_suite</span><span class="o">-&gt;</span><span class="n">AEGP_HashMixInPtr</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">histo_op</span><span class="p">.</span><span class="n">bB</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">histo_op</span><span class="p">.</span><span class="n">bB</span><span class="p">,</span><span class="w"> </span><span class="n">out_keyP</span><span class="p">);</span>
</span><span id="__span-1-25"><span class="w">        </span><span class="p">}</span>
</span><span id="__span-1-26">
</span><span id="__span-1-27"><span class="w">        </span><span class="c1">// mix in any other effect parameters that should affect the cache key</span>
</span><span id="__span-1-28"><span class="w">        </span><span class="c1">// ...</span>
</span><span id="__span-1-29">
</span><span id="__span-1-30"><span class="w">        </span><span class="c1">// out_keyP is returned as the generated key for use as the cache key.</span>
</span><span id="__span-1-31"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-32"><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(...)</span>
</span><span id="__span-1-33"><span class="w">    </span><span class="p">{</span>
</span><span id="__span-1-34"><span class="w">        </span><span class="cm">/* return most appropriate PF_Err */</span>
</span><span id="__span-1-35"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-36"><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="effect-details-compute-cache-api-compute-or-checkout-the-cache-value">Compute or Checkout the Cache Value<a class="headerlink" href="#effect-details-compute-cache-api-compute-or-checkout-the-cache-value" title="Permanent link">&para;</a></h2>
<p>When adding cache support one of the first questions to answer is if a single render call needs to checkout more than one cache value. If more than one cache value is needed to complete a render, then the multi-checkout pattern can be applied to concurrently calculate the caches across multiple render calls and thus avoid serialization of the compute.</p>
<h3 id="effect-details-compute-cache-api-single-cache-value">Single Cache Value<a class="headerlink" href="#effect-details-compute-cache-api-single-cache-value" title="Permanent link">&para;</a></h3>
<p>If a render call only needs one cache value for rendering a frame, then set the <code>wait_for_other_threadB</code> parameter in <code>AEGP_ComputeIfNeededAndCheckout</code> to <code>true</code>. The checkout call will return a receipt, possibly calling the compute callback to populate the cache; or waiting on another thread that had already started the needed computation.</p>
<h3 id="effect-details-compute-cache-api-multi-checkout-cache-values">Multi-Checkout Cache Values<a class="headerlink" href="#effect-details-compute-cache-api-multi-checkout-cache-values" title="Permanent link">&para;</a></h3>
<p>If a render call needs multiple cache values, then the multi-checkout pattern can be used to keep the render threads utilized and thus avoid serializing the compute.</p>
<p>The concept of using multi-checkout is to have one render (e.g. rendering frame 3) thread take advantage of any other render threads (e.g. frame 1, 2) that are computing needed cache values concurrently with the thread (e.g. frame 3 needs data from frames 1 and 2). If no other threads are computing the requested cached value, then the render thread (frame 3) will execute the compute. Once all the cache value checkout calls have been made, the render thread (frame 3) can then wait for any other threads (frame 1, 2) to finish their compute before executing the pixel rendering. Once the pixel rendering is complete, make sure to check-in any cache values that were checked out (frame 1, 2 and 3).</p>
<p>Below is example pseudo-code to illustrate this approach.</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-2-1"><span class="n">Render</span><span class="p">()</span>
</span><span id="__span-2-2"><span class="p">{</span>
</span><span id="__span-2-3"><span class="w">    </span><span class="c1">// Make a request for each cache value that is needed to complete the render</span>
</span><span id="__span-2-4"><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">first_err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AEGP_ComputeIfNeededAndCheckout</span><span class="p">(</span><span class="n">first_options</span><span class="p">,</span><span class="w"> </span><span class="n">do_not_wait</span><span class="p">,</span><span class="w"> </span><span class="n">first_cache_receipt</span><span class="p">);</span>
</span><span id="__span-2-5"><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">second_err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AEGP_ComputeIfNeededAndCheckout</span><span class="p">(</span><span class="n">second_options</span><span class="p">,</span><span class="w"> </span><span class="n">do_not_wait</span><span class="p">,</span><span class="w"> </span><span class="n">second_cache_receipt</span><span class="p">);</span>
</span><span id="__span-2-6"><span class="w">    </span><span class="c1">// Add as many additional do_not_wait checkout calls here as needed.</span>
</span><span id="__span-2-7">
</span><span id="__span-2-8"><span class="w">    </span><span class="c1">// Once all the requests have been made, check to see if any of the Checkouts did not return</span>
</span><span id="__span-2-9"><span class="w">    </span><span class="c1">// a valid checkout receipt.</span>
</span><span id="__span-2-10"><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">first_err</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">A_Err_NOT_IN_CACHE_OR_COMPUTE_PENDING</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-11"><span class="w">        </span><span class="n">AEGP_ComputeIfNeededAndCheckout</span><span class="p">(</span><span class="n">wait</span><span class="p">,</span><span class="w"> </span><span class="n">first_cache_receipt</span><span class="p">);</span>
</span><span id="__span-2-12"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-13"><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">second_err</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">A_Err_NOT_IN_CACHE_OR_COMPUTE_PENDING</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-14"><span class="w">        </span><span class="n">AEGP_ComputeIfNeededAndCheckout</span><span class="p">(</span><span class="n">wait</span><span class="p">,</span><span class="w"> </span><span class="n">second_cache_receipt</span><span class="p">);</span>
</span><span id="__span-2-15"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-2-16"><span class="w">    </span><span class="c1">// Add as many additional waiting checkout calls here as needed</span>
</span><span id="__span-2-17">
</span><span id="__span-2-18"><span class="w">    </span><span class="c1">// All cache values are now available via AEGP_GetReceiptComputeValue for use in the Render</span>
</span><span id="__span-2-19">
</span><span id="__span-2-20"><span class="w">    </span><span class="c1">// ... complete the render steps</span>
</span><span id="__span-2-21">
</span><span id="__span-2-22"><span class="w">    </span><span class="c1">// Check in all cache values now</span>
</span><span id="__span-2-23"><span class="w">    </span><span class="n">AEGP_CheckinComputeReceipt</span><span class="p">(</span><span class="n">first_cache_receipt</span><span class="p">);</span>
</span><span id="__span-2-24"><span class="w">    </span><span class="n">AEGP_CheckinComputeReceipt</span><span class="p">(</span><span class="n">second_cache_receipt</span><span class="p">);</span>
</span><span id="__span-2-25"><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="effect-details-compute-cache-api-impact-of-wait_for_other_threadb-on-aegp_computeifneededandcheckout">Impact of wait_for_other_threadB on AEGP_ComputeIfNeededAndCheckout<a class="headerlink" href="#effect-details-compute-cache-api-impact-of-wait_for_other_threadb-on-aegp_computeifneededandcheckout" title="Permanent link">&para;</a></h2>
<p>Calls to <code>AEGP_ComputeIfNeededAndCheckout</code> will return a checkout receipt for the cache value in nearly every permutation of the parameters, except when <code>wait_for_other_threadB</code> is set to <code>false</code> and another thread is already rendering the requested cache value.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Cache State</p>
</th>
<th colspan="1" rowspan="1">
<p><code>wait_for_other_threadB</code> set to <code>False</code></p>
</th>
<th colspan="1" rowspan="1">
<p><code>wait_for_other_threadB</code> set to <code>True</code></p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><em>No cache for key</em></p>
</td>
<td colspan="1" rowspan="1">
<p>Compute and checkout receipt returned</p>
</td>
<td colspan="1" rowspan="1">
<p>Compute and checkout receipt returned</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><em>Being computed by another thread</em></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns A_Err_NOT_IN_CACHE_OR_COMPUTE_PENDING</p>
<p>Note that After Effects will not report this error to the user, it is only for the effect to respond to.</p>
</td>
<td colspan="1" rowspan="1">
<p>Wait for another thread and return checkout receipt upon completion</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><em>Cached</em></p>
</td>
<td colspan="1" rowspan="1">
<p>Checkout receipt returned</p>
</td>
<td colspan="1" rowspan="1">
<p>Checkout receipt returned</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-details-compute-cache-api-checking-cache-state">Checking Cache State<a class="headerlink" href="#effect-details-compute-cache-api-checking-cache-state" title="Permanent link">&para;</a></h2>
<ul>
<li>There may be scenarios where an effect needs to check if a cache value has been computed but doesn't want to actually execute or block while waiting on another thread to complete the compute. This can be achieved through the <code>AEGP_CheckoutCached()</code> method.</li>
<li>This call could be used to implement a polling pattern where another piece of code is expected to populate the cache. For example, a UI thread could poll the cache for a histogram that is generated on a render thread.</li>
<li>If the cache value is available, the <code>AEGP_CCCheckoutReceiptP</code> parameter will return a checkout receipt that can be passed to <code>AEGP_GetReceiptComputeValue()</code> to retrieve the cache value. If the cache value is not available, the method will return a <code>A_Err_NOT_IN_CACHE_OR_COMPUTE_PENDING</code> error code.</li>
</ul>
<hr />
<h2 id="effect-details-compute-cache-api-persistence-of-cache">Persistence of Cache<a class="headerlink" href="#effect-details-compute-cache-api-persistence-of-cache" title="Permanent link">&para;</a></h2>
<ul>
<li>Unlike flattened sequence data, the contents of the Compute Cache are not stored with the project and anything computed will need to be recomputed when the project is reopened.</li>
<li>Entries in the cache will automatically purge if memory is needed for other operations by After Effects. Code relying on the cache value being available should be written assuming the compute step will need to be completed each time.</li>
<li>The <code>approx_size_value</code> callback should return quickly but provide a reasonably accurate measurement of the data being held by the cache entry. This will allow After Effects to make better decisions on what to purge and when.</li>
<li>Unregistering the cache class will remove all data of that class from the cache. It will cause a <code>delete_compute_value</code> callback to be made for each entry in the cache associated with the cache class.</li>
<li>The <code>delete_compute_value</code> callback should free any resources related to the cache entry. The Compute Cache only contains a void * pointer to the resources and cannot free the resources on behalf of the effect.</li>
</ul>
<hr />
<h2 id="effect-details-compute-cache-api-real-world-integration-example">Real-world Integration Example<a class="headerlink" href="#effect-details-compute-cache-api-real-world-integration-example" title="Permanent link">&para;</a></h2>
<p>The Auto Color plugin that ships with After Effects is an effect that now utilizes the Compute Cache and the <code>HashSuite1</code> suite to cache histogram and level data used when the effect parameter, Temporal Smoothing, is set to a value greater than 0.</p>
<p>The initial steps in integrating the Cache and Hash suites were to identify what data was being computed by Auto Color's Temporal Smoothing, what portions of that computation are time-consuming, and then what effect parameters would cause a re-compute to be needed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Each effect will need to compute and cache different data, so you'll need to do this review uniquely for your effect.</p>
</div>
<p>For Auto Color's Temporal Smoothing, the frame being rendered needs both histogram and level data from the frames surrounding it. The number of surrounding frames that are needed is based on the temporal smoothing parameters value. Both the histogram and levels data can be expensive to calculate but in general can be calculated once for each frame, cached, and then reused as needed.</p>
<p>However, in the Auto Color effect are a number of other parameters that are used to calculate the cache values including the Black Clip, White Clip, Mid Tones and the Auto Color mode. Accordingly, these parameters need to be included in the <code>generate_key</code> and <code>compute</code> methods.</p>
<p>With that information in hand, we began the integration of the Compute Cache:</p>
<ol>
<li>Define the class registration id and add calls to register and unregister the checkout cache class and callbacks<ul>
<li>The call to AEGP_ClassRegister is executed during <code>PF_Cmd_GLOBAL_SETUP</code>.</li>
<li>The call to AEGP_ClassUnregister is executed during <code>PF_Cmd_GLOBAL_SETDOWN</code>.</li>
</ul>
</li>
<li>Implement the callback functions for <code>generate_key</code>, <code>compute</code>, <code>approx_size_value</code> and <code>delete_compute_value</code>.<ul>
<li><code>generate_key</code> utilizes the <code>AEGP_HashSuite1</code> to generate a unique key mixing in the black clip, white clip, mid tones and auto levels mode. It also mixes in the frame time and time step to ensure the cache is unique for the specific frame being computed.</li>
<li><code>compute</code> calculates the histogram and levels and stores those two data structures into a single struct that is set as the <code>out_valuePP</code> parameter from the compute callback.</li>
<li><code>approx_size_value</code> adds the <code>sizeof()</code> the histogram and level data structures that are in the cached value to return the size of the memory being used by the cache entry.</li>
<li><code>delete_compute_value</code> clears the memory held by the histogram and level data structures for the cache entry.</li>
</ul>
</li>
<li>Integrate the compute/checkout call into Temporal Smoothing<ul>
<li>The Temporal Smoothing code was updated to include calls to <code>AEGP_ComputeIfNeededAndCheckout</code>. The calls are made for each frame time / time step needed for the Temporal Smoothing algorithm, utilizing the results from other rendering threads computing surrounding frame histogram and levels data.</li>
</ul>
</li>
<li>Integrate the cache check-out and check-in<ul>
<li>Once all the required cache values were computed for a frame, the effect code checks out the cache values needed using <code>AEGP_GetReceiptComputeValue</code>.</li>
<li>The cache values are then used as part of the temporal smoothing algorithm to make the adjustments to the color of the frame.</li>
<li>Once the cache values are no longer needed by the current frame, a call to <code>AEGP_CheckinComputeReceipt</code> is made for each cache value receipt.</li>
<li>Auto Color does not use <code>AEGP_CheckoutCached</code> at this time.</li>
</ul>
</li>
<li>Testing sequence_data versus Compute Cache implementations<ul>
<li>Auto Color was using sequence data to store the histogram and levels data, and prior to using the Compute Cache, it would have a unique copy of sequence_data on each rendering thread. This meant that every histogram and level required for a frame would need to be rendered on every thread.</li>
<li>With the change to use the Compute Cache, each frame being rendered gained the performance benefits of other render threads computing the histogram and levels data and storing it for future use.</li>
<li>The improvement in rendering the Auto Color effect over a piece of footage with the Compute Cache has resulted in at least 3x faster renders than the sequence_data version.</li>
</ul>
</li>
</ol></section><h1 class='nav-section-title-end'>Ended: Effect Details</h1>
                        <h1 class='nav-section-title' id='section-smartfx'>
                            SmartFX <a class='headerlink' href='#section-smartfx' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="smartfx-smartfx"><h1 id="smartfx-smartfx-smartfx">SmartFX<a class="headerlink" href="#smartfx-smartfx-smartfx" title="Permanent link">&para;</a></h1>
<p>The SmartFX API provides bidirectional communication between effects and After Effects, enabling many performance optimizations and providing previously unavailable dependency information. This extension of the effect API is the way to implement 32-bit per channel support in After Effects.</p>
<p>Normal effect plug-ins are given a full-sized input buffer, and asked to render a full-sized output buffer. While output <a href="#effect-basics-pf_indata-pf_indata-members">extent_hint</a> specifies the portion of the output buffer that must actually be filled, this scheme is still very inefficient if the effect does not need its entire input. Also, many effects don't use extent hints.</p>
<hr />
<h2 id="smartfx-smartfx-the-way-things-were">The Way Things Were<a class="headerlink" href="#smartfx-smartfx-the-way-things-were" title="Permanent link">&para;</a></h2>
<p>Consider a blur effect applied to a huge layer which is mostly off-screen, or viewed through a small region of interest, or masked down to a small size. Only a small section of the output needs to be rendered, indicated to the effect using the output extent_hint. Only a small section of the input to be blurred is needed as well - the output extent_hint expanded by the blur radius. However, using the legacy effects API, there is no way for After Effects to know this, so the entire layer is passed to the plug-in. These extra pixels can be extremely expensive and wasteful to compute, especially in the case of prior effects or nested comps.</p>
<hr />
<h2 id="smartfx-smartfx-the-way-things-are-now">The Way Things Are Now<a class="headerlink" href="#smartfx-smartfx-the-way-things-are-now" title="Permanent link">&para;</a></h2>
<p>SmartFX solves this problem by reversing the calling sequence. The effect is told how much of its output is required, and must explicitly <em>ask</em> the host for the inputs it needs. The render process is split into two parts: pre-render and render.</p>
<p>During pre-render, the effect describes the input pixel data it needs; this necessary input can vary based on anything you like (non-input layer parameters, non-layer parameters, information from in_data, settings in sequence data...). The effect must also return the extent of the resulting output, which may be smaller than the requested size if there are empty pixels in the requested portion of the layer.</p>
<p>During the render stage, the effect can <em>only</em> retrieve pixels that it has previously requested. This two-pass approach facilitates many important optimizations. For example, an effect which multiplies or mattes one input against another might discover that its first input is not</p>
<p>needed at all, if the mask does not intersect it. There are also important optimizations that are performed internally by After Effects to ensure that image buffers are copied as little as possible, and these optimizations are only possible after the host knows the buffer sizes and for all inputs and outputs.</p>
<p>Like AEGPs, SmartFX plug-ins are never unloaded by After Effects.</p>
<hr />
<h2 id="smartfx-smartfx-content-bounds">Content Bounds<a class="headerlink" href="#smartfx-smartfx-content-bounds" title="Permanent link">&para;</a></h2>
<p>The content bounds of a node are the largest possible result rectangle that can be returned from a call to PreRender. It absolutely cannot vary depending on current render request or anything else. It should be calculated carefully, not loosely.</p>
<p>This calculation is very important. It is an intrinsic property of the node (and its inputs) and is fixed once the graph is built. Violation of it can and probably will cause all sorts of problems in various pieces of code.</p>
<hr />
<h2 id="smartfx-smartfx-how-to-smartify">How To Smartify<a class="headerlink" href="#smartfx-smartfx-how-to-smartify" title="Permanent link">&para;</a></h2>
<p>Effects which set <code>PF_OutFlag2_SUPPORTS_SMART_RENDER</code> (from <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlags</a>) will receive the SmartFX calls <code>PF_Cmd_SMART_PRE_RENDER</code> and <code>PF_Cmd_SMART_RENDER</code> (from <a href="#effect-basics-command-selectors-frame-selectors">Frame Selectors</a>), instead of the older <code>PF_Cmd_FRAME_SETUP</code> / <code>PF_Cmd_RENDER</code> / <code>PF_Cmd_FRAME_SETDOWN</code> sequence. To preserve compatibility with non-smartified hosts, you may want to continue supporting the older commands too.</p>
<hr />
<h2 id="smartfx-smartfx-pf_cmd_smart_pre_render">PF_Cmd_SMART_PRE_RENDER<a class="headerlink" href="#smartfx-smartfx-pf_cmd_smart_pre_render" title="Permanent link">&para;</a></h2>
<p>After Effects requests output from the effect. The effect tells After Effects what input it needs to generate that output, through the use of callback functions, and by manipulating the structures in the extra parameter. An effect cannot access the pixels of any layer inputs it has not checked out during <em>PF_Cmd_SMART_PRE_RENDER</em>. So all layer inputs that an effect might possibly need must be checked out in advance using checkout_layer. If an effect might need certain layer inputs, they must be checked out now, even if later during rendering the effect may decide that the layer isn't needed. Also, since no parameter array is passed to SmartFX during <em>PF_Cmd_SMART_PRE_RENDER</em> or <code>PF_Cmd_SMART_RENDER</code>, any non-layer parameters needed must be retrieved using <code>PF_CHECKOUT_PARAM</code> (from <a href="#effect-details-interaction-callback-functions-interaction-callbacks">Interaction Callbacks</a>)</p>
<hr />
<h2 id="smartfx-smartfx-pf_prerenderextra">PF_PreRenderExtra<a class="headerlink" href="#smartfx-smartfx-pf_prerenderextra" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Member</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PreRenderInput</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Describes what After Effects needs rendered (in the <code>PF_RenderRequest</code>), and the bit depth requested (in the aptly-named bitdepth member).</p>
<p><pre lang="cpp">typedef struct {<br/>  PF_LRect        rect;<br/>  PF_Field        field;<br/>  PF_ChannelMask  channel_mask;<br/>  PF_Boolean      preserve_rgb_of_zero_alpha;<br/>  char            unused[3];<br/>  long            reserved[4];<br/>} PF_RenderRequest;</pre></p>
<p><code>rect</code> is in layer coordinates. field is also relative to the layer origin; whether the active field falls on even or odd scanlines of the output buffer depends on the origin of the output buffer.</p>
<p><code>channel_mask</code> specifies for which channels the effect should provide output.</p>
<p>Data written to other channels will not be honored.</p>
<p>It will be one or more of the following, or'd together:</p>
<ul>
<li><code>PF_ChannelMask_ALPHA</code></li>
<li><code>PF_ChannelMask_RED</code></li>
<li><code>PF_ChannelMask_GREEN</code></li>
<li><code>PF_ChannelMask_BLUE</code></li>
<li><code>PF_ChannelMask_ARGB</code></li>
</ul>
<p>If <code>preserve_rgb_of_zero_alpha</code> pixels is <code>TRUE</code>, the effect must propagate the color content of transparent pixels through to the output.</p>
<p>This is related to, but distinct from, <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlag2_REVEALS_ZERO_ALPHA</a>, which tells After Effects that the effect may set alpha to non-zero values for such pixels, restoring them to visibility.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PreRenderOutput</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Filled in by the effect to tell After Effects what output it plans to generate, based on the input.</p>
<p><pre lang="cpp">typedef struct {<br/>  PF_LRect                    result_rect;<br/>  PF_LRect                    max_result_rect;<br/>  PF_Boolean                  solid;<br/>  PF_Boolean                  reserved;<br/>  PF_RenderOutputFlags        flags;<br/>  void*                       pre_render_data;<br/>  PF_DeletePreRenderDataFunc  func;<br/>} PF_PreRenderOutput;</pre></p>
<p><code>pre_render_data</code> will be passed back to the effect during <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_SMART_RENDER</a>.</p>
<p>Currently, the only <code>PF_RenderOutputFlags</code> is <code>PF_RenderOutputFlag_RETURNS_EXTRA_PIXELS</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_PreRenderCallbacks</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Currently, there is only one callback - <code>checkout_layer</code>. checkout_idL is chosen by the effect.</p>
<p>It must be positive and unique. After Effects populates the <code>PF_CheckoutResult</code>.</p>
<p><pre lang="cpp">PF_Err checkout_layer(<br/>  PF_ProgPtr              effect_ref,<br/>  PF_ParamIndex           index,<br/>  A_long                  checkout_idL,<br/>  const PF_RenderRequest  *req,<br/>  A_long                  what_time,<br/>  A_long                  time_step,<br/>  A_u_long                time_scale,<br/>PF_CheckoutResult       *result);<br/><br/>typedef struct {<br/>  PF_LRect          result_rect;<br/>  PF_LRect          max_result_rect;<br/>  PF_RationalScale  par;<br/>  long              solid;<br/>  PF_Boolean        reservedB[3];<br/>  A_long            ref_width;<br/>  A_long            ref_height;<br/>} PF_CheckoutResult;</pre></p>
<p><code>result_rect</code> can be empty. <code>max_result_rect</code> is the largest the output could possibly be, if the host asked for all of it.</p>
<p>If solid is <code>TRUE</code>, the entire result_rect has opaque alpha.</p>
<p><code>ref_width</code> and <code>ref_height</code> are the original dimensions of the layer, before any effects are applied, disregarding any downsample factors.</p>
<p>This will be the size of the composition for collapsed layers.</p>
<p>There is a bug in 11.0 with the Global Performance Cache, when a SmartFX effect uses both <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlag2_AUTOMATIC_WIDE_TIME_INPUT</a> &amp; <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlag_NON_PARAM_VARY</a>.</p>
<p>Calling checkout_layer during <code>PF_Cmd_SMART_PRE_RENDER</code> returns empty rects in <code>PF_CheckoutResult</code>.</p>
<p>The workaround is to simply make the call again. This workaround is no longer needed in 11.0.1.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>result_rect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The output (in layer coordinates) resulting from the render request (can be empty).</p>
<p>This cannot be bigger than the input request rectangle (unless <code>PF_RenderOutputFlag_RETURNS_EXTRA_PIXELS</code> is set), but can be smaller.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>max_result_rect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The maximum size the output could possibly be, if After Effects requested all of it.</p>
<p>This must not vary depending on requested output size.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>solid</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set this <code>TRUE</code> if every pixel in the output will be fully opaque. Set if possible; it enables certain optimizations.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>reserved</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Ignore.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>flags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Currently, the only flag is <code>PF_RenderOutputFlag_RETURNS_EXTRA_PIXELS</code>, which tells After Effects that the smart effect will return more pixels than After Effects requested.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>pre_render_data</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Point this at any data that the effect would like to access during rendering.</p>
<p>Effects can also allocate handles and store them in <code>out_data&gt;frame_data</code>, as with regular (non-smart) effects.</p>
<p>Since <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_SMART_PRE_RENDER</a> can be called with no corresponding <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_SMART_RENDER</a>, effects must never delete this data themselves; once the effect returns from <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_SMART_PRE_RENDER</a>, After Effects owns this data and will dispose of it (using either the following function or a standard free call).</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>delete_pre_render_data_func</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Point this to a function that will eventually be called to delete the pre_render_data.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="smartfx-smartfx-preserve_rgb_of_zero_alpha">preserve_rgb_of_zero_alpha<a class="headerlink" href="#smartfx-smartfx-preserve_rgb_of_zero_alpha" title="Permanent link">&para;</a></h2>
<p><code>preserve_rgb_of_zero_alpha</code> is used both as input to the effect, to tell it what to render, and as output from the effect, to describe the input it needs (as passed to the checkout call). When preserve_rgb_of_zero_alpha is set in an input request, the effect must pass it recursively when making checkouts, otherwise prior effects and masking will eliminate those pixels that the effect would reveal. Use of this is discouraged, though still supported in CS3 (8.0).</p>
<hr />
<h2 id="smartfx-smartfx-rectangles">Rectangles<a class="headerlink" href="#smartfx-smartfx-rectangles" title="Permanent link">&para;</a></h2>
<p>Effects must set both result rectangles accurately. After Effects' caching system relies upon them, incorrect values can cause many problems. If the plug-in returns a <code>result_rect</code> smaller than the request_rect, that tells After Effects the pixels inside the request_rect but outside the <code>result_rect</code> are empty.</p>
<p>Similarly, <code>max_result_rect</code> must encompass all non-zero pixels; the effect will never be asked to render anything outside this region. If there are pixels outside this rectangle, they will never be displayed.</p>
<p>Mis-sized output rectangles can cause problems as well. If these rectangles are too big, a loss of performance results.</p>
<p>Not only will many empty pixels be cached (robbing the application of valuable memory), the effect may be unnecessarily asked to render large regions of nothing. For this reason, the <code>max_result_rect</code> must be computed correctly, rather than set to some arbitrarily large size.</p>
<p>Both <code>result_rect</code> and <code>max_result_rect</code> may vary depending on the effect's parameters, the current time, et cetera; they are valid only for the given invocation of the effect. However, <code>max_result_rect</code> <em>cannot</em> depend on the specific render request. It must be the same no matter what portion of the output is requested by After Effects.</p>
<p>It is legal to return an empty <code>result_rect</code> if the request_rect doesn't intersect the effect's output pixels; no rendering need be done.</p>
<p>After Effects may also call the effect with an empty request_rect, meaning the effect is only being asked to compute the <code>max_result_rect</code>.</p>
<p><code>preserve_rgb_of_zero_alpha</code> can influence the bounds computation process (both result_rect and <code>max_result_rect</code>) and must be respected if the effect behaves differently depending on this setting.</p>
<hr />
<h2 id="smartfx-smartfx-the-size-of-a-layer">The "Size" Of A Layer<a class="headerlink" href="#smartfx-smartfx-the-size-of-a-layer" title="Permanent link">&para;</a></h2>
<p>As with non-smart effects, each smart effect can arbitrarily shrink or expand its requested input. They cannot depend on a fixed frame size, and the size of the input may change over time.</p>
<p>For example, the user could apply an animated drop shadow to a layer, which would add pixels to different edges of the layer at different times, depending on the direction in which the shadow is cast.</p>
<p>Some effects (for example, those which need to align one layer against another) need some notion of "size." This could be defined two ways, each with advantages and disadvantages.</p>
<p>The size of the original layer, before any effects and downsampling are applied, is given <code>in_data&gt;width/height</code>. As this value is unaffected by subsequent effects, it can act an absolute reference for things like center points.</p>
<p>However, this is not fool-proof, as the user could have applied a distortion or translation effect. Also, this value is available only for the layer to which the effect is applied, not other layer parameters.</p>
<p>...or...</p>
<p>Every layer input has a <code>max_result_rect</code> which encompasses all pixel data, in some sense the master "size" of a layer.</p>
<p>It is available for all layers, but changes over time according to previously applied effects, possibly in ways the user might not expect (as in the drop shadow example above).</p>
<p>Note that the ref_width/height and <code>max_result_rect</code> for an input may be obtained without rendering, by calling <code>checkout_layer</code> with an empty <code>request_rect</code>.</p>
<p>This is fairly efficient, and can be useful if the layer "size" is needed first to determine exactly which pixels are required for rendering.</p>
<p>This is an example of requesting a layer in pre-render and then never calling <code>checkout_layer</code> (in this case, there are none).</p>
<hr />
<h2 id="smartfx-smartfx-flag-on-the-play">Flag On The Play<a class="headerlink" href="#smartfx-smartfx-flag-on-the-play" title="Permanent link">&para;</a></h2>
<p>Normally, the <code>max_result_rect</code> of a given <code>PF_RenderRequest</code> will be cropped to the bounds of any applied mask.</p>
<p>However, if <a href="#effect-basics-pf_outdata-pf_outflags2">PF_OutFlag2_REVEALS_ZERO_ALPHA</a> is set, the <code>max_result_rect</code> will be the size of the layer.</p>
<hr />
<h2 id="smartfx-smartfx-pf_cmd_smart_render">PF_Cmd_SMART_RENDER<a class="headerlink" href="#smartfx-smartfx-pf_cmd_smart_render" title="Permanent link">&para;</a></h2>
<p>The effect will receive at most one <em>PF_Cmd_SMART_RENDER</em> call for each pre-render.</p>
<p>Note that render may never be called at all. After Effects may have only wanted to to perform some bounds computations, or it may have subsequently discovered that an effect's output is not needed at all (which can happen, for example, if the pre-render phase for a track matte returns a rectangle that does not intersect the effect's output.)</p>
<p>All effects must be able to handle Pre-Render without Render without leaking resources or otherwise entering an unstable state.</p>
<p>During <em>PF_Cmd_SMART_RENDER</em>, the extra parameter points to a PF_SmartRenderExtra.</p>
<hr />
<h2 id="smartfx-smartfx-pf_smartrenderextra">PF_SmartRenderExtra<a class="headerlink" href="#smartfx-smartfx-pf_smartrenderextra" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Member</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_SmartRenderInput</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Consists of a <a href="#smartfx-smartfx-pf_prerenderextra">PF_RenderRequest</a>, the bitdepth, and a pointer to <code>pre_render_data</code> (allocated during <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_SMART_PRE_RENDER</a>).</p>
<p>This <code>PF_SmartRenderInput</code> is identical to that passed in the corresponding <em>PF_Cmd_SMART_PRE_RENDER</em>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_SmartRenderCallbacks</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PF_Err checkout_layer_pixels(<br/>  PF_ProgPtr      effect_ref,<br/>  A_long          checkout_idL,<br/>  PF_EffectWorld  *pixels);</pre></p>
<p>This is used to actually access the pixels in layers checked out during <em>PF_Cmd_SMART_PRE_RENDER</em>.</p>
<p>The returned <code>PF_EffectWorld</code> is valid for duration of current command or until checked in.</p>
<p>You are only allowed to call <code>checkout_layer_pixels</code> only once with the checkout_idL used earlier in <em>PF_Cmd_SMART_PRERENDER</em>.</p>
<p>There must be a one-to-one mapping between the number of checkouts made in <em>PF_Cmd_SMART_PRERENDER</em> and <em>PF_Cmd_SMART_RENDER</em>.</p>
<p>To call <code>checkout_layer_pixels</code> more than once on a layer, you should call <a href="#smartfx-smartfx-pf_prerenderextra">checkout_layer</a> on the same layer again with a different unique <code>checkout_idL</code> in <em>PF_Cmd_SMART_PRERENDER</em> and then use that <code>checkout_idL</code> to do another <code>checkout_layer_pixels</code> in <em>PF_Cmd_SMART_RENDER</em>.</p>
<p><pre lang="cpp">PF_Err checkin_layer_pixels(<br/>  PF_ProgPtr  effect_ref,<br/>  A_long      checkout_idL);</pre></p>
<p>It isn't necessary to call (After Effects cleans up all such checkouts when the effect returns from <em>PF_Cmd_SMART_RENDER</em>), but useful to free up memory.</p>
<p><pre lang="cpp">PF_Err checkout_output(<br/>  PF_ProgPtr      effect_ref,<br/>  PF_EffectWorld  *output);</pre></p>
<p>Retrieves the output buffer. Note that effects are not allowed to check out output until at least one input has been checked out (unless the effect has no inputs at all).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For optimal memory usage, request the output as late as possible, and request inputs as few at a time as possible.</p>
</div>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="smartfx-smartfx-when-to-access-layer-parameters">When To Access Layer Parameters<a class="headerlink" href="#smartfx-smartfx-when-to-access-layer-parameters" title="Permanent link">&para;</a></h2>
<p>Parameters other than layer inputs may be freely checked out at any point. Layer inputs must be accessed during <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_SMART_PRE_RENDER</a>.</p>
<p>However, you aren't required to actually <em>use</em> every input.</p>
<p>If you check out a frame (or portion thereof) in <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_SMART_PRE_RENDER</a> and do not subsequently check it out in <code>PF_Cmd_SMART_RENDER</code>, it need never be rendered, greatly improving performance.</p>
<hr />
<h2 id="smartfx-smartfx-wait-gimme-that-layer-back">Wait, Gimme That Layer Back!<a class="headerlink" href="#smartfx-smartfx-wait-gimme-that-layer-back" title="Permanent link">&para;</a></h2>
<p><code>checkout_layer_pixels</code> can only be called once with the checkout_id used earlier in PreRender. There has to be a one-to-one mapping on the number of checkouts made in PreRender and SmartRender. If you need to check out the pixels of a layer more than once, perhaps because of the structure of your code, just use more than one checkout_id. In PreRender, call checkout_layer on the same layer with different unique checkout_ids. Then in SmartRender, use a different one of those checkout_ids each time checkout_layer_pixels is called in SmartRender.</p></section><h1 class='nav-section-title-end'>Ended: SmartFX</h1>
                        <h1 class='nav-section-title' id='section-effect-ui-events'>
                            Effect UI & Events <a class='headerlink' href='#section-effect-ui-events' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="effect-ui-events-effect-ui-events"><h1 id="effect-ui-events-effect-ui-events-effect-ui-events">Effect UI &amp; Events<a class="headerlink" href="#effect-ui-events-effect-ui-events-effect-ui-events" title="Permanent link">&para;</a></h1>
<p>Effects can provide custom UI in two areas: (1) the Effect Controls Window (custom ECW UI), and (2) the Composition or Layer Windows (Custom Comp UI).</p>
<p>Effects that use custom UI should set <code>PF_OutFlag_CUSTOM_UI</code> (from <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlags</a> during <code>PF_Cmd_GLOBAL_SETUP</code> (from <a href="#effect-basics-command-selectors-global-selectors">Global Selectors</a>), and handle the PF_Cmd_EVENT selector.</p>
<p>Custom ECW UI allows an effect to provide a parameter with a customized control, which can be used either with standard parameter types or <a href="#effect-details-arbitrary-data-parameters-arbitrary-data-parameters">Arbitrary Data Parameters</a>.</p>
<p>Parameters that have a custom UI should set <code>PF_PUI_CONTROL</code> (from <a href="#effect-basics-pf_paramdef-parameter-ui-flags">Parameter UI Flags</a>) when <a href="#effect-details-interaction-callback-functions-interaction-callbacks">adding the parameter</a>.</p>
<p>Custom Comp UI allows an effect to provide direct manipulation of the video in the Composition or Layer Windows.</p>
<p>When the effect is selected, the Window can overlay custom controls directly on the video, and can handle user interaction with those controls, to adjust parameters more quickly and naturally.</p>
<p>Effects should register themselves to receive events by calling PF_REGISTER_UI.</p>
<p>After Effects can send events to effects for user interface handling and parameter management, integrating effects into its central message queue.</p>
<p>While many events are sent in response to user input, After Effects also sends events to effects which manage arbitrary data parameters.</p>
<p>The type of event is specified in <a href="#effect-ui-events-pf_eventextra-pf_eventextra">PF_EventExtra-&gt;e_type</a> and the various events are described below.</p>
<hr />
<h2 id="effect-ui-events-effect-ui-events-events">Events<a class="headerlink" href="#effect-ui-events-effect-ui-events-events" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Event</p>
</th>
<th colspan="1" rowspan="1">
<p>Indicates</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Event_NEW_CONTEXT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The user created a new context (probably by opening a window) for events.</p>
<p>The plug-in is allowed to store state information inside the context using the context handle.</p>
<p><a href="#effect-ui-events-pf_eventunion-pf_eventunion">PF_EventUnion</a> contains valid context and type, but everything else should be ignored.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Event_ACTIVATE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The user activated a new context (probably by bringing a window into the foreground). <a href="#effect-ui-events-pf_eventunion-pf_eventunion">PF_EventUnion</a> is empty.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Event_DO_CLICK</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The user clicked within the effect's UI. <a href="#effect-ui-events-pf_eventunion-pf_eventunion">PF_EventUnion</a> contains a <code>PF_DoClickEventInfo</code>.</p>
<p>Handle the mouse click and respond, passing along drag info; see sample code), within a context.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of 7.0, do <em>not</em> block until mouse-up; instead, rely on <code>PF_Event_DRAG</code>.</p>
</div>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Event_DRAG</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Also a Click Event, <a href="#effect-ui-events-pf_eventunion-pf_eventunion">PF_EventUnion</a> contains a <code>PF_DoClickEventInfo</code>.</p>
<p>Request this by returning <code>send_drag == TRUE</code> from <code>PF_Event_DO_CLICK</code>.</p>
<p>Do this so After Effects can see new data from the user's changes.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Event_DRAW</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Draw! <a href="#effect-ui-events-pf_eventunion-pf_eventunion">PF_EventUnion</a> contains a <code>PF_DrawEventInfo</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Event_DEACTIVATE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The user has deactivated a context (probably by bringing another window into the foreground). <code>PF_EventUnion</code> is empty.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Event_CLOSE_CONTEXT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A context has been closed by the user. <code>PF_EventUnion</code> will be empty.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Event_IDLE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A context is open but nothing is happening. <code>PF_EventUnion</code> is empty.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Event_ADJUST_CURSOR</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The mouse is over the plug-in's UI. Set the cursor by changing the <code>PF_CursorType</code> in the <code>PF_AdjustCursorEventInfo</code>.</p>
<p>Use OS-specific calls to implement a custom cursor; tell After Effects you've done so by setting <code>PF_CursorType</code> to <code>PF_Cursor_CUSTOM</code>.</p>
<p>Use an After Effects cursor whenever possible to preserve interface continuity.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Event_KEYDOWN</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Keystroke. <a href="#effect-ui-events-pf_eventunion-pf_eventunion">PF_EventUnion</a> contains a <code>PF_KeyDownEvent</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_Event_MOUSE_EXITED</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CS6. Notification that the mouse is no longer over a specific view (layer or comp only).</p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-ui-events-pf_eventextra"><h1 id="effect-ui-events-pf_eventextra-pf_eventextra">PF_EventExtra<a class="headerlink" href="#effect-ui-events-pf_eventextra-pf_eventextra" title="Permanent link">&para;</a></h1>
<p>This structure provide context information for the current event. After Effects passes a pointer to this structure in the extra parameter of the <a href="#effect-basics-entry-point">Entry Point</a> function.</p>
<p>The <code>PF_EventUnion</code> (sent in the <code>PF_EventExtra</code>) varies with the event type, and contains information specific to that event.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Member</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>contextH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Handle to the <code>PF_Context</code>.</p>
<p>This drawing context is used with the <a href="#effect-ui-events-custom-ui-and-drawbot">Drawbot suites</a> for drawing, and also for the <a href="#effect-ui-events-ui-callbacks">UI Callbacks</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>e_type</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Which <a href="#effect-ui-events-effect-ui-events">event</a> is occurring.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>u</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A <a href="#effect-ui-events-pf_eventunion">PF_EventUnion</a> containing information specific to the event.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>effect_win</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A <code>PF_EffectWindowInfo</code> about the event if it occurs within the effects window.</p>
<p>Otherwise, as of After Effects 5.0, effect_win can be replaced by a <code>PF_WindowUnion</code>.</p>
<p>This struct contains both a <code>PF_EffectWindowInfo</code> and an <code>PF_ItemWindowInfo</code>, which (for now) is simply the port rectangle for the item window.</p>
<p>Replacement only occurs if <code>PF_USE_NEW_WINDOW_UNION</code> was defined during compilation; otherwise, it will continue to be just a <code>PF_EffectWindowInfo</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>cbs</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Pointer to <a href="#effect-ui-events-ui-callbacks">UI Callbacks</a>, which are needed to translate points between layer, composition, and screen coordinate systems.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>evt_in_flags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Event Input Flags. This currently contains only one value, <code>PF_EI_DONT_DRAW</code>, which you should check before drawing!</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>evt_out_flags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>One or more of the following, combined with a bitwise OR operation:</p>
<ul>
<li><code>PF_EO_NONE</code></li>
<li><code>PF_EO_HANDLED_EVENT</code> tells After Effects you've handled the event.</li>
<li><code>PF_EO_ALWAYS_UPDATE</code> forces After Effects to rerender the composite in response to every click or drag; this is the same behavior generated by 'alt-scrubbing' the parameter value.</li>
<li><code>PF_EO_NEVER_UPDATE</code> prevents After Effects from rerendering the composite until the user stops clicking and dragging.</li>
<li><code>PF_EO_UPDATE_NOW</code> tells After Effects to update the view immediately after the event returns after calling <code>PF_InvalidateRect</code></li>
</ul>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-ui-events-pf_eventextra-pf_context">PF_Context<a class="headerlink" href="#effect-ui-events-pf_eventextra-pf_context" title="Permanent link">&para;</a></h2>
<p>PF_Context details the event's UI context.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Member</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>magic</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Do not change.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>w_type</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The window type. If you have Custom Comp and ECW UIs in the same plug-in, this is the way to differentiate between them (what kind of masochist are you, anyway?).</p>
<ul>
<li><code>PF_Window_COMP</code>,</li>
<li><code>PF_Window_LAYER</code>,</li>
<li><code>PF_Window_EFFECT</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>reserved_flt</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Do not change.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>plugin_state[4]</code></p>
</td>
<td colspan="1" rowspan="1">
<p>An array of 4 <code>A_longs</code> which the plug-in can use to store state information for a given context.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>reserved_drawref</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A <code>DRAWBOT_DrawRef</code> for use with the <a href="#effect-ui-events-custom-ui-and-drawbot">Drawbot suites</a>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>*reserved_paneP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Do not change.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-ui-events-pf_eventextra-pf_effectwindowinfo">PF_EffectWindowInfo<a class="headerlink" href="#effect-ui-events-pf_eventextra-pf_effectwindowinfo" title="Permanent link">&para;</a></h2>
<p>If an event occurs in the ECP, an PF_EffectWindowInfo is sent in PF_EventExtra.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Member</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>index</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This indicates which parameter in the effect window is being affected. The controls are numbered from 0 to the number of controls minus 1.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>area</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This indicates if the control title (<code>PF_EA_PARAM_TITLE</code>) or the control itself (<code>PF_EA_CONTROL</code>) are being affected.</p>
<p>The title is the area still visible when the parameter's topic ("twirly") is spun up.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>current_frame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A PF_Rect indicating the full frame of the area occupied by the control.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>param_title_frame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A PF_Rect indicating the title area of the control.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>horiz_offset</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A horizontal offset from the left side of the title area in which to draw into the title.</p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-ui-events-pf_eventunion"><h1 id="effect-ui-events-pf_eventunion-pf_eventunion">PF_EventUnion<a class="headerlink" href="#effect-ui-events-pf_eventunion-pf_eventunion" title="Permanent link">&para;</a></h1>
<p>The PF_EventUnion in PF_EventExtra is a union of the four following structures.</p>
<hr />
<h2 id="effect-ui-events-pf_eventunion-click">Click<a class="headerlink" href="#effect-ui-events-pf_eventunion-click" title="Permanent link">&para;</a></h2>
<p>A mouse click or drag occurred within the custom UI's area.</p>
<h3 id="effect-ui-events-pf_eventunion-pf_doclickeventinfo">PF_DoClickEventInfo<a class="headerlink" href="#effect-ui-events-pf_eventunion-pf_doclickeventinfo" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Member</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>when</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The (OS-level) time at which the click occurred.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>screen_point</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Where, in screen coordinates, the click occurred. For Custom Comp UI, these coordinates can be converted to composition coordinates using the <a href="#effect-ui-events-ui-callbacks">UI Callbacks</a>.</p>
<p>See the CCU sample project for an example.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>num_clicks</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The number of clicks that occurred.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>modifiers</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Which modifier keys (if any) were held down during click.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>continue_refcon[4]</code></p>
</td>
<td colspan="1" rowspan="1">
<p>An array of 4 <code>A_intptr_t</code> the plug-in can use to store information during a click-drag-drag sequence.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>send_drag</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set this flag to <code>TRUE</code> to indicate continued dragging. The next click event will then effectively be a drag event.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>last_time</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set when the drag event ends (the user has released the mouse button).</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-ui-events-pf_eventunion-draw">Draw<a class="headerlink" href="#effect-ui-events-pf_eventunion-draw" title="Permanent link">&para;</a></h2>
<p>After Effects needs your custom UI to refresh.</p>
<p>Note: when handling draw requests, use the image dimensions provided in <a href="#effect-basics-pf_indata">PF_InData</a> (rather that the dimensions of your input layer, as you would during <a href="#effect-basics-command-selectors-frame-selectors">PF_Cmd_RENDER</a>).</p>
<h3 id="effect-ui-events-pf_eventunion-pf_draweventinfo">PF_DrawEventInfo<a class="headerlink" href="#effect-ui-events-pf_eventunion-pf_draweventinfo" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Member</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>update_rect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The rectangle in which to draw, in the context window's coordinate system. These coordinates can be converted to different coordinate systems using the <a href="#effect-ui-events-ui-callbacks">UI Callbacks</a>.</p>
<p>See the CCU sample project for an example.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>depth</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Pixel depth of the drawing context.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-ui-events-pf_eventunion-keydown">Keydown<a class="headerlink" href="#effect-ui-events-pf_eventunion-keydown" title="Permanent link">&para;</a></h2>
<p>The user pressed a key, and the effect's UI is active.</p>
<p>Use the macros in AE_EffectUI.h to access and manipulate the key codes received.</p>
<p>In order to receive keydown events in Premiere Pro, plug-ins must set PF_CustomEFlag_COMP in PF_CustomUIInfo.events during PF_Cmd_PARAM_SETUP.</p>
<h3 id="effect-ui-events-pf_eventunion-pf_keydownevent">PF_KeyDownEvent<a class="headerlink" href="#effect-ui-events-pf_eventunion-pf_keydownevent" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Member</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>when</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Time at which the click occurred.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>screen_point</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Screen coordinate of the mouse pointer when the key was pressed.</p>
<p>For Custom Comp UI, these coordinates can be converted to composition coordinates using the <a href="#effect-ui-events-ui-callbacks">UI Callbacks</a>.</p>
<p>See the CCU sample project for an example.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>key_code</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Either a character code (for printable characters, we use the unshifted upper case version; A not a, 7 not &amp;), or a control code:</p>
<ul>
<li><code>PF_ControlCode_Unknown</code></li>
<li><code>PF_ControlCode_Space</code></li>
<li><code>PF_ControlCode_Backspace</code></li>
<li><code>PF_ControlCode_Tab</code></li>
<li><code>PF_ControlCode_Return</code></li>
<li><code>PF_ControlCode_Enter</code></li>
<li><code>PF_ControlCode_Escape</code></li>
<li><code>PF_ControlCode_F1</code></li>
<li>...</li>
<li><code>PF_ControlCode_F24</code></li>
<li><code>PF_ControlCode_PrintScreen</code></li>
<li><code>PF_ControlCode_ScrollLock</code></li>
<li><code>PF_ControlCode_Pause</code></li>
<li><code>PF_ControlCode_Insert</code></li>
<li><code>PF_ControlCode_Delete</code></li>
<li><code>PF_ControlCode_Home</code></li>
<li><code>PF_ControlCode_End</code></li>
<li><code>PF_ControlCode_PageUp</code></li>
<li><code>PF_ControlCode_PageDown</code></li>
<li><code>PF_ControlCode_Help</code></li>
<li><code>PF_ControlCode_Clear</code></li>
<li><code>PF_ControlCode_Left</code></li>
<li><code>PF_ControlCode_Right</code></li>
<li><code>PF_ControlCode_Up</code></li>
<li><code>PF_ControlCode_Down</code></li>
<li><code>PF_ControlCode_NumLock</code></li>
<li><code>PF_ControlCode_Command</code></li>
<li><code>PF_ControlCode_Option</code></li>
<li><code>PF_ControlCode_Alt</code> = <code>PF_ControlCode_Option</code></li>
<li><code>PF_ControlCode_Control</code></li>
<li><code>PF_ControlCode_Shift</code></li>
<li><code>PF_ControlCode_CapsLock</code></li>
<li><code>PF_ControlCode_ContextMenu</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>modifiers</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Which (if any) modifier keys were down during the key press.</p>
<ul>
<li><code>PF_Mod_NONE</code></li>
<li><code>PF_Mod_CMD_CTRL_KEY</code> (cmd on Mac, ctrl on Windows)</li>
<li><code>PF_Mod_SHIFT_KEY</code></li>
<li><code>PF_Mod_CAPS_LOCK_KEY</code></li>
<li><code>PF_Mod_OPT_ALT_KEY</code> (option on Mac, alt on Windows)</li>
<li><code>PF_Mod_MAC_CONTROL_KEY</code></li>
</ul>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-ui-events-pf_eventunion-adjustcursor">AdjustCursor<a class="headerlink" href="#effect-ui-events-pf_eventunion-adjustcursor" title="Permanent link">&para;</a></h2>
<p>The cursor has moved onto (but not off of) the effect's custom UI, to allow the effect to change the cursor.</p>
<h3 id="effect-ui-events-pf_eventunion-pf_adjustcursoreventinfo">PF_AdjustCursorEventInfo<a class="headerlink" href="#effect-ui-events-pf_eventunion-pf_adjustcursoreventinfo" title="Permanent link">&para;</a></h3>
<table>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<h2 id="effect-ui-events-pf_eventunion-member">Member<a class="headerlink" href="#effect-ui-events-pf_eventunion-member" title="Permanent link">&para;</a></h2>
<p><code>screen_point</code></p>
</td>
<td colspan="1" rowspan="1">
<h2 id="effect-ui-events-pf_eventunion-purpose">Purpose<a class="headerlink" href="#effect-ui-events-pf_eventunion-purpose" title="Permanent link">&para;</a></h2>
<p>Screen coordinate of the mouse pointer. For Custom Comp UI, these coordinates can be converted to composition coordinates using the <a href="#effect-ui-events-ui-callbacks">UI Callbacks</a>.</p>
<p>See the CCU sample project for an example.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>modifiers</code></p>
</td>
<td colspan="1" rowspan="1">
<p>What, if any, modifier keys were held down when the message was sent.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>set_cursor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set this to your desired cursor, or <code>PF_Cursor_CUSTOM</code> if you have set the cursor yourself using OS-specific calls. See AE_EffectUI.h for a complete enumeration of built-in cursors.</p>
<p>If you don't want to override the cursor, set this to <code>PF_Cursor_NONE</code>, or simply ignore this message.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-ui-events-pf_eventunion-arbitrary-parameters-event">Arbitrary Parameters Event<a class="headerlink" href="#effect-ui-events-pf_eventunion-arbitrary-parameters-event" title="Permanent link">&para;</a></h2>
<p>After Effects needs your plug-in to manage it's arbitrary data parameter(s).</p>
<p>Though arbitrary data types are not required for custom UI support, <code>PF_ArbParamsExtra</code> follows the EventInfo model.</p>
<h3 id="effect-ui-events-pf_eventunion-pf_arbparamsextra">PF_ArbParamsExtra<a class="headerlink" href="#effect-ui-events-pf_eventunion-pf_arbparamsextra" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Member</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>which_function</code></td>
<td>A <code>PF_FunctionSelector</code> indicating which function is called</td>
</tr>
<tr>
<td><code>id</code></td>
<td>Used by After Effects; will match the ID assigned to the arbitrary data type during <em>PF_Cmd_PARAM_SETUP</em>.</td>
</tr>
<tr>
<td><code>padding</code></td>
<td>Used for byte-alignment</td>
</tr>
<tr>
<td><pre lang="cpp">u {<br/>  new_func_params<br/>  dispose_func_params<br/>  copy_func_params<br/>  flat_size_func_params<br/>  flatten_func_params<br/>  unflatten_func_params<br/>  interp_func_params<br/>  compare_func_params<br/>  print_size_func_params<br/>  print_func_params<br/>  scan_func_params<br/>}</pre></td>
<td>(One of these will be passed; see <a href="#effect-details-arbitrary-data-parameters">Arbitrary Data Parameters</a>)</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-ui-events-custom-ui-and-drawbot"><h1 id="effect-ui-events-custom-ui-and-drawbot-custom-ui-drawbot">Custom UI &amp; Drawbot<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-custom-ui-drawbot" title="Permanent link">&para;</a></h1>
<p>Custom UI uses a composited drawing model using Drawbot. The Drawbot suites can be used for:</p>
<ol>
<li>Basic 2D path drawing: Lines, Rect, Arc, Bezier</li>
<li>Stroking/Filling/Shading paths</li>
<li>Image drawing: Compositing an ARGB/BGRA buffer onto the surface</li>
<li>Pushing/popping surface state</li>
<li>Text drawing, if supplier supports it (clients should first check if text drawing is supported before actual drawing)</li>
</ol>
<p>Drawing may only occur during <code>PF_Event_DRAW</code> (and not during <code>PF_Event_DRAG</code> or <code>PF_Event_DO_CLICK</code>).</p>
<p>To use Drawbot, first get the drawing reference by passing in PF_Context to a new suite call <a href="#effect-ui-events-custom-ui-and-drawbot-drawbot_drawbotsuite">PF_GetDrawingReference</a>.</p>
<p>If a non-NULL drawing reference is returned, use it to get the supplier and surface references from <a href="#effect-ui-events-custom-ui-and-drawbot-drawbot_drawbotsuite">DRAWBOT_DrawbotSuite</a>.</p>
<p>The Drawbot suites include <code>DRAWBOT_DrawbotSuite</code>, <code>DRAWBOT_SupplierSuite</code>, <code>DRAWBOT_SurfaceSuite</code>, <code>DRAWBOT_PathSuite</code>.</p>
<hr />
<h2 id="effect-ui-events-custom-ui-and-drawbot-make-your-custom-ui-look-not-so-custom">Make Your Custom UI Look Not So "Custom"<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-make-your-custom-ui-look-not-so-custom" title="Permanent link">&para;</a></h2>
<p>Use the new <a href="#effect-ui-events-custom-ui-and-drawbot-pf_effectcustomuioverlaythemesuite">PF_EffectCustomUIOverlayThemeSuite</a> to match the host application UI. Your users will thank you.</p>
<hr />
<h2 id="effect-ui-events-custom-ui-and-drawbot-redrawing">Redrawing<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-redrawing" title="Permanent link">&para;</a></h2>
<p>In order to redraw a specific area of a pane, we recommend the following:</p>
<ol>
<li>Call <code>PF_InvalidateRect</code> (from <a href="#effect-details-useful-utility-functions-pf_appsuite">PF_AppSuite</a>) from the effect. This will cause a lazy display redraw, and will update at the next available idle moment. This rect is in coordinates related to the associated pane. Using a NULL rect will update the entire pane.</li>
<li>Set the <a href="#effect-ui-events-pf_eventextra">event outflag</a> to <code>PF_EO_UPDATE_NOW</code>, which will cause an immediate draw event for the specified pane when the current event returns.</li>
</ol>
<p>If an effect needs to update more than one window at a time, it should set <code>PF_OutFlag_REFRESH_UI</code> (from <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlags</a>), which will cause a redraw of the entire ECW, comp, and layer windows.</p>
<hr />
<h2 id="effect-ui-events-custom-ui-and-drawbot-hidpi-and-retina-display-support">HiDPI and Retina Display Support<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-hidpi-and-retina-display-support" title="Permanent link">&para;</a></h2>
<p>To support HiDPI and Retina Displays, you can use offscreen images that are twice the size, and then use the <code>Transform</code> function from <a href="#effect-ui-events-custom-ui-and-drawbot-drawbot_surfacesuite">Drawbot_SurfaceSuite</a> to scale the image down in half before drawing it.</p>
<hr />
<h2 id="effect-ui-events-custom-ui-and-drawbot-pf_effectcustomuisuite">PF_EffectCustomUISuite<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-pf_effectcustomuisuite" title="Permanent link">&para;</a></h2>
<p>Enables an effect to get the drawing reference. This is the first call needed to use Drawbot.</p>
<h3 id="effect-ui-events-custom-ui-and-drawbot-pf_effectcustomuisuite1">PF_EffectCustomUISuite1<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-pf_effectcustomuisuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetDrawingReference</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the drawing reference.</p>
<p><pre lang="cpp"> PF_GetDrawingReference(<br/>  const PF_ContextH  effect_contextH,<br/>  DRAWBOT_DrawRef    *referenceP0);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-ui-events-custom-ui-and-drawbot-drawbot_drawbotsuite">Drawbot_DrawbotSuite<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-drawbot_drawbotsuite" title="Permanent link">&para;</a></h2>
<p>Using the Drawbot reference, get the supplier and surface references.</p>
<h3 id="effect-ui-events-custom-ui-and-drawbot-drawbot_drawbotsuite1">Drawbot_DrawbotSuite1<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-drawbot_drawbotsuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>GetSupplier</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the supplier reference.</p>
<p>Needed to use <a href="#effect-ui-events-custom-ui-and-drawbot-drawbot_suppliersuite">Drawbot_SupplierSuite</a>.</p>
<p><pre lang="cpp"> GetSupplier(<br/>  DRAWBOT_DrawRef      in_drawbot_ref,<br/>  DRAWBOT_SupplierRef  *out_supplierP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>GetSurface</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the surface reference.</p>
<p>Needed to use <a href="#effect-ui-events-custom-ui-and-drawbot-drawbot_surfacesuite">Drawbot_SurfaceSuite</a>.</p>
<p><pre lang="cpp"> GetSurface(<br/>  DRAWBOT_DrawRef     in_drawbot_ref,<br/>  DRAWBOT_SurfaceRef  *out_surfaceP);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-ui-events-custom-ui-and-drawbot-drawbot_suppliersuite">Drawbot_SupplierSuite<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-drawbot_suppliersuite" title="Permanent link">&para;</a></h2>
<p>Calls to create and release drawing tools, get default settings, and query drawing capabilities.</p>
<h3 id="effect-ui-events-custom-ui-and-drawbot-drawbot_suppliersuite1">Drawbot_SupplierSuite1<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-drawbot_suppliersuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>NewPen</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Create a new pen. Release this using <code>ReleaseObject</code> from <a href="#effect-ui-events-custom-ui-and-drawbot-drawbot_suppliersuite">Drawbot_SupplierSuite</a>.</p>
<p><pre lang="cpp"> NewPen(<br/>  DRAWBOT_SupplierRef      in_supplier_ref,<br/>  const DRAWBOT_ColorRGBA  *in_colorP,<br/>  float                    in_size,<br/>  DRAWBOT_PenRef           *out_penP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>NewBrush</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Create a new brush. Release this using <code>ReleaseObject</code> from <a href="#effect-ui-events-custom-ui-and-drawbot-drawbot_suppliersuite">Drawbot_SupplierSuite</a>.</p>
<p><pre lang="cpp"> NewBrush(<br/>  DRAWBOT_SupplierRef      in_supplier_ref,<br/>  const DRAWBOT_ColorRGBA  *in_colorP,<br/>  DRAWBOT_BrushRef         *out_brushP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>SupportsText</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Check if current supplier supports text.</p>
<p><pre lang="cpp"> SupportsText(<br/>  DRAWBOT_SupplierRef  in_supplier_ref,<br/>  DRAWBOT_Boolean      *out_supports_textB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>GetDefaultFontSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the default font size.</p>
<p><pre lang="cpp"> GetDefaultFontSize(<br/>  DRAWBOT_SupplierRef  in_supplier_ref,<br/>  float                *out_font_sizeF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>NewDefaultFont</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Create a new font with default settings.</p>
<p>You can pass the default font size from <code>GetDefaultFontSize</code>.</p>
<p>Release this using <code>ReleaseObject</code> from <a href="#effect-ui-events-custom-ui-and-drawbot-drawbot_suppliersuite">Drawbot_SupplierSuite</a>.</p>
<p><pre lang="cpp"> NewDefaultFont(<br/>  DRAWBOT_SupplierRef  in_supplier_ref,<br/>  float                in_font_sizeF,<br/>  DRAWBOT_FontRef      *out_fontP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>NewImageFromBuffer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Create a new image from buffer passed to in_dataP.</p>
<p>Release this using <code>ReleaseObject</code> from <a href="#effect-ui-events-custom-ui-and-drawbot-drawbot_suppliersuite">Drawbot_SupplierSuite</a>.</p>
<p><pre lang="cpp"> NewImageFromBuffer(<br/>  DRAWBOT_SupplierRef  in_supplier_ref,<br/>  int                  in_width,<br/>  int                  in_height,<br/>  int                  in_row_bytes,<br/>  DRAWBOT_PixelLayout  in_pl,<br/>  const void           *in_dataP,<br/>  DRAWBOT_ImageRef     *out_imageP);</pre></p>
<p><code>DRAWBOT_PixelLayout</code> can be one of the following:</p>
<ul>
<li><code>kDRAWBOT_PixelLayout_24RGB</code></li>
<li><code>kDRAWBOT_PixelLayout_24BGR</code></li>
<li><code>kDRAWBOT_PixelLayout_32RGB</code></li>
<li><code>ARGB</code> (A is ignored)</li>
<li><code>kDRAWBOT_PixelLayout_32BGR</code></li>
<li><code>BGRA</code> (A is ignored)</li>
<li><code>kDRAWBOT_PixelLayout_32ARGB_Straight</code></li>
<li><code>kDRAWBOT_PixelLayout_32ARGB_Premul</code></li>
<li><code>kDRAWBOT_PixelLayout_32BGRA_Straight</code></li>
<li><code>kDRAWBOT_PixelLayout_32BGRA_Premul</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>NewPath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Create a new path. Release this using <code>ReleaseObject</code> from <a href="#effect-ui-events-custom-ui-and-drawbot-drawbot_suppliersuite">Drawbot_SupplierSuite</a>.</p>
<p><pre lang="cpp"> NewPath(<br/>  DRAWBOT_SupplierRef  in_supplier_ref,<br/>  DRAWBOT_PathRef      *out_pathP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>SupportsPixelLayoutBGRA</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A given Drawbot implementation can support multiple channel orders, but will likely prefer one over the other.</p>
<p>Use the following four callbacks to get the preferred channel order for any API that takes a <code>DRAWBOT_PixelLayout</code> (e.g. <code>NewImageFromBuffer</code>).</p>
<p><pre lang="cpp"> SupportsPixelLayoutBGRA(<br/>  DRAWBOT_SupplierRef  in_supplier_ref,<br/>  DRAWBOT_Boolean      *out_supports_bgraPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PrefersPixelLayoutBGRA</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PrefersPixelLayoutBGRA(<br/>  DRAWBOT_SupplierRef  in_supplier_ref,<br/>  DRAWBOT_Boolean      *out_prefers_bgraPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>SupportsPixelLayoutARGB</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">SupportsPixelLayoutARGB(<br/>  DRAWBOT_SupplierRef  in_supplier_ref,<br/>  DRAWBOT_Boolean      *out_supports_argbPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PrefersPixelLayoutARGB</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">PrefersPixelLayoutARGB(<br/>  DRAWBOT_SupplierRef  in_supplier_ref,<br/>  DRAWBOT_Boolean      *out_prefers_argbPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>RetainObject</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retain (increase reference count on) any object (pen, brush, path, etc). For example, it should be used when any object is copied and the copied object should be retained.</p>
<p><pre lang="cpp"> RetainObject(<br/>  DRAWBOT_ObjectRef  in_obj_ref);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>ReleaseObject</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Release (decrease reference count on) any object (pen, brush, path, etc). This function MUST be called for any object created using <code>NewXYZ()</code> from this suite.</p>
<p>Do not call this function on a <code>DRAWBOT_SupplierRef</code> and <code>DRAWBOT_SupplierRef</code>, since these are not created by the plug-in.</p>
<p><pre lang="cpp"> ReleaseObject(<br/>  DRAWBOT_ObjectRef  in_obj_ref);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-ui-events-custom-ui-and-drawbot-drawbot_surfacesuite">Drawbot_SurfaceSuite<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-drawbot_surfacesuite" title="Permanent link">&para;</a></h2>
<p>Calls to draw on the surface, and to query and set drawing settings.</p>
<h3 id="effect-ui-events-custom-ui-and-drawbot-drawbot_surfacesuite1">Drawbot_SurfaceSuite1<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-drawbot_surfacesuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PushStateStack</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Push the current surface state onto the stack. It should be popped to retrieve old state.</p>
<p>It is required to restore state if you are going to clip or transform a surface or change the interpolation or anti-aliasing policy.</p>
<p><pre lang="cpp"> PushStateStack(<br/>  DRAWBOT_SurfaceRef  in_surface_ref);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PopStateStack</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Pop the last pushed surface state off the stack.</p>
<p><pre lang="cpp"> PopStateStack(<br/>  DRAWBOT_SurfaceRef  in_surface_ref);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PaintRect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Paint a rectangle with a color on the surface.</p>
<p><pre lang="cpp"> PaintRect(<br/>  DRAWBOT_SurfaceRef       in_surface_ref,<br/>  const DRAWBOT_ColorRGBA  *in_colorP,<br/>  const DRAWBOT_RectF32    *in_rectPR);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>FillPath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Fill a path using a brush and fill type.</p>
<p><pre lang="cpp"> FillPath(<br/>  DRAWBOT_SurfaceRef  in_surface_ref,<br/>  DRAWBOT_BrushRef    in_brush_ref,<br/>  DRAWBOT_PathRef     in_path_ref,<br/>  DRAWBOT_FillType    in_fill_type);</pre></p>
<p><code>DRAWBOT_FillType</code> is one of the following:</p>
<ul>
<li><code>kDRAWBOT_FillType_EvenOdd</code></li>
<li><code>kDRAWBOT_FillType_Winding</code>
</li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>StrokePath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Stroke a path using a pen.</p>
<p><pre lang="cpp"> StrokePath(<br/>  DRAWBOT_SurfaceRef  in_surface_ref,<br/>  DRAWBOT_PenRef      in_pen_ref,<br/>  DRAWBOT_PathRef     in_path_ref);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>Clip</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Clip the surface.</p>
<p><pre lang="cpp"> Clip(<br/>  DRAWBOT_SurfaceRef    in_surface_ref,<br/>  DRAWBOT_SupplierRef   in_supplier_ref,<br/>  const DRAWBOT_Rect32  *in_rectPR);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>GetClipBounds</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get clip bounds.</p>
<p><pre lang="cpp"> GetClipBounds(<br/>  DRAWBOT_SurfaceRef  in_surface_ref,<br/>  DRAWBOT_Rect32      *out_rectPR);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>IsWithinClipBounds</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Checks whether a rect is within the clip bounds.</p>
<p><pre lang="cpp"> IsWithinClipBounds(<br/>  DRAWBOT_SurfaceRef    in_surface_ref,<br/>  const DRAWBOT_Rect32  *in_rectPR,<br/>  DRAWBOT_Boolean       *out_withinPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>Transform</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Transform the last surface state.</p>
<p><pre lang="cpp"> Transform(<br/>  DRAWBOT_SurfaceRef       in_surface_ref,<br/>  const DRAWBOT_MatrixF32  *in_matrixP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>DrawString</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Draw a string.</p>
<p><pre lang="cpp"> DrawString(<br/>  DRAWBOT_SurfaceRef       in_surface_ref,<br/>  DRAWBOT_BrushRef         in_brush_ref,<br/>  DRAWBOT_FontRef          in_font_ref,<br/>  const DRAWBOT_UTF16Char  *in_stringP,<br/>  const DRAWBOT_PointF32   *in_originP,<br/>  DRAWBOT_TextAlignment    in_alignment_style,<br/>  DRAWBOT_TextTruncation   in_truncation_style,<br/>  float                    in_truncation_width);</pre></p>
<p><code>DRAWBOT_TextAlignment</code> is one of the following:</p>
<ul>
<li><code>kDRAWBOT_TextAlignment_Left</code></li>
<li><code>kDRAWBOT_TextAlignment_Center</code></li>
<li><code>kDRAWBOT_TextAlignment_Right</code></li>
</ul>
<p><code>DRAWBOT_TextTruncation</code> is one of the following:</p>
<ul>
<li><code>kDRAWBOT_TextTruncation_None</code></li>
<li><code>kDRAWBOT_TextTruncation_End</code></li>
<li><code>kDRAWBOT_TextTruncation_EndEllipsis</code></li>
<li><code>kDRAWBOT_TextTruncation_PathEllipsis</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>DrawImage</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Draw an image created using <code>NewImageFromBuffer()</code> on the surface. Alpha = [0.0f, 1.0f ].</p>
<p><pre lang="cpp"> DrawImage(<br/>  DRAWBOT_SurfaceRef      in_surface_ref,<br/>  DRAWBOT_ImageRef        in_image_ref,<br/>  const DRAWBOT_PointF32  *in_originP,<br/>  float                   in_alpha);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>SetInterpolationPolicy</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">SetInterpolationPolicy(<br/>  DRAWBOT_SurfaceRef           in_surface_ref,<br/>  DRAWBOT_InterpolationPolicy  in_interp);</pre></p>
<p><code>DRAWBOT_InterpolationPolicy</code> is one of the following:</p>
<ul>
<li><code>kDRAWBOT_InterpolationPolicy_None</code></li>
<li><code>kDRAWBOT_InterpolationPolicy_Med</code></li>
<li><code>kDRAWBOT_InterpolationPolicy_High</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>GetInterpolationPolicy</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">GetInterpolationPolicy(<br/>  DRAWBOT_SurfaceRef           in_surface_ref,<br/>  DRAWBOT_InterpolationPolicy  *out_interpP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>SetAntiAliasPolicy</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">SetAntiAliasPolicy(<br/>  DRAWBOT_SurfaceRef       in_surface_ref,<br/>  DRAWBOT_AntiAliasPolicy  in_policy);</pre></p>
<p><code>DRAWBOT_AntiAliasPolicy</code> is one of the following:</p>
<ul>
<li><code>kDRAWBOT_AntiAliasPolicy_None</code></li>
<li><code>kDRAWBOT_AntiAliasPolicy_Med</code></li>
<li><code>kDRAWBOT_AntiAliasPolicy_High</code>
</li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>GetAntiAliasPolicy</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">GetAntiAliasPolicy(<br/>  DRAWBOT_SurfaceRef       in_surface_ref,<br/>  DRAWBOT_AntiAliasPolicy  *out_policyP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>Flush</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Flush drawing. This is not always needed, and if overused, may cause excessive redrawing and flashing.</p>
<p><pre lang="cpp"> Flush(<br/>  DRAWBOT_SurfaceRef  in_surface_ref);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-ui-events-custom-ui-and-drawbot-drawbot_pathsuite">Drawbot_PathSuite<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-drawbot_pathsuite" title="Permanent link">&para;</a></h2>
<p>Calls to draw paths.</p>
<h3 id="effect-ui-events-custom-ui-and-drawbot-drawbot_pathsuite1">Drawbot_PathSuite1<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-drawbot_pathsuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>MoveTo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Move to a point.</p>
<p><pre lang="cpp"> MoveTo(<br/>  DRAWBOT_PathRef  in_path_ref,<br/>  float            in_x,<br/>  float            in_y);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>LineTo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Add a line to the path.</p>
<p><pre lang="cpp"> LineTo(<br/>  DRAWBOT_PathRef  in_path_ref,<br/>  float            in_x,<br/>  float            in_y);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>BezierTo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Add a cubic bezier to the path.</p>
<p><pre lang="cpp"> BezierTo(<br/>  DRAWBOT_PathRef         in_path_ref,<br/>  const DRAWBOT_PointF32  *in_pt1P,<br/>  const DRAWBOT_PointF32  *in_pt2P,<br/>  const DRAWBOT_PointF32  *in_pt3P);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AddRect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Add a rect to the path.</p>
<p><pre lang="cpp"> AddRect(<br/>  DRAWBOT_PathRef        in_path_ref,<br/>  const DRAWBOT_RectF32  *in_rectPR);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AddArc</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Add a arc to the path. Zero start degrees == 3 o'clock.</p>
<p>Sweep is clockwise. Units for angle are in degrees.</p>
<p><pre lang="cpp"> AddArc(<br/>  DRAWBOT_PathRef         in_path_ref,<br/>  const DRAWBOT_PointF32  *in_centerP,<br/>  float                   in_radius,<br/>  float                   in_start_angle,<br/>  float                   in_sweep);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>Close</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Close the path.</p>
<p><pre lang="cpp"> Close(<br/>  DRAWBOT_PathRef  in_path_ref);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="effect-ui-events-custom-ui-and-drawbot-pf_effectcustomuioverlaythemesuite">PF_EffectCustomUIOverlayThemeSuite<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-pf_effectcustomuioverlaythemesuite" title="Permanent link">&para;</a></h2>
<p>This suite should be used for stroking and filling paths and vertices on the Composition and Layer Windows. After Effects is using this suite internally, and we have made it available to make custom UI look consistent across effects. The foreground/shadow colors are computed based on the app brightness level so that custom UI is always visible regardless of the application's Brightness setting in the Preferences.</p>
<h3 id="effect-ui-events-custom-ui-and-drawbot-pf_effectcustomuioverlaythemesuite1">PF_EffectCustomUIOverlayThemeSuite1<a class="headerlink" href="#effect-ui-events-custom-ui-and-drawbot-pf_effectcustomuioverlaythemesuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetPreferredForegroundColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the preferred foreground color.</p>
<p><pre lang="cpp"> PF_GetPreferredForegroundColor(<br/>  DRAWBOT_ColorRGBA  *foreground_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetPreferredShadowColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the preferred shadow color.</p>
<p><pre lang="cpp"> PF_GetPreferredShadowColor(<br/>  DRAWBOT_ColorRGBA  *shadow_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetPreferredStrokeWidth</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the preferred foreground &amp; shadow stroke width.</p>
<p><pre lang="cpp"> PF_GetPreferredStrokeWidth(<br/>  float  *stroke_widthPF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetPreferredVertexSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the preferred vertex size.</p>
<p><pre lang="cpp"> PF_GetPreferredVertexSize(<br/>  float  *vertex_sizePF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GetPreferredShadowOffset</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the preferred shadow offset.</p>
<p><pre lang="cpp"> PF_GetPreferredShadowOffset(<br/>  A_LPoint  *shadow_offsetP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_StrokePath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Stroke the path with the overlay theme foreground color.</p>
<p>Optionally draw the shadow using the overlay theme shadow color.</p>
<p>Uses overlay theme stroke width for stroking foreground and shadow strokes.</p>
<p><pre lang="cpp"> PF_StrokePath(<br/>  const DRAWBOT_DrawRef  drawbot_ref,<br/>  const DRAWBOT_PathRef  path_ref<br/>  PF_Boolean             draw_shadowB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_FillPath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Fills the path with overlay theme foreground color.</p>
<p>Optionally draw the shadow using the overlay theme shadow color.</p>
<p><pre lang="cpp"> PF_FillPath(<br/>  const DRAWBOT_DrawRef  drawbot_ref,<br/>  const DRAWBOT_PathRef  path_ref<br/>  PF_Boolean             draw_shadowB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_FillVertex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Fills a square vertex around the center point using the overlay theme foreground color and vertex size.</p>
<p><pre lang="cpp"> PF_FillVertex(<br/>  const DRAWBOT_DrawRef  drawbot_ref,<br/>  const A_FloatPoint     *center_pointP<br/>  PF_Boolean             draw_shadowB);</pre></p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-ui-events-ui-callbacks"><h1 id="effect-ui-events-ui-callbacks-ui-callbacks">UI Callbacks<a class="headerlink" href="#effect-ui-events-ui-callbacks-ui-callbacks" title="Permanent link">&para;</a></h1>
<p>After Effects provides callbacks for transposing between coordinate systems, and obtaining OS-specific information about drawing contexts, without guesswork or asking the OS directly. Use these callbacks! Pointers to these callbacks are provided in PF_EventCallbacks. Use the macros in AE_EffectUI.h and AE_EffectCB.h to access these routines.</p>
<p>It is possible to build a functioning plug-in which utilizes a custom UI without implementing the coordinate system transposition callbacks. However, the moment a user zooms into the layer panel or rotates a layer, your plug-in will behave badly. We added these macros and callbacks so that custom user interfaces could be easily integrated into the After Effects UI, without inflicting user interface overhead on developers. Again, please use them!</p>
<p>These macros default the refcon and context handle for simplicity. The refcon assumes you have a local variable named "extra". The default context is the current context. These default parameters are defined in the PF_EventCallbacks structure (in AE_EffectUI.h). You can override the defaults by accessing the callbacks through the PF_EventExtra structure. We don't recommend (or support) modification of the macros in the header file. Don't do it!</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>layer_to_comp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Transforms layer panel coordinates to the composition panel coordinates.</p>
<p><pre lang="cpp">PF_Err layer_to_comp (<br/>  void           *refcon,<br/>  PF_ContextH    context,<br/>  A_long         curr_time,<br/>  A_long         time_scale,<br/>  PF_FixedPoint  *pt);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>comp_to_layer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Transforms composition panel coordinates to the layer panel coordinates.</p>
<p><pre lang="cpp">PF_Err comp_to_layer (<br/>  void           *refcon,<br/>  PF_ContextH    context,<br/>  A_long         curr_time,<br/>  A_long         time_scale,<br/>  PF_FixedPoint  *pt);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>get_comp2layer_xform</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the matrix used to convert from the composition panel to the layer panel.</p>
<p>If <code>*exists</code> returns <code>FALSE</code>, the matrix cannot be computed because the layer scales to zero.</p>
<p><pre lang="cpp">PF_Err get_comp2layer_xform (<br/>  void            *refcon,<br/>  PF_ContextH     context,<br/>  A_long          curr_time,<br/>  long            time_scale,<br/>  long            *exists,<br/>  PF_FloatMatrix  *comp2layer);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>get_layer2comp_xform</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the transformation matrix used to convert from the layer panel to the composition panel.</p>
<p>This always exists.</p>
<p><pre lang="cpp">PF_Err get_layer2comp_xform (<br/>  void            *refcon,<br/>  PF_ContextH     context,<br/>  A_long          curr_time,<br/>  A_long          time_scale,<br/>  PF_FloatMatrix  *layer2comp);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>source_to_frame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Transforms the source coordinates in the current context to screen coordinates.</p>
<p>Screen (frame) coordinates are affected by the current zoom level.</p>
<p><pre lang="cpp">PF_Err source_to_frame(<br/>  void           *refcon,<br/>  PF_ContextH    context,<br/>  PF_FixedPoint  *pt);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>frame_to_source</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Transforms the screen coordinates identified by <code>*pt</code> to the source coordinates of the current context.</p>
<p><pre lang="cpp">PF_Err frame_to_source(<br/>  void           *refcon,<br/>  PF_ContextH    context,<br/>  PF_FixedPoint  *pt);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_GET_PLATFORM_DATA</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves platform-specific data. For plug-ins loaded with localized resource files, <code>PF_PlatData_RES_FILE_PATH</code> will point to the external file, not the plug-in file.</p>
<p>Use <code>PF_PlatData_EXE_FILE_PATH</code> if you want the path of your plug-in.</p>
<p>Starting in CS6, use <code>PF_PlatData_EXE_FILE_PATH_W</code> and <code>PF_PlatData_RES_FILE_PATH_W</code> instead of the old non-wide calls.</p>
<p><pre lang="cpp">PF_Err PF_GET_PLATFORM_DATA (<br/>  PF_PlatDataID  which,<br/>  void           *ppData);</pre></p>
<p><code>PF_PlatDataID</code> can have the following values:</p>
<ul>
<li><code>PF_PlatData_MAIN_WND</code></li>
<li><code>PF_PlatData_EXE_FILE_PATH_DEPRECATED</code></li>
<li><code>PF_PlatData_RES_FILE_PATH_DEPRECATED</code></li>
<li><code>PF_PlatData_RES_REFNUM</code> // macOS</li>
<li><code>PF_PlatData_RES_DLLINSTANCE</code> // Win</li>
<li><code>PF_PlatData_BUNDLE_REF</code></li>
<li><code>PF_PlatData_EXE_FILE_PATH_W</code> // new CS6</li>
<li><code>PF_PlatData_RES_FILE_PATH_W</code> // new CS6</li>
</ul>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="effect-ui-events-tips-and-tricks"><h1 id="effect-ui-events-tips-and-tricks-tips-tricks">Tips &amp; Tricks<a class="headerlink" href="#effect-ui-events-tips-and-tricks-tips-tricks" title="Permanent link">&para;</a></h1>
<h2 id="effect-ui-events-tips-and-tricks-ui-performance">UI Performance<a class="headerlink" href="#effect-ui-events-tips-and-tricks-ui-performance" title="Permanent link">&para;</a></h2>
<p>Experiment with <code>PF_EO_ALWAYS_UPDATE</code> and <code>PF_EO_NEVER_UPDATE</code> from <a href="#effect-ui-events-pf_eventextra">PF_EventExtra</a>, to find a happy medium between responsiveness and accuracy.</p>
<p>On macOS, the foreground and background colors are not set to white and black when custom UI draw events are sent.</p>
<p>This is by design; you don't have to change the background color when you're drawing directly into our context.</p>
<hr />
<h2 id="effect-ui-events-tips-and-tricks-how-deep-are-my-pixels">How Deep Are My Pixels?<a class="headerlink" href="#effect-ui-events-tips-and-tricks-how-deep-are-my-pixels" title="Permanent link">&para;</a></h2>
<p>There is no way to determine the bit depth of the layer(s) being processed during events.</p>
<p>However, you can cache the last-known pixel depth in your sequence data.</p>
<p>Better still, you can have your fixed and float slider parameters rely on the <code>PF_ValueDisplayFlags</code> in their parameter definitions; if you use this, it will have your parameters' UI respond to the user's preferences for pixel display values.</p>
<p>You can also check the depth of your input world during <code>PF_Cmd_RENDER</code>.</p>
<hr />
<h2 id="effect-ui-events-tips-and-tricks-arbitrary-data">Arbitrary Data<a class="headerlink" href="#effect-ui-events-tips-and-tricks-arbitrary-data" title="Permanent link">&para;</a></h2>
<p>An arbitrary data parameter is an excellent way to manage your custom UI.</p>
<p>Store state, preference, and last-item-used information in an arb, and you'll always be able to recover it.</p>
<p>After Effects manages parameters with a much richer message stream than custom UIs.</p>
<hr />
<h2 id="effect-ui-events-tips-and-tricks-custom-ui-implementation-for-color-sampling-using-keyframes">Custom UI Implementation for Color Sampling, Using Keyframes<a class="headerlink" href="#effect-ui-events-tips-and-tricks-custom-ui-implementation-for-color-sampling-using-keyframes" title="Permanent link">&para;</a></h2>
<p>A plug-in may want to get a color from a layer within a composition. The user would use the eyedropper associated with a color parameter, or the plug-in's custom composition panel UI, to select the point.</p>
<p>During the click event, the plug-in converts the coordinates of the click into layer space, and stores that information in sequence data. It then forces a re-render, during which it has access to the color of the layer point corresponding to the stored coordinates.</p>
<p>The plug-in stores the color value in sequence data, and cancels the render, requesting a redraw of the affected parameter(s).</p>
<p>Finally, during the draw, the plug-in adds appropriate keyframes to its color parameter stream using the <a href="#aegps-aegp-suites-aegp_keyframesuite3">AEGP_KeyframeSuite</a>.</p>
<p>Yes, this means the effect needs to <a href="#aegps-cheating-effect-usage-of-aegp-suites">Cheating Effect Usage of AEGP Suites</a> and use the AEGP API.</p></section><h1 class='nav-section-title-end'>Ended: Effect UI & Events</h1>
                        <h1 class='nav-section-title' id='section-audio'>
                            Audio <a class='headerlink' href='#section-audio' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="audio-audio"><h1 id="audio-audio-audio">Audio<a class="headerlink" href="#audio-audio-audio" title="Permanent link">&para;</a></h1>
<p>After Effects can process audio encoded at up to 96Khz, floating point (24-bit) resolution, mono or stereo.</p>
<p>We provide high quality resampling.</p>
<p><code>PF_InData</code> and <code>PF_OutData</code> both contain information specific to audio handling.</p>
<p>While audio isn't the focus of After Effects' feature set, it is an important component of compositing and pre-visualization workflows.</p>
<p>Also, several engineers on our team are audio fanatics, and ensure that our audio effects (and the whole audio pipeline) are of the highest quality.</p></section><section class="print-page" id="audio-global-outflags"><h1 id="audio-global-outflags-global-outflags">Global Outflags<a class="headerlink" href="#audio-global-outflags-global-outflags" title="Permanent link">&para;</a></h1>
<p>All audio effects must set either <code>PF_OutFlag_AUDIO_EFFECT_TOO</code> or <code>PF_OutFlag_AUDIO_EFFECT_ONLY</code>.</p>
<p><code>PF_OutFlag_I_USE_AUDIO</code> is for visual effects that check out audio data, but don't modify it.</p>
<p><code>PF_OutFlag_AUDIO_FLOAT_ONLY</code>, <code>PF_OutFlag_AUDIO_IIR</code> and <code>PF_OutFlag_I_SYNTHESIZE_AUDIO</code> provide greater control over audio output (see <a href="#effect-basics-pf_outdata-pf_outflags">PF_OutFlags</a> for more details).</p></section><section class="print-page" id="audio-audio-data-structures"><h1 id="audio-audio-data-structures-audio-data-structures">Audio Data Structures<a class="headerlink" href="#audio-audio-data-structures-audio-data-structures" title="Permanent link">&para;</a></h1>
<p>The following data types are used by After Effects to describe audio data.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Structure</p>
</th>
<th colspan="1" rowspan="1">
<p>Description</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_SoundFormat</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Indicates whether the audio is in unsigned pulse code modulation (PCM), signed PCM, or floating point format.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_SoundSampleSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Samples are in 1, 2, or 4 byte format.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_SoundChannels</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Indicates whether the audio is mono or stereo.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_SoundFormatInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Contains the sampling rate, number of channels, sample size, and format of the audio to which it refers.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PF_SoundWorld</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Use <code>PF_SoundWorlds</code> to represent audio.</p>
<p>In addition to a <code>PF_SoundFormatInfo</code>, they contain the length of the audio, and a pointer to the actual audio data.</p>
</td>
</tr>
</tbody>
</table>
<p><code>PF_SoundFormat</code>, <code>PF_SoundSampleSize</code>, and <code>PF_SoundChannels</code> are all contained within a <code>PF_SoundFormatInfo</code>.</p>
<p><code>PF_SoundWorlds</code> contain a <code>PF_SoundFormatInfo</code>, and further instance-specific information.</p></section><section class="print-page" id="audio-audio-specific-float-slider-variables"><h1 id="audio-audio-specific-float-slider-variables-audio-specific-float-slider-variables">Audio-Specific Float Slider Variables<a class="headerlink" href="#audio-audio-specific-float-slider-variables-audio-specific-float-slider-variables" title="Permanent link">&para;</a></h1>
<p><code>PF_Param_FLOAT_SLIDERs</code> contain several parameters not found in other sliders; flags, phase, and curve tolerance.</p>
<hr />
<h2 id="audio-audio-specific-float-slider-variables-flags">Flags<a class="headerlink" href="#audio-audio-specific-float-slider-variables-flags" title="Permanent link">&para;</a></h2>
<p>The only flag available is <code>PF_FSliderFlag_WANT_PHASE</code>.</p>
<p>This registers the effect to receive updated phase information from After Effects during audio rendering.</p>
<p>To understand what this flag does, turn it off and check your output.</p>
<hr />
<h2 id="audio-audio-specific-float-slider-variables-phase">Phase<a class="headerlink" href="#audio-audio-specific-float-slider-variables-phase" title="Permanent link">&para;</a></h2>
<p>This is where the requested phase value is stored.</p>
<hr />
<h2 id="audio-audio-specific-float-slider-variables-curve-tolerance">Curve Tolerance<a class="headerlink" href="#audio-audio-specific-float-slider-variables-curve-tolerance" title="Permanent link">&para;</a></h2>
<p>Curve tolerance is used by After Effects to subdivide the audio effects' time-variant parameters. Set this to zero for default behavior (or for non-audio <code>FLOAT_SLIDER</code> parameters).</p>
<hr />
<h2 id="audio-audio-specific-float-slider-variables-whats-zero-really">What's Zero, Really?<a class="headerlink" href="#audio-audio-specific-float-slider-variables-whats-zero-really" title="Permanent link">&para;</a></h2>
<p>When amplitude is zero, After Effects is at -192db.</p></section><section class="print-page" id="audio-accessing-audio-data"><h1 id="audio-accessing-audio-data-accessing-audio-data">Accessing Audio Data<a class="headerlink" href="#audio-accessing-audio-data-accessing-audio-data" title="Permanent link">&para;</a></h1>
<p>Use <code>PF_CHECKOUT_LAYER_AUDIO</code> from <a href="#effect-details-interaction-callback-functions">Interaction Callbacks</a> to retrieve an audio layer.</p>
<p>This layer is opaque; use <code>PF_GET_AUDIO_DATA</code> to access specific details about that audio.</p>
<p>As with pixel data, it's important that you check in the audio as soon as possible.</p>
<p>If your effect requires as input a time span different from the output time span, update the <code>startsampL</code> and <code>endsampL</code> field in <code>PF_OutData</code> during <code>PF_Cmd_AUDIO_SETUP</code> from <a href="#effect-basics-command-selectors-frame-selectors">Frame Selectors</a>.</p>
<hr />
<h2 id="audio-accessing-audio-data-extending-audio-clips">Extending Audio Clips<a class="headerlink" href="#audio-accessing-audio-data-extending-audio-clips" title="Permanent link">&para;</a></h2>
<p>You cannot extend the length of an audio clip through the API.</p>
<p>However, it is a relatively simple matter for the user to extend the length of the clip before applying your effect. Apply time remapping to the layer and simply extend the out point.</p>
<p>If you're adding a delay effect to a sounds clip, you'd want to allow it time to fade away instead of truncating the sound at the original end point.</p>
<p>Document the steps users should take when applying your effect.</p></section><section class="print-page" id="audio-audio-considerations"><h1 id="audio-audio-considerations-audio-considerations">Audio Considerations<a class="headerlink" href="#audio-audio-considerations-audio-considerations" title="Permanent link">&para;</a></h1>
<p>The After Effects audio API supports sampling rates up to 96Khz, in as many formats as possible.</p>
<p>In the same way that plug-ins' pixel manipulation functions should remain "resolution independent", audio plug-ins should be sample rate- and bit depth-independent.</p>
<p>Your plug-in can't know anything about the final output format of the audio in question; it might get stretched, normalized, truncated, or phase-inverted between the application of your plug-in and the final output.</p>
<p>Audio filters encounter different issues than do image filters.</p>
<p>Investigate the SDK sample for one possible implementation of audio rendering.</p></section><h1 class='nav-section-title-end'>Ended: Audio</h1>
                        <h1 class='nav-section-title' id='section-aegps'>
                            AEGPs <a class='headerlink' href='#section-aegps' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="aegps-aegps"><h1 id="aegps-aegps-aegps">AEGPs<a class="headerlink" href="#aegps-aegps-aegps" title="Permanent link">&para;</a></h1>
<p>The After Effects General Plug-in (AEGP) API is powerful and broad, offering functionality beyond what is available to effect plug-ins.</p>
<p>To users, AEGPs appear to be part of After Effects.</p>
<p>They can add, intercept, and trigger menu commands, access the keyframe database, and register functions as part of After Effects' internal messaging.</p>
<p>AEGPs can add and remove items to projects and compositions, add and remove filters and keyframes.</p>
<p>Once its command is triggered, AEGPs use the numerous PICA function suites (described in this section) to work with every After Effects item.</p>
<p>AEGPs can publish function suites for plug-ins, manipulate all project elements, change interpretations, replace files and determine which external files are used to render a project.</p>
<p>There are several specialized types of AEGP; Keyframers, Artisans, and I/O modules (AEIOs). They are all still AEGPs, but have access to specialized messaging streams, for which they register with After Effects.</p></section><section class="print-page" id="aegps-overview"><h1 id="aegps-overview-overview">Overview<a class="headerlink" href="#aegps-overview-overview" title="Permanent link">&para;</a></h1>
<p>AEGPs use Plug-In Component Architecture (PICA) function suites to access all functionality.</p>
<p>They may also publish their own function suites, for use by effect plug-ins (since plug-in load order varies, AEGPs can't depend on suites not provided by After Effects).</p>
<p>AEGPs can also request a suite and, if it's not present, provide replacement functionality themselves.</p>
<hr />
<h2 id="aegps-overview-aegp-communication-with-after-effects">AEGP Communication With After Effects<a class="headerlink" href="#aegps-overview-aegp-communication-with-after-effects" title="Permanent link">&para;</a></h2>
<p>For effect plug-ins, all communication with After Effects occurs through a single entry point function. This is not the case with AEGPs.</p>
<p>While After Effects <em>does</em> call the entry point function designated in the AEGP's PiPL (which is still required), all subsequent communication between After Effects and AEGPs is handled by the hook functions the AEGP registers.</p>
<p>This registration must be performed from within the plug-in's entry function, using the <a href="#aegps-aegp-suites-aegp_registersuites5">Register Suite</a>.</p>
<hr />
<h2 id="aegps-overview-different-tasks-same-api">Different Tasks, Same API<a class="headerlink" href="#aegps-overview-different-tasks-same-api" title="Permanent link">&para;</a></h2>
<p>AEGPs work in the same manner, regardless of specialization.</p>
<p>They can be simple, just <a href="#aegps-implementation-example-adding-a-menu-item">adding one menu item</a> to trigger an external application, or complex like Artisans.</p>
<p>While any plug-in can access any function suite, only plug-ins of the appropriate type will have access to all the required parameters.</p>
<p>Only Artisans will have render contexts, and only AEIO plug-ins will receive input and output specifications; messaging is dependent upon which hook functions are registered.</p></section><section class="print-page" id="aegps-data-types"><h1 id="aegps-data-types-data-types">Data Types<a class="headerlink" href="#aegps-data-types-data-types" title="Permanent link">&para;</a></h1>
<p>Whenever possible, After Effects presents plug-ins with opaque data types, and provides accessor functions for manipulating them. For example, video frames are represented using the opaque AEGP_WorldH. While in some cases it might be more efficient to simply modify the underlying structure, by maintaining the opaqueness of the data types we allow for changes to our implementation without making you recompile (and redistribute) your plug-ins.</p>
<hr />
<h2 id="aegps-data-types-aegp-api-data-types">AEGP API Data Types<a class="headerlink" href="#aegps-data-types-aegp-api-data-types" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Type</p>
</th>
<th colspan="1" rowspan="1">
<p>Describes</p>
</th>
<th colspan="1" rowspan="1">
<p>Manage Using</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_MemHandle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This structure contains more than just the referenced memory. So it should not be dereferenced directly.</p>
<p>Use <code>AEGP_LockMemHandle</code> in the AEGP Memory Suite to get a pointer to the memory referenced by the <code>AEGP_MemHandle</code>. And of course, unlock it when you're done.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_memorysuite1">AEGP Memory Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ProjectH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The current After Effects project. Projects are a set of elements arranged hierarchically in a tree to preserve semantic relationships.</p>
<p>Interior nodes of the tree are folders.</p>
<p>As of CS6, there will only ever be one open project.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_projsuite6">AEGP Project Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ItemH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>An abstraction describing any element of a project, including folders. An item is anything that can be selected.</p>
<p>Since multiple object types can be selected, we treat them as AEGP_ItemHs until more specificity is required.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_itemsuite9">AEGP Item Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_Collection2H</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A set of selected items.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_collectionsuite2">AEGP Collection Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CompH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A composition is a sequence of renderable items that, together, produce output.</p>
<p>A composition exists over a time interval.</p>
<p>Multiple compositions can exist within one project.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_compositesuite2">AEGP Composition Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_FootageH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>An item that can be rendered. Folders and compositions are the only items that are not footage.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_footagesuite5">AEGP Footage Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_LayerH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>An element of a composition. Layers are rendered in sequence, which allows for occlusions.</p>
<p>Solids, text, paint, cameras, lights, images, and image sequences are all represented as layers.</p>
<p>Layers may be defined over sub-intervals of the composition's time interval.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_layersuite9">AEGP Layer Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_WorldH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A frame of pixels.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_worldsuite3">AEGP World Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_EffectRefH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>An effect applied to a layer. An effect is a function that takes as its argument a layer (and possibly other parameters) and returns an altered version of the layer for rendering.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_effectsuite4">AEGP Effect Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_StreamRefH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Any <a href="#aegps-aegp-suites-diving-into-streams">parameter stream</a> attached to a layer, in a composition.</p>
<p>See the description of <code>AEGP_GetNewLayerStream</code> from <a href="#aegps-aegp-suites-stream-suite">AEGP_StreamSuite5</a> for a full list of stream types.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-stream-suite">AEGP Stream Suite</a>,
<a href="#aegps-aegp-suites-aegp_dynamicstreamsuite4">AEGP Dynamic Stream Suite</a>,
<a href="#aegps-aegp-suites-aegp_keyframesuite3">AEGP Keyframe Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_MaskRefH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A mask applied to a layer. An AEGP_MaskRefH is used to access details about the mask stream, not the specific points which constitute the mask.</p>
<p>A mask is a rasterized path (sequence of vertices) that partitions a layer into two pieces, allowing each to be rendered differently.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_masksuite6">AEGP Mask Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_MaskOutlineValH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The specific points which constitute the mask.</p>
<p>The points in a mask outline are ordered, and the mask need not be closed.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_maskoutlinesuite3">AEGP Mask Outline Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_TextDocumentH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Represents the actual text associated with a text layer.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_textdocumentsuite1">AEGP Text Document Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_TextOutlinesH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A reference to all the paths that make up the outlines of a given text layer.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_textlayersuite1">AEGP Text Layer Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_MarkerVal</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The data associated with a given timeline marker.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_markersuite2">AEGP Marker Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_PersistentBlobH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A "blob" of data containing the current preferences.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-persistent-data-suite">AEGP Persistent Data Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderOptionsH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The settings associated with a render request.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_renderoptionssuite4">AEGP Render Options Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_LayerRenderOptionsH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The settings associated with a layer render request.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_layerrenderoptionssuite1">AEGP Layer Render Options Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_FrameReceiptH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A reference to a rendered frame.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-render-suites">AEGP Render Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RQItemRefH</code>
</p>
</td>
<td colspan="1" rowspan="1">
<p>An item in the render queue.
</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-render-queue-suite">AEGP Render Queue Suite</a>,
<a href="#aegps-aegp-suites-render-queue-item-suite">AEGP Render Queue Item Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_OutputModuleRefH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>An output module, attached to a specific AEGP_RQItemRef in the render queue.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-output-module-suite">AEGP Output Module Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SoundDataH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The <a href="#aegps-aegp-suites-audio-settings">audio settings</a> used for a given layer.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_sounddatesuite1">AEGP Sound Data Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderLayerContextH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>State information at the time of a render request, sent to an Artisan by After Effects.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#artisans-artisan-data-types-aegp_canvassuite8">AEGP Canvas Suite</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderReceiptH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Used by Artisans when rendering.</p>
</td>
<td colspan="1" rowspan="1">
<p><a href="#artisans-artisan-data-types-aegp_canvassuite8">AEGP Canvas Suite</a></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-data-types-nasty-brutish-and-short">Nasty, Brutish, and Short<a class="headerlink" href="#aegps-data-types-nasty-brutish-and-short" title="Permanent link">&para;</a></h2>
<p>Information about layers, streams, and many other items doesn't survive long; it's often invalidated by user activity.</p>
<p>Anything that modifies the quantity (not quality) of items will invalidate references to those items; adding a keyframe to a stream invalidates references to that stream, but forcing a layer to be rendered doesn't invalidate references to it. Do not cache layer pixels.</p>
<p>Caching references between calls to a specific hook function within your plug-in is not recommended; acquire information when you need it, and forget (release) it as soon as possible.</p>
<hr />
<h2 id="aegps-data-types-were-you-just-going-to-leave-that-data-lying-around">Were You Just Going To Leave That Data Lying Around?<a class="headerlink" href="#aegps-data-types-were-you-just-going-to-leave-that-data-lying-around" title="Permanent link">&para;</a></h2>
<p>When you ask After Effects to populate and return handles to data structures, it's important that you clean up after yourself. For the following data types, you must call the appropriate disposal routines.</p>
<hr />
<h2 id="aegps-data-types-data-types-requiring-disposal">Data Types Requiring Disposal<a class="headerlink" href="#aegps-data-types-data-types-requiring-disposal" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Data Type</p>
</th>
<th colspan="1" rowspan="1">
<p>Disposal Function</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_Collection2H</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeCollection</code>, from <a href="#aegps-aegp-suites-aegp_collectionsuite2">AEGP_CollectionSuite2</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_FootageH</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeFootage</code>, from <a href="#aegps-aegp-suites-aegp_footagesuite5">AEGP_FootageSuite5</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_WorldH</code>
</p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEGP_Dispose</code>, from <a href="#aegps-aegp-suites-aegp_worldsuite3">AEGP_WorldSuite3</a>
(Or <code>AEGP_DisposeTexture</code>, from <a href="#artisans-artisan-data-types-aegp_canvassuite8">AEGP_CanvasSuite8</a>, if layer texture created using <code>AEGP_RenderTexture</code>)</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_EffectRefH</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeEffect</code>, from <a href="#aegps-aegp-suites-aegp_effectsuite4">AEGP_EffectSuite4</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_MaskRefH</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeMask</code>, from <a href="#aegps-aegp-suites-aegp_masksuite6">AEGP_MaskSuite6</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderOptionsH</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEGP_Dispose</code>, from <a href="#aegps-aegp-suites-aegp_renderqueuemonitorsuite1">AEGP_RenderQueueMonitorSuite1</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_LayerRenderOptionsH</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEGP_Dispose</code>, from <a href="#aegps-aegp-suites-aegp_layerrenderoptionssuite1">AEGP_LayerRenderOptionsSuite1</a></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderReceiptH</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeRenderReceipt</code>, from <a href="#artisans-artisan-data-types-aegp_canvassuite8">AEGP_CanvasSuite8</a></p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="aegps-implementation"><h1 id="aegps-implementation-implementation">Implementation<a class="headerlink" href="#aegps-implementation-implementation" title="Permanent link">&para;</a></h1>
<p>Because the functionality available through the AEGP API is so vast, and the integration with After Effects so complete, a good deal of design work is necessary to ensure that your plug-in behaves appropriately in all situations.</p>
<p>AEGPs interact with After Effects through PICA function suites.</p>
<p>AEGPs are not loaded in a specific order.</p>
<p>Check the version of the AEGP API (from within your AEGP's entry point function) to confirm whether a given suite will be available.</p>
<p>AEGPs may also use any effect API suite function which doesn't require a PF_ProgPtr (obtained by effects from PF_InData).</p>
<hr />
<h2 id="aegps-implementation-entry-point">Entry Point<a class="headerlink" href="#aegps-implementation-entry-point" title="Permanent link">&para;</a></h2>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">A_Err</span><span class="w"> </span><span class="n">AEGP_PluginInitFuncPrototype</span><span class="p">(</span>
</span><span id="__span-0-2"><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">SPBasicSuite</span><span class="w">  </span><span class="o">*</span><span class="n">pica_basicP</span><span class="p">,</span>
</span><span id="__span-0-3"><span class="w">    </span><span class="n">A_long</span><span class="w">               </span><span class="n">major_versionL</span><span class="p">,</span>
</span><span id="__span-0-4"><span class="w">    </span><span class="n">A_long</span><span class="w">               </span><span class="n">minor_versionL</span><span class="p">,</span>
</span><span id="__span-0-5"><span class="w">    </span><span class="n">AEGP_PluginID</span><span class="w">        </span><span class="n">aegp_plugin_id</span><span class="p">,</span>
</span><span id="__span-0-6"><span class="w">    </span><span class="n">AEGP_GlobalRefcon</span><span class="w">    </span><span class="o">*</span><span class="n">global_refconP</span><span class="p">)</span>
</span></code></pre></div>
<p>The plug-in's entry point, exported in the <a href="#intro-pipl-resources">PiPL Resources</a>, is called just once during launch; all other calls to the AEGP go to the functions it's registered.</p>
<p>This is very different from the effect plug-in model, where all communication comes through the same entry point.</p>
<p>Because plug-in load order may vary, it's never a good idea to acquire suites not provided by After Effects during your entry point function. Rather, wait until the appropriate hook function(s).</p>
<p>The AEGP <a href="#intro-compatibility-across-multiple-versions-api-versions">API Versions</a> can help distinguish between different versions of After Effects, in case the AEGP needs to behave differently or handle different behavior.</p>
<p>Those other functions are registered as callback hooks. An AEGP that adds menu items must register an UpdateMenuHook function (with a function signature as described in AE_GeneralPlug.h) which After Effects can call to determine whether or not to enable those items. Similarly, plug-ins which process commands register a CommandHook (one for all commands).</p>
<hr />
<h2 id="aegps-implementation-specialization">Specialization<a class="headerlink" href="#aegps-implementation-specialization" title="Permanent link">&para;</a></h2>
<p>AEIOs and Artisans must register with After Effects in order to receive the messaging streams on which they depend.</p>
<p>Like everything else in the AEGP API, this is done through a function suite; in this case, the aptly-named AEGP_RegisterSuite.</p>
<hr />
<h2 id="aegps-implementation-example-adding-a-menu-item">Example: Adding A Menu Item<a class="headerlink" href="#aegps-implementation-example-adding-a-menu-item" title="Permanent link">&para;</a></h2>
<p>During your entry point function, use <code>AEGP_GetUniqueCommand()</code> from <a href="#aegps-aegp-suites-aegp_commandsuite1">Command Suite</a> to obtain a command ID from After Effects, for use with <code>AEGP_InsertMenuCommand</code>. Use a different ID for each menu item you add.</p>
<p>Using AEGP_RegisterSuite's <code>AEGP_RegisterCommandHook()</code>, tell After Effects which function to call when your menu item(s) are selected. The function you register using <code>AEGP_RegisterUpdateMenuHook()</code> enables and disabling your menu item(s). Your menu item(s) will be permanently disabled unless you register a menu updating function.</p>
<p>No matter how many menu items you add, you register only one CommandHook. When called, determine which menu item was chosen (based on the command ID), use AEGP PICA suite functions to determine the current state of the project, and act accordingly. For example, keyframing plug-ins may want to disable their menu items unless a (keyframe-able) parameter stream is part of the current selection.</p>
<hr />
<h2 id="aegps-implementation-private-data">Private Data<a class="headerlink" href="#aegps-implementation-private-data" title="Permanent link">&para;</a></h2>
<p>Unlike effects, AEGPs are never unloaded during an After Effects session. Still, that doesn't mean that relying on static and global variables is a good idea.</p>
<p>All hook functions are passed a plugin_refconPV for storage information specific to that function. Many AEGP Suite functions take the <code>aegp_plugin_id</code> as a parameter; store it in the <code>global_refconPV</code> you are passed, either in a structure you allocate or just the ID itself.</p>
<p>Where possible, use these refcons to store information, not statics and global variables. This becomes especially important when dealing with multi-threading issues.</p>
<p>Use <code>global_refconPV</code> for your globals (like your <code>aegp_plugin_id</code>) and refcon for hook-function-specific storage.</p>
<p>A potential "multiple instances of After Effects" gotcha; when a second, command-line instance of After Effects is launched, all of an AEGP's handles are duplicated. If this causes problems (and it may), provide code that attaches saved handles to specific instantiations of your plug-in.</p>
<hr />
<h2 id="aegps-implementation-threading">Threading<a class="headerlink" href="#aegps-implementation-threading" title="Permanent link">&para;</a></h2>
<p>AEGP supports no threading at all. Everything must be done from the main thread, either in response to a callback, or from the idle hook.</p>
<p>There is one call that is thread safe: <code>AEGP_CauseIdleRoutinesToBeCalled()</code>.</p>
<p>But since <code>SPBasicSuite</code> itself is not thread safe, you'll need to stash off the function pointer in the main thread.</p></section><section class="print-page" id="aegps-aegp-suites"><h1 id="aegps-aegp-suites-aegp-suites">AEGP Suites<a class="headerlink" href="#aegps-aegp-suites-aegp-suites" title="Permanent link">&para;</a></h1>
<p>As mentioned earlier, AEGPs do everything through suites. The following suites are used by all types of AEGPs, and may be called from within any hook function (except for the RegisterSuite, which must be used from within the AEGP's entry point). Following is a description of each function in every suite, and, where appropriate details on using those functions.</p>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Suite</p>
</th>
<th colspan="1" rowspan="1">
<p>Description</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_memorysuite1">Memory Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Manage memory resources. Use this suite! Whenever memory-related errors are encountered, After Effects can report errors for you.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_commandsuite1">Command Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Manage your AEGP's menu items. Used in conjunction with the Register Suite.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_registersuites5">Register Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Used in conjunction with the <a href="#aegps-aegp-suites-aegp_commandsuite1">Command Suite</a> to add functions to menu commands.</p>
<p>AEIOs and Artisans must use this suite's functions to indicate to After Effects that they want to receive the appropriate message streams.</p>
<p>You can replace some After Effects' commands using this suite.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_projsuite6">Project Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Reads and modifies project data.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_itemsuite9">Item Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Manages items within a project or composition.</p>
<p>Folders, Compositions, Solids, and Footage are all items.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_collectionsuite2">Collection Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Query which items are currently selected, and create your own selection sets.</p>
<p>It's often a good UI move to select all the items your AEGP has modified, just to give the user some idea what you've done.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_compositesuite2">Composition Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Manages (and creates) compositions in a project, and composition-specific items like solids.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_footagesuite5">Footage Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Manages footage.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_layersuite9">Layer Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Provides information about the layers within a composition, and the relationship(s) between the source and layer times.</p>
<p>Solids, text, paint, cameras, lights, images, and image sequences can all become layers.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_effectsuite4">Effect Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Provides access to the effects applied to a layer.</p>
<p>Use Stream suites to obtain effect keyframe information.</p>
<p>Use <code>AEGP_EffectCallGeneric()</code> (in <a href="#aegps-aegp-suites-aegp_effectsuite4">AEGP_EffectSuite4</a>) to communicate with effects that you setup ahead of time to respond to your AEGP.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-stream-suite">Stream Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Used to access the values of a layer's keyframe properties.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_dynamicstreamsuite4">Dynamic Stream Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Used to access the characteristics of dynamic streams associated with a layer.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_keyframesuite3">Keyframe Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Used to access and manipulate all keyframe data.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_markersuite2">Marker Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Used to manipulate markers. Use <code>AEGP_GetNewCompMarkerStream()</code> (in <a href="#aegps-aegp-suites-aegp_compsuite11">AEGP_CompSuite11</a>) to get the composition marker stream.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_masksuite6">Mask Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Provides access to retrieve information about a layer's masks.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_maskoutlinesuite3">Mask Outline Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Used in conjunction with Stream Suite, this suite provides detailed information about the path rendered to make a layer's mask.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_textdocumentsuite1">Text Document Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Used to access the actual text on a text layer.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_textlayersuite1">Text Layer Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Used to access the paths that make up the outlines of a text layer.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_utilitysuite6">Utility Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Supplies error message handling, AEGP version checking and access to After Effects' undo stack.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_persistentdatesuite4">Persistent Data Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Query and manage all persistent data (i.e., the preferences file).</p>
<p>AEGPs can also add their own data to the prefs.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_colorsettingssuite5">Color Settings Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtain information on After Effects' current color management settings.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_rendersuite4">Render Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Get rendered frames (and audio samples) from within an AEGP.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_worldsuite3">World Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Allocate, dispose of, and query AEGP_Worlds.</p>
<p>Also provides a way to convert a <code>PF_EffectWorld</code> into an <code>AEGP_World</code>, for working with effect plug-ins.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_compositesuite2">Composite Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Exposes After Effects' compositing functionality, including transfer modes, track matting, and good old fashioned bit copying.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_sounddatesuite1">Sound Data Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Functions for managing and accessing sound data.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_renderqueuesuite1">Render Queue Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Add and remove items from the render queue.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-render-queue-item-suite">Render Queue Item Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Query and modify items in the render queue.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_renderoptionssuite4">Render Options Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Query and manage all items exposed in a render queue item's options dialog.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-output-module-suite">Output Module Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Query and modify the output modules attached to items in the render queue.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_pfinterfacesuite1">PF Interface Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>The functions in this suite, while technically part of the AEGP API, are for use by effects.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-aegp_iteratesuite1">AEGP Iterate Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Gives AEGPs a way to have a function (which has the required signature) to be run on any or all available processors.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><a href="#aegps-aegp-suites-file-import-manager-suite">File Import Manager Suite</a></p>
</td>
<td colspan="1" rowspan="1">
<p>Registers AEGP file and project importers as part of After Effects' file handling.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-fail-gracefully">Fail Gracefully<a class="headerlink" href="#aegps-aegp-suites-fail-gracefully" title="Permanent link">&para;</a></h2>
<p>If a suite isn't present, make every attempt to fail gracefully. Show the user a message indicating the nature of the problem. Attempt to acquire and use an earlier version of the same suite.</p>
<p>Since AEGPs are so deeply integrated with After Effects, make sure that users know who or what is encountering a given problem.</p>
<p>Identify yourself! Provide support and/or help information to the user whenever possible.</p>
<hr />
<h2 id="aegps-aegp-suites-handling-handles">Handling Handles<a class="headerlink" href="#aegps-aegp-suites-handling-handles" title="Permanent link">&para;</a></h2>
<p>Use the AEGP Memory Suite to manage memory used by the AEGP. Whenever memory related errors are encountered, After Effects can report errors for you to find early on.</p>
<p><code>AEGP_MemHandle</code> is a structure that contains more than just the referenced memory. So it should not be dereferenced directly. Use <code>AEGP_LockMemHandle</code> to get a pointer to the memory referenced by the <code>AEGP_MemHandle</code>.</p>
<p>And of course, unlock it when you're done.</p>
<h3 id="aegps-aegp-suites-aegp_memorysuite1">AEGP_MemorySuite1<a class="headerlink" href="#aegps-aegp-suites-aegp_memorysuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewMemHandle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Create a new memory handle. This memory is guaranteed to be 16-byte aligned.
<code>plugin_id</code> is the ID passed in through the main <a href="#aegps-implementation-entry-point">Entry Point</a>, or alternatively what you obtained from <code>AEGP_RegisterWithAEGP()</code> (from <a href="#aegps-aegp-suites-aegp_utilitysuite6">AEGP_UtilitySuite6</a>).</p>
<p>Use <code>whatZ</code> to identify the memory you are asking for. After Effects uses the string to display any related error messages.</p>
<p><pre lang="cpp">AEGP_NewMemHandle(<br/>  AEGP_PluginID   *plugin_id,<br/>  const A_char    *whatZ,<br/>  AEGP_MemSize    size,<br/>  AEGP_MemFlag    flags,<br/>  AEGP_MemHandle  *memPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_FreeMemHandle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Release a handle you allocated using <code>AEGP_NewMemHandle()</code>.</p>
<p><pre lang="cpp">AEGP_FreeMemHandle(<br/>  AEGP_MemHandle  memH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_LockMemHandle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Locks the handle into memory (cannot be moved by OS). Use this function prior to using memory allocated by <code>AEGP_NewMemHandle()</code>. Can be nested.</p>
<p><pre lang="cpp">AEGP_LockMemHandle(<br/>  AEGP_MemHandle  memH,<br/>  void            *ptr_to_ptr);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_UnlockMemHandle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Allows OS to move the referenced memory. Always balance lock calls with unlocks.</p>
<p><pre lang="cpp">AEGP_UnlockMemHandle(<br/>  AEGP_MemHandle  memH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMemHandleSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the allocated size of the handle.</p>
<p><pre lang="cpp">AEGP_GetMemHandleSize AEGP_MemHandle memH,<br/>  AEGP_MemSize  *sizeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ResizeMemHandle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Changes the allocated size of the handle.</p>
<p><pre lang="cpp">AEGP_ResizeMemHandle(<br/>  const char      *whatZ,<br/>  AEGP_MemSize    new_size,<br/>  AEGP_MemHandle  memH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMemReportingOn</code></p>
</td>
<td colspan="1" rowspan="1">
<p>If After Effects runs into problems with the memory handling, the error should be reported to the user.
Make use of this during development!</p>
<p>Only memory allocated and then leaked using this suite is reported using this call, so for example memory allocated using <a href="#effect-details-memory-allocation-pf_handlesuite1">PF_HandleSuite1</a> will not be reported.</p>
<p><pre lang="cpp">AEGP_SetMemReportingOn(<br/>  A_Boolean  turn_OnB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMemStats</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtain information about the number of currently allocated handles and their total size.</p>
<p>Only memory allocated using this suite is tracked and reported using this call, so for example memory allocated using <a href="#effect-details-memory-allocation-pf_handlesuite1">PF_HandleSuite1</a> will not be reported here.</p>
<p><pre lang="cpp">AEGP_GetMemStats(<br/>  AEGP_MemID  mem_id,<br/>  A_long      *countPL,<br/>  A_long      *sizePL);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-managing-menu-items">Managing Menu Items<a class="headerlink" href="#aegps-aegp-suites-managing-menu-items" title="Permanent link">&para;</a></h2>
<p>Command Suites allow you to create and handle any menu events.</p>
<p>To add your own menu commands, you must also use <a href="#aegps-aegp-suites-aegp_registersuites5">Register Suite</a> to assign handlers to menu events.</p>
<h3 id="aegps-aegp-suites-aegp_commandsuite1">AEGP_CommandSuite1<a class="headerlink" href="#aegps-aegp-suites-aegp_commandsuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetUniqueCommand</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtain a unique command identifier. Use the <a href="#aegps-aegp-suites-aegp_registersuites5r">Register Suite</a> to register a handler for the command.</p>
<p><pre lang="cpp">AEGP_GetUniqueCommand(<br/>  AEGP_Command  *unique_commandP);</pre></p>
<p>Note: On occasion After Effects will send command 0 (zero), so don't use that as part of your command handling logic.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_InsertMenuCommand</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Add a new menu command. Using <code>nameZ = "-"</code> will insert a separator.</p>
<p><code>menu_ID</code> can be:</p>
<ul>
<li><code>AEGP_Menu_NONE</code></li>
<li><code>AEGP_Menu_APPLE</code></li>
<li><code>AEGP_Menu_FILE</code></li>
<li><code>AEGP_Menu_EDIT</code></li>
<li><code>AEGP_Menu_COMPOSITION</code></li>
<li><code>AEGP_Menu_LAYER</code></li>
<li><code>AEGP_Menu_EFFECT</code></li>
<li><code>AEGP_Menu_WINDOW</code></li>
<li><code>AEGP_Menu_FLOATERS</code></li>
<li><code>AEGP_Menu_KF_ASSIST</code></li>
<li><code>AEGP_Menu_IMPORT</code></li>
<li><code>AEGP_Menu_SAVE_FRAME_AS</code></li>
<li><code>AEGP_Menu_PREFS</code></li>
<li><code>AEGP_Menu_EXPORT</code></li>
<li><code>AEGP_Menu_ANIMATION</code></li>
<li><code>AEGP_Menu_PURGE</code></li>
<li><code>AEGP_Menu_NEW</code> - Supported in CC and later</li>
</ul>
<p>Locations can be set to a specific location in the menu or can be one assigned by After Effects:</p>
<ul>
<li><code>AEGP_MENU_INSERT_SORTED</code></li>
<li><code>AEGP_MENU_INSERT_AT_BOTTOM</code></li>
<li><code>AEGP_MENU_INSERT_AT_TOP</code></li>
</ul>
<p>For <code>AEGP_Menu_WINDOW</code>, the BOTTOM and TOP options haven't been supported since CS4 and will return an error. We recommend <code>SORTED</code>.</p>
<p><pre lang="cpp">AEGP_InsertMenuCommand(<br/>  AEGP_Command  command,<br/>  const A_char  *nameZ,<br/>  AEGP_MenuID   menu_id,<br/>  A_long        after_itemL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RemoveMenuCommand</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Remove a menu command. If you were so motivated, you could remove ALL of the After Effects menu items.</p>
<p><pre lang="cpp">AEGP_RemoveMenuCommand(<br/>  AEGP_Command  command);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCommandName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set menu name of a command.</p>
<p><pre lang="cpp">AEGP_SetCommandName(<br/>  AEGP_Command  command,<br/>  const A_char  *nameZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_EnableCommand</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Enable a menu command.</p>
<p><pre lang="cpp">AEGP_EnableCommand(<br/>  AEGP_Command  command);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisableCommand</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Disable a menu command.</p>
<p><pre lang="cpp">AEGP_DisableCommand(<br/>  AEGP_Command  command);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CheckMarkMenuCommand</code></p>
</td>
<td colspan="1" rowspan="1">
<p>After Effects will draw a check mark next to the menu command.</p>
<p><pre lang="cpp">AEGP_CheckMarkMenuCommand(<br/>  AEGP_Command  command,<br/>  A_Boolean     checkB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DoCommand</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Call the handler for a specified menu command. Every After Effects menu item has an associated command.</p>
<p>Note that we make no guarantees that command IDs will be consistent from version to version.</p>
<p><pre lang="cpp">AEGP_DoCommand(<br/>  AEGP_Command  command);</pre></p>
<p>Having given the disclaimer above, here are a few command numbers that have been supplied to other developers, and may be of interest:</p>
<ul>
<li><code>3061</code> - Open selection, ignoring any modifier keys.</li>
<li><code>10314</code> - Play/Stop (valid in 13.5 and later)</li>
<li><code>2285</code> - RAM Preview (valid prior to 13.5)</li>
<li><code>2415</code> - Play (spacebar) (valid prior to 13.5)</li>
<li><code>2997</code> - Crop composition to region of interest.</li>
<li><code>2372</code> - Edit &gt; Purge &gt; Image Caches</li>
</ul>
<p>If your AEGP needs to call some other After Effects menu item, there's a fairly easy way to find out most commands you want, using scripting:</p>
<p><pre lang="js">cmd = app.findMenuCommandId(text); // e.g. text = "Open Project..."<br/>alert(cmd);</pre></p>
<p>With AE running, just open up Adobe ExtendScript Toolkit CC, copy the above script in, and in the app drop-down choose the version of After Effects you have running. Then hit the Play button to run the script in AE. Otherwise, contact <a href="mailto:zlam@adobe.com">API Engineering</a> for the command number.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-registering-with-after-effects">Registering with After Effects<a class="headerlink" href="#aegps-aegp-suites-registering-with-after-effects" title="Permanent link">&para;</a></h2>
<p>Register functions for After Effects' use.</p>
<h3 id="aegps-aegp-suites-aegp_registersuites5">AEGP_RegisterSuites5<a class="headerlink" href="#aegps-aegp-suites-aegp_registersuites5" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterCommandHook</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Register a hook (command handler) function with After Effects.</p>
<p>If you are replacing a function which After Effects also handles, <code>AEGP_HookPriority</code> determines whether your plug-in gets it first.</p>
<ul>
<li><code>AEGP_HP_BeforeAE</code></li>
<li><code>AEGP_HP_AfterAE</code></li>
</ul>
<p>For each menu item you add, obtain your own <code>AEGP_Command</code> using <code>AEGP_GetUniqueCommand()</code> (from <a href="#aegps-aegp-suites-aegp_commandsuite1">AEGP_CommandSuite1</a>) prior registering a single <code>command_hook_func</code>.</p>
<p>Determine which command was sent within this hook function, and act accordingly.</p>
<p>Currently, <code>AEGP_HookPriority</code> is ignored.</p>
<p><pre lang="cpp">AEGP_RegisterCommandHook(<br/>  AEGP_PluginID      aegp_plugin_id,<br/>  AEGP_HookPriority  hook_priority,<br/>  AEGP_Command       command,<br/>  AEGP_CommandHook   command_hook_func<br/>  void               *refconPV);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterUpdateMenuHook</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Register your menu update function (which determines whether or not items are active), called every time any menu is to be drawn.</p>
<p>This hook function handles updates for all menus.</p>
<p><pre lang="cpp">AEGP_RegisterUpdateMenuHook(<br/>  AEGP_PluginID        aegp_plugin_id,<br/>  AEGP_UpdateMenuHook  update_menu_hook_func,<br/>  void                 *refconPV);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterDeathHook</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Register your termination function. Called when the application quits.</p>
<p><pre lang="cpp">AEGP_RegisterDeathHook(<br/>  AEGP_PluginID   aegp_plugin_id,<br/>  AEGP_DeathHook  death_hook_func,<br/>  void            *refconPV);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterVersionHook</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Currently not called.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterAboutStringHook</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Currently not called.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterAboutHook</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Currently not called.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterArtisan</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Register your Artisan. See <a href="#artisans-artisans">Artisans</a> for more details.</p>
<p><pre lang="cpp">AEGP_RegisterArtisan(<br/>  A_Version              api_version,<br/>  A_Version              Artisan_version,<br/>  long                   aegp_plugin_id,<br/>  void                   *aegp_refconPV,<br/>  const A_char           *match_nameZ,<br/>  const A_char           *Artisan_nameZ,<br/>  PR_ArtisanEntryPoints  *entry_funcsP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterIO</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Register your AEIO plug-in. See <a href="#aeios-aeios">AEIOs</a> for more details.</p>
<p><pre lang="cpp">AEGP_RegisterIO (<br/>  AEGP_PluginID              aegp_plugin_id,<br/>  AEGP_IORefcon              aegp_refconP,<br/>  const AEIO_ModuleInfo      *io_infoP,<br/>  const AEIO_FunctionBlock4  *aeio_fcn_blockP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterIdleHook</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Register your IdleHook function. After Effects will call the function sporadically, while the user makes difficult artistic decisions (or while they're getting more coffee).</p>
<p><pre lang="cpp">AEGP_RegisterIdleHook(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_IdleHook    idle_hook_func,<br/>  AEGP_IdleRefcon  refconP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterInteractiveArtisan</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Registers your AEGP as an interactive artisan, for use in previewing and rendering all layers in a given composition.</p>
<p><pre lang="cpp">AEGP_RegisterInteractiveArtisan (<br/>  A_Version              api_version,<br/>  A_Version              artisan_version,<br/>  AEGP_PluginID          aegp_plugin_id,<br/>  void                   *aegp_refconPV,<br/>  const A_char           *match_nameZ,<br/>  const A_char           *artisan_nameZ,<br/>  PR_ArtisanEntryPoints  *entry_funcsP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterPresetLocalizationString</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Call this to register as many strings as you like for name-replacement when presets are loaded.</p>
<p>Any time a Property name is found, or referred to in an expression, and it starts with an ASCII tab character ('t'), followed by one of the English names, it will be replaced with the localized name.</p>
<p>(In English the tab character will simply be removed).</p>
<p><pre lang="cpp">AEGP_RegisterPresetLocalizationString(<br/>  const A_char  *english_nameZ,<br/>  const A_char  *localized_nameZ);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-manage-projects">Manage Projects<a class="headerlink" href="#aegps-aegp-suites-manage-projects" title="Permanent link">&para;</a></h2>
<p>These functions access and modify project data. Support for multiple projects is included to prepare for future expansion;
After Effects currently adheres to the single project model.</p>
<p>To save project-specific data in After Effects' preferences (and thus, outside the projects themselves), use the <a href="#aegps-aegp-suites-persistent-data-suite">Persistent Data Suite</a>.</p>
<p>Use caution: the functions for opening and creating projects do not save changes to the project currently open when they are called!</p>
<h3 id="aegps-aegp-suites-aegp_projsuite6">AEGP_ProjSuite6<a class="headerlink" href="#aegps-aegp-suites-aegp_projsuite6" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NumProjects</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Currently will never return more than 1. After Effects can have only one project open at a time.</p>
<p><pre lang="cpp">AEGP_GetNumProjects(<br/>  A_long  *num_projPL)</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetIndProject</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves a specific project by index.</p>
<p><pre lang="cpp">AEGP_GetProjectProjectByIndex(<br/>  A_long         proj_indexL,<br/>  AEGP_ProjectH  *projPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetProjectName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the project name (up to <code>AEGP_MAX_PROJ_NAME_LEN + 1</code>) in length.</p>
<p><pre lang="cpp">AEGP_GetProjectName(<br/>  AEGP_ProjectH  projH,<br/>  A_char         *nameZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetProjectPath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the path of the project (empty string the project hasn't been saved yet).</p>
<p>The path is a handle to a NULL-terminated A_UTF16Char string, and must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetProjectPath(<br/>  AEGP_ProjectH   projH,<br/>  AEGP_MemHandle  *unicode_pathPH)</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetProjectRootFolder</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the root of the project, which After Effects also treats as a folder.</p>
<p><pre lang="cpp">AEGP_GetProjectRootFolder(<br/>  AEGP_ProjectH  projH,<br/>  AEGP_ItemH     *root_folderPH)</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SaveProjectToPath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Saves the entire project to the specified full path.</p>
<p>The file path is a NULL-terminated UTF-16 string with platform separators.</p>
<p><pre lang="cpp">AEGP_SaveProjectToPath(<br/>  AEGP_ProjectH      projH,<br/>  const A_UTF16Char  *pathZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetProjectTimeDisplay</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the current time display settings.</p>
<p><pre lang="cpp">AEGP_GetProjectTimeDisplay(<br/>  AEGP_ProjectH      projH,<br/>  AEGP_TimeDisplay3  *time_displayP);<br/><br/>typedef struct {<br/>  AEGP_TimeDisplayMode            display_mode;<br/>  AEGP_SourceTimecodeDisplayMode  footage_display_mode;<br/>  A_Boolean                       display_dropframeB;<br/>  A_Boolean                       use_feet_framesB;<br/>  A_char                          timebaseC;<br/>  A_char                          frames_per_footC;<br/>  AEGP_FramesDisplayMode          frames_display_mode;<br/>} AEGP_TimeDisplay3;<br/><br/>enum {<br/>  AEGP_TimeDisplay_TIMECODE = 0,<br/>  AEGP_TimeDisplay_FRAMES<br/>};<br/><br/>typedef char AEGP_TimeDisplayMode;<br/><br/>typedef char AEGP_FramesDisplayMode;</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetProjectTimeDisplay</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specified the settings to be used for displaying time.</p>
<p><pre lang="cpp">AEGP_SetProjectTimeDisplay(<br/>  AEGP_ProjectH            projH,<br/>  const AEGP_TimeDisplay3  *time_displayP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ProjectIsDirty</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns <code>TRUE</code> if the project has been modified since it was opened.</p>
<p><pre lang="cpp">AEGP_ProjectIsDirty(<br/>  AEGP_ProjectH  projH,<br/>  A_Boolean      *is_dirtyPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SaveProjectAs</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Saves the project to the specified path.</p>
<p>The file path is a NULL-terminated UTF-16 string with platform separators.</p>
<p>NOTE: This will overwrite an existing file.</p>
<p><pre lang="cpp">AEGP_SaveProjectAs(<br/>  AEGP_ProjectH      projH,<br/>  const A_UTF16Char  *pathZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewProject</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a new project. NOTE: Will close the current project without saving it first!</p>
<p><pre lang="cpp">AEGP_NewProject(<br/>  AEGP_ProjectH  *new_projectPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_OpenProjectFromPath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Opens a project from the supplied path, and returns its <code>AEGP_ProjectH</code>.</p>
<p>The file path is a NULL-terminated UTF-16 string with platform separators.</p>
<p>NOTE: Will close the current project without saving it first!</p>
<p><pre lang="cpp">AEGP_OpenProjectFromPath(<br/>  const A_UTF16Char  *pathZ,<br/>  AEGP_ProjectH      *projectPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetProjectBitDepth</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the project bit depth.</p>
<p><pre lang="cpp">AEGP_GetProjectBitDepth(<br/>  AEGP_Projec        tH projectH,<br/>  AEGP_ProjBitDepth  *bit_depthP);</pre></p>
<p>AEGP_ProjBitDepth will be one of the following:</p>
<ul>
<li><code>AEGP_ProjBitDepth_8</code></li>
<li><code>AEGP_ProjBitDepth_16</code></li>
<li><code>AEGP_ProjBitDepth_32</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetProjectBitDepth</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the project bit depth. Undoable.</p>
<p><pre lang="cpp">AEGP_SetProjectBitDepth(<br/>  AEGP_ProjectH      projectH,<br/>  AEGP_ProjBitDepth  bit_depth);</pre></p>
</td>
</tr>
</tbody>
</table>
<h3 id="aegps-aegp-suites-aegp_timedisplay2">AEGP_TimeDisplay2<a class="headerlink" href="#aegps-aegp-suites-aegp_timedisplay2" title="Permanent link">&para;</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Values in unused fields persist when After Effects is using a different display type.</p>
</div>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Member</p>
</th>
<th colspan="1" rowspan="1">
<p>Descrpition</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_TimeDisplayType type;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>One of the following:</p>
<ul>
<li><code>AEGP_TimeDisplayType_TIMECODE</code></li>
<li><code>AEGP_TimeDisplayType_FRAMES</code></li>
<li><code>AEGP_TimeDisplayType_FEET_AND_FRAMES</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_char timebaseC;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>0 - 100. Only used for <code>AEGP_TimeDisplayType_TIMECODE</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_Boolean non_drop_30B;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>When the timebase is 30 and the item's framerate is 29.97, determines whether to display as non-drop frame.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_char frames_per_footC;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Only used for <code>AEGP_TimeDisplayType_FEET_AND_FRAMES</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_long starting_frameL;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Usually 0 or 1. Not used when type is usually 0 or 1, not used for <code>AEGP_TimeDisplayType_TIMECODE</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_Boolean auto_timecode_baseB;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>If <code>TRUE</code>, the project timecode display setting is set to auto.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-control-items-within-projects">Control Items Within Projects<a class="headerlink" href="#aegps-aegp-suites-control-items-within-projects" title="Permanent link">&para;</a></h2>
<p>Accesses and modifies items within a project or composition.</p>
<p>Anything in the project bin is an <code>AEGP_Item</code>. Note that cameras have no source, and thus have no <code>AEGP_ItemH</code>.</p>
<p>Unless more specificity is required for the function(s) you're using, remain as abstract as possible; AEGP_Comps are passed into and returned from most functions as AEGP_Items.</p>
<h3 id="aegps-aegp-suites-aegp_itemsuite9">AEGP_ItemSuite9<a class="headerlink" href="#aegps-aegp-suites-aegp_itemsuite9" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetFirstProjItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the first item in a given project.</p>
<p><pre lang="cpp">AEGP_GetFirstProjItem(<br/>  AEGP_ProjectH  projectH,<br/>  AEGP_ItemH     *itemPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNextProjItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the next project item; <code>*next_itemPH</code> will be <code>NULL</code> after the last item.</p>
<p><pre lang="cpp">AEGP_GetNextProjItem(<br/>  AEGP_ProjectH  projectH,<br/>  AEGP_ItemH     itemH,<br/>  AEGP_ItemH     *next_itemPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetActiveItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>If the Project window is active, the active item is the selected item (if only one item is selected).</p>
<p>If a Composition, Timeline, or Footage window is active, returns the parent of the layer associated with the front-most tab in the window.</p>
<p>Returns NULL if no item is active.</p>
<p><pre lang="cpp">AEGP_GetActiveItem(<br/>  AEGP_ItemH  *itemPH,</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsItemSelected</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns true if the Project window is active and the item is selected.</p>
<p><pre lang="cpp">AEGP_IsItemSelected(<br/>  AEGP_ItemH  itemH,<br/>  A_Boolean   *selectedPB)</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SelectItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Toggles the selection state of the item, and (depending on <code>deselect_othersB</code>) can deselect other items. This call selects items in the Project panel.</p>
<p>To make selections in the Composition panel, use <code>AEGP_SetSelection</code> from <a href="#aegps-aegp-suites-aegp_compsuite11">AEGP_CompSuite11</a>.</p>
<p><pre lang="cpp">AEGP_SelectItem(<br/>  AEGP_ItemH  itemH,<br/>  A_Boolean   selectB,<br/>  A_Boolean   deselect_othersB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Gets type of an item. Note: solids don't appear in the project, but can be the source to a layer.</p>
<p><pre lang="cpp">AEGP_GetItemType(<br/>  AEGP_ItemH     itemH,<br/>  AEGP_ItemType  *item_typeP);</pre></p>
<p>Items are one of the following types:</p>
<ul>
<li><code>AEGP_ItemType_NONE</code></li>
<li><code>AEGP_ItemType_FOLDER</code></li>
<li><code>AEGP_ItemType_COMP</code></li>
<li><code>AEGP_ItemType_SOLID</code></li>
<li><code>AEGP_ItemType_FOOTAGE</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetTypeName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get name of type. (name length up to <code>AEGP_MAX_TYPE_NAME_LEN + 1</code>).</p>
<p><pre lang="cpp">AEGP_GetTypeName(<br/>  AEGP_ItemType  item_type,<br/>  A_char         *nameZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get item name. (name length has no limit).</p>
<p><code>unicode_namePH</code> points to <code>A_UTF16Char</code> (contains null terminated UTF16 string).</p>
<p>It must be disposed with <code>AEGP_FreeMemHandle</code> .</p>
<p><pre lang="cpp">AEGP_GetItemName(<br/>  AEGP_PluginID  pluginID,<br/>  AEGP_ItemH     itemH,<br/>  AEGP_MemHandle *unicode_namePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetItemName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the name of the AEGP_ItemH. (name length has no limit). Undoable.</p>
<p><pre lang="cpp">AEGP_SetItemName(<br/>  AEGP_ItemH         itemH,<br/>  const A_UTF16Char  *nameZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemID</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the item's unique ID, which persists across saves and loads of the project.</p>
<p><pre lang="cpp">AEGP_GetItemID(<br/>  AEGP_ItemH  itemH,<br/>  A_long      *item_idPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemFlags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get properties of an item.</p>
<p><pre lang="cpp">AEGP_GetItemFlags(<br/>  AEGP_ItemH      itemH,<br/>  AEGP_ItemFlags  *item_flagsP);</pre></p>
<p>Flag values (may be OR'd together):</p>
<ul>
<li><code>AEGP_ItemFlag_MISSING</code></li>
<li><code>AEGP_ItemFlag_HAS_PROXY</code></li>
<li><code>AEGP_ItemFlag_USING_PROXY</code></li>
<li><code>AEGP_ItemFlag_MISSING_PROXY</code></li>
<li><code>AEGP_ItemFlag_HAS_VIDEO</code></li>
<li><code>AEGP_ItemFlag_HAS_AUDIO</code></li>
<li><code>AEGP_ItemFlag_STILL</code></li>
<li><code>AEGP_ItemFlag_HAS_ACTIVE_AUDIO</code></li>
</ul>
<p>Unlike the <code>HAS_AUDIO</code> flag, this bit flag will set only if the comp has at least one layer where audio is actually on.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetItemUseProxy</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Toggle item's proxy usage. Undoable.</p>
<p><pre lang="cpp">AEGP_SetItemUseProxy(<br/>  AEGP_ItemH  itemH,<br/>  A_Boolean   use_proxyB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemParentFolder</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get folder containing item.</p>
<p><pre lang="cpp">AEGP_GetItemParentFolder(<br/>  AEGP_ItemH  itemH,<br/>  AEGP_ItemH  *parent_itemPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetItemParentFolder</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets an item's parent folder. Undoable.</p>
<p><pre lang="cpp">AEGP_SetItemParentFolder(<br/>  AEGP_ItemH  itemH,<br/>  AEGP_ItemH  parent_folderH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get duration of item, in seconds.</p>
<p><pre lang="cpp">AEGP_GetItemDuration(<br/>  AEGP_ItemH  itemH,<br/>  A_Time      *durationPT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemCurrentTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get current time within item. Not updated while rendering.</p>
<p><pre lang="cpp">AEGP_GetItemCurrentTime(<br/>  AEGP_ItemH  itemH,<br/>  A_long      *curr_timePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemDimensions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get width and height of item.</p>
<p><pre lang="cpp">AEGP_GetItemDimensions(<br/>  AEGP_ItemH  itemH,<br/>  A_long      *widthPL)<br/>  A_long      *heightPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemPixelAspectRatio</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the width of a pixel, assuming its height is 1.0, as numerator over denominator.</p>
<p><pre lang="cpp">AEGP_GetItemPixelAspectRatio(<br/>  AEGP_ItemH  itemH,<br/>  A_Ratio     *ratioPRt);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DeleteItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Removes item from all compositions. Undo-able.</p>
<p>Do not use the <code>AEGP_ItemH</code> after calling this function.</p>
<p><pre lang="cpp">AEGP_DeleteItem(<br/>  AEGP_ItemH  itemH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemSolidColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Removed in <code>AEGP_ItemSuite4</code>. See <code>AEGP_GetSolidFootageColor</code> from <a href="#aegps-aegp-suites-aegp_footagesuite5">AEGP_FootageSuite5</a></p>
<p>Given a solid item, return its color.</p>
<p><pre lang="cpp">AEGP_GetItemSolidColor(<br/>  AEGP_ItemH  itemH,<br/>  PF_Pixel    *PF_Pixel);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetSolidColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Removed in <code>AEGP_ItemSuite4</code>. See <code>AEGP_SetSolidFootageColor</code> from <a href="#aegps-aegp-suites-aegp_footagesuite5">AEGP_FootageSuite5</a>.</p>
<p>Sets the color of an existing solid (error if <code>itemH</code> is not a solid).</p>
<p><pre lang="cpp">AEGP_SetSolidColor(<br/>  AEGP_ItemH     itemH,<br/>  AEGP_ColorVal  color);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetSolidDimensions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Removed in <code>AEGP_ItemSuite4</code>. See <code>AEGP_SetSolidFootageDimensions</code> from <a href="#aegps-aegp-suites-aegp_footagesuite5">AEGP_FootageSuite5</a>.</p>
<p>Sets the dimensions of an existing solid (error if <code>itemH</code> is not a solid).</p>
<p><pre lang="cpp">AEGP_SetSolidDimensions(<br/>  AEGP_ItemH  itemH,<br/>  A_short     widthS,<br/>  A_short     heightS);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CreateNewFolder</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a new folder in the project. The newly created folder is allocated and owned by After Effects.</p>
<p>Passing <code>NULL</code> for <code>parent_folderH0</code> creates the folder at the project's root.</p>
<p><pre lang="cpp">AEGP_CreateNewFolder(<br/>  const A_UTF16Char  *nameZ,<br/>  AEGP_ProjectH      projH),<br/>  AEGP_ItemH         parentH0),<br/>  AEGP_ItemH         *new_folderPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetItemCurrentTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the current time within a given <code>itemH</code>.</p>
<p><pre lang="cpp">AEGP_SetItemCurrentTime(<br/>  AEGP_ItemH    itemH,<br/>  const A_Time  *new_timePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemCommentLength</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Removed in <code>ItemSuite9</code>. Retrieves the length (in characters) of the <code>itemH's</code> comment.</p>
<p><pre lang="cpp">AEGP_GetItemCommentLength(<br/>  AEGP_ItemH  itemH,<br/>  A_u_long    *buf_sizePLu);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemComment</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Updated to support Unicode in <code>ItemSuite9</code>, available in 14.1. Retrieves the <code>itemH's</code> comment.</p>
<p><pre lang="cpp">AEGP_GetItemComment(<br/>  AEGP_ItemH      itemH,<br/>  AEGP_MemHandle  *unicode_namePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetItemComment</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Updated to support Unicode in <code>ItemSuite9</code>, available in 14.1. Sets the <code>itemH's</code> comment.</p>
<p><pre lang="cpp">AEGP_SetItemComment(<br/>  AEGP_ItemH         itemH,<br/>  const A_UTF16Char  *commentZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemLabel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves an item's label.</p>
<p><pre lang="cpp">AEGP_GetItemLabel(<br/>  AEGP_ItemH    itemH,<br/>  AEGP_LabelID  *labelP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetItemLabel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets an item's label.</p>
<p><pre lang="cpp">AEGP_SetItemLabel(<br/>  AEGP_ItemH    itemH,<br/>  AEGP_LabelID  label);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemMRUView</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Gets an item's most recently used view. The view can be used with two calls in the <code>AEGP_ColorSettingsSuite</code>, to perform a color transform on a pixel buffer from working to view color space.</p>
<p><pre lang="cpp">AEGP_GetItemMRUView(<br/>  AEGP_ItemH      itemH,<br/>  AEGP_ItemViewP  *mru_viewP);</pre></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>AEGP_RenderNewItemSoundData()</code> used to be here, but is now part of <a href="#aegps-aegp-suites-aegp_rendersuite4">AEGP_RenderSuite4</a>.</p>
</div>
<hr />
<h2 id="aegps-aegp-suites-managing-selections">Managing Selections<a class="headerlink" href="#aegps-aegp-suites-managing-selections" title="Permanent link">&para;</a></h2>
<p>This suite manages selection states, mirroring the functionality supplied by vectors in the C++ Standard Template Library.</p>
<p>Many types of items may be simultaneously selected in After Effects; <code>AEGP_CollectionItems</code> are unions of layer, mask, effect, stream, mask vertex, and keyframe items.</p>
<p>First acquire the current collection, then iterate across its members to ensure that whatever your AEGP does is applicable to each.</p>
<p>We've added <code>AEGP_Collection2H</code> and <code>AEGP_CollectionItemV2</code> so that selected dynamic streams can be handled with the <code>AEGP_CollectionSuite</code>.</p>
<h3 id="aegps-aegp-suites-aegp_collectionsuite2">AEGP_CollectionSuite2<a class="headerlink" href="#aegps-aegp-suites-aegp_collectionsuite2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewCollection</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates and returns a new, empty collection.</p>
<p>To obtain the current composition's selection as a collection, use <code>AEGP_GetNewCollectionFromCompSelection</code>.</p>
<p><pre lang="cpp">AEGP_NewCollection(<br/>  AEGP_PluginID      plugin_id,<br/>  AEGP_Collection2H  *collectionPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeCollection</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Disposes of a collection.</p>
<p><pre lang="cpp">AEGP_DisposeCollection(<br/>  AEGP_Collection2H  collectionH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCollectionNumItems</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the number of items contained in the given collection.</p>
<p><pre lang="cpp">AEGP_GetCollectionNumItems(<br/>  AEGP_Collection2H  collectionH,<br/>  A_u_long           *num_itemsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCollectionItemByIndex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves (creates and populates) the index'd collection item.</p>
<p><pre lang="cpp">AEGP_GetCollectionItemByIndex(<br/>  AEGP_Collection2H      collectionH,<br/>  A_u_long               indexL,<br/>  AEGP_CollectionItemV2  *itemP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CollectionPushBack</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Adds an item to the given collection.</p>
<p><pre lang="cpp">AEGP_CollectionPushBack(<br/>  AEGP_Collection2H            collectionH,<br/>  const AEGP_CollectionItemV2  *itemP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CollectionErase</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Removes an index'd item (or items) from a given collection. NOTE: this range is exclusive, like STL iterators. To erase the first item, you would pass 0 and 1, respectively.</p>
<p><pre lang="cpp">AEGP_CollectionErase(<br/>  AEGP_Collection2H  collectionH,<br/>  A_u_long           index_firstL,<br/>  A_u_long           index_lastL);</pre></p>
</td>
</tr>
</tbody>
</table>
<h3 id="aegps-aegp-suites-ownership-of-collection-items">Ownership Of Collection Items<a class="headerlink" href="#aegps-aegp-suites-ownership-of-collection-items" title="Permanent link">&para;</a></h3>
<p>When <code>AEGP_StreamRefHs</code> are inserted into a collection, they are adopted by the collection; do not free them.</p>
<p><code>AEGP_EffectRefHs</code>, on the other hand, are not adopted, and must be freed by the calling AEGP.</p>
<hr />
<h2 id="aegps-aegp-suites-manipulate-compositions">Manipulate Compositions<a class="headerlink" href="#aegps-aegp-suites-manipulate-compositions" title="Permanent link">&para;</a></h2>
<p>Provide information about the compositions in a project, and create cameras, lights, and solids.</p>
<h3 id="aegps-aegp-suites-aegp_compsuite11">AEGP_CompSuite11<a class="headerlink" href="#aegps-aegp-suites-aegp_compsuite11" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompFromItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the handle to the composition, given an item handle.</p>
<p>Returns <code>NULL</code> if <code>itemH</code> is not an <code>AEGP_CompH</code>.</p>
<p><pre lang="cpp">AEGP_GetCompFromItem(<br/>  AEGP_ItemH  itemH,<br/>  AEGP_CompH  *compPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetItemFromComp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Used to get the item handle, given a composition handle.</p>
<p><pre lang="cpp">AEGP_GetItemFromComp(<br/>  AEGP_CompH  compH,<br/>  AEGP_ItemH  *itemPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompDownsampleFactor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns current downsample factor. Measured in pixels X by Y.</p>
<p>Users can choose a custom downsample factor with independent X and Y.</p>
<p><pre lang="cpp">AEGP_GetCompDownsampleFactor(<br/>  AEGP_CompH             compH,<br/>  AEGP_DownsampleFactor  *dsfP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCompDownsampleFactor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the composition's downsample factor.</p>
<p><pre lang="cpp">AEGP_SetCompDownsampleFactor(<br/>  AEGP_CompH             compH,<br/>  AEGP_DownsampleFactor  *dsfP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompBGColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the composition background color.</p>
<p><pre lang="cpp">AEGP_GetCompBGColor(<br/>  AEGP_CompH     compH,<br/>  AEGP_ColorVal  *bg_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCompBGColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets a composition's background color.</p>
<p><pre lang="cpp">AEGP_SetCompBGColor(<br/>  AEGP_CompH           compH,<br/>  const AEGP_ColorVal  *bg_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompFlags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns composition flags, or'd together.</p>
<p><pre lang="cpp">AEGP_GetCompFlags(<br/>  AEGP_CompH      compH,<br/>  AEGP_CompFlags  *AEGP_CompFlags);</pre></p>
<ul>
<li><code>AEGP_CompFlag_SHOW_ALL_SHY</code></li>
<li><code>AEGP_CompFlag_ENABLE_MOTION_BLUR</code></li>
<li><code>AEGP_CompFlag_ENABLE_TIME_FILTER</code></li>
<li><code>AEGP_CompFlag_GRID_TO_FRAME</code></li>
<li><code>AEGP_CompFlag_GRID_TO_FIELDS</code></li>
<li><code>AEGP_CompFlag_USE_LOCAL_DSF</code></li>
<li><code>AEGP_CompFlag_DRAFT_3D</code></li>
<li><code>AEGP_CompFlag_SHOW_GRAPH</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetShowLayerNameOrSourceName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Passes back true if the Comp's timeline shows layer names, false if source names. This will open the comp as a side effect.</p>
<p><pre lang="cpp">AEGP_GetShowLayerNameOrSourceName(<br/>  AEGP_CompH  compH,<br/>  A_Boolean   *layer_names_shownPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetShowLayerNameOrSourceName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Pass in true to have the Comp's timeline show layer names, false for source names. This will open the comp as a side effect.</p>
<p><pre lang="cpp">AEGP_SetShowLayerNameOrSourceName(<br/>  AEGP_CompH  compH,<br/>  A_Boolean   *layer_names_shownPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetShowBlendModes</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Passes back true if the Comp's timeline shows blend modes column, false if hidden. This will open the comp as a side effect.</p>
<p><pre lang="cpp">AEGP_GetShowBlendModes(<br/>  AEGP_CompH  compH,<br/>  A_Boolean   *blend_modes_shownPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetShowBlendModes</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Pass in true to have the Comp's timeline show the blend modes column, false to hide it. This will open the comp as a side effect.</p>
<p><pre lang="cpp">AEGP_GetCompFlags(<br/>  AEGP_CompH  compH,<br/>  A_Boolean   show_blend_modesB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompFramerate</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the composition's frames per second.</p>
<p><pre lang="cpp">AEGP_GetCompFramerate(<br/>  AEGP_CompH  compH,<br/>  A_FpLong    *fpsPF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCompFramerate</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the composition's frames per second.</p>
<p><pre lang="cpp">AEGP_SetCompFramerate(<br/>  AEGP_CompH  compH,<br/>  A_FpLong    *fpsPF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompShutterAnglePhase</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The composition shutter angle and phase.</p>
<p><pre lang="cpp">AEGP_GetCompShutterAnglePhase(<br/>  AEGP_CompH  compH,<br/>  A_Ratio     *angle,<br/>  A_Ratio     *phase);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompShutterFrameRange</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The duration of the shutter frame, in seconds.</p>
<p><pre lang="cpp">AEGP_GetCompShutterFrameRange(<br/>  AEGP_CompH    compH,<br/>  const A_Time  *comp_timeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompSuggestedMotionBlurSamples</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the number of motion blur samples After Effects will perform in the given composition.</p>
<p><pre lang="cpp">AEGP_GetCompSuggestedMotionBlurSamples(<br/>  AEGP_CompH  compH,<br/>  A_long      *samplesPL)</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCompSuggestedMotionBlurSamples</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the number of motion blur samples After Effects will perform in the given composition. Undoable.</p>
<p><pre lang="cpp">AEGP_SetCompSuggestedMotionBlurSamples(<br/>  AEGP_CompH  compH,<br/>  A_long      samplesL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompMotionBlurAdaptiveSampleLimit</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Retrieves the motion blur adaptive sample limit for the given composition.</p>
<p>As of CC, a new comp defaults to <code>128</code>.</p>
<p><pre lang="cpp">AEGP_GetCompMotionBlurAdaptiveSampleLimit(<br/>  AEGP_CompH  compH,<br/>  A_long      *samplesPL)</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCompMotionBlurAdaptiveSampleLimit</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Specifies the motion blur adaptive sample limit for the given composition.</p>
<p>As of CC, both the limit and the suggested values are clamped to [2,256] range and the limit value will not be allowed less than the suggested value.</p>
<p>Undoable.</p>
<p><pre lang="cpp">AEGP_SetCompMotionBlurAdaptiveSampleLimit(<br/>  AEGP_CompH  compH,<br/>  A_long      samplesL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompWorkAreaStart</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the time where the current work area starts.</p>
<p><pre lang="cpp">AEGP_GetCompWorkAreaStart(<br/>  AEGP_CompH  compH,<br/>  A_Time      *startPT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompWorkAreaDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the duration of a composition's current work area, in seconds.</p>
<p><pre lang="cpp">AEGP_GetCompWorkAreaDuration(<br/>  AEGP_CompH  compH,<br/>  A_Time      *durationPT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCompWorkAreaStartAndDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set the work area start and duration, in seconds. Undo-able.</p>
<p>One call to this function is sufficient to set the layer's in point and duration; it's not necessary to call it twice, once for each timespace.</p>
<p><pre lang="cpp">AEGP_SetCompWorkAreaStartAndDuration(<br/>  AEGP_CompH    compH,<br/>  const A_Time  *startPT)<br/>  const A_Time  *durationPT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CreateSolidInComp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a new solid with a specified width, height, color, and duration in the composition. Undo-able.</p>
<p>If you pass <code>NULL</code> for the duration, After Effects uses its preference for the duration of a new still. If you pass <code>NULL</code>, or an invalid time scale, duration is set to the length of the composition.</p>
<p><pre lang="cpp">AEGP_CreateSolidInComp(<br/>  const A_UTF16Char  *utf_nameZ,<br/>  A_Long             widthL,<br/>  A_Long             heightL,<br/>  const PF_Pixel     *color,<br/>  AEGP_CompH         parent_compH,<br/>  const A_Time       *durationPT0,<br/>  AEGP_LayerH        *new_solidPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CreateCameraInComp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates and adds a camera to the specified composition. Once created, you can manipulate the camera's parameter streams using the AEGP <a href="#aegps-aegp-suites-stream-suite">Stream Suite</a>.</p>
<p>To specify a two-node camera, use <code>AEGP_SetLayerFlag</code> from <a href="#aegps-aegp-suites-aegp_layersuite9">AEGP_LayerSuite9</a> to set <code>AEGP_LayerFlag_LOOK_AT_POI</code>.</p>
<p><pre lang="cpp">AEGP_CreateCameraInComp(<br/>  const A_UTF16Char  *utf_nameZ,<br/>  A_FloatPoint       center_point,<br/>  AEGP_CompH         parent_compH,<br/>  AEGP_LayerH        *new_cameraPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CreateLightInComp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates and adds a light to the specified composition. Once created, you can manipulate the light's parameter streams using the AEGP <a href="#aegps-aegp-suites-stream-suite">Stream Suite</a>.</p>
<p><pre lang="cpp">AEGP_CreateLightInComp(<br/>  const A_UTF16Char  *utf_nameZ,<br/>  A_FloatPoint       center_point,<br/>  AEGP_CompH         parent_compH,<br/>  AEGP_LayerH        *new_lightPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CreateComp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a new composition for the project. If you don't provide a parent folder, the composition will be at the root level of the project. Undo-able.</p>
<p><pre lang="cpp">AEGP_CreateComp(<br/>  AEGP_ItemH         parent_folderHO,<br/>  const A_UTF16Char  *utf_nameZ,<br/>  A_Long             widthL,<br/>  A_Long             heightL,<br/>  const A_Ratio      *pixel_aspect_ratioPRt,<br/>  const A_Time       *durationPT,<br/>  const A_Ratio      *frameratePRt,<br/>  AEGP_CompH         *new_compPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewCollectionFromCompSelection</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a new AEGP_Collection2H from the items selected in the given composition.</p>
<p>The plug-in is responsible for disposing of the <code>AEGP_Collection2H</code>.</p>
<p><pre lang="cpp">AEGP_GetNewCollectionFromCompSelection(<br/>  AEGP_PluginID      plugin_id,<br/>  AEGP_CompH         compH,<br/>  AEGP_Collection2H  *collectionPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetSelection</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the selection within the given composition to the given <code>AEGP_Collection2H</code>.</p>
<p>Will return an error if members of the <code>AEGP_Collection2H</code> are not available. Don't assume that a composition hasn't changed between operations; always use a fresh <code>AEGP_Collection2H</code>.</p>
<p><pre lang="cpp">AEGP_SetSelection(<br/>  AEGP_CompH         compH,<br/>  AEGP_Collection2H  collectionH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompDisplayStartTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Gets the displayed start time of a composition.</p>
<p><pre lang="cpp">AEGP_GetCompDisplayStartTime(<br/>  AEGP_CompH    compH,<br/>  const A_Time  *start_timePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCompDisplayStartTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Not undo-able. Sets the displayed start time of a composition (has no effect on the duration of the composition).</p>
<p><pre lang="cpp">AEGP_SetCompDisplayStartTime(<br/>  AEGP_CompH    compH,<br/>  const A_Time  *start_timePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCompDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Undoable. Sets the duration of the given composition.</p>
<p><pre lang="cpp">AEGP_SetCompDuration(<br/>  AEGP_CompH    compH,<br/>  const A_Time  *durationPT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CreateNullInComp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a "null object" in the composition (useful for translating projects from 3D applications into After Effects).</p>
<p>If you pass <code>NULL</code> for the duration, After Effects uses its preference for the duration of a new still. If you pass 0, or an invalid time scale, duration is set to the length of the composition.</p>
<p><pre lang="cpp">AEGP_CreateNullInComp(<br/>  const A_UTF16Char  *utf_nameZ,<br/>  AEGP_CompH         parent_compH,<br/>  const A_Time       *durationPT0,<br/>  AEGP_LayerH        *new_null_solidPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCompPixelAspectRatio</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the pixel aspect ratio of a composition.</p>
<p><pre lang="cpp">AEGP_SetCompPixelAspectRatio(<br/>  AEGP_CompH     compH,<br/>  const A_Ratio  *parPRt);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CreateTextLayerInComp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Updated in CS6. Creates a text layer in the composition, and returns its <code>AEGP_LayerH</code>.</p>
<p><pre lang="cpp">AEGP_CreateTextLayerInComp(<br/>  AEGP_CompH   parent_compH,<br/>  A_Boolean    select_new_layerB,<br/>  AEGP_LayerH  *new_text_lyrPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CreateBoxTextLayerInComp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Updated in CS6. Creates a new box text layer, and returns its <code>AEGP_LayerH</code>.</p>
<p><pre lang="cpp">AEGP_CreateBoxTextLayerInComp(<br/>  AEGP_CompH    parent_compH,<br/>  A_Boolean     select_new_layerB,<br/>  A_FloatPoint  box_dimensions,<br/>  AEGP_LayerH   *new_text_layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCompDimensions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the dimensions of the composition. Undoable.</p>
<p><pre lang="cpp">AEGP_SetCompDimensions(<br/>  AEGP_CompH  compH,<br/>  A_long      widthL,<br/>  A_long      heightL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DuplicateComp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Duplicates the composition. Undoable.</p>
<p><pre lang="cpp">AEGP_DuplicateComp(<br/>  AEGP_CompH  compH,<br/>  AEGP_CompH  *new_compPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompFrameDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the duration of a frame in a composition.</p>
<p><pre lang="cpp">AEGP_GetCompFrameDuration(<br/>  AEGP_CompH  compH,<br/>  A_Time      *timeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMostRecentlyUsedComp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the most-recently-used composition.</p>
<p><pre lang="cpp">AEGP_GetMostRecentlyUsedComp(<br/>  AEGP_CompH  *compPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CreateVectorLayerInComp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates and returns a handle to a new vector layer.</p>
<p><pre lang="cpp">AEGP_CreateVectorLayerInComp(<br/>  AEGP_CompH   parent_compH,<br/>  AEGP_LayerH  *new_vec_layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewCompMarkerStream</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns an AEGP_StreamRefH to the composition's marker stream. Must be disposed by caller.</p>
<p><pre lang="cpp">AEGP_GetNewCompMarkerStream(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_CompH       parent_compH,<br/>  AEGP_StreamRefH  *streamPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompDisplayDropFrame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Passes back a boolean that indicates whether the specified comp uses drop-frame timecode or not.</p>
<p><pre lang="cpp">AEGP_GetCompDisplayDropFrame(<br/>  AEGP_CompH  compH,<br/>  A_Boolean   *dropFramePB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCompDisplayDropFrame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the dropness of the timecode in the specified composition.</p>
<p><pre lang="cpp">AEGP_SetCompDisplayDropFrame(<br/>  AEGP_CompH  compH,<br/>  A_Boolean   dropFrameB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ReorderCompSelection</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Move the selection to a certain layer index. Use along with <code>AEGP_SetSelection().</code></p>
<p><pre lang="cpp">AEGP_SetCompDisplayDropFrame(<br/>  AEGP_CompH  compH,<br/>  A_long      index);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-work-with-footage">Work with Footage<a class="headerlink" href="#aegps-aegp-suites-work-with-footage" title="Permanent link">&para;</a></h2>
<p>Provides information about footage, or items in a project or composition. When getting and setting footage's interpretation, it is possible to specify incompatible options.</p>
<p>If you encounter warnings and errors during development, be sure to make all related changes atomically, and reassess the logic of the operation you're performing.</p>
<p>For example, changing the pull-down interpretation of footage won't work unless there's a difference between it's native and conformed frame rate.</p>
<p>Depending on what you're trying to accomplish, it may make sense to abort all of your operations at that point, inform the user of the problem encountered.</p>
<h3 id="aegps-aegp-suites-aegp_footagesuite5">AEGP_FootageSuite5<a class="headerlink" href="#aegps-aegp-suites-aegp_footagesuite5" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMainFootageFromItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns an error if item isn't a footage item. Used to convert an item handle to a footage handle.</p>
<p><pre lang="cpp">AEGP_GetMainFootageFromItem(<br/>  AEGP_ItemH     itemH,<br/>  AEGP_FootageH  *footagePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetProxyFootageFromItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns an error if item has no proxy. Returns the proxy footage handle.</p>
<p>Note: a composition can have a proxy.</p>
<p><pre lang="cpp">AEGP_GetProxyFootageFromItem(<br/>  AEGP_ItemH     itemH,<br/>  AEGP_FootageH  *proxy_ftgPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetFootageNumFiles</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the number of data (RGBA or audio) files, and the number of files per frame (may be greater than one if the footage has auxiliary channels).</p>
<p><pre lang="cpp">AEGP_GetFootageNumFiles(<br/>  AEGP_FootageH  footageH,<br/>  A_long         *num_filesPL0,<br/>  A_long         *files_per_frmPL0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetFootagePath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get fully realized path to footage source file. Retrieves the footage path for a piece of footage (or for the specified frame of a footage sequence).</p>
<p><code>frame_numL</code> ranges from <code>0 to num_main_files</code>, as obtained using <code>AEGP_GetFootageNumFiles</code> from <a href="#aegps-aegp-suites-aegp_footagesuite5">AEGP_FootageSuite5</a>.</p>
<p><code>AEGP_FOOTAGE_MAIN_FILE_INDEX</code> is the main file.</p>
<p>The path is a handle to a NULL-terminated <code>A_UTF16Char</code> string, and must be disposed with AEGP_FreeMemHandle.</p>
<p><pre lang="cpp">AEGP_GetFootagePath(<br/>  AEGP_FootageH   footageH,<br/>  A_long          frame_numL,<br/>  A_long          file_indexL,<br/>  AEGP_MemHandle  *unicode_pathPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetFootageSignature</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the footage signature of specified footage.</p>
<p><pre lang="cpp">AEGP_GetFootageSignature(<br/>  AEGP_FootageH          footageH,<br/>  AEGP_FootageSignature  *sigP);</pre></p>
<p>The signature will be one of the following:</p>
<ul>
<li><code>AEGP_FootageSignature_NONE</code></li>
<li><code>AEGP_FootageSignature_MISSING</code></li>
<li><code>AEGP_FootageSignature_SOLID</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewFootage</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a new footage item. The file path is a NULL-terminated UTF-16 string with platform separators.</p>
<p>Note that footage filenames with colons are not allowed, since colons are used as path separators in the HFS+ file system.</p>
<p><pre lang="cpp">AEGP_NewFootage(<br/>  AEGP_PluginID                         aegp_plugin_id,<br/>  const A_UTF16Char                     *pathZ,<br/>  const AEGP_FootageLayerKey            *layer_infoP0,<br/>  const AEGP_FileSequenceImportOptions  *sequence_optionsP0,<br/>  AEGP_InterpretationStyle              interp_style,<br/>  void                                  *reserved,<br/>  AEGP_FootageH                         *footagePH);</pre></p>
<p>Note the optional params. If <code>allow_interpretation_dialogB</code> is FALSE, After Effects will guess the alpha interpretation.</p>
<p><pre lang="cpp">typedef struct {<br/>  A_long               layer_idL;<br/>  A_long               layer_indexL<br/>  char                 *nameAC;<br/>  AEGP_LayerDrawStyle  draw_style;<br/>} AEGP_FootageLayerKey;</pre></p>
<p><code>AEGP_LayerDrawStyle</code> can be:</p>
<ul>
<li><code>AEGP_LayerDrawStyle_LAYER_BOUNDS</code></li>
<li><code>AEGP_LayerDrawStyle_DOCUMENT_BOUNDS</code></li>
</ul>
<p><code>AEGP_InterpretationStyle</code> can be:</p>
<ul>
<li><code>AEGP_InterpretationStyle_NO_DIALOG_GUESS</code> Will guess alpha interpretation even if file contains unknown alpha interpretation and user pref says to ask user.</li>
<li><code>AEGP_InterpretationStyle_DIALOG_OK</code> Optionally can show a dialog.</li>
<li><code>AEGP_InterpretationStyle_NO_DIALOG_NO_GUESS</code> Used for replace footage implementation.</li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_AddFootageToProject</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Adds a footage item to a project. Footage will be adopted by the project, and may be added only once.</p>
<p>This is Undo-able; do not dispose of the returned added item if it's undone.</p>
<p><pre lang="cpp">AEGP_AddFootageToProject(<br/>  AEGP_FootageH  footageH,<br/>  AEGP_ItemH     folderH,<br/>  AEGP_ItemH     *add_itemPH0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetItemProxyFootage</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets footage as the proxy for an item. Will be adopted by the project.</p>
<p>This is Undo-able; do not dispose of the returned added item if it's undone.</p>
<p><pre lang="cpp">AEGP_SetItemProxyFootage(<br/>  AEGP_FootageH  footageH,<br/>  AEGP_ItemH     itemH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ReplaceItemMainFootage</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Replaces footage for an item. The item will replace the main footage for this item.</p>
<p>This is Undo-able; do not dispose of the returned added item if it's undone.</p>
<p><pre lang="cpp">AEGP_ReplaceItemMainFootage(<br/>  AEGP_FootageH  footageH,<br/>  AEGP_ItemH     itemH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeFootage</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Deletes a footage item. Do not dispose of footage you did not create, or that has been added to the project.</p>
<p><pre lang="cpp">AEGP_DisposeFootage(<br/>  AEGP_FootageH  footageH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetFootageInterpretation</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Populates an AEGP_FootageInterp describing the settings of the <code>AEGP_FootageH</code>.</p>
<p>There is no way to create a valid <code>AEGP_FootageInterp</code> other than by using this function.</p>
<p><pre lang="cpp">AEGP_GetFootageInterpretation(<br/>  const AEGP_ItemH    itemH,<br/>  A_Boolean           proxyB,<br/>  AEGP_FootageInterp  *interpP);</pre></p>
<p>If proxyB is <code>TRUE</code>, the proxy footage's settings are retrieved.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetFootageInterpretation</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Apply the settings in the <code>AEGP_FootageInterp</code> to the <code>AEGP_FootageH</code>. Undo-able.</p>
<p><pre lang="cpp">AEGP_SetFootageInterpreta tion(<br/>  const AEGP_ItemH          itemH,<br/>  A_Boolean                 proxyB,<br/>  const AEGP_FootageInterp  *interpP);</pre></p>
<p>If <code>proxyB</code> is <code>TRUE</code>, the proxy footage's settings are modified.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetFootageLayerKey</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Populates an <code>AEGP_FootageLayerKey</code> describing the footage.</p>
<p><pre lang="cpp">AEGP_GetFootageLayerKey(<br/>  AEGP_FootageH          footageH,<br/>  AEGP_FootageLayerKey*  layerKeyP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewPlaceholderFootage</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Deprecated. Adds a new placeholder footage item to the project.</p>
<p>Using this function for missing footage will cause the user to search for each individual missing file, regardless of whether or not they're all in the same directory.</p>
<p>Undo-able.</p>
<p><pre lang="cpp">AEGP_NewPlaceholderFootage(<br/>  AEGP_PluginID  plugin_id,<br/>  const A_char   *nameZ,<br/>  A_long         width,<br/>  A_long         height,<br/>  const A_Time   *durationPT,<br/>  AEGP_FootageH  *footagePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewPlaceholderFootageWithPath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This is the hip new way to add references to footage that can't be found right this moment.</p>
<p>The file path is a NULL-terminated UTF-16 string with platform separators.</p>
<p>In CS6 and earlier, file_type was ignored and we previously recommendedsetting it to <code>AEIO_FileType_NONE</code>.</p>
<p>Starting in CC, <code>AEIO_FileType_NONE</code> is now a warning condition.</p>
<p>If you pass <code>AEIO_FileType_ANY</code>, then path MUST exist.</p>
<p>If the path may not exist, pass <code>AEIO_FileType_DIR</code> for folder, or <code>AEIO_FileType_GENERIC</code> for a file.</p>
<p><pre lang="cpp">AEGP_NewPlaceholderFootageWithPath(<br/>  AEGP_PluginID      plugin_id,<br/>  const A_UTF16Char  *pathZ,<br/>  AEGP_Platform      path_platform,<br/>  AEIO_FileType      file_type,<br/>  A_long             widthL,<br/>  A_long             heightL,<br/>  const A_Time       *durationPT,<br/>  AEGP_FootageH      *footagePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewSolidFootage</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This is the way to add a solid.</p>
<p>Until the footage is added to the project, the caller owns the <code>AEGP_FootageH</code> (and must dispose of it if, and only if, it isn't added to the project).</p>
<p><pre lang="cpp">AEGP_NewSolidFootage(<br/>  const A_char         *nameZ,<br/>  A_long               width,<br/>  A_long               height,<br/>  const AEGP_ColorVal  *colorP,<br/>  AEGP_FootageH        *footagePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetSolidFootageColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the color of a given solid. Returns an error if the <code>AEGP_ItemH</code> is not a solid.</p>
<p><pre lang="cpp">AEGP_GetSolidFootageColor(<br/>  AEGP_ItemH     itemH,<br/>  A_Boolean      proxyB,<br/>  AEGP_ColorVal  *colorP);</pre></p>
<p>If <code>proxyB</code> is <code>TRUE</code>, the proxy solid's color is retrieved.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetSolidFootageColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the color of a solid. Undo-able.</p>
<p><pre lang="cpp">AEGP_SetSolidFootageColor(<br/>  AEGP_ItemH     itemH,<br/>  A_Boolean      proxyB,<br/>  AEGP_ColorVal  *colorP);</pre></p>
<p>If <code>proxyB</code> is <code>TRUE</code>, the proxy solid's color is set.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetSolidFootageDimensions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the dimensions of a solid. Undo-able.</p>
<p><pre lang="cpp">AEGP_SetSolidFootageDimensions(<br/>  AEGP_ItemH  itemH,<br/>  A_Boolean   proxyB,<br/>  A_long      widthL,<br/>  A_long      heightL);</pre></p>
<p>If <code>proxyB</code> is <code>TRUE</code>, the proxy solid's dimensions are modified. Returns an error if the item isn't a solid.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetFootageSoundDataFormat</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves information about the audio data in the footage item (by populating the <code>AEGP_SoundDataFormat</code> you passed in).</p>
<p><pre lang="cpp">AEGP_GetFootageSoundDataFormat(<br/>  AEGP_FootageH         footageH,<br/>  AEGP_SoundDataFormat  *formatP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetFootageSequenceImportOptions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Populates and returns a <code>AEGP_FileSequenceImportOptions</code> describing the given <code>AEGP_FootageH</code>.</p>
<p><pre lang="cpp">AEGP_GetFootageSequenceImportOptions(<br/>  AEGP_FootageH                   footageH,<br/>  AEGP_FileSequenceImportOptions  *optionsP);</pre></p>
</td>
</tr>
</tbody>
</table>
<h3 id="aegps-aegp-suites-aegp_footageinterp-structure">AEGP_FootageInterp Structure<a class="headerlink" href="#aegps-aegp-suites-aegp_footageinterp-structure" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Member</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_InterlaceLabel il;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The interlace settings for the footage item.</p>
<p><pre lang="cpp">A_u_long signature; // 'FIEL'<br/>A_short version;<br/>FIEL_Type type;<br/>FIEL_Order order;<br/>A_u_long reserved;</pre></p>
<p><code>FIEL_Type</code> is one of the following:</p>
<ul>
<li><code>FIEL_Type_FRAME_RENDERED</code></li>
<li><code>FIEL_Type_INTERLACED</code></li>
<li><code>FIEL_Type_HALF_HEIGHT</code></li>
<li><code>FIEL_Type_FIELD_DOUBLED</code> (60 full-sized field doubled frames per second.)</li>
</ul>
<p><code>FIEL_Order</code> is either:</p>
<ul>
<li><code>FIEL_Order_UPPER_FIRST</code></li>
<li><code>FIEL_Order_LOWER_FIRST</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_AlphaLabel al;</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">AEGP_AlphaFlag flags;<br/>A_u_char redCu;<br/>A_u_char greenCu;<br/>A_u_char blueCu;</pre></p>
<p><code>AEGP_AlphaFlags</code> is one or more of the following, OR'd together:</p>
<ul>
<li><code>AEGP_AlphaPremul</code></li>
<li><code>AEGP_AlphaInverted</code> (indicates that higher values are transparent, instead of lower)</li>
<li><code>AEGP_AlphaIgnore</code></li>
</ul>
<p>If <code>AEGP_AlphaPremul</code> is not set, straight alpha is assumed.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_PulldownPhase pd;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Indicates the phase for use in 3:2 pulldown. One of the following:</p>
<ul>
<li><code>AEGP_PulldownPhase_NO_PULLDOWN</code></li>
<li><code>AEGP_PulldownPhase_WSSWW</code></li>
<li><code>AEGP_PulldownPhase_SSWWW</code></li>
<li><code>AEGP_PulldownPhase_SWWWS</code></li>
<li><code>AEGP_PulldownPhase_WWWSS</code></li>
<li><code>AEGP_PulldownPhase_WWSSW</code></li>
<li><code>AEGP_PulldownPhase_WWWSW</code></li>
<li><code>AEGP_PulldownPhase_WWSWW</code></li>
<li><code>AEGP_PulldownPhase_WSWWW</code></li>
<li><code>AEGP_PulldownPhase_SWWWW</code></li>
<li><code>AEGP_PulldownPhase_WWWWS</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_LoopBehavior loop;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Indicates the number of times the footage should loop.</p>
<p><pre lang="cpp">A_long loops;<br/>A_long reserved;</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_Ratio pix_aspect_ratio;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Expresses the pixel aspect ratio of the footage (x over y).</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_FpLong native_fpsF;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The original framerate (in frames per second) of the footage item.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_FpLong conform_fpsF;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The framerate being used for the footage item.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_long depthL;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The pixel depth of the footage. One of the following:</p>
<ul>
<li><code>AEGP_Footage_Depth_1</code></li>
<li><code>AEGP_Footage_Depth_2</code></li>
<li><code>AEGP_Footage_Depth_4</code></li>
<li><code>AEGP_Footage_Depth_8</code></li>
<li><code>AEGP_Footage_Depth_16</code></li>
<li><code>AEGP_Footage_Depth_24</code></li>
<li><code>AEGP_Footage_Depth_30</code></li>
<li><code>AEGP_Footage_Depth_32</code></li>
<li><code>AEGP_Footage_Depth_GRAY_2</code></li>
<li><code>AEGP_Footage_Depth_GRAY_4</code></li>
<li><code>AEGP_Footage_Depth_GRAY_8</code></li>
<li><code>AEGP_Footage_Depth_48</code></li>
<li><code>AEGP_Footage_Depth_64</code></li>
<li><code>AEGP_Footage_Depth_GRAY_16</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>A_Boolean motion_dB;</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Indicates whether motion de-interlacing is being applied to the footage item.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-manage-layers">Manage Layers<a class="headerlink" href="#aegps-aegp-suites-manage-layers" title="Permanent link">&para;</a></h2>
<p><code>AEGP_LayerSuite</code> provides information about layers within a composition, and the relationship(s) between the source and layer times.</p>
<p>As most After Effects usage boils down to layer manipulation, this is among the largest function suites in our API.</p>
<h3 id="aegps-aegp-suites-aegp_layersuite9">AEGP_LayerSuite9<a class="headerlink" href="#aegps-aegp-suites-aegp_layersuite9" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompNumLayers</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the number of layers in a composition.</p>
<p><pre lang="cpp">AEGP_GetCompNumLayers(<br/>  AEGP_CompH  compH,<br/>  A_long      *num_layersPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompLayerByIndex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get a <code>AEGP_LayerH</code> from a composition. Zero is the foremost layer.</p>
<p><pre lang="cpp">AEGP_GetCompLayerByIndex(<br/>  AEGP_CompH   compH,<br/>  A_long       layer_indexL,<br/>  AEGP_LayerH  *layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetActiveLayer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the active layer. If a Layer or effect controls palette is active, the active layer is that associated with the front-most tab in the window.</p>
<p>If a composition or timeline window is active, the active layer is the selected layer (if only one is selected; otherwise <code>NULL</code> is returned).</p>
<p><pre lang="cpp">AEGP_GetActiveLayer(<br/>  AEGP_LayerH  *layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerIndex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the index of the layer (0 is the topmost layer in the composition).</p>
<p><pre lang="cpp">AEGP_GetLayerIndex(<br/>  AEGP_LayerH  layerH,<br/>  A_long       *layer_indexPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerSourceItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the AEGP_ItemH of the layer's source item.</p>
<p><pre lang="cpp">AEGP_GetLayerSourceItem(<br/>  AEGP_LayerH  layerH,<br/>  AEGP_ItemH   *source_itemPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerSourceItemID</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the ID of the given <code>AEGP_LayerH</code>. This is useful when hunting for a specific layer's ID in an <code>AEGP_StreamVal</code>.</p>
<p><pre lang="cpp">AEGP_GetLayerSourceItemID(<br/>  AEGP_LayerH  layerH,<br/>  A_long       *source_idPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerParentComp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the AEGP_CompH of the composition containing the layer.</p>
<p><pre lang="cpp">AEGP_GetLayerParentComp(<br/>  AEGP_LayerH  layerH,<br/>  AEGP_CompH   *compPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the name of a layer.</p>
<p>Both <code>utf_layer_namePH0</code> and <code>utf_source_namePH0</code> point to null terminated UTF-16 strings. They must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetLayerName(<br/>  AEGP_PluginID   pluginID,<br/>  AEGP_LayerH     layerH,<br/>  AEGP_MemHandle  *utf_layer_namePH0,<br/>  AEGP_MemHandle  *utf_source_namePH0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerQuality</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the quality of a layer.</p>
<p><pre lang="cpp">AEGP_GetLayerQuality(<br/>  AEGP_LayerH        layerH,<br/>  AEGP_LayerQuality  *qualityP);</pre></p>
<p>Layer quality is one of the following flags:</p>
<ul>
<li><code>AEGP_LayerQual_NONE</code></li>
<li><code>AEGP_LayerQual_WIREFRAME</code></li>
<li><code>AEGP_LayerQual_DRAFT</code></li>
<li><code>AEGP_LayerQual_BEST</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetLayerQuality</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the quality of a layer (see flag values above). Undoable.</p>
<p><pre lang="cpp">AEGP_SetLayerQuality(<br/>  AEGP_LayerH        layerH,<br/>  AEGP_LayerQuality  quality);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerFlags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get flags for a layer.</p>
<p><pre lang="cpp">AEGP_GetLayerFlags(<br/>  AEGP_LayerH      layerH,<br/>  AEGP_LayerFlags  *layer_flagsP);</pre></p>
<ul>
<li><code>AEGP_LayerFlag_NONE</code></li>
<li><code>AEGP_LayerFlag_VIDEO_ACTIVE</code></li>
<li><code>AEGP_LayerFlag_AUDIO_ACTIVE</code></li>
<li><code>AEGP_LayerFlag_EFFECTS_ACTIVE</code></li>
<li><code>AEGP_LayerFlag_MOTION_BLUR</code></li>
<li><code>AEGP_LayerFlag_FRAME_BLENDING</code></li>
<li><code>AEGP_LayerFlag_LOCKED</code></li>
<li><code>AEGP_LayerFlag_SHY</code></li>
<li><code>AEGP_LayerFlag_COLLAPSE</code></li>
<li><code>AEGP_LayerFlag_AUTO_ORIENT_ROTATION</code></li>
<li><code>AEGP_LayerFlag_ADJUSTMENT_LAYER</code></li>
<li><code>AEGP_LayerFlag_TIME_REMAPPING</code></li>
<li><code>AEGP_LayerFlag_LAYER_IS_3D</code></li>
<li><code>AEGP_LayerFlag_LOOK_AT_CAMERA</code></li>
<li><code>AEGP_LayerFlag_LOOK_AT_POI</code></li>
<li><code>AEGP_LayerFlag_SOLO</code></li>
<li><code>AEGP_LayerFlag_MARKERS_LOCKED</code></li>
<li><code>AEGP_LayerFlag_NULL_LAYER</code></li>
<li><code>AEGP_LayerFlag_HIDE_LOCKED_MASKS</code></li>
<li><code>AEGP_LayerFlag_GUIDE_LAYER</code></li>
<li><code>AEGP_LayerFlag_ENVIRONMENT_LAYER</code></li>
<li><code>AEGP_LayerFlag_ADVANCED_FRAME_BLENDING</code>, <code>True</code> only if pixel motion frame blending is on for the layer.</li>
<li><code>AEGP_LayerFlag_SUBLAYERS_RENDER_SEPARATELY</code>, Used to get/set the state of per-character 3D enablement on a text layer.</li>
<li><code>AEGP_LayerFlag_ENVIRONMENT_LAYER</code>, New in CS6.</li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetLayerFlag</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets one layer flag at a time. Undoable.</p>
<p><pre lang="cpp">AEGP_SetLayerFlag(<br/>  AEGP_LayerH      layerH,<br/>  AEGP_LayerFlags  single_flag,<br/>  A_Boolean        valueB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsLayerVideoReallyOn</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Determines whether the layer's video is visible. This is necessary to account for 'solo' status of other layers in the composition; non-solo'd layers are still on.</p>
<p><pre lang="cpp">AEGP_IsLayerVideoReallyOn(<br/>  AEGP_LayerH  layerH,<br/>  A_Boolean    *onPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsLayerAudioReallyOn</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Accounts for solo status of other layers in the composition.</p>
<p><pre lang="cpp">AEGP_IsLayerAudioReallyOn(<br/>  AEGP_LayerH  layerH,<br/>  A_Boolean    *onPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerCurrentTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get current time, in layer or composition timespace. This value is not updated during rendering.</p>
<p>NOTE: If a layer starts at other than time 0 or is time-stretched other than 100%, layer time and composition time are distinct.</p>
<p><pre lang="cpp">AEGP_GetLayerCurrentTime(<br/>  AEGP_LayerH     layerH,<br/>  AEGP_LTimeMode  time_mode,<br/>  A_Time          *curr_timePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerInPoint</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get time of first visible frame in composition or layer time. In layer time, the <code>in_pointPT</code> is always 0.</p>
<p><pre lang="cpp">AEGP_GetLayerInPoint(<br/>  AEGP_LayerH     layerH,<br/>  AEGP_LTimeMode  time_mode,<br/>  A_Time          *in_pointPT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get duration of layer, in composition or layer time, in seconds.</p>
<p><pre lang="cpp">AEGP_GetLayerDuration(<br/>  AEGP_LayerH     layerH,<br/>  AEGP_LTimeMode  time_mode,<br/>  A_Time          *durationPT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetLayerInPointAndDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set duration and in point of layer in composition or layer time. Undo-able.</p>
<p><pre lang="cpp">AEGP_SetLayerInPointAndDuration(<br/>  AEGP_LayerH     layerH,<br/>  AEGP_LTimeMode  time_mode,<br/>  const A_Time    *in_pointPT,<br/>  const A_Time    *durationPT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerOffset</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the offset from the start of the composition to layer time 0, in composition time.</p>
<p><pre lang="cpp">AEGP_GetLayerOffset(<br/>  AEGP_LayerH  layerH,<br/>  A_Time       *offsetPT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetLayerOffset</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set the offset from the start of the composition to the first frame of the layer, in composition time. Undoable.</p>
<p><pre lang="cpp">AEGP_SetLayerOffset(<br/>  AEGP_LayerH  layerH,<br/>  A_Time       *offsetPT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerStretch</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get stretch factor of a layer.</p>
<p><pre lang="cpp">AEGP_GetLayerStretch(<br/>  AEGP_LayerH  layerH,<br/>  A_Ratio      *stretchPRt);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetLayerStretch</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set stretch factor of a layer.</p>
<p><pre lang="cpp">AEGP_SetLayerStretch(<br/>  AEGP_LayerH  layerH,<br/>  A_Ratio      *stretchPRt);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerTransferMode</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get transfer mode of a layer.</p>
<p><pre lang="cpp">AEGP_GetLayerTransferMode(<br/>  AEGP_LayerH             layerH,<br/>  AEGP_LayerTransferMode  *modeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetLayerTransferMode</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set transfer mode of a layer. Undoable.</p>
<p><pre lang="cpp">AEGPSetLayerTransferMode(<br/>  AEGP_LayerH             layerH,<br/>  AEGP_LayerTransferMode  *modeP);</pre></p>
<p>As of 23.0, when you make a layer a track matte, the layer being matted will be disabled, as when you do this via the interface.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsAddLayerValid</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Tests whether it's currently valid to add a given item to a composition.</p>
<p>A composition cannot be added to itself, or to any compositions which it contains; other conditions can preclude successful adding too.</p>
<p>Adding a layer without first using this function will produce undefined results.</p>
<p><pre lang="cpp">AEGP_IsAddLayerValid(<br/>  AEGP_ItemH  item_to_addH,<br/>  AEGP_CompH  into_compH,<br/>  A_Boolean   *validPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_AddLayer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Add an item to the composition, above all other layers. Undo-able.</p>
<p>Use <code>AEGP_IsAddLayerValid()</code> first, to confirm that it's possible.</p>
<p><pre lang="cpp">AEGP_AddLayer(<br/>  AEGP_ItemH  item_to_addH,<br/>  AEGP_CompH  into_compH,<br/>  A_Boolean   *added_layerPH0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ReorderLayer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Change the order of layers. Undoable.</p>
<p><pre lang="cpp">AEGP_ReorderLayer(<br/>  AEGP_LayerH  layerH,<br/>  A_long       layer_indexL);</pre></p>
<p>To add a layer to the end of the composition, to use <code>layer_indexL = AEGP_REORDER_LAYER_TO_END</code></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerMaskedBounds</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a layer's handle and a time, returns the bounds of area visible with masks applied.</p>
<p><pre lang="cpp">AEGP_GetLayerMaskedBounds(<br/>  AEGP_LayerH   layerH,<br/>  const A_Time  *comp_timePT,<br/>  A_FloatRect   *boundsPR);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerObjectType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns a layer's object type.</p>
<p><pre lang="cpp">AEGP_GetLayerObjectType(<br/>  AEGP_LayerH      layerH,<br/>  AEGP_ObjectType  *object_type);</pre></p>
<ul>
<li><code>AEGP_ObjectType_AV</code></li>
<li><code>AEGP_ObjectType_LIGHT</code></li>
<li><code>AEGP_ObjectType_CAMERA</code></li>
<li><code>AEGP_ObjectType_TEXT</code></li>
<li><code>AEGP_ObjectType_3D_MODEL</code>, New in 24.4.</li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsLayer3D</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Is the footage item a 3D layer. All AV layers are either 2D or 3D.</p>
<p><pre lang="cpp">AEGP_IsLayer3D(<br/>  AEGP_LayerH  layerH,<br/>  A_Boolean    *is_3DPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsLayer2D</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Is the footage item a 2D layer. All AV layers are either 2D or 3D.</p>
<p><pre lang="cpp">AEGP_IsLayer2D(<br/>  AEGP_LayerH  layerH,<br/>  A_Boolean    *is_2DPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsVideoActive</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given composition time and a layer, see if the layer will render.</p>
<p>Time mode is either <code>AEGP_LTimeMode_LayerTime</code> or <code>AEGP_LTimeMode_CompTime</code>.</p>
<p><pre lang="cpp">AEGP_IsVideoActive(<br/>  AEGP_LayerH     layerH,<br/>  AEGP_LTimeMode  time_mode,<br/>  A_Time          *comp_timePT,<br/>  A_Boolean       *is_activePB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsLayerUsedAsTrackMatte</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Is the layer used as a track matte?</p>
<p><pre lang="cpp">AEGP_IsLayerUsedAsTrackMatte(<br/>  AEGP_LayerH  layerH,<br/>  A_Boolean    fill_must_be_activeB,<br/>  A_Boolean    *is_track_mattePB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DoesLayerHaveTrackMatte</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Does this layer have a Track Matte?</p>
<p><pre lang="cpp">AEGP_DoesLayerHaveTrackMatte(<br/>  AEGP_LayerH  layerH,<br/>  A_Boolean    *has_track_mattePB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ConvertCompToLayerTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a time in composition space, returns the time relative to the layer source footage.</p>
<p><pre lang="cpp">AEGP_ConvertCompToLayerTime(<br/>  AEGP_LayerH   layerH,<br/>  const A_Time  *comp_timeP,<br/>  A_Time        *layer_timeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ConvertLayerToCompTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a time in layer space, find the corresponding time in composition space.</p>
<p><pre lang="cpp">AEGP_ConvertLayerToCompTime(<br/>  AEGP_LayerH   layerH,<br/>  const A_Time  *layer_timePT,<br/>  A_Time        *comp_timePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerDancingRandValue</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Used by the dancing dissolve transfer function.</p>
<p><pre lang="cpp">AEGP_GetLayerDancingRandValue(<br/>  AEGP_LayerH   layerH,<br/>  const A_Time  *comp_timePT,<br/>  A_long        *rand_valuePL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerID</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Supplies the layer's unique ID. This ID never changes during the lifetime of the project.</p>
<p><pre lang="cpp">AEGP_GetLayerID(<br/>  AEGP_LayerH      layerH,<br/>  AEGP_LayerIDVal  *id_valP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerToWorldXform</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a layer handle and time, returns the layer-to-world transformation matrix.</p>
<p><pre lang="cpp">AEGP_GetLayerToWorldXform(<br/>  AEGP_LayerH   aegp_layerH,<br/>  const A_Time  *comp_timeP,<br/>  A_Matrix4     *transform);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerToWorldXformFromView</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a layer handle, the current (composition) time, and the requested view time, returns the translation between the user's view and the layer, corrected for the composition's current aspect ratio.</p>
<p><pre lang="cpp">AEGP_GetLayerToWorldXformFromView(<br/>  AEGP_LayerH   aegp_layerH,<br/>  const A_Time  *view_timeP,<br/>  const A_Time  *comp_timeP,<br/>  A_Matrix4     *transform);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetLayerName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the name of a layer. Undo-able. new_nameZ points to a null terminated UTF-16 string.</p>
<p><pre lang="cpp">AEGP_SetLayerName(<br/>  AEGP_LayerH        aegp_layerH,<br/>  const A_UTF16Char  *new_nameZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerParent</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the handle to a layer's parent (none if not parented).</p>
<p><pre lang="cpp">AEGP_GetLayerParent(<br/>  AEGP_LayerH  layerH,<br/>  AEGP_LayerH  *parent_layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetLayerParent</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets a layer's parent layer.</p>
<p><pre lang="cpp">AEGP_SetLayerParent(<br/>  AEGP_LayerH        layerH,<br/>  const AEGP_LayerH  parent_layerH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DeleteLayer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Deletes a layer. Can you believe it took us three suite versions to add a delete function? Neither can we.</p>
<p><pre lang="cpp">AEGP_DeleteLayer(<br/>  AEGP_LayerH  layerH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DuplicateLayer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Duplicates the layer. Undoable.</p>
<p><pre lang="cpp">AEGP_DuplicateLayer(<br/>  AEGP_LayerH  orig_layerH,<br/>  AEGP_LayerH  *dupe_layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerFromLayerID</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the <code>AEGP_LayerH</code> associated with a given <code>AEGP_LayerIDVal</code> (which is what you get when accessing an effect's layer parameter stream).</p>
<p><pre lang="cpp">AEGP_GetLayerFromLayerID(<br/>  AEGP_CompH       parent_compH,<br/>  AEGP_LayerIDVal  id,<br/>  AEGP_LayerH      *layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerLabel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Gets a layer's <code>AEGP_LabelID</code>.</p>
<p><pre lang="cpp">AEGP_GetLayerLabel(<br/>  AEGP_LayerH   layerH,<br/>  AEGP_LabelID  *labelP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetLayerLabel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets a layer's <code>AEGP_LabelID</code>. Undoable.</p>
<p><pre lang="cpp">AEGP_SetLayerLabel(<br/>  AEGP_LayerH   layerH,<br/>  AEGP_LabelID  label);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerSamplingQuality</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Get the sampling quality of a layer.</p>
<p><pre lang="cpp">AEGP_GetLayerSamplingQuality(<br/>  AEGP_LayerH                layerH,<br/>  AEGP_LayerSamplingQuality  *label);</pre></p>
<p>Layer sampling quality is one of the following flags:</p>
<ul>
<li><code>AEGP_LayerSamplingQual_BILINEAR</code></li>
<li><code>AEGP_LayerSamplingQual_BICUBIC</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetLayerSamplingQuality</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Sets the sampling quality of a layer (see flag values above). Option is explicitly set on the layer independent of layer quality.</p>
<p>If you want to force it on you must also set the layer quality to <code>AEGP_LayerQual_BEST</code> with <code>AEGP_SetLayerQuality</code> Otherwise it will only be using the specified layer sampling quality whenever the layer quality is set to <code>AEGP_LayerQual_BEST</code>.</p>
<p>Undoable.</p>
<p><pre lang="cpp">AEGP_SetLayerSamplingQuality(<br/>  AEGP_LayerH                layerH,<br/>  AEGP_LayerSamplingQuality  label);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetTrackMatteLayer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in 23.0. Returns the track matte layer of <code>layerH</code>. Returns <code>NULL</code> if there is no track matte layer.</p>
<p><pre lang="cpp">AEGP_GetTrackMatteLayer(<br/>  const AEGP_LayerH          layerH,<br/>  AEGP_LayerH                *track_matte_layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetTrackMatte</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in 23.0. Sets the track matte layer and track matte type of <code>layerH</code>.</p>
<p><strong>Track Matte Types</strong>:</p>
<ul>
<li><code>AEGP_TrackMatte_NO_TRACK_MATTE</code></li>
<li><code>AEGP_TrackMatte_ALPHA</code></li>
<li><code>AEGP_TrackMatte_NOT_ALPHA</code></li>
<li><code>AEGP_TrackMatte_LUMA</code></li>
<li><code>AEGP_TrackMatte_NOT_LUMA</code></li>
</ul>
<p>Setting the track matte type as <code>AEGP_TrackMatte_NO_TRACK_MATTE</code> removes track matte.</p>
<p><pre lang="cpp">AEGP_SetTrackMatte(<br/>  AEGP_LayerH                layerH,<br/>  const AEGP_LayerH          track_matte_layerH0,<br/>  const AEGP_TrackMatte      track_matte_type);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RemoveTrackMatte</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in 23.0. Removes the track matte layer of <code>layerH</code>.</p>
<p><pre lang="cpp">AEGP_RemoveTrackMatte(<br/>  AEGP_LayerH                layerH);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-layer-creation-notes">Layer Creation Notes<a class="headerlink" href="#aegps-aegp-suites-layer-creation-notes" title="Permanent link">&para;</a></h2>
<p>All layers created using AEGP calls will start at composition time 0, and have the duration of the composition.</p>
<p>Use <code>AEGP_SetLayerOffset()</code> and <code>AEGP_SetLayerInPointAndDuration()</code> from <a href="#aegps-aegp-suites-aegp_layersuite9">AEGP_LayerSuite9</a> to properly set the layer's time information.</p>
<p>When the layer stretch factor (obtained using <code>AEGP_GetLayerStretch</code> in <a href="#aegps-aegp-suites-aegp_layersuite9">AEGP_LayerSuite9</a>, naturally) is not 100%, the following computation will be needed to yield the correct layer offset:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compIn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">stretch</span><span class="w"> </span><span class="err">\</span><span class="o">*</span><span class="w"> </span><span class="n">layerIn</span><span class="p">;</span>
</span></code></pre></div>
<hr />
<h2 id="aegps-aegp-suites-communication-with-a-layers-effects">Communication With A Layer's Effects<a class="headerlink" href="#aegps-aegp-suites-communication-with-a-layers-effects" title="Permanent link">&para;</a></h2>
<p>Access the effects applied to a layer. This suite provides access to all parameter data streams.</p>
<p>Use the <a href="#aegps-aegp-suites-stream-suite">Stream Suite</a> to work with those streams.</p>
<p>An <code>AEGP_Effect_RefH</code> is a reference to an applied effect. An <code>AEGP_InstalledEffectKey</code> is a reference to an installed effect, which may or may not be currently applied to anything.</p>
<p>If Foobarocity is applied to a layer twice, there will be two distinct <code>AEGP_Effect_RefHs</code>, but they'll both return the same <code>AEGP_InstalledEffectKey</code>.</p>
<h3 id="aegps-aegp-suites-aegp_effectsuite4">AEGP_EffectSuite4<a class="headerlink" href="#aegps-aegp-suites-aegp_effectsuite4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerNumEffects</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get number of effects applied to a layer.</p>
<p><pre lang="cpp">AEGP_GetLayerNumEffects(<br/>  AEGP_LayerH  layerH,<br/>  A_long       *num_effectsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerEffectByIndex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves (by index) a reference to an effect applied to the layer.</p>
<p><pre lang="cpp">AEGP_GetLayerEffectByIndex(<br/>  AEGP_PluginID     aegp_plugin_id,<br/>  AEGP_LayerH       layerH,<br/>  AEGP_EffectIndex  effect_indexL,<br/>  AEGP_EffectRefH   *effectPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInstalledKeyFromLayerEffect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given an <code>AEGP_EffectRefH</code>, retrieves its associated <code>AEGP_InstalledEffectKey</code>.</p>
<p><pre lang="cpp">AEGP_GetInstalledKeyFromLayerEffect(<br/>  AEGP_EffectRefH          effect_refH,<br/>  AEGP_InstalledEffectKey  *installed_keyP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetEffectParamUnionByIndex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns description of effect parameter.</p>
<p>Do not use the value(s) in the ParamDef returned by this function (Use <code>AEGP_GetNewStreamValue()</code> instead); it's provided so AEGPs can access parameter defaults, checkbox names, and pop-up strings.</p>
<p>Use <code>AEGP_GetEffectNumParamStreams()</code> from <a href="#aegps-aegp-suites-aegp_streamsuite5">AEGP_StreamSuite5</a> to get the stream count, useful for determining the maximum <code>param_index</code>. The last parameter is optional.</p>
<p><pre lang="cpp">AEGP_GetEffectParamUnionByIndex(<br/>  AEGP_PluginID     aegp_plugin_id,<br/>  AEGP_EffectRefH   effectH,<br/>  PF_ParamIndex     param_index,<br/>  PF_ParamType      *param_typeP<br/>  PF_ParamDefUnion  *uP0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetEffectFlags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the flags for the given <code>AEGP_EffectRefH</code>.</p>
<p><pre lang="cpp">AEGP_GetEffectFlags(<br/>  AEGP_EffectRefH   effect_refH,<br/>  AEGP_EffectFlags  *effect_flagsP);</pre></p>
<p>Flags will be a combination of the following:</p>
<ul>
<li><code>AEGP_EffectFlags_NONE</code></li>
<li><code>AEGP_EffectFlags_ACTIVE</code></li>
<li><code>AEGP_EffectFlags_AUDIO_ONLY</code></li>
<li><code>AEGP_EffectFlags_AUDIO_TOO</code></li>
<li><code>AEGP_EffectFlags_MISSING</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetEffectFlags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the flags (enumerated above) for the given <code>AEGP_EffectRefH</code>, masked by a different set of effect flags.</p>
<p><pre lang="cpp">AEGP_SetEffectFlags(<br/>  AEGP_EffectRefH   effect_refH,<br/>  AEGP_EffectFlags  mask,<br/>  AEGP_EffectFlags  effect_flags);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ReorderEffect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Change the order of applied effects (pass the requested index).</p>
<p><pre lang="cpp">AEGP_ReorderEffect(<br/>  AEGP_EffectRefH  effect_refH,<br/>  A_long           effect_indexL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_EffectCallGeneric</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Call an effect plug-in, and pass it a pointer to any data you like; the effect can modify it. This is how AEGPs communicate with effects.</p>
<p>Pass <code>PF_Cmd_COMPLETELY_GENERAL</code> for <code>effect_cmd</code>.</p>
<p><pre lang="cpp">AEGP_EffectCallGeneric(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_EffectRefH  effectH,<br/>  const A_Time     *timePT,<br/>  PF_Cmd           effect_cmd,<br/>  void             *extraPV);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeEffect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Disposes of an <code>AEGP_EffectRefH</code>. Use this to dispose of any <code>AEGP_EffectRefH</code> returned by After Effects.</p>
<p><pre lang="cpp">AEGP_DisposeEffect(<br/>  AEGP_EffectRefH  effectH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ApplyEffect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Apply an effect to a given layer. Returns the newly-created <code>AEGP_EffectRefH</code>.</p>
<p><pre lang="cpp">AEGP_ApplyEffect(<br/>  AEGP_PluginID            aegp_plugin_id,<br/>  AEGP_LayerH              layerH,<br/>  AEGP_InstalledEffectKey  installed_key,<br/>  AEGP_EffectRefH          *effect_refPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DeleteLayerEffect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Remove an applied effect.</p>
<p><pre lang="cpp">AEGP_DeleteLayerEffect(<br/>  AEGP_EffectRefH  effect_refH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumInstalledEffects</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the count of effects installed in After Effects.</p>
<p><pre lang="cpp">AEGP_GetNumInstalledEffects(<br/>  A_long  *num_installed_effectsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNextInstalledEffect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the <code>AEGP_InstalledEffectKey</code> of the next installed effect.</p>
<p>Pass <code>AEGP_InstalledEffectKey_NONE</code> as the first parameter to obtain the first <code>AEGP_InstalledEffectKey</code>.</p>
<p><pre lang="cpp">AEGP_GetNextInstalledEffect(<br/>  AEGP_InstalledEffectKey  key,<br/>  AEGP_InstalledEffectKey  *next_keyPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetEffectName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get name of the effect. <code>nameZ</code> can be up to <code>AEGP_MAX_EFFECT_NAME_SIZE + 1</code> long.</p>
<p><pre lang="cpp">AEGP_GetEffectName(<br/>  AEGP_InstalledEffectKey  installed_key,<br/>  A_char                   *nameZ);</pre></p>
<p>Note: use <code>AEGP_SetStreamName</code> to change the display name of an effect.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetEffectMatchName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get match name of an effect (defined in PiPL). <code>match_nameZ</code> up to <code>AEGP_MAX_EFFECT_MATCH_NAME_SIZE + 1</code> long.</p>
<p><pre lang="cpp">AEGP_GetEffectMatchName(<br/>  AEGP_InstalledEffectKey  installed_key,<br/>  A_char                   *match_nameZ);</pre></p>
<p>Match names are in 7-bit ASCII. UI names are in the current application runtime encoding; for example, ISO 8859-1 for most languages on Windows.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetEffectCategory</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Menu category of effect. <code>categoryZ</code> can be up to <code>AEGP_MAX_EFFECT_CATEGORY_NAME_SIZE + 1</code> long.</p>
<p><pre lang="cpp">AEGP_GetEffectCategory(<br/>  AEGP_InstalledEffectKey  installed_key,<br/>  A_char                   *categoryZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DuplicateEffect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Duplicates a given <code>AEGP_EffectRefH</code>. Caller must dispose of duplicate when finished.</p>
<p><pre lang="cpp">AEGP_DuplicateEffect(<br/>  AEGP_EffectRefH  orig_effect_refH,<br/>  AEGP_EffectRefH  *dupe_refPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NumEffectMask</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC 2014. How many masks are on this effect?</p>
<p><pre lang="cpp">AEGP_NumEffectMask(<br/>  AEGP_EffectRefH  effect_refH,<br/>  A_u_long         *num_masksPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetEffectMaskID</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC 2014. For a given mask_indexL, returns the corresponding <code>AEGP_MaskIDVal</code> for use in uniquely identifying the mask.</p>
<p><pre lang="cpp">AEGP_GetEffectMaskID(<br/>  AEGP_EffectRefH  effect_refH,<br/>  A_u_long         mask_indexL,<br/>  AEGP_MaskIDVal   *id_valP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_AddEffectMask</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC 2014. Add an effect mask, which may be created using the <a href="#aegps-aegp-suites-mask-management">Mask Management</a>.</p>
<p>Returns the local stream of the effect ref - useful if you want to add keyframes.</p>
<p>Caller must dispose of <code>AEGP_StreamRefH</code> when finished.</p>
<p>Undoable.</p>
<p><pre lang="cpp">AEGP_AddEffectMask(<br/>  AEGP_EffectRefH  effect_refH,<br/>  AEGP_MaskIDVal   id_val,<br/>  AEGP_StreamRefH  streamPH0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RemoveEffectMask</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC 2014. Remove an effect mask.</p>
<p>Undoable.</p>
<p><pre lang="cpp">AEGP_RemoveEffectMask(<br/>  AEGP_EffectRefH  effect_refH,<br/>  AEGP_MaskIDVal   id_val);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetEffectMask</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC 2014. Set an effect mask on an existing index.</p>
<p>Returns the local stream of the effect ref - useful if you want to add keyframes.</p>
<p>Caller must dispose of <code>AEGP_StreamRefH</code> when finished.</p>
<p>Undoable.</p>
<p><pre lang="cpp">AEGP_SetEffectMask(<br/>  AEGP_EffectRefH  effect_refH,<br/>  A_u_long         mask_indexL,<br/>  AEGP_MaskIDVal   id_val,<br/>  AEGP_StreamRefH  *streamPH0);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-exploiting-effect-ui-behavior-to-look-cool">Exploiting Effect UI Behavior To Look Cool<a class="headerlink" href="#aegps-aegp-suites-exploiting-effect-ui-behavior-to-look-cool" title="Permanent link">&para;</a></h2>
<p>Even if you manipulate a layer's effects, its effect controls won't necessarily become visible.</p>
<p>However, if you apply then immediately remove an effect, the layer's effect controls will be made visible.</p>
<p>Tricky, eh?</p>
<hr />
<h2 id="aegps-aegp-suites-streamrefs-and-effectrefs">StreamRefs And EffectRefs<a class="headerlink" href="#aegps-aegp-suites-streamrefs-and-effectrefs" title="Permanent link">&para;</a></h2>
<p>How do you get an AEGP_StreamRef for an effect? Start by getting the effect's <code>AEGP_EffectRef</code>, by calling <code>AEGP_GetNewEffectForEffect()</code>.</p>
<p>Then call <code>AEGP_GetNewEffectStreamByIndex()</code>, say for param index 1, which passes back a parameter stream.</p>
<p>Then call <code>AEGP_GetNewParentStreamRef()</code> - voila, your <code>AEGP_StreamRef</code> sir!</p>
<p>If you acquire references to an effect's streams, do not dispose of the <code>AEGP_EffectRefH</code> until you're done with the streams, or you'll unbalance After Effects' checkout mechanism. Also remember that AEGP_StreamRefHs are opaque; <code>AEGP_StreamValue2s</code> are not (entirely).</p>
<p>To get an effect's instance name (as renamed by the user), get the AEGP_StreamRef for the effect itself and call <code>AEGP_GetStreamName</code>.</p>
<hr />
<h2 id="aegps-aegp-suites-diving-into-streams">Diving Into Streams!<a class="headerlink" href="#aegps-aegp-suites-diving-into-streams" title="Permanent link">&para;</a></h2>
<p>Just about everything in After Effects is a stream. Effect parameters, layers, masks, and shapes are all internally represented by streams. The AEGP API can access nearly every aspect of every stream.</p>
<p>The After Effects timeline can contain numerous object types; each object supports a set of parameters called streams. All streams, regardless of which type of object to which they're attached, are conceptually similar (and handled similarly by After Effects. But the way you access each type of stream varies because of their containment.</p>
<p>A stream, once acquired, represents a value which may change over time. Not all streams *can* vary over time, and a particular stream may not be time-variant at the time of access.</p>
<p>There are two ways to access the value of a stream. If the stream has keyframes, you can use the <a href="#aegps-aegp-suites-working-with-keyframes">Working With Keyframes</a>. The values provided won't reflect the influence of expressions. Note: In any expression, the current keyframed value is always available as the variable value.</p>
<p>You can also use <code>AEGP_GetNewStreamValue</code> from <a href="#aegps-aegp-suites-aegp_streamsuite5">AEGP_StreamSuite5</a>, which samples the value of the stream at a particular time. For streams without expressions or keyframes, the time parameter is meaningless, and the function returns what essentially is the constant value of the stream. Use <code>AEGP_SetStreamValue</code> (which doesn't take a time as a parameter) to set these streams.</p>
<p>Many StreamSuite functions populate a StreamH, which your AEGP must dispose. when done. After Effects allocates and passes you a copy of the values, not a direct handle to the original value. <code>AEGP_GetNewLayerStream()</code> is restricted to streams for which no memory allocation is required to access their values.</p>
<hr />
<h2 id="aegps-aegp-suites-okay-what-did-i-just-get">Okay, What Did I Just Get?<a class="headerlink" href="#aegps-aegp-suites-okay-what-did-i-just-get" title="Permanent link">&para;</a></h2>
<p>A stream value is a large union, only one structure of which (depending on the stream type) is populated. Note the similarity to the <a href="#effect-basics-pf_paramdef">PF_ParamDef</a>.</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-1-1"><span class="k">typedef</span><span class="w"> </span><span class="k">union</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><span class="w">    </span><span class="n">AEGP_FourDVal</span><span class="w">         </span><span class="n">four_d</span><span class="p">;</span>
</span><span id="__span-1-3"><span class="w">    </span><span class="n">AEGP_ThreeDVal</span><span class="w">        </span><span class="n">three_d</span><span class="p">;</span>
</span><span id="__span-1-4"><span class="w">    </span><span class="n">AEGP_TwoDVal</span><span class="w">          </span><span class="n">two_d</span><span class="p">;</span>
</span><span id="__span-1-5"><span class="w">    </span><span class="n">AEGP_OneDVal</span><span class="w">          </span><span class="n">one_d</span><span class="p">;</span>
</span><span id="__span-1-6"><span class="w">    </span><span class="n">AEGP_ColorVal</span><span class="w">         </span><span class="n">color</span><span class="p">;</span>
</span><span id="__span-1-7"><span class="w">    </span><span class="n">AEGP_ArbBlockVal</span><span class="w">      </span><span class="n">arbH</span><span class="p">;</span>
</span><span id="__span-1-8"><span class="w">    </span><span class="n">AEGP_MarkerValP</span><span class="w">       </span><span class="n">markerP</span><span class="p">;</span>
</span><span id="__span-1-9"><span class="w">    </span><span class="n">AEGP_LayerIDVal</span><span class="w">       </span><span class="n">layer_id</span><span class="p">;</span>
</span><span id="__span-1-10"><span class="w">    </span><span class="n">AEGP_MaskIDVal</span><span class="w">        </span><span class="n">mask_id</span><span class="p">;</span>
</span><span id="__span-1-11"><span class="w">    </span><span class="n">AEGP_MaskOutlineValH</span><span class="w">  </span><span class="n">mask</span><span class="p">;</span>
</span><span id="__span-1-12"><span class="w">    </span><span class="n">AEGP_TextDocumentH</span><span class="w">    </span><span class="n">text_documentH</span><span class="p">;</span>
</span><span id="__span-1-13"><span class="p">}</span><span class="w"> </span><span class="n">AEGP_StreamVal2</span><span class="p">;</span>
</span></code></pre></div>
<hr />
<h2 id="aegps-aegp-suites-layers">Layers<a class="headerlink" href="#aegps-aegp-suites-layers" title="Permanent link">&para;</a></h2>
<p><code>AEGP_GetLayerStreamValue</code> is used to access the parameters like anchor point and position, native to almost all layers in AE.</p>
<p>Use <code>IsStreamLegal</code> to allow you to determine if that stream type is offered on that layer.</p>
<hr />
<h2 id="aegps-aegp-suites-masks">Masks<a class="headerlink" href="#aegps-aegp-suites-masks" title="Permanent link">&para;</a></h2>
<p>Since a layer can have multiple masks, access the masks using <code>AEGP_GetLayerMaskByIndex</code> from <a href="#aegps-aegp-suites-aegp_masksuite6">AEGP_MaskSuite6</a>.</p>
<p>Masks don't have streams like layers do; they get their own enumeration. Access their streams using <code>AEGP_GetNewMaskStream</code> from <a href="#aegps-aegp-suites-aegp_streamsuite5">AEGP_StreamSuite5</a>.</p>
<hr />
<h2 id="aegps-aegp-suites-effects">Effects<a class="headerlink" href="#aegps-aegp-suites-effects" title="Permanent link">&para;</a></h2>
<p>They can have a variable number of streams/parameters, and the order and definition of them is not known when the AEGP is written.</p>
<p>Therefore we cannot offer an enum for selecting them, and instead you must get them by index, hence <code>GetNewEffectStreamByIndex</code> from <a href="#aegps-aegp-suites-aegp_streamsuite5">AEGP_StreamSuite5</a>.</p>
<hr />
<h2 id="aegps-aegp-suites-stream-suite">Stream Suite<a class="headerlink" href="#aegps-aegp-suites-stream-suite" title="Permanent link">&para;</a></h2>
<p>Access and manipulate the values of a layer's streams. For paint and text streams, use <a href="#aegps-aegp-suites-aegp_dynamicstreamsuite4">Dynamic Streams</a> instead.</p>
<h3 id="aegps-aegp-suites-aegp_streamsuite5">AEGP_StreamSuite5<a class="headerlink" href="#aegps-aegp-suites-aegp_streamsuite5" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsStreamLegal</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Determines if the given stream is appropriate for the given layer.</p>
<p><pre lang="cpp">AEGP_IsStreamLegal(<br/>  AEGP_LayerH       layerH,<br/>  AEGP_LayerStream  which_stream,<br/>  A_Boolean*        is_legalP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CanVaryOverTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a stream, returns whether or not a stream is time-variant (and can be keyframed).</p>
<p><pre lang="cpp">AEGP_CanVaryOverTime(<br/>  AEGP_StreamRefH  streamH,<br/>  A_Boolean        *can_varyPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetValidInterpolations</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves an <code>AEGP_KeyInterpolationMask</code> indicating which interpolation types are valid for the <code>AEGP_StreamRefH</code>.</p>
<p><pre lang="cpp">AEGP_GetValidInterpolations(<br/>  AEGP_StreamRefH            streamH,<br/>  AEGP_KeyInterpolationMask  *valid_interpP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1">
<p><code>AEGP_KeyInterpolationMask</code> will be a combination of the following:</p>
<ul>
<li><code>AEGP_KeyInterpMask_NONE</code></li>
<li><code>AEGP_KeyInterpMask_LINEAR</code></li>
<li><code>AEGP_KeyInterpMask_BEZIER</code></li>
<li><code>AEGP_KeyInterpMask_HOLD</code></li>
<li><code>AEGP_KeyInterpMask_CUSTOM</code></li>
<li><code>AEGP_KeyInterpMask_ANY</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewLayerStream</code></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetEffectNumParamStreams</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get number of parameter streams associated with an effect.</p>
<p><pre lang="cpp">AEGP_GetEffectNumParamStreams(<br/>  AEGP_EffectRefH  effect_refH,<br/>  A_long           *num_parmsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewEffectStreamByIndex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get an effect's parameter stream. Plug-in must dispose of <code>streamPH</code>.</p>
<p><pre lang="cpp">AEGP_GetNewEffectStreamByIndex(<br/>  AEGP_PluginID    id,<br/>  AEGP_EffectRefH  effect_refH,<br/>  PF_ParamIndex    param_index,<br/>  AEGP_StreamRefH  *streamPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewMaskStream</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get a mask's stream. The stream must be disposed.</p>
<p>Also see the <a href="#aegps-aegp-suites-aegp_masksuite6">AEGP_MaskSuite</a> and <a href="#aegps-aegp-suites-aegp_maskoutlinesuite3">AEGP_MaskOutlineSuite</a> for additional Mask functions.</p>
<ul>
<li><code>AEGP_MaskStream_OUTLINE</code></li>
<li><code>AEGP_MaskStream_OPACITY</code></li>
<li><code>AEGP_MaskStream_FEATHER</code></li>
<li><code>AEGP_MaskStream_EXPANSION</code></li>
</ul>
<p>Useful for iteration:</p>
<ul>
<li><code>AEGP_MaskStream_BEGIN</code> = <code>AEGP_MaskStream_OUTLINE</code></li>
<li><code>AEGP_MaskStream_END</code> = <code>AEGP_MaskStream_EXPANSION + 1</code></li>
</ul>
<p><pre lang="cpp">AEGP_GetNewMaskStream(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_MaskRefH    mask_refH,<br/>  AEGP_MaskStream  which_stream,<br/>  AEGP_StreamRefH  *mask_strmPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeStream</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Dispose of a stream (do this with all streams passed to the plug-in by these functions).</p>
<p><pre lang="cpp">AEGP_DisposeStream(<br/>  AEGP_StreamRefH  streamH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewMaskOpacity</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the mask's opacity stream. The stream must be disposed.</p>
<p><pre lang="cpp">AEGP_GetNewMaskOpacity(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_MaskH       maskH,<br/>  PF_ParamIndex    param_index,<br/>  AEGP_StreamRefH  *mask_opacity_streamPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetStreamName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get name of the stream (localized or forced English). is handle of <code>A_UTF16Char</code> (contains null terminated UTF16 string); must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetStreamName(<br/>  AEGP_PluginID    pluginID,<br/>  AEGP_StreamRefH  streamH,<br/>  A_Boolean        force_englishB,<br/>  AEGP_MemHandle   *utf_stream_namePH);</pre></p>
<p>NOTE: if <code>force_englishB</code> is <code>TRUE</code>, the default name will override any stream renaming which has been done (either programatically, or by the user).</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetStreamUnitsText</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get stream units, formatted as text (localized or forced English); <code>unitsZ</code> up to <code>AEGP_MAX_STREAM_NAME_LEN + 1</code> long.</p>
<p><pre lang="cpp">AEGP_GetStreamUnitsText(<br/>  AEGP_StreamRefH  streamH,<br/>  A_Boolean        force_englishB,<br/>  A_char           *unitsZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetStreamProperties</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get stream's flags, as well as minimum and maximum values (as floats), if the stream <em>has</em> mins and maxes.</p>
<p>StreamFlags values:</p>
<ul>
<li><code>AEGP_StreamFlag_NONE</code></li>
<li><code>AEGP_StreamFlag_HAS_MIN</code></li>
<li><code>AEGP_StreamFlag_HAS_MAX</code></li>
</ul>
<p><pre lang="cpp">AEGP_GetStreamProperties(<br/>  AEGP_StreamRefH   streamH,<br/>  AEGP_StreamFlags  *flagsP,<br/>  A_FpLong          *minP0,<br/>  A_FpLong          *maxP0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsStreamTimevarying</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether or not the stream is affected by expressions.</p>
<p><pre lang="cpp">AEGP_IsStreamTimevarying(<br/>  AEGP_StreamRefH  streamH,<br/>  A_Boolean        *is_timevaryPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetStreamType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get type (dimension) of a stream.</p>
<p><pre lang="cpp">AEGP_GetStreamType(<br/>  AEGP_StreamRefH  streamH,<br/>  AEGP_StreamType  *stream_typeP);</pre></p>
<ul>
<li><code>AEGP_StreamType_NO_DATA</code></li>
<li><code>AEGP_StreamType_TwoD_SPATIAL</code></li>
<li><code>AEGP_StreamType_TwoD</code></li>
<li><code>AEGP_StreamType_ThreeD</code></li>
<li><code>AEGP_StreamType_ThreeD_SPATIAL</code></li>
<li><code>AEGP_StreamType_OneD</code></li>
<li><code>AEGP_StreamType_COLOR</code></li>
<li><code>AEGP_StreamType_ARB</code></li>
<li><code>AEGP_StreamType_MARKER</code></li>
<li><code>AEGP_StreamType_LAYER_ID</code></li>
<li><code>AEGP_StreamType_MASK_ID</code></li>
<li><code>AEGP_StreamType_MASK</code></li>
<li><code>AEGP_StreamType_TEXT_DOCUMENT</code></li>
</ul>
<p>NOTE: always returns <code>ThreeD_Spatial</code> for position, regardless of whether or not the layer is 3D.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewStreamValue</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get value, at a time you specify, of stream. <code>valueP</code> must be disposed by the plug-in.</p>
<p>The <code>AEGP_LTimeMode</code> indicates whether the time is in compositions or layer time.</p>
<p><pre lang="cpp">AEGP_GetNewStreamValue(<br/>  AEGP_PluginID      aegp_plugin_id,<br/>  AEGP_StreamRefH    streamH,<br/>  AEGP_LTimeMode     time_mode,<br/>  const A_Time       *timePT,<br/>  A_Boolean          pre_exprB,<br/>  AEGP_StreamValue2  *valueP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeStreamValue</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Dispose of stream value. Always deallocate values passed to the plug-in.</p>
<p><pre lang="cpp">AEGP_DisposeStreamValue(<br/>  AEGP_StreamValue2  *valueP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetStreamValue</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Only legal when stream is not time-variant.</p>
<p><pre lang="cpp">AEGP_SetStreamValue(<br/>  AEGP_PluginID      aegp_plugin_id,<br/>  AEGP_StreamRefH    streamH,<br/>  AEGP_StreamValue2  *valueP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerStreamValue</code></p>
</td>
<td colspan="1" rowspan="1">
<p>NOTE: This convenience function is only valid for streams with primitive data types, and not for <code>AEGP_ArbBlockVal</code>, <code>AEGP_MarkerValH</code> or <code>AEGP_MaskOutlineValH</code>. For these and other complex types, use <code>AEGP_GetNewStreamValue</code>, described above.</p>
<p><pre lang="cpp">AEGP_GetLayerStreamValue(<br/>  AEGP_LayerH       layerH,<br/>  AEGP_LayerStream  which_stream,<br/>  AEGP_LTimeMode    time_mode,<br/>  const A_Time      *timePT,<br/>  A_Boolean         pre_expB,<br/>  AEGP_StreamVal    *stream_valP,<br/>  AEGP_StreamType   *strm_typeP0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetExpressionState</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Determines whether expressions are enabled on the given <code>AEGP_StreamRefH</code>.</p>
<p><pre lang="cpp">AEGP_GetExpressionState(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_StreamRefH  streamH,<br/>  A_Boolean        *enabledPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetExpressionState</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Enables and disables expressions on the given <code>AEGP_StreamRefH</code>.</p>
<p><pre lang="cpp">AEGP_SetExpressionState(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_StreamRefH  streamH,<br/>  A_Boolean        enabledB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetExpression</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the expression's text. Starting in suite version 5 (available in 15.0 and later), this now supports Unicode.</p>
<p><pre lang="cpp">AEGP_GetExpression(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_StreamRefH  streamH,<br/>  AEGP_MemHandle   *unicodeHZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetExpression</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the expression's text. Starting in suite version 5 (available in 15.0 and later), this now supports Unicode.</p>
<p><pre lang="cpp">AEGP_SetExpression(<br/>  AEGP_PluginID      aegp_plugin_id,<br/>  AEGP_StreamRefH    streamH,<br/>  const A_UTF16Char*  expressionP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DuplicateStreamRef</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Duplicates a given <code>AEGP_StreamRefH</code>. Dispose of the duplicate.</p>
<p><pre lang="cpp">AEGP_DuplicateStreamRef(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_StreamRefH  streamH,<br/>  AEGP_StreamRefH  *dup_streamPH);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-dynamic-streams">Dynamic Streams<a class="headerlink" href="#aegps-aegp-suites-dynamic-streams" title="Permanent link">&para;</a></h2>
<p><code>AEGP_DynamicStreamSuite</code> accesses and manipulates paint and text streams.</p>
<p>Use <code>AEGP_GetStreamGroupingType</code> and <code>AEGP_GetDynamicStreamFlags</code> to identify the stream before attempting to use functions which only work on certain stream types.</p>
<p>Also note that, often, you can simply use <a href="#aegps-aegp-suites-stream-suite">Stream Suite</a> calls to work with dynamic streams. On the other hand, only those functions specific to dynamic streams are in this suite.</p>
<h3 id="aegps-aegp-suites-aegp_dynamicstreamsuite4">AEGP_DynamicStreamSuite4<a class="headerlink" href="#aegps-aegp-suites-aegp_dynamicstreamsuite4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewStreamRefForLayer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the AEGP_StreamRefH corresponding to the layer. This function is used to initiate a recursive walk of the layer's streams.</p>
<p><pre lang="cpp">AEGP_GetNewStreamRefForLayer(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_LayerH      layerH,<br/>  AEGP_StreamRefH  *streamPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewStreamRefForMask</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the AEGP_StreamRefH corresponding to the mask.</p>
<p><pre lang="cpp">AEGP_GetNewStreamRefForMask(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_MaskRefH    maskH,<br/>  AEGP_StreamRefH  *streamPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetStreamDepth</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the number of sub-streams associated with the given <code>AEGP_StreamRefH</code>. The initial layer has a depth of 0.</p>
<p><pre lang="cpp">AEGP_GetStreamDepth(<br/>  AEGP_StreamRefH  streamH,<br/>  A_long           *depthPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetStreamGroupingType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the grouping type for the given <code>AEGP_StreamRefH</code>.</p>
<p><pre lang="cpp">AEGP_GetStreamGroupingType(<br/>  AEGP_StreamRefH          streamH,<br/>  AEGP_StreamGroupingType  *group_typeP);</pre></p>
<p>AEGP_StreamGroupingType will be one of the following:</p>
<ul>
<li><code>AEGP_StreamGroupingType_NONE</code></li>
<li><code>AEGP_StreamGroupingType_LEAF</code></li>
<li><code>AEGP_StreamGroupingType_NAMED_GROUP</code></li>
<li><code>AEGP_StreamGroupingType_INDEXED_GROUP</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumStreamsInGroup</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the number of streams associated with the given <code>AEGP_StreamRefH</code>.</p>
<p>This function will return an error if called with an <code>AEGP_StreamRefH</code> with type <code>AEGP_StreamGroupingType_LEAF</code>.</p>
<p><pre lang="cpp">AEGP_GetNumStreamsInGroup(<br/>  AEGP_StreamRefH  streamH,<br/>  A_long           *num_streamsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetDynamicStreamFlags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the flags for a given AEGP_StreamRefH.</p>
<p><pre lang="cpp">AEGP_GetDynamicStreamFlags(<br/>  AEGP_StreamRefH      streamH,<br/>  AEGP_DynStreamFlags  *flagsP);</pre></p>
<p><code>AEGP_DynStreamFlags</code> will be one of the following:</p>
<ul>
<li><code>AEGP_DynStreamFlag_ACTIVE_EYEBALL</code> means that the stream is available for reading and writing.</li>
<li><code>AEGP_DynStreamFlag_HIDDEN</code> means that, while the stream is still readable/writable, it may not currently be visible in the UI.</li>
<li><code>AEGP_DynStreamFlag_DISABLED</code> A read-only flag. Indicates whether the <code>AEGP_StreamRefH</code> is grayed out in the UI.<ul>
<li>Note that as of CS5, this flag will not be returned if a parameter is disabled.</li>
<li>Instead, check <code>PF_PUI_DISABLED</code> in <a href="#effect-basics-pf_paramdef-parameter-ui-flags">Parameter UI Flags</a>.</li>
</ul>
</li>
<li><code>AEGP_DynStreamFlag_ELIDED</code> A read-only flag. Indicates that the <code>AEGP_StreamRefH</code> is read-only, the user never sees it. However, the children are still seen and not indented in the Timeline panel.</li>
<li><code>AEGP_DynStreamFlag_SHOWN_WHEN_EMPTY</code> New in CS6. A read-only flag. Indicates that this stream group should be shown when empty.</li>
<li><code>AEGP_DynStreamFlag_SKIP_REVEAL_WHEN_UNHIDDEN</code> New in CS6. A read-only flag. Indicates that this stream property will not be automatically revealed when un-hidden.</li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetDynamicStreamFlag</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the specified flag for the <code>AEGP_StreamRefH</code>.</p>
<p>Note: flags must be set individually. Undoable if <code>undoableB</code> is <code>TRUE</code>.</p>
<p><pre lang="cpp">AEGP_SetDynamicStreamFlag(<br/>  AEGP_StreamRefH      streamH,<br/>  AEGP_DynStreamFlags  one_flag,<br/>  A_Boolean            undoableB,<br/>  A_Boolean            setB);</pre></p>
<p>This call may be used to dynamically show or hide parameters, by setting and clearing <code>AEGP_DynStreamFlag_HIDDEN</code>. However, <code>AEGP_DynStreamFlag_DISABLED</code> may not be set.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewStreamRefByIndex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves a sub-stream by index from a given <code>AEGP_StreamRefH</code>. Cannot be used on streams of type <code>AEGP_StreamGroupingType_LEAF</code>.</p>
<p><pre lang="cpp">AEGP_GetNewStreamRefByIndex(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_StreamRefH  parent_groupH,<br/>  A_long           indexL,<br/>  AEGP_StreamRefH  *streamPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewStreamRefByMatchname</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves a sub-stream by match name from a given <code>AEGP_StreamRefH</code>. Only legal for <code>AEGP_StreamGroupingType_NAMED_GROUP</code>.</p>
<p><pre lang="cpp">AEGP_GetNewStreamRefByMatchname(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_StreamRefH  parent_groupH,<br/>  const A_char     *match_nameZ,<br/>  AEGP_StreamRefH  *streamPH);</pre></p>
<p>Here are some handy stream names, for which references may be retrieved:</p>
<ul>
<li><code>AEGP_StreamGroupName_MASK_PARADE</code></li>
<li><code>AEGP_StreamGroupName_MASK_ATOM</code></li>
<li><code>AEGP_StreamName_MASK_FEATHER</code></li>
<li><code>AEGP_StreamName_MASK_OPACITY</code></li>
<li><code>AEGP_StreamName_MASK_OFFSET</code></li>
<li><code>AEGP_StreamGroupName_EFFECT_PARADE</code></li>
<li><code>AEGP_StreamGroupName_LAYER</code></li>
<li><code>AEGP_StreamGroupName_AV_LAYER</code></li>
<li><code>AEGP_StreamGroupName_TEXT_LAYER</code></li>
<li><code>AEGP_StreamGroupName_CAMERA_LAYER</code></li>
<li><code>AEGP_StreamGroupName_LIGHT_LAYER</code></li>
<li><code>AEGP_StreamGroupName_AUDIO</code></li>
<li><code>AEGP_StreamGroupName_MATERIAL_OPTIONS</code></li>
<li><code>AEGP_StreamGroupName_TRANSFORM</code></li>
<li><code>AEGP_StreamGroupName_LIGHT_OPTIONS</code></li>
<li><code>AEGP_StreamGroupName_CAMERA_OPTIONS</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DeleteStream</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Deletes the specified stream from a stream grouping.</p>
<p>Note that the caller must still dispose of any <code>AEGP_StreamRefH</code> it's already acquired (allocated) via the API. Undoable.</p>
<p>Only valid for children of type <code>AEGP_StreamGroupingType_INDEXED_GROUP</code>.</p>
<p><pre lang="cpp">AEGP_DeleteStream(<br/>  AEGP_StreamRefH  streamH);</pre></p>
<p>Note: as of 6.5, if a stream is deleted while it or any child stream is selected, the current composition selection will become <code>NULL</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ReorderStream</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the new index of the specified <code>AEGP_StreamRefH</code>. Undoable.</p>
<p>Only valid for children of <code>AEGP_StreamGroupingType_INDEXED_GROUP</code>.</p>
<p>The <code>AEGP_StreamRefH</code> is updated to refer to the newly-ordered stream.</p>
<p><pre lang="cpp">AEGP_ReorderStream(<br/>  AEGP_StreamRefH  streamH<br/>  A_long           new_indexL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DuplicateStream</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Duplicates the specified stream and appends it to the stream group.</p>
<p>Undoable.</p>
<p>Only valid for children of <code>AEGP_StreamGroupingType_INDEXED_GROUP</code>.</p>
<p><pre lang="cpp">AEGP_DuplicateStream(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_StreamRefH  streamH,<br/>  A_long           *new_indexPL0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetStreamName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the name of the given <code>AEGP_StreamRefH</code>. Undoable. nameZ points to a null terminated UTF-16 string.</p>
<p>Only valid for children of <code>AEGP_StreamGroupingType_INDEXED_GROUP</code>.</p>
<p>NOTE: If you retrieve the name with force_englishB set to <code>TRUE</code>, you will get the canonical, UNchanged name of the stream.</p>
<p><pre lang="cpp">AEGP_SetStreamName(<br/>  AEGP_StreamRefH    streamH,<br/>  const A_UTF16Char  *nameZ);</pre></p>
<p>Note: Use this on an effect stream's group to change the display name of an effect.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CanAddStream</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether or not it is currently possible to add a stream through the API.</p>
<p><pre lang="cpp">AEGP_CanAddStream(<br/>  AEGP_StreamRefH  group_streamH,<br/>  const A_char     *match_nameZ,<br/>  A_Boolean        *can_addPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_AddStream</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Adds a stream to the specified stream group. Undoable. Only valid for <code>AEGP_StreamGroupingType_INDEXED_GROUP</code>.</p>
<p><pre lang="cpp">AEGP_AddStream(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_StreamRefH  indxd_grp_streamH,<br/>  const A_char     *match_nameZ,<br/>  AEGP_StreamRefH  *streamPH0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMatchName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the match name for the specified <code>AEGP_StreamRefH</code>.</p>
<p>Note that this may differ from the display name, which can be retrieves using <code>AEGP_GetStreamName</code>, in <a href="#aegps-aegp-suites-aegp_streamsuite5">AEGP_StreamSuite5</a>.</p>
<p><code>nameZ</code> can be up to <code>AEGP_MAX_STREAM_MATCH_NAME_SIZE</code> in length.</p>
<p><pre lang="cpp">AEGP_GetMatchName(<br/>  AEGP_StreamRefH  streamH,<br/>  A_char           *nameZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewParentStreamRef</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves an <code>AEGP_StreamRefH</code> for the parent of the specified <code>AEGP_StreamRefH</code>.</p>
<p><pre lang="cpp">AEGP_GetNewParentStreamRef(<br/>  AEGP_PluginID    plugin_id,<br/>  AEGP_StreamRefH  streamH,<br/>  AEGP_StreamRefH  *parentPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetStreamIsModified</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether or not the specified <code>AEGP_StreamRefH</code> has been modified.</p>
<p>Note: the same result is available throught the After Effect user interface by typing "UU" with the composition selected.</p>
<p><pre lang="cpp">AEGP_GetStreamIsModified(<br/>  AEGP_StreamRefH  streamH,<br/>  A_Boolean        *modifiedPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetStreamIndexInParent</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the index of a given stream, relative to its parent stream.</p>
<p>Only valid for children of <code>AEGP_StreamGroupingType_INDEXED_GROUP</code></p>
<p><pre lang="cpp">AEGP_GetStreamIndexInParent(<br/>  AEGP_StreamRefH  streamH,<br/>  A_long           *indexPL);</pre></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As mentioned <em>elsewhere</em>, <code>AEGP_StreamRefHs</code> don't persist across function calls.</p>
</div>
<p>If streams are re-ordered, added or removed, all <code>AEGP_StreamRefHs</code> previously retrieved may be invalidated.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsSeparationLeader</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Valid on leaf streams only. Returns true if this stream is a multidimensional stream that can have its dimensions separated, though they may not be currently separated.</p>
<p>Terminology: A Leader is the stream that can be separated, a Follower is one of N automatic streams that correspond to the N dimensions of the Leader.</p>
<p>A Leader isn't always separated, call <code>AEGP_AreDimensionsSeparated</code> to find out if it is. As of CS4, the only stream that is ever separarated is the layer's Position property.</p>
<p>Please <em>do not</em> write code assuming that, we anticipate allowing separation of more streams in the future.</p>
<p><pre lang="cpp">AEGP_IsSeparationLeader(<br/>  AEGP_StreamRefH  streamH,<br/>  A_Boolean        *leaderPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_AreDimensionsSeparated</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Methods such as <code>AEGP_GetNewKeyframeValue</code> that work on keyframe indices will most definitely <em>not</em> work on the Leader property, you will need to retrieve and operate on the Followers explicitly.</p>
<p><pre lang="cpp">AEGP_AreDimensionsSeparated(<br/>  AEGP_StreamRefH  streamH,<br/>  A_Boolean        *separatedPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetDimensionsSeparated</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Valid only if <code>AEGP_IsSeparationLeader()</code> is <code>true</code>.</p>
<p><pre lang="cpp">AEGP_AreDimensionsSeparated(<br/>  AEGP_StreamRefH  streamH,<br/>  A_Boolean        *separatedPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetSeparationFollower</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieve the Follower stream corresponding to a given dimension of the Leader stream.</p>
<p><code>dimS</code> can range from <code>0</code> to <code>AEGP_GetStreamValueDimensionality(lea der_streamH) - 1</code>.</p>
<p><pre lang="cpp">AEGP_GetSeparationFollower(<br/>  AEGP_StreamRefH  leader_streamH<br/>  A_short          dimS,<br/>  AEGP_StreamRefH  *follower_streamPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsSeparationFollower</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Valid on leaf streams only.</p>
<p>Returns <code>true</code> if this stream is a one dimensional property that represents one of the dimensions of a Leader.</p>
<p>You can retrieve stream from the Leader using <code>AEGP_GetSeparationFollower()</code>.</p>
<p><pre lang="cpp">AEGP_IsSeparationFollower(<br/>  AEGP_StreamRefH  streamH<br/>  A_Boolean        *followerPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetSeparationLeader</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Valid on separation Followers only, returns the Leader it is part of.</p>
<p><pre lang="cpp">AEGP_GetSeparationLeader(<br/>  AEGP_StreamRefH  follower_streamH,<br/>  AEGP_StreamRefH  *leader_streamPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetSeparationDimension</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Valid on separation Followers only, returns which dimension of the Leader it corresponds to.</p>
<p><pre lang="cpp">AEGP_GetSeparationDimension(<br/>  AEGP_StreamRefH  follower_streamH,<br/>  A_short          *dimPS);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-working-with-keyframes">Working With Keyframes<a class="headerlink" href="#aegps-aegp-suites-working-with-keyframes" title="Permanent link">&para;</a></h2>
<p>Keyframes make After Effects what it is. AEGPs (and...ssshh, don't tell anyone...effects) can use this suite to add, manipulate and remove keyframes from any keyframe-able stream.</p>
<h3 id="aegps-aegp-suites-aegp_keyframesuite3">AEGP_KeyframeSuite3<a class="headerlink" href="#aegps-aegp-suites-aegp_keyframesuite3" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetStreamNumKFs</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the number of keyframes on the given stream.</p>
<p>Returns <code>AEGP_NumKF_NO_DATA</code> if the stream is not keyframe-able.</p>
<p>Also, note that a stream without keyframes isn't necessarily constant; it can be altered by expressions.</p>
<p><pre lang="cpp">AEGP_GetStreamNumKFs(<br/>  AEGP_StreamRefH  streamH,<br/>  A_long           *num_kfsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetKeyframeTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the time of the specified keyframe.</p>
<p><pre lang="cpp">AEGP_GetKeyframeTime(<br/>  AEGP_StreamRefH     streamH,<br/>  AEGP_KeyframeIndex  index,<br/>  AEGP_LTimeMode      time_mode,<br/>  A_Time              *timePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_InsertKeyframe</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Adds a keyframe to the specified stream (at the specified composition or layer time).</p>
<p>Returns the new keyframe's index.</p>
<p>All indexes greater than the new index are now invalid (but you knew that). If there is already a keyframe at that time, the values will be updated.</p>
<p><pre lang="cpp">AEGP_InsertKeyframe(<br/>  AEGP_StreamRefH     streamH,<br/>  AEGP_LTimeMode      time_mode,<br/>  const A_Time        *timePT,<br/>  AEGP_KeyframeIndex  *key_indexP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DeleteKeyframe</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Deletes the specified keyframe.</p>
<p><pre lang="cpp">AEGP_DeleteKeyframe(<br/>  AEGP_StreamRefH     streamH,<br/>  AEGP_KeyframeIndex  key_index);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewKeyframeValue</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates and populates an <code>AEGP_StreamValue2</code> for the stream's value at the time of the keyframe.</p>
<p>The returned <code>AEGP_StreamValue2</code> must be disposed of using <code>AEGP_DisposeStreamValue</code>.</p>
<p><pre lang="cpp">AEGP_GetNewKeyframeValue(<br/>  AEGP_PluginID       plugin_id,<br/>  AEGP_StreamRefH     streamH,<br/>  AEGP_KeyframeIndex  key_index,<br/>  AEGP_StreamValue2   *valueP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetKeyframeValue</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the stream's value at the time of the keyframe.</p>
<p><pre lang="cpp">AEGP_SetKeyframeValue(<br/>  AEGP_StreamRefH          streamH,<br/>  AEGP_KeyframeIndex       index,<br/>  const AEGP_StreamValue2  *valP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetStreamValueDimensionality</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the dimensionality of the stream's value.</p>
<p><pre lang="cpp">AEGP_GetStreamValueDimensionality(<br/>  AEGP_StreamRefH  streamH,<br/>  A_short          *value_dimPS);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetStreamTemporalDimensionality</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the temporal dimensionality of the stream.</p>
<p><pre lang="cpp">AEGP_GetStreamTemporalDimensionality(<br/>  AEGP_StreamRefH  streamH,<br/>  A_short          *t_dimPS);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewKeyframeSpatialTangents</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the <code>AEGP_StreamValue2s</code> representing the stream's tangential values at the time of the keyframe.</p>
<p>The returned <code>AEGP_StreamValue2s</code> must be disposed of using <code>AEGP_DisposeStreamValue</code>.</p>
<p><pre lang="cpp">AEGP_GetNewKeyframeSpatialTangents(<br/>  AEGP_PluginID       plugin_id,<br/>  AEGP_StreamRefH     streamH,<br/>  AEGP_KeyframeIndex  key_index,<br/>  AEGP_StreamValue2   *in_tanP0,<br/>  AEGP_StreamValue2   *out_tanP0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetKeyframeSpatialTangents</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the tangential <code>AEGP_StreamValue2s</code> to be used for the stream's value at the time of the keyframe.</p>
<p>The <code>AEGP_StreamValue2s</code> passed for in and out tangents are not adopted by After Effects, and must be disposed of using <code>AEGP_DisposeStreamValue</code>.</p>
<p><pre lang="cpp">AEGP_SetKeyframeSpatialTangents(<br/>  AEGP_StreamRefH          streamH,<br/>  AEGP_KeyframeIndex       key_index,<br/>  const AEGP_StreamValue2  *in_tP0,<br/>  const AEGP_StreamValue2  *out_tP0);</pre></p>
<p>NOTE: In <code>AEGP_KeyframeSuite2</code> and prior versions, the values returned from this function were wrong when called on an effect point control stream or anchor point. They were not multiplied by the layer size. Now they are.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetKeyframeTemporalEase</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the <code>AEGP_KeyframeEases</code> associated with the specified dimension of the stream's value at the time of the keyframe.</p>
<p><code>dimensionL</code> ranges from <code>0</code> to <code>(temporal_dimensionality -1)</code>.</p>
<p><pre lang="cpp">AEGP_GetKeyframeTemporalEase(<br/>  AEGP_StreamRefH     streamH,<br/>  AEGP_KeyframeIndex  key_index,<br/>  A_long              dimensionL,<br/>  AEGP_KeyframeEase   *in_easeP0,<br/>  AEGP_KeyframeEase   *out_easeP0);</pre></p>
<p>NOTE: the returned ease values must be multiplied by layer height to match the values displayed in the After Effects UI.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetKeyframeTemporalEase</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the <code>AEGP_KeyframeEases</code> to be used for the stream's value at the time of the keyframe.</p>
<p><code>dimensionL</code> ranges from <code>0</code> to <code>(temporal_dimensionality -1)</code>.</p>
<p>The <code>AEGP_KeyframeEases</code> passed are not adopted by After Effects.</p>
<p><pre lang="cpp">AEGP_SetKeyframeTemporalEase(<br/>  AEGP_StreamRefH           streamH,<br/>  AEGP_KeyframeIndex        key_index,<br/>  A_long                    dimL,<br/>  const AEGP_KeyframeEase   *in_P0,<br/>  const AEGP_KeyframeEase   *outP0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetKeyframeFlags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the flags currently set for the keyframe.</p>
<p><pre lang="cpp">AEGP_GetKeyframeFlags(<br/>  AEGP_StreamRefH     streamH,<br/>  AEGP_KeyframeIndex  key_index,<br/>  AEGP_KeyframeFlags  *flagsP);</pre></p>
<p><code>*flagsP</code> will be a combination of the following:</p>
<ul>
<li><code>AEGP_KeyframeFlag_NONE</code></li>
<li><code>AEGP_KeyframeFlag_TEMPORAL_CONTINUOUS</code></li>
<li><code>AEGP_KeyframeFlag_TEMPORAL_AUTOBEZIER</code></li>
<li><code>AEGP_KeyframeFlag_SPATIAL_CONTINUOUS</code></li>
<li><code>AEGP_KeyframeFlag_SPATIAL_AUTOBEZIER</code></li>
<li><code>AEGP_KeyframeFlag_ROVING</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetKeyframeFlag</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the specified flag for the keyframe. Flags must be set individually.</p>
<p><pre lang="cpp">AEGP_SetKeyframeFlag(<br/>  AEGP_StreamRefH     streamH,<br/>  AEGP_KeyframeIndex  key_index,<br/>  AEGP_KeyframeFlags  flag,<br/>  A_Boolean           valueB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetKeyframeInterpolation</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the in and out <code>AEGP_KeyframeInterpolationTypes</code> for the specified keyframe.</p>
<p><pre lang="cpp">AEGP_GetKeyframeInterpolation(<br/>  AEGP_StreamRefH                 streamH,<br/>  AEGP_KeyframeIndex              key_index,<br/>  AEGP_KeyframeInterpolationType  *inP0,<br/>  AEGP_KeyframeInterpolationType  *outP0);</pre></p>
<p><code>AEGP_KeyframeInterpolationType</code> is one of the following:</p>
<ul>
<li><code>AEGP_KeyInterp_NONE</code></li>
<li><code>AEGP_KeyInterp_LINEAR</code></li>
<li><code>AEGP_KeyInterp_BEZIER</code></li>
<li><code>AEGP_KeyInterp_HOLD</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetKeyframeInterpolation</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the in and out <code>AEGP_KeyframeInterpolationTypes</code> to be used for the given keyframe.</p>
<p><pre lang="cpp">AEGP_SetKeyframeInterpolation(<br/>  AEGP_StreamRefH                 streamH,<br/>  AEGP_KeyframeIndex              key_index,<br/>  AEGP_KeyframeInterpolationType  in_interp,<br/>  AEGP_KeyframeInterpolationType  out_interp);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_StartAddKeyframes</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Informs After Effects that you're going to be adding several keyframes to the specified stream. After Effects will return an allocated opaque <code>AEGP_AddKeyframesInfoH</code>, for use with the calls below.</p>
<p><pre lang="cpp">AEGP_StartAddKeyframes(<br/>  AEGP_StreamRefH         streamH,<br/>  AEGP_AddKeyframesInfoH  *akPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_AddKeyframes</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Adds a keyframe to the specified stream at the specified (layer or composition) time.</p>
<p>Note: this doesn't actually do anything to the stream's value.</p>
<p><pre lang="cpp">AEGP_AddKeyframes(<br/>  AEGP_AddKeyframesInfoH  akH,<br/>  AEGP_LTimeMode          time_mode,<br/>  const A_Time            *timePT,<br/>  A_long                  *indexPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetAddKeyframe</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the value of the specified keyframe.</p>
<p><pre lang="cpp">AEGP_SetAddKeyframe(<br/>  AEGP_AddKeyframesInfoH   akH,<br/>  A_long                   indexL,<br/>  const AEGP_StreamValue2  *valueP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_EndAddKeyframes</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Tells After Effects you're done adding keyframes.</p>
<p><pre lang="cpp">AEGP_EndAddKeyframes(<br/>  A_Boolean               addB,<br/>  AEGP_AddKeyframesInfoH  akH);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-adding-multiple-keyframes">Adding Multiple Keyframes<a class="headerlink" href="#aegps-aegp-suites-adding-multiple-keyframes" title="Permanent link">&para;</a></h2>
<p>Each time you call <code>AEGP_InsertKeyframe()</code>, the entire stream is added to the undo stack.</p>
<p>If you're adding one or two keyframes, this isn't a problem. However, if you're writing a keyframer, you'll want to do things the *right* way.</p>
<p>Before you begin adding keyframes, call the (very-appropriately-named) <code>AEGP_StartAddKeyframes</code>, passing it an opaque <code>AEGP_AddKeyframesInfoH</code>.</p>
<p>For each keyframe to add, call <code>AEGP_AddKeyframes</code> to set the time to be used (and get the newly-added keyframe's index), then <code>AEGP_SetAddKeyframe</code> to specify the value to be used.</p>
<p>Once you're finished, call <code>AEGP_EndAddKeyframes</code> to let know After Effects know it's time to add the changed parameter stream to the undo stack.</p>
<hr />
<h2 id="aegps-aegp-suites-marker-streams">Marker Streams<a class="headerlink" href="#aegps-aegp-suites-marker-streams" title="Permanent link">&para;</a></h2>
<p><code>AEGP_MarkerSuite</code> allows for direct manipulation of marker data.</p>
<h3 id="aegps-aegp-suites-aegp_markersuite2">AEGP_MarkerSuite2<a class="headerlink" href="#aegps-aegp-suites-aegp_markersuite2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewMarker</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a new marker.</p>
<p><pre lang="cpp">AEGP_NewMarker(<br/>  AEGP_MarkerValP  *markerPP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeMarker</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Disposes of a marker.</p>
<p><pre lang="cpp">AEGP_DisposeMarker(<br/>  AEGP_MarkerValP  markerP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DuplicateMarker</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Duplicates a marker (didn't see *that* one coming, eh?).</p>
<p><pre lang="cpp">AEGP_DuplicateMarker(<br/>  AEGP_MarkerValP  markerP,<br/>  AEGP_MarkerValP  *new_markerP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMarkerFlag</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets a marker flag's value.</p>
<p><pre lang="cpp">AEGP_SetMarkerFlag(<br/>  AEGP_MarkerValP      markerP,<br/>  AEGP_MarkerFlagType  flagType,<br/>  A_Boolean            valueB);</pre></p>
<p>Currently, AEGP_MarkerFlagType is one of the following:</p>
<ul>
<li><code>AEGP_MarkerFlag_NONE</code></li>
<li><code>AEGP_MarkerFlag_NAVIGATION</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMarkerFlag</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Gets the value (see above) of a given <code>AEGP_MarkerFlagType</code>.</p>
<p><pre lang="cpp">AEGP_GetMarkerFlag(<br/>  AEGP_ConstMarkerValP  markerP,<br/>  AEGP_MarkerFlagType   flagType<br/>  A_Boolean             *valueBP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMarkerString</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the UTF-16, NULL-terminated string located in the specified marker field. Must be disposed of by caller using <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetMarkerString(<br/>  AEGP_PluginID          id,<br/>  AEGP_ConstMarkerValP   markerP,<br/>  AEGP_MarkerStringType  strType,<br/>  AEGP_MemHandle         *unicodePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMarkerString</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the specified field of a marker to the provided text.</p>
<p><pre lang="cpp">AEGP_SetMarkerString(<br/>  AEGP_MarkerValP        markerP,<br/>  AEGP_MarkerStringType  strType,<br/>  const A_u_short        *unicodeP,<br/>  A_long                 lengthL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CountCuePointParams</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the number of cue point parameters.</p>
<p><pre lang="cpp">AEGP_CountCuePointParams(<br/>  AEGP_ConstMarkerValP  markerP,<br/>  A_long                *paramsLP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetIndCuePointParam</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the cue point param at the specified index (which must be between <code>0</code> and <code>(cue point params -1)</code>.</p>
<p>Returned handles are UTF-16, NULL-terminated strings, and must be disposed of by caller using <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetIndCuePointParam(<br/>  AEGP_PluginID         id,<br/>  AEGP_ConstMarkerValP  markerP,<br/>  A_long                param_indexL,<br/>  AEGP_MemHandle        *unicodeKeyPH,<br/>  AEGP_MemHandle        *uni_ValuePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetIndCuePointParam</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set the value of an indexed cue point parameter to the specified value.</p>
<p><code>key_lengthL</code> is "number of unicode characters", and <code>value_lenL</code> is the length of the provided value.</p>
<p><code>unicode_KeyP</code> and <code>unicode_ValueP</code> point to UTF-16 data.</p>
<p><pre lang="cpp">AEGP_SetIndCuePointParam(<br/>  AEGP_MarkerValP  markerP,<br/>  A_long           param_idxL,<br/>  const A_u_short  *unicode_KeyP,<br/>  A_long           key_lengthL,<br/>  const A_u_short  *unicode_ValueP,<br/>  A_long           value_lengthL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_InsertCuePointParam</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Inserts a cue point parameter.</p>
<p>This call is following by <code>AEGP_SetIndCuePointParam</code> to actually set the data.</p>
<p><pre lang="cpp">AEGP_InsertCuePointParam(<br/>  AEGP_MarkerValP  markerP,<br/>  A_long           param_idxL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DeleteIndCuePointParam</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Deletes the cue point param at the specified index.</p>
<p><pre lang="cpp">AEGP_DeleteIndCuePointParam(<br/>  AEGP_MarkerValP  markerP,<br/>  A_long           param_idxL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMarkerDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">AEGP_SetMarkerDuration(<br/>  AEGP_MarkerValP  markerP,<br/>  const A_Time     *durationPT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMarkerDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">AEGP_GetMarkerDuration(<br/>  AEGP_ConstMarkerValP  markerP,<br/>  A_Time                *durationPT);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-mask-management">Mask Management<a class="headerlink" href="#aegps-aegp-suites-mask-management" title="Permanent link">&para;</a></h2>
<p>Access, manipulate, and delete a layer's masks.</p>
<h3 id="aegps-aegp-suites-aegp_masksuite6">AEGP_MaskSuite6<a class="headerlink" href="#aegps-aegp-suites-aegp_masksuite6" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerNumMasks</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Counts the masks applied to a layer,</p>
<p><pre lang="cpp">AEGP_GetLayerNumMasks(<br/>  AEGP_LayerH  aegp_layerH,<br/>  A_long       *num_masksPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerMaskByIndex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a layer handle and mask index, returns a pointer to the mask handle. You must destroy the mask handle by using <code>AEGP_DisposeMask()</code>.</p>
<p><pre lang="cpp">AEGP_GetLayerMaskByIndex(<br/>  AEGP_LayerH    aegp_layerH,<br/>  A_long         mask_indexL,<br/>  AEGP_MaskRefH  *maskPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeMask</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Dispose of a mask handle.</p>
<p><pre lang="cpp">AEGP_DisposeMask(<br/>  AEGP_MaskRefH  maskH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMaskInvert</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a mask handle, determines if the mask is inverted or not.</p>
<p><pre lang="cpp">AEGP_GetMaskInvert(<br/>  AEGP_MaskRefH  maskH,<br/>  A_Boolean      *invertPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMaskInvert</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the inversion state of a mask.</p>
<p><pre lang="cpp">AEGP_SetMaskInvert(<br/>  AEGP_MaskRefH  mask_refH,<br/>  A_Boolean      invertB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMaskMode</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a mask handle, returns the current mode of the mask.</p>
<p><code>PF_MaskMode_NONE</code> does nothing, <code>PF_MaskMode_ADD</code> is the default behavior.</p>
<ul>
<li><code>PF_MaskMode_NONE</code></li>
<li><code>PF_MaskMode_ADD</code></li>
<li><code>PF_MaskMode_SUBTRACT</code></li>
<li><code>PF_MaskMode_INTERSECT</code></li>
<li><code>PF_MaskMode_LIGHTEN</code></li>
<li><code>PF_MaskMode_DARKEN</code></li>
<li><code>PF_MaskMode_DIFFERENCE</code></li>
</ul>
<p><pre lang="cpp">AEGP_GetMaskMode(<br/>  AEGP_MaskRefH  maskH,<br/>  PF_MaskMode    *modeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMaskMode</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the mode of the given mask.</p>
<p><pre lang="cpp">AEGP_SetMaskMode(<br/>  AEGP_MaskRefH  maskH,<br/>  PF_MaskMode    mode);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMaskMotionBlurState</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the motion blur setting for the given mask.</p>
<p><pre lang="cpp">AEGP_GetMaskMotionBlurState(<br/>  AEGP_MaskRefH   mask_refH,<br/>  AEGP_MaskMBlur  *blur_stateP);</pre></p>
<p><code>AEGP_MaskMBlur</code> will be one of the following:</p>
<ul>
<li><code>AEGP_MaskMBlur_SAME_AS_LAYER</code></li>
<li><code>AEGP_MaskMBlur_OFF</code></li>
<li><code>AEGP_MaskMBlur_ON</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMaskMotionBlurState</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CS6. Sets the motion blur setting for the given mask.</p>
<p><pre lang="cpp">AEGP_SetMaskMotionBlurState(<br/>  AEGP_MaskRefH   mask_refH,<br/>  AEGP_MaskMBlur  blur_state);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMaskFeatherFalloff</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CS6. Gets the type of feather falloff for the given mask, either <code>AEGP_MaskFeatherFalloff_SMOOTH</code> or <code>AEGP_MaskFeatherFalloff_LINEAR</code>.</p>
<p><pre lang="cpp">AEGP_SetMaskMotionBlurState(<br/>  AEGP_MaskRefH            mask_refH,<br/>  AEGP_MaskFeatherFalloff  *feather_falloffP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMaskFeatherFalloff</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the type of feather falloff for the given mask.</p>
<p><pre lang="cpp">AEGP_SetMaskMotionBlurState(<br/>  AEGP_MaskRefH            mask_refH,<br/>  AEGP_MaskFeatherFalloff  feather_falloff);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMaskName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Removed in CS4. Use <code>AEGP_GetNewStreamRefForMask</code> and the name functions in the Dynamic Stream Suite instead.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMaskName</code></p>
</td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMaskID</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the <code>AEGP_MaskIDVal</code> for the given <code>AEGP_MaskRefH</code>, for use in uniquely identifying the mask.</p>
<p><pre lang="cpp">AEGP_GetMaskID(<br/>  AEGP_MaskRefH   mask_refH,<br/>  AEGP_MaskIDVal  *id_valP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CreateNewMask</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a new mask on the referenced <code>AEGP_LayerH</code>, with zero nodes. The new mask's index is returned.</p>
<p><pre lang="cpp">AEGP_CreateNewMask(<br/>  AEGP_LayerH    layerH,<br/>  AEGP_MaskRefH  *mask_refPH,<br/>  A_long         *mask_indexPL0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DeleteMaskFromLayer</code></p>
</td>
<td colspan="1" rowspan="1">
<p><pre lang="cpp">AEGP_DeleteMaskFromLayer(<br/>  AEGP_MaskRefH  mask_refH);</pre></p>
<p>NOTE: As of 6.5, if you delete a mask and it or a child stream is selected, the current selection within the composition will become NULL.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMaskColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the color of the specified mask.</p>
<p><pre lang="cpp">AEGP_GetMaskColor(<br/>  AEGP_MaskRefH  mask_refH,<br/>  AEGP_ColorVal  *colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMaskColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the color of the specified mask.</p>
<p><pre lang="cpp">AEGP_SetMaskColor(<br/>  AEGP_MaskRefH        mask_refH,<br/>  const AEGP_ColorVal  *colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMaskLockState</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the lock state of the specified mask.</p>
<p><pre lang="cpp">AEGP_GetMaskLockState(<br/>  AEGP_MaskRefH  mask_refH,<br/>  A_Boolean      *is_lockedPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMaskLockState</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the lock state of the specified mask.</p>
<p><pre lang="cpp">AEGP_SetMaskLockState(<br/>  AEGP_MaskRefH  mask_refH,<br/>  A_Boolean      lockB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMaskIsRotoBezier</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether or not the given mask is used as a rotobezier.</p>
<p><pre lang="cpp">AEGP_GetMaskIsRotoBezier(<br/>  AEGP_MaskRefH  mask_refH,<br/>  A_Boolean      *is_roto_bezierPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMaskIsRotoBezier</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets whether a given mask is to be used as a rotobezier.</p>
<p><pre lang="cpp">AEGP_SetMaskIsRotoBezier(<br/>  AEGP_MaskRefH  mask_refH,<br/>  A_Boolean      *is_roto_bezierPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DuplicateMask</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Duplicates a given <code>AEGP_MaskRefH</code>. Caller must dispose of duplicate.</p>
<p><pre lang="cpp">AEGP_DuplicateMask(<br/>  AEGP_MaskRefH  orig_mask_refH,<br/>  AEGP_MaskRefH  *dupe_mask_refPH);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-mask-outlines">Mask Outlines<a class="headerlink" href="#aegps-aegp-suites-mask-outlines" title="Permanent link">&para;</a></h2>
<p>The Mask Suite above tells plug-ins about the masks on a layer, but not about the details of those masks.</p>
<p>This is because processing is required on After Effects' part to access the information; the information isn't just lying around.</p>
<p>Plug-ins access that information using this Mask Outline Suite.</p>
<h3 id="aegps-aegp-suites-aegp_maskoutlinesuite3">AEGP_MaskOutlineSuite3<a class="headerlink" href="#aegps-aegp-suites-aegp_maskoutlinesuite3" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsMaskOutlineOpen</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given an mask outline pointer (obtainable through the <a href="#aegps-aegp-suites-stream-suite">Stream Suite</a>), determines if the mask path is open or closed.</p>
<p><pre lang="cpp">AEGP_IsMaskOutlineOpen(<br/>  AEGP_MaskOutlineVal  *mask_outlineP,<br/>  A_Boolean            *openPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMaskOutlineOpen</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the open state of the given mask outline.</p>
<p><pre lang="cpp">AEGP_SetMaskOutlineOpen(<br/>  AEGP_MaskOutlineValH  mask_outlineH,<br/>  A_Boolean             openB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMaskOutlineNumSegments</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a mask outline pointer, returns the number of segments in the path.</p>
<p><code>num_segmentsPL</code> is the total number of segments <code>[0...N-1]</code>.</p>
<p><pre lang="cpp">AEGP_GetMaskOutlineNumSegments(<br/>  AEGP_MaskOutlineVal  *mask_outlineP,<br/>  A_long               *num_segmentsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMaskOutlineVertexInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a mask outline pointer and a point between 0 and the total number of segments.</p>
<p>For closed mask paths, <code>vertex[0]</code> is the same as <code>vertex[num_segments]</code>.</p>
<p><pre lang="cpp">AEGP_GetMaskOutlineVertexInfo(<br/>  AEGP_MaskOutlineVal  *mask_outlineP,<br/>  A_long               which_pointL,<br/>  AEGP_MaskVertex      *vertexP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMaskOutlineVertexInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the vertex information for a given index.</p>
<p>Setting vertex 0 is special; its in tangent will actually set the out tangent of the last vertex in the outline.</p>
<p>Of course, <code>which_pointL</code> must be valid for the mask outline, or the function will return an error.</p>
<p><pre lang="cpp">AEGP_SetMaskOutlineVertexInfo(<br/>  AEGP_MaskOutlineValH  mask_outlineH,<br/>  AEGP_VertexIndex      which_pointL,<br/>  AEGP_MaskVertex       *vertexP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CreateVertex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a vertex at index position.</p>
<p>All vertices which formerly had an <code>AEGP_VertexIndex</code> of position or greater will have their indices incremented by one.</p>
<p><pre lang="cpp">AEGP_CreateVertex(<br/>  AEGP_MaskOutlineValH  mask_outlineH,<br/>  AEGP_VertexIndex      position);.</pre></p>
<p>NOTE: All masks must have at least one vertex.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DeleteVertex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Removes a vertex from a mask.</p>
<p><pre lang="cpp">AEGP_DeleteVertex(<br/>  AEGP_MaskOutlineValH  mask_outlineH,<br/>  AEGP_VertexIndex      index);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMaskOutlineNumFeathers</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CS6.</p>
<p><pre lang="cpp">AEGP_DeleteVertex(<br/>  AEGP_MaskOutlineValH  mask_outlineH,<br/>  A_long                *num_feathersPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMaskOutlineFeatherInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CS6.</p>
<p><pre lang="cpp">AEGP_GetMaskOutlineFeatherInfo(<br/>  AEGP_MaskOutlineValH  mask_outlineH,<br/>  AEGP_FeatherIndex     which_featherL,<br/>  AEGP_MaskFeather      *featherP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMaskOutlineFeatherInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CS6. Feather must already exist; use <code>AEGP_CreateMaskOutlineFeather</code> first, if needed.</p>
<p><pre lang="cpp">AEGP_SetMaskOutlineFeatherInfo(<br/>  AEGP_MaskOutlineValH    mask_outlineH,<br/>  AEGP_VertexIndex        which_featherL,<br/>  const AEGP_MaskFeather  *featherP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CreateMaskOutlineFeather</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CS6. Index of new feather is passed back in <code>insert_positionP</code>.</p>
<p><pre lang="cpp">AEGP_CreateMaskOutlineFeather(<br/>  AEGP_MaskOutlineValH    mask_outlineH,<br/>  const AEGP_MaskFeather  *featherP0,<br/>  AEGP_FeatherIndex       *insert_positionP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DeleteMaskOutlineFeather</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CS6.</p>
<p><pre lang="cpp">AEGP_DeleteMaskOutlineFeather(<br/>  AEGP_MaskOutlineValH  mask_outlineH,<br/>  AEGP_FeatherIndex     index);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-mask-feathering">Mask Feathering<a class="headerlink" href="#aegps-aegp-suites-mask-feathering" title="Permanent link">&para;</a></h2>
<p>New for CS6, masks can be feathered.</p>
<p><code>AEGP_MaskFeather</code> is defined as follows:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-2-1"><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-2"><span class="w">    </span><span class="n">A_long</span><span class="w">                  </span><span class="n">segment</span><span class="p">;</span><span class="w">          </span><span class="c1">// mask segment where feather is</span>
</span><span id="__span-2-3"><span class="w">    </span><span class="n">PF_FpLong</span><span class="w">               </span><span class="n">segment_sF</span><span class="p">;</span><span class="w">       </span><span class="c1">// 0-1: feather location on segment</span>
</span><span id="__span-2-4"><span class="w">    </span><span class="n">PF_FpLong</span><span class="w">               </span><span class="n">radiusF</span><span class="p">;</span><span class="w">          </span><span class="c1">// negative value allowed if type == AEGP_MaskFeatherType_INNER</span>
</span><span id="__span-2-5"><span class="w">    </span><span class="n">PF_FpShort</span><span class="w">              </span><span class="n">ui_corner_angleF</span><span class="p">;</span><span class="w"> </span><span class="c1">// 0-1: angle of UI handle on corners</span>
</span><span id="__span-2-6"><span class="w">    </span><span class="n">PF_FpShort</span><span class="w">              </span><span class="n">tensionF</span><span class="p">;</span><span class="w">         </span><span class="c1">// 0-1: tension of boundary at feather pt</span>
</span><span id="__span-2-7"><span class="w">    </span><span class="n">AEGP_MaskFeatherInterp</span><span class="w">  </span><span class="n">interp</span><span class="p">;</span>
</span><span id="__span-2-8"><span class="w">    </span><span class="n">AEGP_MaskFeatherType</span><span class="w">    </span><span class="n">type</span><span class="p">;</span>
</span><span id="__span-2-9"><span class="p">}</span><span class="w"> </span><span class="n">AEGP_MaskFeather</span><span class="p">;</span>
</span></code></pre></div>
<p><code>AEGP_MaskFeatherInterp</code> is either <code>AEGP_MaskFeatherInterp_NORMAL</code> or <code>AEGP_MaskFeatherInterp_HOLD_CW</code>.</p>
<p><code>AEGP_MaskFeatherType</code> is either <code>AEGP_MaskFeatherType_OUTER</code> or <code>AEGP_MaskFeatherType_INNER</code>.</p>
<p>This suite enables AEGPs to get and set the text associated with text layers.</p>
<p>Note: to get started, retrieve an <code>AEGP_TextDocumentH</code> by calling <code>AEGP_GetLayerStreamValue</code>, above, and passing <code>AEGP_StreamType_TEXT_DOCUMENT</code> as the <code>AEGP_StreamType</code>.</p>
<hr />
<h2 id="aegps-aegp-suites-working-with-text-layers">Working With Text Layers<a class="headerlink" href="#aegps-aegp-suites-working-with-text-layers" title="Permanent link">&para;</a></h2>
<p>This suite enables AEGPs to get and set the text associated with text layers.</p>
<!-- note:

To get started, retrieve an ``AEGP_TextDocumentH`` by calling ``AEGP_GetLayerStreamValue`` above, and passing ``AEGP_StreamType_TEXT_DOCUMENT`` as the ``AEGP_StreamType``. -->

<h3 id="aegps-aegp-suites-aegp_textdocumentsuite1">AEGP_TextDocumentSuite1<a class="headerlink" href="#aegps-aegp-suites-aegp_textdocumentsuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewText</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the UTF-16, NULL-terminated string used in the <code>AEGP_TextDocumentH</code>.</p>
<p>Note: After Effects will allocate the <code>AEGP_MemHandle</code>; your plug-in must dispose of it when done using <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetNewText(<br/>  AEGP_PluginID       id,<br/>  AEGP_TextDocumentH  text_docH,<br/>  AEGP_MemHandle      *unicodePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetText</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the text to be used by the <code>AEGP_TextDocumentH</code>.</p>
<p><pre lang="cpp">AEGP_SetText(<br/>  AEGP_TextDocumentH  text_docH,<br/>  const A_u_short     *unicodePS,<br/>  long                lengthL);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-working-with-text-outlines">Working With Text Outlines<a class="headerlink" href="#aegps-aegp-suites-working-with-text-outlines" title="Permanent link">&para;</a></h2>
<p>The <code>AEGP_TextLayerSuite</code> provides access to the actual outlines of the text used by text layers.</p>
<p>Once you have a path, you can manipulate it with <a href="#effect-details-working-with-paths-pf_pathquerysuite1">PF_PathQuerySuite1</a> and <a href="#effect-details-working-with-paths-pf_pathdatasuite">PF_PathDataSuite</a>.</p>
<h3 id="aegps-aegp-suites-aegp_textlayersuite1">AEGP_TextLayerSuite1<a class="headerlink" href="#aegps-aegp-suites-aegp_textlayersuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewTextOutlines</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Allocates and returns a handle to the <code>AEGP_TextOutlinesHs</code> associated with the specified layer.</p>
<p><code>outlinesPH</code> will be NULL if there are no <code>AEGP_TextOutlinesHs</code> associated with <code>layerH</code> (in other words, if it's not a text layer).</p>
<p><pre lang="cpp">AEGP_GetNewTextOutlines(<br/>  AEGP_LayerH         layerH,<br/>  const A_Time        *layer_timePT,<br/>  AEGP_TextOutlinesH  *outlinesPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeTextOutlines</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Dispose of those outlines we allocated on your behalf!</p>
<p><pre lang="cpp">AEGP_DisposeTextOutlines(<br/>  AEGP_TextOutlinesH  outlinesH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumTextOutlines</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the number of text outlines for the layer.</p>
<p><pre lang="cpp">AEGP_GetNumTextOutlines(<br/>  AEGP_TextOutlinesH  outlinesH,<br/>  A_long              *num_otlnsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetIndexedTextOutline</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns a <code>PF_PathOutlinePtr</code> for the specifed text outline.</p>
<p><pre lang="cpp">AEGP_GetIndexedTextOutline(<br/>  AEGP_TextOutlinesH  outlinesH,<br/>  A_long              path_indexL,<br/>  PF_PathOutlinePtr   *pathPP);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-utility-functions">Utility Functions<a class="headerlink" href="#aegps-aegp-suites-utility-functions" title="Permanent link">&para;</a></h2>
<p>The Utility suite supplies error message handling, AEGP version checking and access to the undo stack.</p>
<p>Everything you need to keep After Effects and your plug-in tidy.</p>
<hr />
<h3 id="aegps-aegp-suites-aegp_utilitysuite6">AEGP_UtilitySuite6<a class="headerlink" href="#aegps-aegp-suites-aegp_utilitysuite6" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ReportInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Displays dialog with name of the AEGP followed by the string passed.</p>
<p><pre lang="cpp">AEGP_ReportInfo(<br/>  AEGP_PluginID  aegp_plugin_id,<br/>  const A_char   *info_stringZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ReportInfoUnicode</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Displays dialog with name of the AEGP followed by the unicode string passed.</p>
<p><pre lang="cpp">AEGP_ReportInfoUnicode(<br/>  AEGP_PluginID      aegp_plugin_id,<br/>  const A_UTF16Char  *info_stringP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetDriverSpecVersion</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns version of <code>AEGPDriver</code> plug-in (use to determine supported features).</p>
<p><pre lang="cpp">AEGP_GetDriverSpecVersion(<br/>  A_short  *major_versionPS,<br/>  A_short  *minor_versionPS);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_StartQuietErrors</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Silences errors. Must be balanced with <code>AEGP_EndQuietErrors</code>.</p>
<p>The <code>AEGP_ErrReportState</code> is an opaque structure private to After Effects.</p>
<p><pre lang="cpp">AEGP_StartQuietErrors(<br/>  AEGP_ErrReportState  *err_stateP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_EndQuietErrors</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Re-enables errors.</p>
<p><pre lang="cpp">AEGP_EndQuietErrors(<br/>  AEGP_ErrReportState  *err_stateP)</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_StartUndoGroup</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Add action(s) to the undo queue. The user may undo any actions between this and <code>AEGP_EndUndoGroup()</code>.</p>
<p>The <code>undo_nameZ</code> will appear in the edit menu.</p>
<p><pre lang="cpp">AEGP_StartUndoGroup(<br/>  const A_char  *undo_nameZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_EndUndoGroup</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Ends the undo list.</p>
<p><pre lang="cpp">AEGP_EndUndoGroup();</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterWithAEGP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns an AEGP_PluginID, which effect plug-ins can then use in calls to many functions throughout the AEGP API.</p>
<p>Effects should only call this function once, during <code>PF_Cmd_GLOBAL_SETUP</code>, and save the <code>AEGP_PluginID</code> for later use.</p>
<p>The first parameter can be any value, and the second parameter should be the plug-in's match name.</p>
<p><pre lang="cpp">AEGP_RegisterWithAEGP(<br/>  AEGP_GlobalRefcon  global_refcon,<br/>  const A_char       *plugin_nameZ,<br/>  AEGP_PluginID      *plugin_id);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMainHWND</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves After Effects' HWND; useful when displaying your own dialog on Windows.</p>
<p>If you don't use After Effects' HWND, your modal dialog will not prevent interaction with the windows behind, and pain will ensue.</p>
<p><pre lang="cpp">AEGP_GetMainHWND(<br/>  void  *main_hwnd);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ShowHideAllFloaters</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Toggles whether or not floating palettes are displayed.</p>
<p>Use this with care; users get twitchy when you unexpectedly change the UI on them.</p>
<p><pre lang="cpp">AEGP_ShowHideAllFloaters(<br/>  A_Boolean  include_tool_palB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_PaintPalGetForeColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the foreground color from the paint palette.</p>
<p><pre lang="cpp">AEGP_PaintPalGetForeColor(<br/>  AEGP_ColorVal  *fore_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_PaintPalGetBackColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the background color from the paint palette.</p>
<p><pre lang="cpp">AEGP_PaintPalGetBackColor(<br/>  AEGP_ColorVal  *back_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_PaintPalSetForeColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the foreground color in the paint palette.</p>
<p><pre lang="cpp">AEGP_PaintPalSetForeColor(<br/>  const AEGP_ColorVal  *fore_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_PaintPalSetBackColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the background color in the paint palette.</p>
<p><pre lang="cpp">AEGP_PaintPalSetBackColor(<br/>  const AEGP_ColorVal  *back_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CharPalGetFillColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the fill color from the character palette.</p>
<p><pre lang="cpp">AEGP_CharPalGetFillColor(<br/>  A_Boolean     *is_fcolor_definedPB,<br/>  AEGP_ColorVal *fill_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CharPalGetStrokeColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the stroke color from the character palette.</p>
<p><pre lang="cpp">AEGP_CharPalGetStrokeColor(<br/>  A_Boolean      *is_scolor_definedPB,<br/>  AEGP_ColorVal  *stroke_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CharPalSetFillColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the fill color in the character palette.</p>
<p><pre lang="cpp">AEGP_CharPalSetFillColor(<br/>  const AEGP_ColorVal  *fill_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CharPalSetStrokeColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the stroke color in the character palette.</p>
<p><pre lang="cpp">AEGP_CharPalSetStrokeColor(<br/>  const AEGP_ColorVal  *stroke_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CharPalIsFillColorUIFrontmost</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether or not the fill color is frontmost. If it isn't, the stroke color is frontmost.</p>
<p><pre lang="cpp">AEGP_CharPalIsFillColorUIFrontmost(<br/>  A_Boolean  *is_fcolor_selectedPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ConvertFpLongToHSFRatio</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns an <code>A_Ratio</code> interpretation of the given <code>A_FpLong</code>. Useful for horizontal scale factor interpretation.</p>
<p><pre lang="cpp">AEGP_ConvertFpLongToHSFRatio(<br/>  A_FpLong  numberF,<br/>  A_Ratio   *ratioPR);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ConvertHSFRatioToFpLong</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns an <code>A_FpLong</code> interpretation of the given <code>A_Ratio</code>. Useful for horizontal scale factor interpretation.</p>
<p><pre lang="cpp">AEGP_ConvertHSFRatioToFpLong(<br/>  A_Ratio    ratioR,<br/>  A_FpLong  *numberPF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CauseIdleRoutinesToBeCalled</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This routine is safe to call from threads other than the main thread. It is asynchronous and will return before the idle handler is called.</p>
<p>The suite functions to get this function pointer are not thread safe; save it off in the main thread for use by the child thread.</p>
<p><pre lang="cpp">AEGP_CauseIdleRoutinesToBeCalled(void);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetSuppressInteractiveUI</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether After Effects is running without a user interface.</p>
<p><pre lang="cpp">AEGP_GetSuppressInteractiveUI(<br/>  A_Boolean  *ui_is_suppressedPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_WriteToOSConsole</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sends a string to the OS console.</p>
<p><pre lang="cpp">AEGP_WriteToOSConsole(<br/>  const A_char  *textZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_WriteToDebugLog</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Writes a message to the debug log, or to the OS command line if After Effects was launched with the "-debug" option.</p>
<p><pre lang="cpp">AEGP_WriteToDebugLog(<br/>  const A_char  *subsystemZ,<br/>  const A_char  *event_typeZ,<br/>  const A_char  *infoZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLastErrorMessage</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the last error message displayed to the user, and its associated error number. Pass in the size of the character buffer to be returned.</p>
<p><pre lang="cpp">AEGP_GetLastErrorMessage(<br/>  A_long  buffer_size,<br/>  A_char  *error_string,<br/>  A_Err   *error_num);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsScriptingAvailable</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns <code>TRUE</code> if scripting is available to the plug-in.</p>
<p><pre lang="cpp">AEGP_IsScriptingAvailable(<br/>  A_Boolean  *outAvailablePB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ExecuteScript</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Have After Effects execute a script. The script passed in can be in either UTF-8 or the current application encoding (if platform_encodingB is passed in as TRUE).</p>
<p>The two out arguments are optional. The value of the last line of the script is what is passed back in outResultPH0.</p>
<p><pre lang="cpp">AEGP_ExecuteScript(<br/>  AEGP_PluginID inPlugin_id,<br/>  const A_char *inScriptZ,<br/>  const A_Boolean platform_encodingB,<br/>  AEGP_MemHandle *outResultPH0,<br/>  AEGP_MemHandle *outErrStringPH0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_HostIsActivated</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns <code>TRUE</code> if the user has successfully activated After Effects.</p>
<p><pre lang="cpp">AEGP_HostIsActivated(<br/>  A_Boolean  *is_activatedPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetPluginPlatformRef</code></p>
</td>
<td colspan="1" rowspan="1">
<p>On macOS, returns a <code>CFBundleRef</code> to your Mach-O plug-in, or NULL for a CFM plug-in.</p>
<p>Always returns <code>NULL</code> on Windows (you can use an OS-specific entry point to capture your DLLInstance).</p>
<p><pre lang="cpp">AEGP_GetPluginPlatformRef(<br/>  AEGP_PluginID  plug_id,<br/>  void           *plat_refPPV);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_UpdateFontList</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Rescans the system font list.</p>
<p><pre lang="cpp">AEGP_UpdateFontList();</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetPluginPaths</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Returns a particular path associated with the plug-in:</p>
<ul>
<li><code>AEGP_GetPathTypes_PLUGIN</code> - (Not Implemented) The path to the location of the plug-in itself.</li>
<li><code>AEGP_GetPathTypes_USER_PLUGIN</code> -The suite specific location of user specific plug-ins.</li>
<li><code>AEGP_GetPathTypes_ALLUSER_PLUGIN</code> - The suite specific location of plug-ins shared by all users.</li>
<li><code>AEGP_GetPathTypes_APP</code> - The After Effects .exe or .app location. Not plug-in specific.</li>
</ul>
<p><pre lang="cpp">AEGP_GetPluginPaths(<br/>  AEGP_PluginID      aegp_plugin_id,<br/>  AEGP_GetPathTypes  path_type<br/>  AEGP_MemHandle     *unicode_pathPH);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-persistent-data-suite">Persistent Data Suite<a class="headerlink" href="#aegps-aegp-suites-persistent-data-suite" title="Permanent link">&para;</a></h2>
<p>Plug-ins have read and write access to persistent data in After Effects' preferences. AEGPs may add and manage their own persistent data using the following suite. The data entries are accessed by (section key, value key) pairs. It is recommended that plug-ins use their matchname as their section key, or as a prefix if using multiple section keys.</p>
<p>The available data types are <code>A_long</code>, <code>A_FpLong</code>, strings, and <code>void*</code>. <code>A_FpLongs</code> are stored with 6 decimal places of precision. There is no provision for specifying a different precision. String data supports the full 8-bit space. Only 0x00 is reserved for string ending. This makes them ideal for storing UTF-8 encoded strings, ISO 8859-1, and plain ASCII. Both section keys and value keys are of this type. For data types not represented by the simple data types provided, use data handles containing your custom data. void* unstructured data allows you to store any kind of data. You must pass in a size in bytes along with the data.</p>
<p>When calling any of the functions to retrieve the value of a key, if a given key is not found, the default value is both written to the blob and returned as the value; if no default is provided, a blank value will be written and returned.</p>
<p>Note that this data is stored in the application's preferences, not in the project. As of 6.5, there is no way to store opaque AEGP-generated data in an After Effects project.</p>
<p>After Effects can handle plug-ins which change the preferences during their application; it checks the in-RAM copy of the prefs before acting upon pref-able settings, rather than relying on the saved prefs. It's like we *planned* this, or something!</p>
<h3 id="aegps-aegp-suites-aegp_persistentdatesuite4">AEGP_PersistentDateSuite4<a class="headerlink" href="#aegps-aegp-suites-aegp_persistentdatesuite4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetApplicationBlob</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the handle to all persistent application data. Modifying this will modify the application.</p>
<p>The <code>AEGP_PersistentType</code> parameter is new in CC, and should be set to one of the following:</p>
<ul>
<li><code>AEGP_PersistentType_MACHINE_SPECIFIC</code></li>
<li><code>AEGP_PersistentType_MACHINE_INDEPENDENT</code></li>
<li><code>AEGP_PersistentType_MACHINE_INDEPENDENT_RENDER</code></li>
<li><code>AEGP_PersistentType_MACHINE_INDEPENDENT_OUTPUT</code></li>
<li><code>AEGP_PersistentType_MACHINE_INDEPENDENT_COMPOSITION</code></li>
<li><code>AEGP_PersistentType_MACHINE_SPECIFIC_TEXT</code></li>
<li><code>AEGP_PersistentType_MACHINE_SPECIFIC_PAINT</code></li>
</ul>
<p><pre lang="cpp">AEGP_GetApplicationBlob(<br/>  AEGP_PersistentType   blob_type,<br/>  AEGP_PersistentBlobH  *blobPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumSections</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the number of sections in the application blob.</p>
<p><pre lang="cpp">AEGP_GetNumSections(<br/>  AEGP_PersistentBlobH  blobH,<br/>  A_long                *num_sectionPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetSectionKeyByIndex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the key at the given index.</p>
<p><pre lang="cpp">AEGP_GetSectionKeyByIndex(<br/>  AEGP_PersistentBlobH  blobH,<br/>  A_long                section_index,<br/>  A_long                max_section_size,<br/>  A_char                *section_keyZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DoesKeyExist</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether or not a given key/value pair exists with the blob.</p>
<p><pre lang="cpp">AEGP_DoesKeyExist(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  A_Boolean             *existsPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumKeys</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the number of value keys in the section.</p>
<p><pre lang="cpp">AEGP_GetNumKeys(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  A_long                *num_keysPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetValueKeyByIndex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the value of the indexed key.</p>
<p><pre lang="cpp">AEGP_GetValueKeyByIndex(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  A_long                key_index,<br/>  A_long                max_key_size,<br/>  A_char                *value_keyZ);</pre></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the functions below, if a given key is not found, the default value is both written to the blob and returned as the value; if no default is provided, a blank value will be written and returned.</p>
</div>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetDataHandle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the value associated with the given section's key. If using in-memory data structures, watch for endian issues.</p>
<p><pre lang="cpp">AEGP_GetDataHandle(<br/>  AEGP_PluginID         plugin_id,<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  AEGP_MemHandle        defaultH0,<br/>  AEGP_MemHandle        *valuePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetData</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the data located at a given section's value.</p>
<p><pre lang="cpp">AEGP_GetData(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  A_u_long              data_sizeLu,<br/>  const void            *defaultPV0,<br/>  void                  *bufPV);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetString</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the string for a given section key's value (and indicates its length in <code>actual_szLu0</code>).</p>
<p><pre lang="cpp">AEGP_GetString(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  const A_char          *defaultZ0,<br/>  A_u_long              buf_sizeLu,<br/>  char                  *bufZ,<br/>  A_u_long              *actual_szLu0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLong</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the <code>A_long</code> associated with a given section key's value.</p>
<p><pre lang="cpp">AEGP_GetLong(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  A_long                defaultL,<br/>  A_long                *valuePL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetFpLong</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the <code>A_FpLong</code> associated with a given section key's value.</p>
<p><pre lang="cpp">AEGP_GetFpLong(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  A_FpLong              defaultF,<br/>  A_FpLong              *valuePF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Obtains the <code>A_Time</code> associated with a given section key's value.</p>
<p><pre lang="cpp">AEGP_GetTime(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  const A_Time          *defaultPT0,<br/>  A_Time                *valuePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetARGB</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Obtains the <code>PF_PixelFloat</code> associated with a given section key's value.</p>
<p><pre lang="cpp">AEGP_GetARGB(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  const PF_PixelFloat   *defaultP0,<br/>  PF_PixelFloat         *valueP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetDataHandle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the given section key's value to the handle passed in.</p>
<p><pre lang="cpp">AEGP_SetDataHandle(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  const AEGP_MemHandle  valueH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetData</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the given section key's value to the data contained in <code>dataPV</code>.</p>
<p><pre lang="cpp">AEGP_SetData(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  A_u_long              data_sizeLu,<br/>  const void            *dataPV);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetString</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the given section key's string to <code>strZ</code>.</p>
<p><pre lang="cpp">AEGP_SetString(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  const A_char          *strZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetLong</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the given section key's value to <code>valueL</code>.</p>
<p><pre lang="cpp">AEGP_SetLong(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  A_long                valueL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetFpLong</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the given section key's value to <code>valueF</code>.</p>
<p><pre lang="cpp">AEGP_SetFpLong(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  A_FpLong              valueF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Sets the given section key's value to <code>valuePT</code>.</p>
<p><pre lang="cpp">AEGP_SetTime(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  A_Time                *valuePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetARGB</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Sets the given section key's value to <code>valueP</code>.</p>
<p><pre lang="cpp">AEGP_SetARGB(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ,<br/>  PF_PixelFloat         *valueP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DeleteEntry</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Removes the given section's value from the blob.</p>
<p><pre lang="cpp">AEGP_DeleteEntry(<br/>  AEGP_PersistentBlobH  blobH,<br/>  const A_char          *section_keyZ,<br/>  const A_char          *value_keyZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetPrefsDirectory</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the path to the folder containing After Effects' preference file.</p>
<p>The path is a handle to a NULL-terminated A_UTF16Char string, and must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetPrefsDirectory(<br/>  AEGP_MemHandle  *unicode_pathPH);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-color-management">Color Management<a class="headerlink" href="#aegps-aegp-suites-color-management" title="Permanent link">&para;</a></h2>
<p>We've provided a function so AEGPs can obtain information on After Effects' current color management settings.</p>
<h3 id="aegps-aegp-suites-aegp_colorsettingssuite5">AEGP_ColorSettingsSuite5<a class="headerlink" href="#aegps-aegp-suites-aegp_colorsettingssuite5" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetBlendingTables</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the current opaque <code>PF_EffectBlendingTables</code>, for use with <code>AEGP_TransferRect</code>.</p>
<p><pre lang="cpp">AEGP_GetBlendingTables(<br/>  PR_RenderContextH        render_contextH,<br/>  PF_EffectBlendingTables  *blending_tables);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DoesViewHaveColorSpaceXform</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether there is a colorspace transform applied to the current item view.</p>
<p><pre lang="cpp">AEGP_DoesViewHaveColorSpaceXform(<br/>  AEGP_ItemViewP  viewP,<br/>  A_Boolean       *has_xformPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_XformWorkingToViewColorSpace</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Changes the view colorspace of the source to be the working colorspace of the destination. Source and destination can be the same.</p>
<p><pre lang="cpp">AEGP_XformWorkingToViewColorSpace(<br/>  AEGP_ItemViewP  viewP,<br/>  AEGP_WorldH     srcH,<br/>  AEGP_WorldH     dstH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewWorkingSpaceColorProfile</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the opaque current working space ICC profile. Must be disposed.</p>
<p>The "New" in the name does not indicate that you're making up a new profile; rather, it's part of our function naming standard; anything with "New" in the name allocates something which the caller must dispose.</p>
<p><pre lang="cpp">AEGP_GetNewWorkingSpaceColorProfile(<br/>  AEGP_PluginID   aegp_plugin_id,<br/>  AEGP_MemHandle  *icc_profPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewColorProfileFromICCProfile</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves a new <code>AEGP_ColorProfileP</code> from After Effects, representing the specified ICC profile. The caller must dispose of the returned <code>AEGP_ColorProfileP</code> using <code>AEGP_DisposeColorProfile()</code>.</p>
<p><pre lang="cpp">AEGP_GetNewColorProfile FromICCProfile(<br/>  AEGP_PluginID       aegp_plugin_id,<br/>  A_long              icc_sizeL,<br/>  const void          *icc_dataPV,<br/>  AEGP_ColorProfileP  *profilePP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewICCProfileFromColorProfile</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves a new ICC profile (stored in an <code>AEGP_MemHandle</code>) representing the specified color profile.</p>
<p>Returned <code>AEGP_MemHandle</code> must be disposed by the caller.</p>
<p><pre lang="cpp">AEGP_GetNewICCProfile FromColorProfile(<br/>  AEGP_PluginID            plugin_id,<br/>  AEGP_ConstColorProfileP  profileP,<br/>  AEGP_MemHandle           *profilePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewColorProfileDescription</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns a textual description of the specified color profile. Text will be a null-terminated UTF16 string, which must be disposed by the caller.</p>
<p><pre lang="cpp">AEGP_GetNewColorProfileDescription(<br/>  AEGP_PluginID            aegp_plugin_id,<br/>  AEGP_ConstColorProfileP  profileP,<br/>  AEGP_MemHandle           *unicode_descPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeColorProfile</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Disposes of a color profile, obtained using other functions in this suite.</p>
<p><pre lang="cpp">AEGP_DisposeColorProfile(<br/>  AEGP_ColorProfileP  profileP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetColorProfileApproximateGamma</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns a floating point number approximating the gamma setting used by the specified color profile.</p>
<p><pre lang="cpp">AEGP_GetColorProfileApproximateGamma(<br/>  AEGP_ConstColorProfileP  profileP,<br/>  A_FpShort                *approx_gammaP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsRGBColorProfile</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether the specified color profile is RGB.</p>
<p><pre lang="cpp">AEGP_IsRGBColorProfile(<br/>  AEGP_ConstColorProfileP  profileP,<br/>  A_Boolean                *is_rgbPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetWorkingColorSpace</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the working space to the passed color profile.</p>
<p><pre lang="cpp">AEGP_SetWorkingColorSpace(<br/>  AEGP_PluginID            aegp_plugin_id,<br/>  AEGP_CompH               compH,<br/>  AEGP_ConstColorProfileP  color_profileP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsOCIOColorManagementUsed</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Check if the current project is using the OCIO color engine or not.</p>
<p>Returns <code>true</code> if current project uses OCIO color managed mode.</p>
<p><pre lang="cpp">AEGP_IsOCIOColorManagementUsed(<br/>  AEGP_PluginID  aegp_plugin_id,<br/>  A_Boolean      *is_OCIOColorManagementUsedPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOCIOConfigurationFile</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the OCIO configuration file used by the project.</p>
<p>Returned config_filePH is a handle of <code>A_UTF16Char</code> containing a null terminated UTF16String which holds the OCIO Configuration file. The returned string must be disposed by the caller.</p>
<p><pre lang="cpp">AEGP_GetOCIOConfigurationFile(<br/>  AEGP_PluginID   aegp_plugin_id,<br/>  AEGP_MemHandle  *congif_filePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOCIOConfigurationFilePath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the absolute file path to the OCIO configuration used by the project</p>
<p>The returned config_filePH is a handle of <code>A_UTF16Char</code> containing a null terminated UTF16String which holds the absolute path to OCIO Configuration file. The returned string must be disposed by the caller.</p>
<p><pre lang="cpp">AEGP_GetOCIOConfigurationFilePath(<br/>  AEGP_PluginID   aegp_plugin_id,<br/>  AEGP_MemHandle  *congif_filePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGPD_GetOCIOWorkingColorSpace</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the working color space of the project in OCIO mode.</p>
<p>The returned ocio_working_colorspaceH is a handle of <code>A_UTF16Char</code> containing a null terminated UTF16String which holds the string specifying the working color space. The returned string must be disposed by the caller.</p>
<p><pre lang="cpp">AEGPD_GetOCIOWorkingColorSpace(<br/>  AEGP_PluginID   aegp_plugin_id,<br/>  AEGP_MemHandle  *ocio_working_colorspaceH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGPD_GetOCIODisplayColorSpace</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the Display and View transforms used by the project.</p>
<p>The returned ocio_displayH and ocio_viewH are handles of <code>A_UTF16Char</code> containing a null terminated UTF16String specifying the Display and View transforms used at project level. The returned strings must be disposed by the caller.</p>
<p><pre lang="cpp">AEGPD_GetOCIODisplayColorSpace(<br/>  AEGP_PluginID   aegp_plugin_id,<br/>  AEGP_MemHandle  *ocio_displayH,<br/>  AEGP_MemHandle  *ocio_viewH);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-render-suites">Render Suites<a class="headerlink" href="#aegps-aegp-suites-render-suites" title="Permanent link">&para;</a></h2>
<p>Since we introduced the AEGP API, we've been asked to provide functions for retrieving rendered frames.</p>
<p>These function suites allows you to do just that.</p>
<p>First, specify what you want rendered in the <a href="#aegps-aegp-suites-aegp_renderoptionssuite4">AEGP_RenderOptionsSuite4</a> or <a href="#aegps-aegp-suites-aegp_layerrenderoptionssuite1">AEGP_LayerRenderOptionsSuite1</a>.</p>
<p>Then do the rendering with <a href="#aegps-aegp-suites-aegp_rendersuite4">AEGP_RenderSuite4</a>.</p>
<h3 id="aegps-aegp-suites-aegp_renderoptionssuite4">AEGP_RenderOptionsSuite4<a class="headerlink" href="#aegps-aegp-suites-aegp_renderoptionssuite4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewFromItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the <code>AEGP_RenderOptionsH</code> associated with a given <code>AEGP_ItemH</code>.</p>
<p>If there are no options yet specified, After Effects passes back an <code>AEGP_RenderOptionsH</code> with render time set to 0, time step set to the current frame duration, field render set to <code>PF_Field_FRAME</code>, and the depth set to the highest resolution specified within the item.</p>
<p><pre lang="cpp">AEGP_NewFromItem(<br/>  AEGP_PluginID        plugin_id,<br/>  AEGP_ItemH           itemH,<br/>  AEGP_RenderOptionsH  *optionsPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_Duplicate</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Duplicates an <code>AEGP_RenderOptionsH</code> into <code>copyPH</code>.</p>
<p><pre lang="cpp">AEGP_Duplicate(<br/>  AEGP_PluginID        plugin_id,<br/>  AEGP_RenderOptionsH  optionsH,<br/>  AEGP_RenderOptionsH  *copyPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_Dispose</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Deletes an <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_Dispose(<br/>  AEGP_RenderOptionsH  optionsH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the render time of an <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_SetTime(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  A_Time               time);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the render time of the given <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_GetTime(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  A_Time               *timeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetTimeStep</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the time step (duration of a frame) for the referenced <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_SetTimeStep(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  A_Time               time_step);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetTimeStep</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the time step (duration of a frame) for the given <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_GetTimeStep(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  A_Time               *timePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetFieldRender</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the field settings for the given <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_SetFieldRender(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  PF_Field             field_render);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetFieldRender</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the field settings for the given <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_GetFieldRender(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  PF_Field             *field_renderP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetWorldType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the AEGP_WorldType of the output of a given <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_SetWorldType(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  AEGP_WorldType       type);</pre></p>
<p><code>AEGP_WorldType</code> will be either <code>AEGP_WorldType_8</code> or <code>AEGP_WorldType_16</code></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetWorldType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the <code>AEGP_WorldType</code> of the given <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_GetWorldType(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  AEGP_WorldType       *typeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetDownsampleFactor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the downsample factor (with independent horizontal and vertical settings) for the given <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_SetDownsampleFactor(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  A_short              x,<br/>  A_short              y);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetDownsampleFactor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the downsample factor for the given <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_GetDownsampleFactor(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  A_short              *xP,<br/>  A_short              *yP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetRegionOfInterest</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the region of interest sub-rectangle for the given <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_SetRegionOfInterest(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  const A_LRect        *roiP)</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRegionOfInterest</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the region of interest sub-rectangle for the given <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_GetRegionOfInterest(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  A_LRect              *roiP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMatteMode</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the <code>AEGP_MatteMode</code> for the given <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_SetMatteMode(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  AEGP_MatteMode       mode);</pre></p>
<p><code>AEGP_MatteMode</code> will be one of the following:</p>
<ul>
<li><code>AEGP_MatteMode_STRAIGHT</code></li>
<li><code>AEGP_MatteMode_PREMUL_BLACK</code></li>
<li><code>AEGP_MatteMode_PREMUL_BG_COLOR</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMatteMode</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the <code>AEGP_MatteMode</code> for the given <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_GetMatteMode(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  AEGP_MatteMode       *modeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetChannelOrder</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Gets the <code>AEGP_ChannelOrder</code> for the given <code>AEGP_RenderOptionsH</code>.</p>
<p><code>AEGP_ChannelOrder</code> will be either <code>AEGP_ChannelOrder_ARGB</code> or <code>AEGP_ChannelOrder_BGRA</code>.</p>
<p><pre lang="cpp">AEGP_GetChannelOrder(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  AEGP_ChannelOrder    *orderP);</pre></p>
<p>Factoid: this was added to facilitate live linking with Premiere Pro.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetChannelOrder</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the <code>AEGP_ChannelOrder</code> of the <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_SetChannelOrder(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  AEGP_ChannelOrder    order);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRenderGuideLayers</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Passes back a boolean that is true if the render guide layers setting is on.</p>
<p><pre lang="cpp">AEGP_GetRenderGuideLayers)(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  A_Boolean            *will_renderPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetRenderGuideLayers</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specify whether or not to render guide layers.</p>
<p><pre lang="cpp">AEGP_SetRenderGuideLayers)(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  A_Boolean            render_themB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRenderQuality</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the render quality of the render queue item.</p>
<p>Quality can be either <code>AEGP_ItemQuality_DRAFT</code> or <code>AEGP_ItemQuality_BEST</code>.</p>
<p><pre lang="cpp">AEGP_GetRenderQuality(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  AEGP_ItemQuality     *qualityP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetRenderQuality</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set the render quality of the render queue item.</p>
<p><pre lang="cpp">AEGP_GetRenderQuality(<br/>  AEGP_RenderOptionsH  optionsH,<br/>  AEGP_ItemQuality     quality);</pre></p>
</td>
</tr>
</tbody>
</table>
<h3 id="aegps-aegp-suites-aegp_layerrenderoptionssuite1">AEGP_LayerRenderOptionsSuite1<a class="headerlink" href="#aegps-aegp-suites-aegp_layerrenderoptionssuite1" title="Permanent link">&para;</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>New in 13.0</p>
</div>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewFromLayer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the <code>AEGP_LayerRenderOptionsH</code> associated with a given <code>AEGP_LayerH</code>.</p>
<p>Render time is set to the layer's current time, time step is set to layer's frame duration, ROI to the layer's nominal bounds, and EffectsToRender to "all".</p>
<p><code>optionsPH</code> must be disposed by calling code.</p>
<p><pre lang="cpp">AEGP_NewFromLayer(<br/>  AEGP_PluginID             plugin_id,<br/>  AEGP_LayerH               layerH,<br/>  AEGP_LayerRenderOptionsH  *optionsPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewFromUpstreamOfEffect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the <code>AEGP_LayerRenderOptionsH</code> from the layer associated with a given <code>AEGP_EffectRefH</code>.</p>
<p>Render time is set to the layer's current time, time step is set to layer's frame duration, ROI to the layer's nominal bounds, and EffectsToRender to the index of <code>effectH</code>.</p>
<p><code>optionsPH</code> must be disposed by calling code.</p>
<p><pre lang="cpp">AEGP_NewFromUpstreamOfEffect(<br/>  AEGP_PluginID             plugin_id,<br/>  AEGP_EffectRefH           effectH,<br/>  AEGP_LayerRenderOptionsH  *optionsPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_Duplicate</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Duplicates an <code>AEGP_LayerRenderOptionsH</code> into <code>copyPH</code>.</p>
<p><pre lang="cpp">AEGP_Duplicate(<br/>  AEGP_PluginID             plugin_id,<br/>  AEGP_LayerRenderOptionsH  optionsH,<br/>  AEGP_LayerRenderOptionsH  *copyPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_Dispose</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Deletes an <code>AEGP_LayerRenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_Dispose(<br/>  AEGP_LayerRenderOptionsH  optionsH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the render time of an <code>AEGP_LayerRenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_SetTime(<br/>  AEGP_LayerRenderOptionsH  optionsH,<br/>  A_Time                    time);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the render time of the given <code>AEGP_LayerRenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_GetTime(<br/>  AEGP_LayerRenderOptionsH  optionsH,<br/>  A_Time                    *timeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetTimeStep</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the time step (duration of a frame) for the referenced <code>AEGP_LayerRenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_SetTimeStep(<br/>  AEGP_LayerRenderOptionsH  optionsH,<br/>  A_Time                    time_step);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetTimeStep</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the time step (duration of a frame) for the given <code>AEGP_LayerRenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_GetTimeStep(<br/>  AEGP_LayerRenderOptionsH  optionsH,<br/>  A_Time                    *timePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetWorldType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the AEGP_WorldType of the output of a given <code>AEGP_LayerRenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_SetWorldType(<br/>  AEGP_LayerRenderOptionsH  optionsH,<br/>  AEGP_WorldType            type);</pre></p>
<p><code>AEGP_WorldType</code> will be either <code>AEGP_WorldType_8</code> or <code>AEGP_WorldType_16</code></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetWorldType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the AEGP_WorldType of the given <code>AEGP_LayerRenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_GetWorldType(<br/>  AEGP_LayerRenderOptionsH  optionsH,<br/>  AEGP_WorldType            *typeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetDownsampleFactor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the downsample factor (with independent horizontal and vertical settings) for the given <code>AEGP_LayerRenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_SetDownsampleFactor(<br/>  AEGP_LayerRenderOptionsH  optionsH,<br/>  A_short                   x,<br/>  A_short                   y);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetDownsampleFactor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the downsample factor for the given <code>AEGP_LayerRenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_GetDownsampleFactor(<br/>  AEGP_LayerRenderOptionsH  optionsH,<br/>  A_short                   *xP,<br/>  A_short                   *yP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetMatteMode</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the AEGP_MatteMode for the given <code>AEGP_LayerRenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_SetMatteMode(<br/>  AEGP_LayerRenderOptionsH  optionsH,<br/>  AEGP_MatteMode            mode);</pre></p>
<p>AEGP_MatteMode will be one of the following:</p>
<ul>
<li><code>AEGP_MatteMode_STRAIGHT</code></li>
<li><code>AEGP_MatteMode_PREMUL_BLACK</code></li>
<li><code>AEGP_MatteMode_PREMUL_BG_COLOR</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetMatteMode</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the AEGP_MatteMode for the given <code>AEGP_LayerRenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_GetMatteMode(<br/>  AEGP_LayerRenderOptionsH  optionsH,<br/>  AEGP_MatteMode            *modeP);</pre></p>
</td>
</tr>
</tbody>
</table>
<h3 id="aegps-aegp-suites-aegp_rendersuite4">AEGP_RenderSuite4<a class="headerlink" href="#aegps-aegp-suites-aegp_rendersuite4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderAndCheckoutFrame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves an <code>AEGP_FrameReceiptH</code> (not the actual pixels) for the frame requested. Check in this receipt using <code>AEGP_CheckinFrame</code> to release memory.</p>
<p>Create the <code>AEGP_RenderOptionsH</code> using the <a href="#aegps-aegp-suites-aegp_renderoptionssuite4">AEGP_RenderOptionsSuite4</a>.</p>
<p>Optionally, the AEGP can pass a function to be called by After Effects if the user cancels the current render, as well as a refcon (constant reference to opaque data) for use during that function.</p>
<p><pre lang="cpp">AEGP_RenderAndCheckoutFrame(<br/>  AEGP_RenderOptionsH             optionsH,<br/>  AEGP_RenderSuiteCheckForCancel  cancel_functionP0,<br/>  AEGP_CancelRefcon               cancel_function_refconP0,<br/>  AEGP_FrameReceiptH              *receiptPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderAndCheckoutLayerFrame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC 2014. This allows frame checkout of a layer with effects applied at non-render time.</p>
<p>This is useful for an operation that requires the frame, for example, when a button is clicked and it is acceptable to wait for a moment while it is rendering.</p>
<p>Note: Since it is not asynchronous, it will not solve the general problem where custom UI needs to draw based on the frame.</p>
<p>Retrieves an <code>AEGP_FrameReceiptH</code> (not the actual pixels) for the layer frame requested. Check in this receipt using <code>AEGP_CheckinFrame</code> to release memory.</p>
<p>Create the <code>AEGP_LayerRenderOptionsH</code> using <code>AEGP_NewFromUpstreamOfEffect()</code>, in <a href="#aegps-aegp-suites-aegp_layerrenderoptionssuite1">AEGP_LayerRenderOptionsSuite1</a>.</p>
<p>You can actually use <code>AEGP_NewFromLayer()</code> to get other layer param's layers with their effects applied. However, be careful. If you do it in your effect A, and there's an effect B on the other layer that does the same thing during rendering, you'd create an infinite loop. If you're not doing it for render purposes then it could be okay.</p>
<p>Optionally, the AEGP can pass a function to be called by After Effects if the user cancels the current render, as well as a refcon (constant reference to opaque data) for use during that function.</p>
<p><pre lang="cpp">AEGP_RenderAndCheckoutLayerFrame(<br/>  AEGP_LayerRenderOptionsH        optionsH,<br/>  A_Boolean                       render_plain_layer_frameB,<br/>  AEGP_RenderSuiteCheckForCancel  cancel_functionP0,<br/>  AEGP_CancelRefcon               cancel_function_refconP0,<br/>  AEGP_FrameReceiptH              *receiptPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CheckinFrame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Call this function as soon as your AEGP is done accessing the frame.</p>
<p>After Effects makes caching decisions based on which frames are checked out, so don't hog them!</p>
<p><pre lang="cpp">AEGP_CheckinFrame(<br/>  AEGP_FrameReceiptH  receiptH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetReceiptWorld</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the pixels (<code>AEGP_WorldH</code>) associated with the referenced <code>AEGP_FrameReceiptH</code>.</p>
<p><pre lang="cpp">AEGP_GetReceiptWorld(<br/>  AEGP_FrameReceiptH  receiptH,<br/>  AEGP_WorldH         *worldPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRenderedRegion</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves an <code>A_LRect</code> containing the region of the <code>AEGP_FrameReceiptH's</code> <code>AEGP_WorldH</code> that has already been rendered.</p>
<p>Remember that it's possible for only those portions of an image that have been changed to be rendered, so it's important to be able to check whether or not that includes the portion you need.</p>
<p><pre lang="cpp">AEGP_GetRenderedRegion(<br/>  AEGP_FrameReceiptH  receiptH,<br/>  A_LRect             *regionP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsRenderedFrameSufficient</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given two sets of <code>AEGP_RenderOptionsH</code>, After Effects will return <code>TRUE</code> if the already-rendered pixels are still valid for the proposed <code>AEGP_RenderOptionsH</code>.</p>
<p><pre lang="cpp">AEGP_IsRenderedFrameSufficient(<br/>  AEGP_RenderOptionsH  rendered_optionsH,<br/>  AEGP_RenderOptionsH  proposed_optionsH,<br/>  A_Boolean            *is_sufficientPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderNewItemSoundData</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains an <code>AEGP_ItemH's</code> audio at the given time, of the given duration, in the given format.</p>
<p>The plug-in must dispose of the returned <code>AEGP_SoundDataH</code> (which may be NULL if no audio is available).</p>
<p><pre lang="cpp">AEGP_RenderNewItemSoundData(<br/>  AEGP_ItemH                  itemH,<br/>  const A_Time                *start_timePT,<br/>  const A_Time                *durationPT,<br/>  const AEGP_SoundDataFormat  *formatP,<br/>  AEGP_SoundDataH             *new_dataPH);</pre></p>
<p>NOTE: This function, if called as part of <code>AEGP_ItemSuite2</code>, provides a render interruptible using mouse clicks, unlike the version published here in <code>AEGP_RenderSuite</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCurrentTimestamp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the current <code>AEGP_TimeStamp</code> of the project.</p>
<p>The <code>AEGP_TimeStamp</code> is updated whenever an item is touched in a way that affects rendering.</p>
<p><pre lang="cpp">AEGP_GetCurrentTimestamp(<br/>  AEGP_TimeStamp  *time_stampP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_HasItemChangedSinceTimestamp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether the video of an AEGP_ItemH has changed since the given <code>AEGP_TimeStamp</code>.</p>
<p>Note: this does not track changes in audio.</p>
<p><pre lang="cpp">AEGP_HasItemChangedSinceTimestamp(<br/>  AEGP_ItemH            itemH,<br/>  const A_Time          *start_timeP,<br/>  const A_Time          *durationP,<br/>  const AEGP_TimeStamp  *time_stampP,<br/>  A_Boolean             *changedPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsItemWorthwhileToRender</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether this frame would be worth rendering externally and checking in to the cache.</p>
<p>A speculative renderer should check this twice: before sending the frame out to render and when it is complete, before calling <code>AEGP_NewPlatformWorld()</code> and checking in.</p>
<p>This function is to be used with <code>AEGP_HasItemChangedSinceTimestamp()</code>, not alone.</p>
<p><pre lang="cpp">AEGP_IsItemWorthwhileToRender(<br/>  AEGP_RenderOptionsH   roH,<br/>  const AEGP_TimeStamp  *time_stampP,<br/>  A_Boolean             *worthwhilePB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CheckinRenderedFrame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Provide a rendered frame (<code>AEGP_PlatformWorldH</code>) to After Effects, which adopts it.</p>
<p><code>ticksL</code> is the approximate time required to render the frame.</p>
<p><pre lang="cpp">AEGP_CheckinRenderedFrame(<br/>  AEGP_RenderOptionsH    roH,<br/>  const AEGP_TimeStamp*  time_stampP,<br/>  A_u_long               ticksL,<br/>  AEGP_PlatformWorldH    imageH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetReceiptGuid</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CS6. Retrieve a GUID for a rendered frame. The memory handle passed back must be disposed.</p>
<p><pre lang="cpp">AEGP_GetReceiptGuid(<br/>  AEGP_FrameReceiptH  receiptH,<br/>  AEGP_MemHandle      *guidMH)</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-the-aegp_world-as-we-know-it">The AEGP_World As We Know It<a class="headerlink" href="#aegps-aegp-suites-the-aegp_world-as-we-know-it" title="Permanent link">&para;</a></h2>
<p><code>AEGP_Worlds</code> are the common format used throughout the AEGP APIs to describe frames of pixels.</p>
<h3 id="aegps-aegp-suites-aegp_worldsuite3">AEGP_WorldSuite3<a class="headerlink" href="#aegps-aegp-suites-aegp_worldsuite3" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_New</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns an allocated, initialized <code>AEGP_WorldH</code>.</p>
<p><pre lang="cpp">AEGP_New(<br/>  AEGP_PluginID   plugin_id,<br/>  AEGP_WorldType  type,<br/>  A_long          widthL,<br/>  A_long          heightL,<br/>  AEGP_WorldH     *worldPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_Dispose</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Disposes of an <code>AEGP_WorldH</code>. Use this on every world you allocate.</p>
<p><pre lang="cpp">AEGP_Dispose(<br/>  AEGP_WorldH  worldH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the type of a given <code>AEGP_WorldH</code>.</p>
<p><pre lang="cpp">AEGP_GetType(<br/>  AEGP_WorldH worldH,<br/>  AEGP_WorldType *typeP);</pre></p>
<p>AEGP_WorldType will be one of the following:</p>
<ul>
<li><code>AEGP_WorldType_8</code></li>
<li><code>AEGP_WorldType_16</code></li>
<li><code>AEGP_WorldType_32</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the width and height of the given <code>AEGP_WorldH</code>.</p>
<p><pre lang="cpp">AEGP_GetSize(<br/>  AEGP_WorldH  worldH,<br/>  A_long       *widthPL,<br/>  A_long       *heightPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRowBytes</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the rowbytes for the given <code>AEGP_WorldH</code>.</p>
<p><pre lang="cpp">AEGP_GetRowBytes(<br/>  AEGP_WorldH  worldH,<br/>  A_u_long     *row_bytesPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetBaseAddr8</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the base address of the <code>AEGP_WorldH</code> for use in pixel iteration functions.</p>
<p>Will return an error if used on a non-8bpc world.</p>
<p><pre lang="cpp">AEGP_GetBaseAddr8(<br/>  AEGP_WorldH  worldH,<br/>  PF_Pixel8    *base_addrP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetBaseAddr16</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the base address of the <code>AEGP_WorldH</code> for use in pixel iteration functions.</p>
<p>Will return an error if used on a non-16bpc world.</p>
<p><pre lang="cpp">AEGP_GetBaseAddr16(<br/>  AEGP_WorldH  worldH,<br/>  PF_Pixel16   *base_addrP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetBaseAddr32</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the base address of the <code>AEGP_WorldH</code> for use in pixel iteration functions.</p>
<p>Will return an error if used on a non-32bpc world.</p>
<p><pre lang="cpp">AEGP_GetBaseAddr32(<br/>  AEGP_WorldH    worldH,<br/>  PF_PixelFloat  *base_addrP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_FillOutPFEffectWorld</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Populates and returns a PF_EffectWorld representing the given <code>AEGP_WorldH</code>, for use with numerous pixel processing callbacks.</p>
<p>NOTE: This does not give your plug-in ownership of the world referenced; destroy the source <code>AEGP_WorldH</code> only if you allocated it. It just fills out the provided <code>PF_EffectWorld</code> to point to the same pixel buffer.</p>
<p><pre lang="cpp">AEGP_FillOutPFEffectWorld(<br/>  AEGP_WorldH     worldH,<br/>  PF_EffectWorld  *pf_worldP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_FastBlur</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Performs a fast blur on a given <code>AEGP_WorldH</code>.</p>
<p><pre lang="cpp">AEGP_FastBlur(<br/>  A_FpLong      radiusF,<br/>  PF_ModeFlags  mode,<br/>  PF_Quality    quality,<br/>  AEGP_WorldH   worldH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewPlatformWorld</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a new <code>AEGP_PlatformWorldH</code> (a pixel world native to the execution platform).</p>
<p><pre lang="cpp">AEGP_NewPlatformWorld(<br/>  AEGP_PluginID        plugin_id,<br/>  AEGP_WorldType       type,<br/>  A_long               widthL,<br/>  A_long               heightL,<br/>  AEGP_PlatformWorldH  *worldPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposePlatformWorld</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Disposes of an <code>AEGP_PlatformWorldH</code>.</p>
<p><pre lang="cpp">AEGP_DisposePlatformWorld(<br/>  AEGP_PlatformWorldH  worldH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewReferenceFromPlatformWorld</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves an AEGP_WorldH referring to the given <code>AEGP_PlatformWorldH</code>.</p>
<p>NOTE: This doesn't allocate a new world, it simply provides a reference to an existing one.</p>
<p><pre lang="cpp">AEGP_NewReferenceFromPlatformWorld(<br/>  AEGP_PluginID        plugin_id,<br/>  AEGP_PlatformWorldH  plat_worldH,<br/>  AEGP_WorldH          *worldPH);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-track-mattes-and-transform-functions">Track Mattes and Transform Functions<a class="headerlink" href="#aegps-aegp-suites-track-mattes-and-transform-functions" title="Permanent link">&para;</a></h2>
<p>Use the <code>AEGP_CompositeSuite</code> to copy pixel worlds, operate on track mattes, and apply transfer functions.</p>
<h3 id="aegps-aegp-suites-aegp_compositesuite2">AEGP_CompositeSuite2<a class="headerlink" href="#aegps-aegp-suites-aegp_compositesuite2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ClearAlphaExceptRect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>For the given <code>PF_EffectWorld</code>, sets the alpha to fully transparent except for the specified rectangle.</p>
<p><pre lang="cpp">AEGP_ClearAlphaExceptRect(<br/>  A_Rect          *clipped_dst_rectPR,<br/>  PF_EffectWorld  *dstP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_PrepTrackMatte</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Mattes the pixels in a <code>PF_EffectWorld</code> with the <code>PF_Pixel</code> described in src_masks, putting the output into an array of pixels dst_mask.</p>
<p>NOTE: Unlike most of the other pixel mangling functions provided by After Effects, this one doesn't take <code>PF_EffectWorld</code> arguments; rather, you can simply pass the data pointer from within the <code>PF_EffectWorld</code>. This can be confusing, but as a bonus, the function pads output appropriately so that <code>num_pix</code> pixels are always output.</p>
<p><pre lang="cpp">AEGP_PrepTrackMatte(<br/>  A_long          num_pix,<br/>  A_Boolean       deepB,<br/>  const PF_Pixel  *src_mask,<br/>  PF_MaskFlags    mask_flags,<br/>  PF_Pixel        *dst_mask);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_TransferRect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Blends two <code>PF_EffectWorlds</code> using a transfer mode, with an optional mask. Pass <code>NULL</code> for the <code>blend_tablesP0</code> parameter to perform blending in the current working color space.</p>
<p><pre lang="cpp">AEGP_TransferRect(<br/>  PF_Quality               quality,<br/>  PF_ModeFlags             m_flags,<br/>  PF_Field                 field,<br/>  const A_Rect             *src_rec,<br/>  const PF_EffectWorld     *src_world,<br/>  const PF_CompositeMode   *comp_mode,<br/>  PF_EffectBlendingTables  blend_tablesP0,<br/>  const PF_MaskWorld       *mask_world0,<br/>  A_long                   dest_x,<br/>  A_long                   dest_y,<br/>  PF_EffectWorld           *dst_world);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CopyBits_LQ</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Copies a rectangle of pixels (pass a <code>NULL</code> rectangle to get all pixels) from one <code>PF_EffectWorld</code> to another, at low quality.</p>
<p><pre lang="cpp">AEGP_CopyBits_LQ(<br/>  PF_EffectWorld  *src_worldP,<br/>  A_Rect          *src_r,<br/>  A_Rect          *dst_r,<br/>  PF_EffectWorld  *dst_worldP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CopyBits_HQ_Straight</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Copies a rectangle of pixels (pass a <code>NULL</code> rectangle to get all pixels) from one <code>PF_EffectWorld</code> to another, at high quality, with a straight alpha channel.</p>
<p><pre lang="cpp">AEGP_CopyBits_HQ_Straight(<br/>  PF_EffectWorld  *src,<br/>  A_Rect          *src_r,<br/>  A_Rect          *dst_r,<br/>  PF_EffectWorld  *dst);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CopyBits_HQ_Premul</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Copies a rectangle of pixels (pass a <code>NULL</code> rectangle to get all pixels) from one <code>PF_EffectWorld</code> to another, at high quality, premultiplying the alpha channel.</p>
<p><pre lang="cpp">AEGP_CopyBits_HQ_Premul(<br/>  PF_EffectWorld  *src,<br/>  A_Rect          *src_r,<br/>  A_Rect          *dst_r,<br/>  PF_EffectWorld  *dst);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-work-with-audio">Work With Audio<a class="headerlink" href="#aegps-aegp-suites-work-with-audio" title="Permanent link">&para;</a></h2>
<p><code>AEGP_SoundDataSuite</code> allows AEGPs to obtain and manipulate the audio associated with compositions and footage items.</p>
<p>Audio-only items may be added to the render queue using <code>AEGP_RenderNewItemSoundData()</code>.</p>
<h3 id="aegps-aegp-suites-aegp_sounddatesuite1">AEGP_SoundDateSuite1<a class="headerlink" href="#aegps-aegp-suites-aegp_sounddatesuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_NewSoundData</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Creates a new <code>AEGP_SoundDataH</code>, of which the plug-in must dispose.</p>
<p><pre lang="cpp">AEGP_NewSoundData(<br/>  const AEGP_SoundDataFormat  *formatP,<br/>  AEGP_SoundDataH             *new_dataPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeSoundData</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Frees an <code>AEGP_SoundDataH</code>.</p>
<p><pre lang="cpp">AEGP_DisposeSoundData(<br/>  AEGP_SoundDataH  sound_dataH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetSoundDataFormat</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains information about the format of a given <code>AEGP_SoundDataH</code>.</p>
<p><pre lang="cpp">AEGP_GetSoundDataFormat(<br/>  AEGP_SoundDataH       soundH,<br/>  AEGP_SoundDataFormat  *formatP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_LockSoundDataSamples</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Locks the <code>AEGP_SoundDataH</code> in memory.</p>
<p><pre lang="cpp">AEGP_LockSoundDataSamples(<br/>  AEGP_SoundDataH  soundH,<br/>  void             *samples);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_UnlockSoundDataSamples</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Unlocks an <code>AEGP_SoundDataH</code>.</p>
<p><pre lang="cpp">AEGP_UnlockSoundDataSamples(<br/>  AEGP_SoundDataH  soundH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumSamples</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the number of samples in the given <code>AEGP_SoundDataH</code>.</p>
<p><pre lang="cpp">AEGP_GetNumSamples(<br/>  AEGP_SoundDataH  soundH,<br/>  A_long           *numsamplesPL);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-audio-settings">Audio Settings<a class="headerlink" href="#aegps-aegp-suites-audio-settings" title="Permanent link">&para;</a></h2>
<p>Audio render settings are represented using the <code>AEGP_SoundDataFormat</code>.</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-3-1"><span class="k">struct</span><span class="w"> </span><span class="nc">AEGP_SoundDataFormat</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-2"><span class="w">    </span><span class="n">A_FpLong</span><span class="w">            </span><span class="n">sample_rateF</span><span class="p">;</span>
</span><span id="__span-3-3"><span class="w">    </span><span class="n">AEGP_SoundEncoding</span><span class="w">  </span><span class="n">encoding</span><span class="p">;</span>
</span><span id="__span-3-4"><span class="w">    </span><span class="n">A_long</span><span class="w">              </span><span class="n">bytes_per_sampleL</span><span class="p">;</span>
</span><span id="__span-3-5"><span class="w">    </span><span class="n">A_long</span><span class="w">              </span><span class="n">num_channelsL</span><span class="p">;</span><span class="w"> </span><span class="c1">// 1 for mono, 2 for stereo</span>
</span><span id="__span-3-6"><span class="p">}</span><span class="w"> </span><span class="n">AEGP_SoundDataFormat</span><span class="p">;</span>
</span></code></pre></div>
<p><code>bytes_per_sampleL</code> is always either <code>1</code>, <code>2</code>, or <code>4</code>, and is ignored if float encoding is specified.</p>
<p><code>AEGP_SoundEncoding</code> is one of the following:</p>
<ul>
<li><code>AEGP_SoundEncoding_UNSIGNED_PCM</code></li>
<li><code>AEGP_SoundEncoding_SIGNED_PCM</code></li>
<li><code>AEGP_SoundEncoding_FLOAT</code></li>
</ul>
<hr />
<h2 id="aegps-aegp-suites-render-queue-suite">Render Queue Suite<a class="headerlink" href="#aegps-aegp-suites-render-queue-suite" title="Permanent link">&para;</a></h2>
<p>This suite allows AEGPs to add items the to render queue (using default options), and control the basic state of the render queue.</p>
<h3 id="aegps-aegp-suites-aegp_renderqueuesuite1">AEGP_RenderQueueSuite1<a class="headerlink" href="#aegps-aegp-suites-aegp_renderqueuesuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_AddCompToRenderQueue</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Adds a composition to the render queue, using default options.</p>
<p><pre lang="cpp">AEGP_AddCompToRenderQueue(<br/>  AEGP_CompH     compH,<br/>  const A_char*  pathZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetRenderQueueState</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the render queue to one of three valid states. It is not possible to go from stopped to paused.</p>
<p><pre lang="cpp">AEGP_SetRenderQueueState(<br/>  AEGP_RenderQueueState  state);</pre></p>
<ul>
<li><code>AEGP_RenderQueueState_STOPPED</code></li>
<li><code>AEGP_RenderQueueState_PAUSED</code></li>
<li><code>AEGP_RenderQueueState_RENDERING</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRenderQueueState</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the current render queue state.</p>
<p><pre lang="cpp">AEGP_GetRenderQueueState(<br/>  AEGP_RenderQueueState  *stateP);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-render-queue-item-suite">Render Queue Item Suite<a class="headerlink" href="#aegps-aegp-suites-render-queue-item-suite" title="Permanent link">&para;</a></h2>
<p>Manipulate all aspects of render queue items using this suite.</p>
<h3 id="aegps-aegp-suites-aegp_rqitemsuite4">AEGP_RQItemSuite4<a class="headerlink" href="#aegps-aegp-suites-aegp_rqitemsuite4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumRQItems</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the number of items currently in the render queue.</p>
<p><pre lang="cpp">AEGP_GetNumRQItems(<br/>  A_long  *num_itemsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRQItemByIndex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns an <code>AEGP_RQItemRefH</code> referencing the index'd item.</p>
<p><pre lang="cpp">AEGP_GetRQItemByIndex(<br/>  A_long           rq_item_index,<br/>  AEGP_RQItemRefH  *rq_item_refPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNextRQItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the next <code>AEGP_RQItemRefH</code>, for iteration purposes.</p>
<p>To get the first <code>AEGP_RQItemRefH</code>, pass <code>RQ_ITEM_INDEX_NONE</code> for the <code>current_rq_itemH</code>.</p>
<p><pre lang="cpp">AEGP_GetNextRQItem(<br/>  AEGP_RQItemRefH  current_rq_itemH,<br/>  AEGP_RQItemRefH  *next_rq_itemPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumOutputModulesForRQItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the number of output modules applied to the given <code>AEGP_RQItemRefH</code>.</p>
<p><pre lang="cpp">AEGP_GetNumOutputModulesForRQItem(<br/>  AEGP_RQItemRefH  rq_itemH,<br/>  A_long           *num_outmodsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRenderState</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns <code>TRUE</code> if the <code>AEGP_RQItemRefH</code> is set to render (once the user clicks the Render button).</p>
<p><pre lang="cpp">AEGP_GetRenderState(<br/>  AEGP_RQItemRefH  rq_itemH,<br/>  A_Boolean        *will_renderPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetRenderState</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Controls whether or not the <code>AEGP_RQItemRefH</code> will render when the user next clicks the Render button.</p>
<p>Returns an error if called during rendering.</p>
<p>This function will return:</p>
<ul>
<li><code>Err_PARAMETER</code> if you try to call while <code>AEGP_RenderQueueState</code> isn't <code>AEGP_RenderQueueState_STOPPED</code></li>
<li><code>Err_RANGE</code> if you pass a status that is illegal in any case, and</li>
<li><code>Err_PARAMETER</code> if you try to pass a status that doesn't make sense (like trying to queue something for which there's no output path)</li>
</ul>
<p><pre lang="cpp">AEGP_SetRenderState(<br/>  AEGP_RQItemRefH  rq_itemH,<br/>  A_Boolean        renderB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetStartedTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the time (in seconds, since 1904) that rendering began.</p>
<p><pre lang="cpp">AEGP_GetStartedTime(<br/>  AEGP_RQItemRefH  rq_itemH,<br/>  A_Time           *started_timePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetElapsedTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the time elapsed since rendering began.</p>
<p><pre lang="cpp">AEGP_GetElapsedTime(<br/>  AEGP_RQItemRefH  rq_itemH,<br/>  A_Time           *render_timePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLogType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the log type for the referenced <code>AEGP_RQItemRefH</code>.</p>
<p><pre lang="cpp">AEGP_GetLogType(<br/>  AEGP_RQItemRefH  rq_itemH,<br/>  AEGP_LogType     *logtypeP);</pre></p>
<p><code>AEGP_LogtType</code> will have one of the following values:</p>
<ul>
<li><code>AEGP_LogType_NONE</code></li>
<li><code>AEGP_LogType_ERRORS_ONLY</code></li>
<li><code>AEGP_LogType_PLUS_SETTINGS</code></li>
<li><code>AEGP_LogType_PER_FRAME_INFO</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetLogType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the log type to be used with the referenced <code>AEGP_RQItemRefH</code>.</p>
<p><pre lang="cpp">AEGP_SetLogType(<br/>  AEGP_RQItemRefH  rq_itemH,<br/>  AEGP_LogType     logtype);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RemoveOutputModule</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Removes the specified output module from the referenced <code>AEGP_RQItemRefH</code>.</p>
<p><pre lang="cpp">AEGP_RemoveOutputModule(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetComment</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Updated to support Unicode in <code>RQItemSuite4</code>, available in 14.1.</p>
<p>Retrieves the comment associated with the referenced <code>AEGP_RQItemRefH</code>.</p>
<p><pre lang="cpp">AEGP_GetComment(<br/>  AEGP_RQItemRefH  rq_itemH,<br/>  AEGP_MemHandle   *unicodeH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetComment</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Updated to support Unicode in <code>RQItemSuite4</code>, available in 14.1.</p>
<p>Specifies the comment associated with the referenced <code>AEGP_RQItemRefH</code>.</p>
<p><pre lang="cpp">AEGP_SetComment(<br/>  AEGP_RQItemRefH    rq_itemH,<br/>  const A_UTF16Char  *commentZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompFromRQItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the <code>AEGP_CompH</code> associated with the <code>AEGP_RQItemRefH</code>.</p>
<p><pre lang="cpp">AEGP_GetCompFromRQItem(<br/>  AEGP_RQItemRefH  rq_itemH,<br/>  AEGP_CompH       *compPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DeleteRQItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Deletes the render queue item. Undoable.</p>
<p><pre lang="cpp">AEGP_DeleteRQItem(<br/>  AEGP_RQItemRefH  rq_itemH);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-render-queue-monitor-suite">Render Queue Monitor Suite<a class="headerlink" href="#aegps-aegp-suites-render-queue-monitor-suite" title="Permanent link">&para;</a></h2>
<p>New in CS6. This suite provides all the info a render queue manager needs to figure out what is happening at any point in a render.</p>
<h3 id="aegps-aegp-suites-aegp_renderqueuemonitorsuite1">AEGP_RenderQueueMonitorSuite1<a class="headerlink" href="#aegps-aegp-suites-aegp_renderqueuemonitorsuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
<th colspan="1" rowspan="1"></th>
<th colspan="1" rowspan="1"></th>
<th colspan="1" rowspan="1"></th>
<th colspan="1" rowspan="1"></th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterListener</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Register a set of plug-in-defined functions to be called by the render queue.</p>
<p>Use the refcon to pass in data that you want to use later on when your plug-in-defined functions in <code>AEGP_RQM_FunctionBlock1</code> are called later. It may be set it to <code>NULL</code> if you don't need it.</p>
<p><pre lang="cpp">AEGP_RegisterListener(<br/>  AEGP_PluginID                  aegp_plugin_id,<br/>  AEGP_RQM_Refcon                aegp_refconP,<br/>  const AEGP_RQM_FunctionBlock1  *fcn_blockP);</pre></p>
<p>The <code>AEGP_RQM_FunctionBlock1</code> is defined as follows:</p>
<p><pre lang="cpp">struct _AEGP_RQM_FunctionBlock1 {<br/>  A_Err (<em>AEGP_RQM_RenderJobStarted)(<br/>    AEGP_RQM_BasicData  *basic_dataP,<br/>    AEGP_RQM_SessionId  jobid);<br/><br/>A_Err (</em>AEGP_RQM_RenderJobEnded)(<br/>    AEGP_RQM_BasicData  *basic_dataP,<br/>    AEGP_RQM_SessionId  jobid);</p>
<p><code>AEGP_RQM_FinishedStatus</code> will be one of the following:</p>
<ul>
<li><code>AEGP_RQM_FinishedStatus_UNKNOWN</code></li>
<li><code>AEGP_RQM_FinishedStatus_SUCCEEDED</code></li>
<li><code>AEGP_RQM_FinishedStatus_ABORTED</code></li>
<li><code>AEGP_RQM_FinishedStatus_ERRED</code></li>
</ul>
<p>The <code>AEGP_RQM_BasicData</code> is defined below.</p>
<p><pre lang="cpp">struct _AEGP_RQM_BasicData {<br/>  const struct SPBasicSuite *pica_basicP;<br/>  A_long                    aegp_plug_id;<br/>  AEGP_RQM_Refcon           aegp_refconPV;<br/>} AEGP_RQM_BasicData;</pre></p>
</td>
<td colspan="1" rowspan="1">
<p><br/><br/>A_Err (*AEGP_RQM_RenderJobItemStarted)(<br/>    AEGP_RQM_BasicData  *basic_dataP,<br/>    AEGP_RQM_SessionId  jobid,<br/>    AEGP_RQM_ItemId     itemid);</p>
</td>
<td colspan="1" rowspan="1">
<p><br/><br/>A_Err (*AEGP_RQM_RenderJobItemUpdated)(<br/>    AEGP_RQM_BasicData  *basic_dataP,<br/>    AEGP_RQM_SessionId  jobid,<br/>    AEGP_RQM_ItemId     itemid,<br/>    AEGP_RQM_FrameId    frameid);</p>
</td>
<td colspan="1" rowspan="1">
<p><br/><br/>A_Err (*AEGP_RQM_RenderJobItemEnded)(<br/>    AEGP_RQM_BasicData       *basic_dataP,<br/>    AEGP_RQM_SessionId       jobid,<br/>    AEGP_RQM_ItemId          itemid,<br/>    AEGP_RQM_FinishedStatus  fstatus);</p>
</td>
<td colspan="1" rowspan="1">
<p><br/><br/>A_Err (*AEGP_RQM_RenderJobItemReportLog)(<br/>    AEGP_RQM_BasicData  *basic_dataP,<br/>    AEGP_RQM_SessionId  jobid,<br/>    AEGP_RQM_ItemId     itemid,<br/>    A_Boolean           isError,<br/>    AEGP_MemHandle      logbuf);<br/>} AEGP_RQM_FunctionBlock1;</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DeregisterListener</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Deregister from the render queue.</p>
<p><pre lang="cpp">AEGP_DeregisterListener(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  AEGP_RQM_Refcon  aegp_refconP);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetProjectName</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtain the current project name. The project name is a handle to a NULL-terminated A_UTF16Char string, and must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetProjectName(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_MemHandle      *utf_project_namePH0);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetAppVersion</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtain the app version. The app version is a handle to a NULL-terminated A_UTF16Char string, and must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetAppVersion(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_MemHandle      *utf_app_versionPH0);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumJobItems</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtain the number of job items.</p>
<p><pre lang="cpp">AEGP_GetNumJobItems(<br/>  AEGP_RQM_SessionId  sessid,<br/>  A_long              *num_jobitemsPL);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetJobItemID</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the job with the index specified.</p>
<p><pre lang="cpp">AEGP_GetJobItemID(<br/>  AEGP_RQM_SessionId  sessid,<br/>  A_long              jobItemIndex,<br/>  AEGP_RQM_ItemId     *jobItemID);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumJobItemRenderSettings</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the number of render settings for the job with the index specified.</p>
<p><pre lang="cpp">AEGP_GetNumJobItemRenderSettings(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_RQM_ItemId     itemid,<br/>  A_long              *num_settingsPL);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetJobItemRenderSetting</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get a specific render setting of a specific job. The setting name and value are handles to NULL-terminated A_UTF16Char strings, and must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetJobItemRenderSetting(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_RQM_ItemId     itemid,<br/>  A_long              settingIndex,<br/>  AEGP_MemHandle      *utf_setting_namePH0,<br/>  AEGP_MemHandle      *utf_setting_valuePH0);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumJobItemOutputModules</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the number of output modules for the job with the index specified.</p>
<p><pre lang="cpp">AEGP_GetNumJobItemOutputModules(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_RQM_ItemId     itemid,<br/>  A_long              *num_outputmodulesPL);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumJobItemOutputModuleSettings</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the number of settings for the output module with the index specified.</p>
<p><pre lang="cpp">AEGP_GetNumJobItemOutputModuleSettings(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_RQM_ItemId     itemid,<br/>  A_long              outputModuleIndex,<br/>  A_long              *num_settingsPL);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetJobItemOutputModuleSetting</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get a specific setting of a job item output module. The setting name and value are handles to NULL-terminated A_UTF16Char strings, and must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetJobItemOutputModuleSetting(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_RQM_ItemId     itemid,<br/>  A_long              outputModuleIndex,<br/>  A_long              settingIndex,<br/>  AEGP_MemHandle      *utf_setting_namePH0,<br/>  AEGP_MemHandle      *utf_setting_valuePH0);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumJobItemOutputModuleWarnings</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the number of output module warnings for a job item.</p>
<p><pre lang="cpp">AEGP_GetNumJobItemOutputModuleWarnings(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_RQM_ItemId     itemid,<br/>  A_long              outputModuleIndex,<br/>  A_long              *num_warningsPL);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetJobItemOutputModuleWarning</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get a specific warning of a specific output module for a specific job item. The warning value is a handle to NULL-terminated A_UTF16Char string, and must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetJobItemOutputModuleWarning(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_RQM_ItemId     itemid,<br/>  A_long              outputModuleIndex,<br/>  A_long              warningIndex,<br/>  AEGP_MemHandle      *utf_warning_valuePH0);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumJobItemFrameProperties</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the number of properties for a job item frame.</p>
<p><pre lang="cpp">AEGP_GetNumJobItemFrameProperties(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_RQM_ItemId     itemid,<br/>  AEGP_RQM_FrameId    frameid,<br/>  A_long              *num_propertiesPL);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetJobItemFrameProperty</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get a specific property on a job item frame. The property name and values are handle to NULL-terminated A_UTF16Char strings, and must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetJobItemFrameProperty(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_RQM_ItemId     itemid,<br/>  AEGP_RQM_FrameId    frameid,<br/>  A_long              propertyIndex,<br/>  AEGP_MemHandle      *utf_property_namePH0,<br/>  AEGP_MemHandle      *utf_property_valuePH0);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumJobItemOutputModuleProperties</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get the number of properties for a job item output module.</p>
<p><pre lang="cpp">AEGP_GetNumJobItemOutputModuleProperties(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_RQM_ItemId     itemid,<br/>  A_long              outputModuleIndex,<br/>  A_long              *num_propertiesPL);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetJobItemOutputModuleProperty</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get a specific property off a job item output module. The property name and values are handle to NULL-terminated A_UTF16Char strings, and must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetJobItemOutputModuleProperty(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_RQM_ItemId     itemid,<br/>  A_long              outputModuleIndex,<br/>  A_long              propertyIndex,<br/>  AEGP_MemHandle      *utf_property_namePH0,<br/>  AEGP_MemHandle      *utf_property_valuePH0);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetJobItemFrameThumbnail</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Get a buffer with a JPEG-encoded thumbnail of the job item frame.</p>
<p>Pass in the maximum width and height, and the actual dimensions will be passed back.</p>
<p><pre lang="cpp">AEGP_GetJobItemFrameThumbnail(<br/>  AEGP_RQM_SessionId  sessid,<br/>  AEGP_RQM_ItemId     itemid,<br/>  AEGP_RQM_FrameId    frameid,<br/>  A_long              *widthPL,<br/>  A_long              *heightPL,<br/>  AEGP_MemHandle      *thumbnailPH0);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-output-module-suite">Output Module Suite<a class="headerlink" href="#aegps-aegp-suites-output-module-suite" title="Permanent link">&para;</a></h2>
<p>Every item in the render queue has at least one output module specified.</p>
<p>Use this suite to query and control all aspects of the output modules attached to a given render item.</p>
<p>You may also add and remove output modules.</p>
<p>Factoid: For each frame rendered for a given render item, the list of output modules is traversed. So, for frame 0, output module 0, then 1, then 2 are called.</p>
<h3 id="aegps-aegp-suites-aegp_outputmodulesuite4">AEGP_OutputModuleSuite4<a class="headerlink" href="#aegps-aegp-suites-aegp_outputmodulesuite4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutputModuleByIndex</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the indexed output module.</p>
<p>NOTE: <code>AEGP_OutputModuleRefH</code> is an opaque data type, and can't be manipulated directly; you must use our accessor functions to modify it.</p>
<p><pre lang="cpp">AEGP_GetOutputModuleByIndex(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  A_long                 outmod_indexL,<br/>  AEGP_OutputModuleRefH  *outmodPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetEmbedOptions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the embedding setting specified for the referenced <code>AEGP_OutputModuleRefH</code>.</p>
<p><pre lang="cpp">AEGP_GetEmbedOptions(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  AEGP_EmbeddingType     *embed_optionsP);</pre></p>
<p><code>AEGP_EmbeddingType</code> will be one of the following:</p>
<ul>
<li><code>AEGP_Embedding_NOTHING</code></li>
<li><code>AEGP_Embedding_LINK</code></li>
<li><code>AEGP_Embedding_LINK_AND_COPY</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetEmbedOptions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the embedding setting for the referenced <code>AEGP_OutputModuleRefH</code>.</p>
<p><pre lang="cpp">AEGP_SetEmbedOptions(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  AEGP_EmbeddingType     embed_options);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetPostRenderAction</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the post-render action setting for the referenced <code>AEGP_OutputModuleRefH</code>.</p>
<p><pre lang="cpp">AEGP_GetPostRenderAction(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  AEGP_PostRenderAction  *actionP);</pre></p>
<p><code>AEGP_PostRenderAction</code> will be one of the following:</p>
<ul>
<li><code>AEGP_PostRenderOptions_IMPORT</code></li>
<li><code>AEGP_PostRenderOptions_IMPORT_AND_REPLACE_USAGE</code></li>
<li><code>AEGP_PostRenderOptions_SET_PROXY</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetPostRenderAction</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the post-render action setting for the referenced <code>AEGP_OutputModuleRefH</code>.</p>
<p><pre lang="cpp">AEGP_SetPostRenderAction(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  AEGP_PostRenderAction  action);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetEnabledOutputs</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves which output types are enabled for the referenced <code>AEGP_OutputModuleRefH</code>.</p>
<p><pre lang="cpp">AEGP_GetEnabledOutputs(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  AEGP_OutputTypes       *typesP);</pre></p>
<p><code>AEGP_OutputTypes</code> will contain one or both of the following values:</p>
<ul>
<li><code>AEGP_OutputType_VIDEO</code></li>
<li><code>AEGP_OutputType_AUDIO</code></li>
</ul>
<p>NOTE: These are flags, not an enumeration.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetEnabledOutputs</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies which output types are enabled for the referenced <code>AEGP_OutputModuleRefH</code>.</p>
<p><pre lang="cpp">AEGP_SetEnabledOutputs(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  AEGP_OutputTypes       enabled_types);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutputChannels</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves which video channels are enabled for output in the referenced AEGP_OutputModuleRefH.</p>
<p><pre lang="cpp">AEGP_GetOutputChannels(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  AEGP_VideoChannels     *outchannelsP);</pre></p>
<p><code>AEGP_VideoChannels</code> will be one of the following:</p>
<ul>
<li><code>AEGP_VideoChannels_RGB</code></li>
<li><code>AEGP_VideoChannels_RGBA</code></li>
<li><code>AEGP_VideoChannels_ALPHA</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetOutputChannels</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies which video channels are enabled for output in the referenced <code>AEGP_OutputModuleRefH</code>.</p>
<p><pre lang="cpp">AEGP_SetOutputChannels(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  AEGP_VideoChannels     outchannels);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetStretchInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the stretch information enabled for the referenced <code>AEGP_OutputModuleRefH</code>; whether or not stretching is enabled, whether or not the frame aspect ratio is locked to the composition's, and what quality setting is specified.</p>
<p><pre lang="cpp">AEGP_GetStretchInfo(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  A_Boolean              *enabledPB,<br/>  AEGP_StretchQuality    *qualP,<br/>  A_Boolean              *lockedPB);</pre></p>
<p><code>AEGP_StretchQuality</code> will be one of the following:</p>
<ul>
<li><code>AEGP_StretchQual_LOW</code></li>
<li><code>AEGP_StretchQual_HIGH</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetStretchInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the stretch information enabled for the referenced <code>AEGP_OutputModuleRefH</code>.</p>
<p><pre lang="cpp">AEGP_SetStretchInfo(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  A_Boolean              is_enabledB,<br/>  AEGP_StretchQuality    quality);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCropInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves whether or not the cropping is enabled for the referenced <code>AEGP_OutputModuleRefH</code>, and the rectangle to be used.</p>
<p><pre lang="cpp">AEGP_GetCropInfo(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  A_Boolean              *is_enabledBP,<br/>  A_Rect                 *crop_rectP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCropInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies whether cropping is enabled for the referenced <code>AEGP_OutputModuleRefH</code>, and the rectangle to be used.</p>
<p><pre lang="cpp">AEGP_SetCropInfo(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  A_Boolean              enableB,<br/>  A_Rect                 crop_rect);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetSoundFormatInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves whether or not audio output is enabled for the referenced <code>AEGP_OutputModuleRefH</code>, and the settings to be used.</p>
<p><pre lang="cpp">AEGP_GetSoundFormatInfo(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  AEGP_SoundDataFormat   *formatP,<br/>  A_Boolean              *enabledPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetSoundFormatInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies whether or not audio output is enabled for the referenced <code>AEGP_OutputModuleRefH</code>, and the settings to be used.</p>
<p><pre lang="cpp">AEGP_SetSoundFormatInfo(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  AEGP_SoundDataFormat   format_info,<br/>  A_Boolean              enabledB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutputFilePath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the path to which <code>AEGP_OutputModuleRefH's</code> output file will be written. The path is a handle to a NULL-terminated A_UTF16Char string, and must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetOutputFilePath(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  AEGP_MemHandle         *unicode_pathPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetOutputFilePath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies the path to which <code>AEGP_OutputModuleRefH's</code> output file will be written. The file path is a NULL-terminated UTF-16 string with platform separators.</p>
<p><pre lang="cpp">AEGP_SetOutputFilePath(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  const A_UTF16Char      *pathZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_AddDefaultOutputModule</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Adds the default output module to the specified <code>AEGP_RQItemRefH</code>, and returns the added output module's <code>AEGP_OutputModuleRefH</code> (you wouldn't add it if you didn't plan to mess around with it, would you?).</p>
<p><pre lang="cpp">AEGP_AddDefaultOutputModule(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  *outmodPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetExtraOutputModuleInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves information about the output module.</p>
<p><code>format_uniPH</code> and <code>info_uniPH</code> provide the textual description of, and information about, the output module, formatted as the user would see it.</p>
<p><code>format_uniPH</code> and <code>info_uniPH</code> will contain NULL-terminated UTF16 strings, of which the caller must dispose.</p>
<p><pre lang="cpp">AEGP_GetExtraOutputModuleInfo(<br/>  AEGP_RQItemRefH        rq_itemH,<br/>  AEGP_OutputModuleRefH  outmodH,<br/>  AEGP_MemHandle         *format_uniPH,<br/>  AEGP_MemHandle         *info_uniPH,<br/>  A_Boolean              *is_sequenceBP,<br/>  A_Boolean              *multi_frameBP);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-working-with-effects">Working With Effects<a class="headerlink" href="#aegps-aegp-suites-working-with-effects" title="Permanent link">&para;</a></h2>
<p>These functions provide a way for effects (and AEGPs) to obtain information about the context of an applied effect.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any time you modify or rely on data from outside the normal render pipeline, you run the risk of dependency problems.</p>
</div>
<p>There is no way for After Effects to know that you depend on this external information; consequently, you will not be notified if it changes out from under you.</p>
<h3 id="aegps-aegp-suites-aegp_pfinterfacesuite1">AEGP_PFInterfaceSuite1<a class="headerlink" href="#aegps-aegp-suites-aegp_pfinterfacesuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetEffectLayer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtain the layer handle of the layer to which the effect is applied.</p>
<p><pre lang="cpp">AEGP_GetEffectLayer(<br/>  PF_ProgPtr   effect_ref,<br/>  AEGP_LayerH  *layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewEffectForEffect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtain the <code>AEGP_EffectRefH</code> corresponding to the effect.</p>
<p><pre lang="cpp">AEGP_GetNewEffectForEffect(<br/>  AEGP_PluginID    aegp_plugin_id,<br/>  PF_ProgPtr       effect_ref,<br/>  AEGP_EffectRefH  *effectPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ConvertEffectToCompTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retreive the composition time corresponding to the effect's layer time.</p>
<p><pre lang="cpp">AEGP_ConvertEffectToCompTime(<br/>  PF_ProgPtr     effect_ref,<br/>  long           what_timeL,<br/>  unsigned long  time_scaleLu,<br/>  A_Time         *comp_timePT);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetEffectCamera</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtain the camera (if any) being used by After Effects to view the effect's layer.</p>
<p><pre lang="cpp">AEGP_GetEffectCamera(<br/>  PF_ProgPtr    effect_ref,<br/>  const A_Time  *comp_timePT,<br/>  AEGP_LayerH   camera_layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetEffectCameraMatrix</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtain the transform used to move between the layer's coordinate space and that of the containing composition.</p>
<p><pre lang="cpp">AEGP_GetEffectCameraMatrix(<br/>  PF_ProgPtr    effect_ref,<br/>  const A_Time  *comp_timePT,<br/>  A_Matrix4     *camera_matrixP,<br/>  A_FpLong      *dst_to_planePF,<br/>  A_short       *plane_widthPL,<br/>  A_short       *plane_heightPL);</pre></p>
<p>NOTE: In cases where the effect's input layer has square pixels, but is in a non-square pixel composition, you must correct for the pixel aspect ratio by premultiplying the matrix by <code>(1/parF, 1, 1)</code>.</p>
</td>
</tr>
</tbody>
</table>
<h3 id="aegps-aegp-suites-aegp_geteffectcameramatrix-notes">AEGP_GetEffectCameraMatrix Notes<a class="headerlink" href="#aegps-aegp-suites-aegp_geteffectcameramatrix-notes" title="Permanent link">&para;</a></h3>
<p>The model view for the camera matrix is inverse of the matrix obtained from <code>AEGP_GetEffectCameraMatrix()</code>.</p>
<p>Also note that our matrix is row-based; OpenGL's is column-based.</p>
<hr />
<h2 id="aegps-aegp-suites-do-this-many-times">Do This Many Times<a class="headerlink" href="#aegps-aegp-suites-do-this-many-times" title="Permanent link">&para;</a></h2>
<p>Utilizes multiple processors (if available) for your computations.</p>
<h3 id="aegps-aegp-suites-aegp_iteratesuite1">AEGP_IterateSuite1<a class="headerlink" href="#aegps-aegp-suites-aegp_iteratesuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumThreads</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Ask After Effects how many threads are currently available.</p>
<p><pre lang="cpp">AEGP_GetNumThreads(<br/>  A_long  *num_threadsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IterateGeneric</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specify a function for After Effects to manage on multiple processors.</p>
<p>Can be any function pointer specified by <code>fn_func</code>, taking the arguments listed below.</p>
<p>See <a href="#aegps-implementation-private-data">Private Data</a> for a description of how <code>refconPV</code> is used.</p>
<p><pre lang="cpp">AEGP_IterateGeneric(<br/>  A_long  iterationsL,<br/>  void    *refconPV,<br/>  A_Err   (*fn_func)<br/>    (void   *refconPV,<br/>    A_long  thread_indexL,<br/>    A_long  i,<br/>    A_long  iterationsL));</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aegps-aegp-suites-file-import-manager-suite">File Import Manager Suite<a class="headerlink" href="#aegps-aegp-suites-file-import-manager-suite" title="Permanent link">&para;</a></h2>
<p>The FIMSuite allows file types handled by AEGPs to appear as part of the After Effects import dialog, and drag-and-drop messaging.</p>
<p>These are not for use by AEIOs! Rather, they are for importing projects which are best represented as After Effects compositions.</p>
<h3 id="aegps-aegp-suites-aegp_fimsuite3">AEGP_FIMSuite3<a class="headerlink" href="#aegps-aegp-suites-aegp_fimsuite3" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterImportFlavor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Registers the name of the file type(s) supported by the plug-in. Upon return, <code>imp_refP</code> will be a valid opaque reference, or <code>AE_FIM_ImportFlavorRef_NONE</code>.</p>
<p><pre lang="cpp">AEGP_RegisterImportFlavor(<br/>  const char              *nameZ,<br/>  AE_FIM_ImportFlavorRef  *imp_refP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterImportFlavorFileTypes</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Registers an array of file types and file extensions (the two arrays need not be of equal length) supported by the AEGP.</p>
<p><pre lang="cpp">AEGP_RegisterImportFlavorFileTypes(<br/>  AE_FIM_ImportFlavorRef  imp_ref,<br/>  long                    num_filekindsL,<br/>  const AEIO_FileKind     *kindsAP,<br/>  long                    num_fileextsL,<br/>  const AEIO_FileKind     *extsAP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RegisterImportFlavorImportCallbacks</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Register the AEGP functions which will respond to import of different filetypes.</p>
<p><pre lang="cpp">AEGP_RegisterImportFlavorImportCallbacks(<br/>  AE_FIM_ImportFlavorRef        ref,<br/>  AE_FIM_ImportFlags            single_flag,<br/>  const AE_FIM_ImportCallbacks  *imp_cbsP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetImportedItem</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Designates an item as having been imported (possibly replacing an existing item), and sets associated import options.</p>
<p><pre lang="cpp">AEGP_SetImportedItem(<br/>  AE_FIM_ImportOptions  imp_options,<br/>  AEGP_ItemH            imported_itemH);</pre></p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="aegps-cheating-effect-usage-of-aegp-suites"><h1 id="aegps-cheating-effect-usage-of-aegp-suites-cheating-effect-usage-of-aegp-suites">Cheating Effect Usage of AEGP Suites<a class="headerlink" href="#aegps-cheating-effect-usage-of-aegp-suites-cheating-effect-usage-of-aegp-suites" title="Permanent link">&para;</a></h1>
<p>As soon as we showed developers the initial implementation of AEGP suites, they wanted to "cheat" and use them from within effects. This is certainly possible, but please keep in mind that depending on factors outside the effect API (i.e., any information you get from the AEGP APIs) can lead to trouble. If After Effects thinks an effect has all the information it needs to render, it won't (for example) update its parameters based on changes made through an AEGP function. We're actively working on this dependency issue for future versions, but bear it in mind as you write effects which "masquerade" as AEGPs.</p>
<p>Effects can use some AEGP suites to take advantage of camera and lighting information, as well as the <code>AEGP_GetLayerParentComp</code> and <code>AEGP_GetCompBGColor</code> functions, from <a href="#aegps-aegp-suites-aegp_compsuite11">AEGP_CompSuite11</a>. This should not be interpreted to mean that effects can use <em>any</em> AEGP suite calls. Also, see <a href="#effect-ui-events-effect-ui-events">Effect UI &amp; Events</a> for more information on effects adding keyframes.</p>
<p><a href="#aegps-aegp-suites-aegp_pfinterfacesuite1">AEGP_PFInterfaceSuite</a> is the starting point. The functions in this suite allow you to retrieve the AEGP_LayerH for the layer to which the effect is applied, and the AEGP_EffectRefH for the instance of your effect. <code>AEGP_RegisterWithAEGP</code> from <a href="#aegps-aegp-suites-aegp_utilitysuite6">AEGP_UtilitySuite6</a> allows you to get an AEGP_PluginID, which is needed for many AEGP calls.</p>
<hr />
<h2 id="aegps-cheating-effect-usage-of-aegp-suites-depending-on-aegp-queries">Depending on AEGP Queries<a class="headerlink" href="#aegps-cheating-effect-usage-of-aegp-suites-depending-on-aegp-queries" title="Permanent link">&para;</a></h2>
<p>One word: Don't. Effects cannot allow the results of AEGP queries to control what is rendered, without appropriately storing those query results (usually in sequence data), cancelling their own render, and forcing a re-render using the queried information.</p>
<p>This is tricky.</p>
<p>Failure to do so will result in nasty, subtle caching bugs guaranteed to cause hair loss and weight gain.</p></section><section class="print-page" id="aegps-aegp-details"><h1 id="aegps-aegp-details-aegp-details">AEGP Details<a class="headerlink" href="#aegps-aegp-details-aegp-details" title="Permanent link">&para;</a></h1>
<h2 id="aegps-aegp-details-have-a-cookie">Have A Cookie<a class="headerlink" href="#aegps-aegp-details-have-a-cookie" title="Permanent link">&para;</a></h2>
<p>In cases where After Effects must preserve state information around the functions your AEGP calls (as when an artisan is rendering a frame, or a keyframer is adding and removing a series of keyframes from the same stream), you'll call begin() and end() functions.</p>
<p>Typically, the begin function will return an opaque identifier, or 'cookie', which you must then pass to the functions being used. The end function will properly dispose of the cookie. See <code>AEGP_StartAddKeyframes()</code> (under <a href="#aegps-aegp-suites-aegp_keyframesuite3">AEGP_KeyframeSuite3</a>) for an example.</p>
<hr />
<h2 id="aegps-aegp-details-modifying-items-in-the-render-queue">Modifying Items In The Render Queue<a class="headerlink" href="#aegps-aegp-details-modifying-items-in-the-render-queue" title="Permanent link">&para;</a></h2>
<p>If you call <code>AEGP_AddCompToRenderQueue</code> (from <a href="#aegps-aegp-suites-aegp_renderqueuesuite1">AEGP_RenderQueueSuite1</a>), or if the user manually adds or removes a composition from the render queue, all references to render queue items are invalidated. Similarly, adding or removing output modules invalidates any such references for each render queue item.</p>
<hr />
<h2 id="aegps-aegp-details-names-and-solids">Names And Solids<a class="headerlink" href="#aegps-aegp-details-names-and-solids" title="Permanent link">&para;</a></h2>
<p>Solids have names in the After Effects UI, but not in their <code>PF_LayerDef</code> <a href="#effect-basics-pf_effectworld">PF_EffectWorld / PF_LayerDef</a>. Consequently, their names cannot be retrieved by <code>AEGP_GetItemName</code> (in <a href="#aegps-aegp-suites-aegp_itemsuite9">AEGP_ItemSuite9</a>) or <code>AEGP_GetLayerName</code> (in <a href="#aegps-aegp-suites-aegp_layersuite9">AEGP_LayerSuite9</a>).</p>
<p>However, you can use the ItemH associated with them to <code>AEGP_GetItemName</code> (from <a href="#aegps-aegp-suites-aegp_itemsuite9">AEGP_ItemSuite9</a>).</p>
<hr />
<h2 id="aegps-aegp-details-reporting-errors-and-problems">Reporting Errors And Problems<a class="headerlink" href="#aegps-aegp-details-reporting-errors-and-problems" title="Permanent link">&para;</a></h2>
<p>Use <code>AEGP_ItemSuite&gt;AEGP_ReportInfo()</code> to report information to users, and identify your plug-in. AEIO plug-ins use the msg_func pointer contained in the AEIO_BasicData they're passed (with every function) instead.</p>
<hr />
<h2 id="aegps-aegp-details-transforms-what-happens-first">Transforms: What Happens First?<a class="headerlink" href="#aegps-aegp-details-transforms-what-happens-first" title="Permanent link">&para;</a></h2>
<p>After Effects computes rotation based on auto-orientation (towards path, or point of interest), then computes Orientation, then computes X, Y, and Z rotation.</p>
<hr />
<h2 id="aegps-aegp-details-accessing-pixels-from-effect-layer-parameters">Accessing Pixels From Effect Layer Parameters<a class="headerlink" href="#aegps-aegp-details-accessing-pixels-from-effect-layer-parameters" title="Permanent link">&para;</a></h2>
<p>Use <code>AEGP_GetNewStreamValue</code> (in <a href="#aegps-aegp-suites-aegp_streamsuite5">AEGP_StreamSuite5</a>) to get the layer's <code>layer_id</code>, then the new <code>AEGP_GetLayerFromLayerID</code> (in <a href="#aegps-aegp-suites-aegp_layersuite9">AEGP_LayerSuite9</a>) to get the <code>AEGP_LayerH</code>.</p></section><h1 class='nav-section-title-end'>Ended: AEGPs</h1>
                        <h1 class='nav-section-title' id='section-artisans'>
                            Artisans <a class='headerlink' href='#section-artisans' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="artisans-artisans"><h1 id="artisans-artisans-artisans">Artisans<a class="headerlink" href="#artisans-artisans-artisans" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you're considering developing an Artisan, please talk it over with us first.</p>
</div>
<p>The Artisan API exposes function hooks necessary for a plug-in to provide rendered output of 3D layers, taking over completely from After Effects (which still handles all rendering of 2D layers). There can be only one Artisan per composition, chosen from within the <em>Composition Settings</em> &gt; <em>Advanced</em> dialog. Artisans render the 3D environment, asking After Effects for information about each element in the composition. As you might guess, this is a vast and tedious process. This API is not recommended for anyone without a strong need to override After Effects' 3D rendering.</p>
<p>Artisans may share information with effects written to communicate with them, but effects may not initiate this communication. Many of the suites used by Artisans require a rendering context which is generated only after all effects have been applied to the layer.</p>
<hr />
<h2 id="artisans-artisans-interactive-artisans">Interactive Artisans<a class="headerlink" href="#artisans-artisans-interactive-artisans" title="Permanent link">&para;</a></h2>
<p>These differ from standard artisans in that they handle all layers in a composition (not just those which the user has made 3D), and they will only ever be called for onscreen display, never for rendered final output (the rendering calls "fall through" to the default artisan).</p></section><section class="print-page" id="artisans-artisan-data-types"><h1 id="artisans-artisan-data-types-artisan-data-types">Artisan Data Types<a class="headerlink" href="#artisans-artisan-data-types-artisan-data-types" title="Permanent link">&para;</a></h1>
<p>Below are the data types most commonly used in the Artisan API.</p>
<hr />
<h2 id="artisans-artisan-data-types-data-types-used-in-the-artisan-api">Data Types Used In The Artisan API<a class="headerlink" href="#artisans-artisan-data-types-data-types-used-in-the-artisan-api" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Type</p>
</th>
<th colspan="1" rowspan="1">
<p>Describes</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderLayerContextH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>State information at the time of a render request, sent to an Artisan by After Effects.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>PR_RenderContextH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A collection of settings defining what is to be rendered, and how.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SoundDataH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The audio settings used for a given layer.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderReceiptH</code>
<code>AEGP_FrameReceiptH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Used by Artisans when rendering.
</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_WorldH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A frame of pixels.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderOptionsH</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The settings associated with a render queue item.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="artisans-artisan-data-types-horz-vert">Horz? Vert?<a class="headerlink" href="#artisans-artisan-data-types-horz-vert" title="Permanent link">&para;</a></h2>
<p>After Effects' matrix is row based; OpenGL's is column based. This means more work for you. Yay, billable hours!</p>
<hr />
<h2 id="artisans-artisan-data-types-implementation-and-design">Implementation And Design<a class="headerlink" href="#artisans-artisan-data-types-implementation-and-design" title="Permanent link">&para;</a></h2>
<p>An Artisan is nearly an application unto itself. Because we realized early in the After Effects 5.0 that there are many ways to approach the problems inherent in 3D rendering; intersections and shading, for example.</p>
<p>We provided an API with which we and third parties (yes, we really do use our own APIs) could implement any 3D rendering scheme desired.</p>
<hr />
<h2 id="artisans-artisan-data-types-3d-compositing-not-modeling">3D Compositing, Not Modeling<a class="headerlink" href="#artisans-artisan-data-types-3d-compositing-not-modeling" title="Permanent link">&para;</a></h2>
<p>After Effects is <em>not</em> a 3D modeling application. Users work in a responsive mode, switching to higher quality only at for proofing or final output. Consider providing at least two quality modes, one for layout and another for final output. Be conscious of render time in low quality mode.</p>
<hr />
<h2 id="artisans-artisan-data-types-registering-an-artisan">Registering An Artisan<a class="headerlink" href="#artisans-artisan-data-types-registering-an-artisan" title="Permanent link">&para;</a></h2>
<p>An Artisan is an AEGP, and has a single entry point. Artisans must also register their own function entry points and have a special callback for this purpose. See <code>AEGP_RegisterArtisan()</code> from <a href="#aegps-aegp-suites-aegp_registersuites5">AEGP_RegisterSuites5</a>.</p>
<p>This tables shows the functions that Artisans can support as defined by <code>PR_ArtisanEntryPoints</code>: only <code>render_func</code> is required.</p>
<h3 id="artisans-artisan-data-types-artisan-entry-points">Artisan Entry Points<a class="headerlink" href="#artisans-artisan-data-types-artisan-entry-points" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>PR_ArtisanEntryPoints</p>
</th>
<th colspan="1" rowspan="1"></th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>global_setup_func0</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Called only once, right after <code>GP_Main</code>. The global data is common across all instances of the plug-in.</p>
<p>If you allocate memory during Global Setup, you must free it during your <code>global_setdown_func</code>.</p>
<p><pre lang="cpp">PR_GlobalSetupFunc(<br/>  const PR_InData    *in_dataP,<br/>  PR_GlobalContextH  global_contextH,<br/>  PR_GlobalDataH     *global_dataPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>global_setdown_func0</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Dispose of any global data you allocated.</p>
<p><pre lang="cpp">PR_GlobalSetdownFunc(<br/>  const PR_InData    *in_dataP,<br/>  PR_GlobalContextH  global_contextH,<br/>  PR_GlobalDataH     global_dataH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>global_do_about_func0</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Tell the world about yourself! Use <code>in_dataP&gt;msg_func</code> to display your dialog.</p>
<p><pre lang="cpp">PR_GlobalDoAboutFunc(<br/>  const PR_InData    *in_dataP,<br/>  PR_GlobalContextH  global_contextH,<br/>  PR_GlobalDataH     global_dataH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>setup_instance_func0</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Allocate and instantiate any data specific to this instance of your Artisan.</p>
<p><pre lang="cpp">PR_InstanceSetupFunc(<br/>  const PR_InData      *in_dataP,<br/>  PR_GlobalContextH    global_contextH,<br/>  PR_InstanceContextH  instance_contextH,<br/>  PR_GlobalDataH       global_dataH,<br/>  PR_InstanceFlags     flags,<br/>  PR_FlatHandle        flat_dataH0,<br/>  PR_InstanceDataH     *instance_dataPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>setdown_instance_func0</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Deallocate and free any data specific to this instance of your Artisan.</p>
<p><pre lang="cpp">PR_InstanceSetdownFunc(<br/>  const PR_InData      *in_dataP,<br/>  PR_GlobalContextH    global_contextH,<br/>  PR_InstanceContextH  instance_contextH,<br/>  PR_GlobalDataH       global_dataH,<br/>  PR_InstanceDataH     instance_dataH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>flatten_instance_func0</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Flatten your data in preparation to being written to disk. (making sure it's OS independent, if your Artisan is).</p>
<p><pre lang="cpp">PR_FlattenInstanceFunc(<br/>  const PR_InData      *in_dataP,<br/>  PR_GlobalContextH    global_contextH,<br/>  PR_InstanceContextH  instance_contextH,<br/>  PR_GlobalDataH       global_dataH,<br/>  PR_InstanceDataH     instance_dataH,<br/>  PR_FlatHandle        *flatH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>do_instance_dialog_func0</code></p>
</td>
<td colspan="1" rowspan="1">
<p>If your Artisan has a additional parameters (accessed through its Options dialog), this function will be called to get and set them.</p>
<p><pre lang="cpp">PR_DoInstanceDialogFunc(<br/>  const PR_InData      *in_dataP,<br/>  PR_GlobalContextH    global_contextH,<br/>  PR_InstanceContextH  instance_contextH,<br/>  PR_GlobalDataH       global_dataH,<br/>  PR_InstanceDataH     instance_dataH,<br/>  PR_DialogResult      *resultP);</pre></p>
<p><code>PR_DialogResultis</code> is either <code>PR_DialogResult_NO_CHANGE</code> or <code>PR_DialogResult_CHANGE_MADE</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>frame_setup_func0</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Perform any setup necessary to render a frame (called immediately before rendering).</p>
<p><pre lang="cpp">PR_FrameSetupFunc(<br/>  const PR_InData      *in_dataP,<br/>  PR_GlobalContextH    global_contextH,<br/>  PR_InstanceContextH  instance_contextH<br/>  PR_RenderContextH    render_contextH,<br/>  PR_GlobalDataH       global_dataH,<br/>  PR_InstanceDataH     instance_dataH,<br/>  PR_RenderDataH       *render_dataPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>frame_setdown_func0</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Dispose of any setup data allocated during <code>frame_setup</code> (sent immediately after rendering).</p>
<p><pre lang="cpp">PR_FrameSetdownFunc(<br/>  const PR_InData      *in_dataP,<br/>  PR_GlobalContextH    global_contextH,<br/>  PR_InstanceContextH  instance_contextH<br/>  PR_RenderContextH    render_contextH,<br/>  PR_GlobalDataH       global_dataH,<br/>  PR_InstanceDataH     instance_dataH,<br/>  PR_RenderDataH       render_dataH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>render_func</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Render the scene.</p>
<p><pre lang="cpp">PR_FrameRenderFunc(<br/>  const PR_InData      *in_dataP,<br/>  PR_GlobalContextH    global_contextH,<br/>  PR_InstanceContextH  instance_contextH<br/>  PR_RenderContextH    render_contextH,<br/>  PR_GlobalDataH       global_dataH,<br/>  PR_InstanceDataH     instance_dataH,<br/>  PR_RenderDataH       render_dataH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>query_func0</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Artisans can draw their own projection axes, should the need arise.</p>
<p>After Effects will call this function to obtain the transform between the composition world and those axes, as well as for a number of other functions related to on- and off-screen preview drawing (the former is relevant only to interactive artisans).</p>
<p><pre lang="cpp">PR_QueryFunc(<br/>  const PR_InData      *in_dataP,<br/>  PR_GlobalContextH    global_contextH,<br/>  PR_InstanceContextH  instance_contextH<br/>  PR_QueryContextH     query_contextH,<br/>  PR_QueryType         query_type,<br/>  PR_GlobalDataH       global_dataH,<br/>  PR_InstanceDataH     instance_dataH);</pre></p>
<p><code>PR_QueryType</code> can be one of the following:</p>
<ul>
<li><code>PR_QueryType_NONE = 0</code></li>
<li><code>PR_QueryType_TRANSFORM</code></li>
<li><code>PR_QueryType_INTERACTIVE_WINDOW_DISPOSE</code></li>
<li><code>PR_QueryType_INTERACTIVE_WINDOW_CLEAR</code></li>
<li><code>PR_QueryType_INTERACTIVE_WINDOW_FROZEN_PROXY</code></li>
<li><code>PR_QueryType_INTERACTIVE_SWAP_BUFFER</code></li>
<li><code>PR_QueryType_INTERACTIVE_DRAW_PROCS</code></li>
<li><code>PR_QueryType_PREPARE_FOR_LINE_DRAWING</code></li>
<li><code>PR_QueryType_UNPREPARE_FOR_LINE_DRAWING</code></li>
<li><code>PR_QueryType_GET_CURRENT_CONTEXT_SAFE_FOR_LINE_DRAWING</code></li>
<li><code>PR_QueryType_GET_ARTISAN_QUALITY</code> (New in CS6.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="artisans-artisan-data-types-the-world-is-your-canvas">The World Is Your Canvas<a class="headerlink" href="#artisans-artisan-data-types-the-world-is-your-canvas" title="Permanent link">&para;</a></h2>
<p><code>AEGP_RenderTexture()</code> supplies the raw pixels of a layer, untransformed, into an arbitrarily-sized buffer.</p>
<p><code>AEGP_RenderLayer()</code> invokes the entire After Effects render pipeline, including transforms, masking, et cetera, providing the layer as it appears in its composition, in a composition-sized buffer.</p>
<p>If the layer being rendered is 3D, the default (Standard 3D) Artisan is invoked to perform any 3D geometrics.</p>
<p>Your Artisan can use this to render track matte layers, and apply them only in a strictly 2D sense, to the transformed 3D layer.</p>
<p>Before rendering, the Artisans that ship with After Effects apply an inverse transform to get square pixels, then re-apply the transform before display.</p>
<p>For example, if the pixel aspect ratio is 10/11 (DV NTSC), we multiply by 11/10 to get square pixels. We process and composite 3D layers, then re-divide to get back to the original pixel aspect ratio.</p>
<p>The following suite supplies the layers, compositions, texture and destination buffers. This is a vital suite for all artisans.</p>
<h3 id="artisans-artisan-data-types-aegp_canvassuite8">AEGP_CanvasSuite8<a class="headerlink" href="#artisans-artisan-data-types-aegp_canvassuite8" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompToRender</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given the render context provided to the Artisan at render time, returns a handle to the composition.</p>
<p><pre lang="cpp">AEGP_GetCompToRender(<br/>  PR_RenderContextH  render_contextH,<br/>  AEGP_CompH         *compPH)</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumLayersToRender</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given the render context, returns the number of layers the Artisan needs to render.</p>
<p><pre lang="cpp">AEGP_GetNumLayersToRender(<br/>  PR_RenderContextH  render_contextH,<br/>  A_long             *num_to_renderPL)</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNthLayerContextToRender</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Used to build a list of layers to render after determining the total number of layers that need rendering by the Artisan.</p>
<p><pre lang="cpp">AEGP_GetNthLayerContextToRender(<br/>  PR_RenderContextH         render_contextH,<br/>  A_long                    n,<br/>  AEGP_RenderLayerContextH  *layer_indexPH)</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerFromLayerContext</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a <code>AEGP_RenderLayerContextH</code>,retrieves the associated <code>AEGP_LayerH</code> (required by many suite functions).</p>
<p><pre lang="cpp">AEGP_GetLayerFromLayerContext(<br/>  const PR_RenderContextH   render_contextH,<br/>  AEGP_RenderLayerContextH  layer_contextH,<br/>  AEGP_LayerH               *layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLayerAndSubLayerFromLayerContext</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Allows for rendering of sub-layers (as within a Photoshop file).</p>
<p><pre lang="cpp">AEGP_GetLayerAndSubLayerFromLayerContext(<br/>  const PR_RenderContextH   render_contextH,<br/>  AEGP_RenderLayerContextH  layer_contextH,<br/>  AEGP_LayerH               *layerPH,<br/>  AEGP_SubLayerIndex        *sublayerP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetTopLayerFromLayerContext</code></p>
</td>
<td colspan="1" rowspan="1">
<p>With collapsed geometrics "on" this gives the layer in the root composition containing the layer context.</p>
<p>With collapsed geometrics off this is the same as <code>AEGP_GetLayerFromLayerContext</code>.</p>
<p><pre lang="cpp">AEGP_GetTopLayerFromLayerContext(<br/>  const PR_RenderContextH   r_contextH,<br/>  AEGP_RenderLayerContextH  l_contextH,<br/>  AEGP_LayerH               *layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompRenderTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given the render context, returns the current point in (composition) time to render.</p>
<p><pre lang="cpp">AEGP_GetNthLayerIndexToRender(<br/>  PR_RenderContextH  render_contextH,<br/>  A_long             *time,<br/>  A_long             *time_step)</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompDestinationBuffer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given the render context, returns a buffer in which to place the final rendered output.</p>
<p><pre lang="cpp">AEGP_GetCompToRender(<br/>  PR_RenderContextH  render_contextH,<br/>  AEGP_CompH         compH,<br/>  PF_EffectWorld     *dst);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetROI</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given the render context provided to the Artisan at render time, returns a handle to the composition.</p>
<p><pre lang="cpp">AEGP_GetROI(<br/>  PR_RenderContextH  render_contextH,<br/>  A_LegacyRect       *roiPR);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderTexture</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given the render context and layer, returns the layer texture.</p>
<p>All parameters with a trailing '0' are optional; the returned <code>PF_EffectWorld</code> can be NULL.</p>
<p><pre lang="cpp">AEGP_RenderTexture(<br/>  PR_RenderContextH  render_contextH,<br/>  AEGP_LayerH        layerH,<br/>  AEGP_RenderHints   render_hints,<br/>  A_FloatPoint       *suggested_scaleP0,<br/>  A_FloatRect        *suggsted_src_rectP0,<br/>  A_Matrix3          *src_matrixP0,<br/>  PF_EffectWorld     *render_bufferP);</pre></p>
<p><code>AEGP_RenderHints</code> contains one or more of the following:</p>
<ul>
<li><code>AEGP_RenderHints_NONE</code></li>
<li><code>AEGP_RenderHints_IGNORE_EXTENTS</code></li>
<li><code>AEGP_RenderHints_NO_TRANSFER_MODE</code> (prevents application of opacity &amp; transfer mode; for use with <code>RenderLayer</code> calls.)</li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeTexture</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Disposes of an acquired layer texture.</p>
<p><pre lang="cpp">AEGP_DisposeTexture(<br/>  PR_RenderContextH  render_contextH,<br/>  AEGP_LayerH        layerH,<br/>  AEGP_WorldH        *dst0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetFieldRender</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the field settings of the given <code>PR_RenderContextH</code>.</p>
<p><pre lang="cpp">AEGP_GetFieldRender(<br/>  PR_RenderContextH  render_contextH,<br/>  PF_Field           *field);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ReportArtisanProgress</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given the render context provided to the Artisan at render time, returns a handle to the composition.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is NOT thread-safe on macOS; only use this function when the current thread ID is 0.</p>
</div>
<p><pre lang="cpp">AEGP_ReportArtisanProgress(<br/>  PR_RenderContextH  render_contextH,<br/>  A_long             countL,<br/>  A_long             totalL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRenderDownsampleFactor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the downsample factor of the <code>PR_RenderContextH</code>.</p>
<p><pre lang="cpp">AEGP_GetRenderDownsampleFactor(<br/>  PR_RenderContextH      render_contextH,<br/>  AEGP_DownsampleFactor  *dsfP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsBlankCanvas</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Determines whether the <code>PR_RenderContextH</code> is blank (empty).</p>
<p><pre lang="cpp">AEGP_IsBlankCanvas(<br/>  PR_RenderContextH  render_contextH,<br/>  A_Boolean          *is_blankPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRenderLayerToWorldXform</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a render context and a layer (at a given time), retrieves the 4 by 4 transform to move between their coordinate spaces.</p>
<p><pre lang="cpp">AEGP_GetRenderLayerToWorldXform(<br/>  PR_RenderContextH         render_contextH,<br/>  AEGP_RenderLayerContextH  layer_contextH,<br/>  const A_Time              *comp_timeP,<br/>  A_Matrix4                 *transform);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRenderLayerBounds</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the bounding rectangle of the layer_contextH (at a given time) within the <code>render_contextH</code>.</p>
<p><pre lang="cpp">AEGP_GetRenderLayerBounds(<br/>  PR_RenderContextH         render_contextH,<br/>  AEGP_RenderLayerContextH  layer_contextH,<br/>  const A_Time              *comp_timeP,<br/>  A_LegacyRect              *boundsP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRenderOpacity</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the opacity of the given layer context at the given time, within the render context.</p>
<p><pre lang="cpp">AEGP_GetRenderOpacity(<br/>  PR_RenderContextH         render_contextH,<br/>  AEGP_RenderLayerContextH  layer_contextH,<br/>  const A_Time              *comp_timePT,<br/>  A_FpLong                  *opacityPF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_IsRenderLayerActive</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether or not a given layer context is active within the render context, at the given time.</p>
<p><pre lang="cpp">AEGP_IsRenderLayerActive(<br/>  PR_RenderContextH         render_contextH,<br/>  AEGP_RenderLayerContextH  layer_contextH,<br/>  const A_Time              *comp_timePT,<br/>  A_Boolean                 *activePB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetArtisanLayerProgress</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the progress information for a rendering Artisan.</p>
<ul>
<li><code>countL</code> is the number of layers completed,</li>
<li><code>num_layersL</code> is the total number of layers the Artisan is rendering.</li>
</ul>
<p><pre lang="cpp">AEGP_SetArtisanLayerProgress(<br/>  PR_RenderContextH  render_contextH,<br/>  A_long             countL,<br/>  A_long             num_layersL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderLayerPlus</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Similar to <code>AEGP_RenderLayer</code>, but takes into account the <code>AEGP_RenderLayerContextH</code>.</p>
<p><pre lang="cpp">AEGP_RenderLayerPlus(<br/>  PR_RenderContextH          r_contextH,<br/>  AEGP_LayerH                layerH,<br/>  AEGP_RenderLayerContextH   l_contextH,<br/>  AEGP_RenderHints           render_hints,<br/>  AEGP_WorldH                *bufferP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetTrackMatteContext</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the <code>AEGP_RenderLayerContextH</code> for the specified render and fill contexts.</p>
<p><pre lang="cpp">AEGP_GetTrackMatteContext(<br/>  PR_RenderContextH         rnder_contextH,<br/>  AEGP_RenderLayerContextH  fill_contextH,<br/>  AEGP_RenderLayerContextH  *mattePH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderTextureWithReceipt</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Renders a texture into an <code>AEGP_WorldH</code>, and provides an <code>AEGP_RenderReceiptH</code> for the operation.</p>
<p>The returned <code>receiptPH</code> must be disposed of with <code>AEGP_DisposeRenderReceipt</code>.</p>
<p><pre lang="cpp">AEGP_RenderTextureWithReceipt(<br/>  PR_RenderContextH         render_contextH,<br/>  AEGP_RenderLayerContextH  layer_contextH,<br/>  AEGP_RenderHints          render_hints,<br/>  A_FloatPoint              *suggested_scaleP0,<br/>  A_FloatRect               *suggest_src_rectP0,<br/>  A_Matrix3                 *src_matrixP0,<br/>  AEGP_RenderReceiptH       *receiptPH,<br/>  AEGP_WorldH               *dstPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumberOfSoftwareEffects</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the number of software effects applied in the given <code>AEGP_RenderLayerContextH</code>.</p>
<p><pre lang="cpp">AEGP_GetNumberOfSoftwareEffects(<br/>  PR_RenderContextH         ren_contextH,<br/>  AEGP_RenderLayerContextH  lyr_contextH,<br/>  A_short                   *num_sft_FXPS);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_RenderLayerPlusWithReceipt</code></p>
</td>
<td colspan="1" rowspan="1">
<p>An improvement over <code>AEGP_RenderLayerPlus</code>, this function also provides an <code>AEGP_RenderReceiptH</code> for caching purposes.</p>
<p><pre lang="cpp">AEGP_RenderLayerPlusWithReceipt(<br/>  PR_RenderContextH            render_contextH,<br/>  AEGP_LayerH                  layerH,<br/>  AEGP_RenderLayerContextH     layer_contextH,<br/>  AEGP_RenderHints             render_hints,<br/>  AEGP_NumEffectsToRenderType  num_effectsS,<br/>  AEGP_RenderReceiptH          *receiptPH,<br/>  AEGP_WorldH                  *bufferPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_DisposeRenderReceipt</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Frees an <code>AEGP_RenderReceiptH</code>.</p>
<p><pre lang="cpp">AEGP_DisposeRenderReceipt(<br/>  AEGP_RenderReceiptH  receiptH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_CheckRenderReceipt</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Checks with After Effects' internal caching to determine whether a given <code>AEGP_RenderReceiptH</code> is still valid.</p>
<p><pre lang="cpp">AEGP_CheckRenderReceipt(<br/>  PR_RenderContextH            current_contextH,<br/>  AEGP_RenderLayerContextH     current_lyr_ctxtH,<br/>  AEGP_RenderReceiptH          old_receiptH,<br/>  A_Boolean                    check_aceB,<br/>  AEGP_NumEffectsToRenderType  num_effectsS,<br/>  AEGP_RenderReceiptStatus     *receipt_statusP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GenerateRenderReceipt</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Generates a <code>AEGP_RenderReceiptH</code> for a layer as if the first <code>num_effectsS</code> have been rendered.</p>
<p><pre lang="cpp">AEGP_GenerateRenderReceipt(<br/>  PR_RenderContextH            current_contextH,<br/>  AEGP_RenderLayerContextH     current_lyr_contextH,<br/>  AEGP_NumEffectsToRenderType  num_effectsS,<br/>  AEGP_RenderReceiptH          *render_receiptPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNumBinsToRender</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the number of bins After Effects wants the artisan to render.</p>
<p><pre lang="cpp">AEGP_GetNumBinsToRender(<br/>  const PR_RenderContextH  contextH,<br/>  A_long                   *num_binsPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetNthBin</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the given render context to be the n-th bin to be rendered by After Effects.</p>
<p><pre lang="cpp">AEGP_SetNthBin(<br/>  const PR_RenderContextH  contextH,<br/>  A_long                   n);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetBinType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the type of the given bin.</p>
<p><pre lang="cpp">AEGP_GetBinType(<br/>  const PR_RenderContextH  contextH,<br/>  AEGP_BinType             *bin_typeP);</pre></p>
<p><code>AEGP_BinType</code> will be one of the following:</p>
<ul>
<li><code>AEGP_BinType_NONE</code></li>
<li><code>AEGP_BinType_2D</code></li>
<li><code>AEGP_BinType_3D</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRenderLayerToWorldXform2D3D</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the transform to correctly orient the layer being rendered with the output world.</p>
<p>Pass <code>TRUE</code> for <code>only_2dB</code> to constrain the transform to two dimensions.</p>
<p><pre lang="cpp">AEGP_GetRenderLayerToWorldXform2D3D(<br/>  PR_RenderContextH         render_contextH,<br/>  AEGP_RenderLayerContextH  layer_contextH,<br/>  const A_Time              *comp_timeP,<br/>  A_Boolean                 only_2dB,<br/>  A_Matrix4                 *transformP);</pre></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Functions below are for interactive artisans only.</p>
</div>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetPlatformWindowRef</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the platform-specific window context into which to draw the given <code>PR_RenderContextH</code>.</p>
<p><pre lang="cpp">AEGP_GetPlatformWindowRef(<br/>  const PR_RenderContextH  contextH,<br/>  AEGP_PlatformWindowRef   *window_refP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetViewportScale</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the source-to-frame downsample factor for the given <code>PR_RenderContextH</code>.</p>
<p><pre lang="cpp">AEGP_GetViewportScale(<br/>  const PR_RenderContextH  contextH,<br/>  A_FpLong                 *scale_xPF,<br/>  A_FpLong                 *scale_yPF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetViewportOrigin</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves to origin of the source, within the frame (necessary to translate between the two), for the given <code>PR_RenderContextH</code>.</p>
<p><pre lang="cpp">AEGP_GetViewportOrigin(<br/>  const PR_RenderContextH  contextH,<br/>  A_long                   *origin_xPL,<br/>  A_long                   *origin_yPL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetViewportRect</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the bounding rectangle for the area to be drawn, for the given <code>PR_RenderContextH</code>.</p>
<p><pre lang="cpp">AEGP_GetViewportRect(<br/>  const PR_RenderContextH  contextH,<br/>  A_LegacyRect             *v_rectPR);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetFallowColor</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the color used for the fallow regions in the given <code>PR_RenderContextH</code>.</p>
<p><pre lang="cpp">AEGP_GetFallowColor(<br/>  const PR_RenderContextH  contextH,<br/>  PF_Pixel8                *fallow_colorP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInteractiveCheckerboard</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves whether or not the checkerboard is currently active for the given <code>PR_RenderContextH</code>.</p>
<p><pre lang="cpp">AEGP_GetInteractiveCheckerboard(<br/>  const PR_RenderContextH  contextH,<br/>  A_Boolean                *cboard_onPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInteractiveCheckerboardColors</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the colors used in the checkerboard.</p>
<p><pre lang="cpp">AEGP_GetInteractiveCheckerboardColors(<br/>  const PR_RenderContextH  contextH,<br/>  PF_Pixel                 *color1P,<br/>  PF_Pixel                 *color2P);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInteractiveCheckerboardSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the width and height of one checkerboard square.</p>
<p><pre lang="cpp">AEGP_GetInteractiveCheckerboardSize(<br/>  const PR_RenderContextH  contextH,<br/>  A_u_long                 *cbd_widthPLu,<br/>  A_u_long                 *cbd_heightPLu);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInteractiveCachedBuffer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the cached AEGP_WorldH last used for the <code>PR_RenderContextH</code>.</p>
<p><pre lang="cpp">AEGP_GetInteractiveCachedBuffer(<br/>  const PR_RenderContextH  contextH,<br/>  AEGP_WorldH              *buffer);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ArtisanMustRenderAsLayer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Determines whether or not the artisan must render the current <code>AEGP_RenderLayerContextH</code> as a layer.</p>
<p><pre lang="cpp">AEGP_ArtisanMustRenderAsLayer(<br/>  const PR_RenderContextH   contextH,<br/>  AEGP_RenderLayerContextH  layer_contextH,<br/>  A_Boolean                 *use_txturePB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInteractiveDisplayChannel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns which channels should be displayed by the interactive artisan.</p>
<p><pre lang="cpp">AEGP_GetInteractiveDisplayChannel(<br/>  const PR_RenderContextH  contextH,<br/>  AEGP_DisplayChannelType  *channelP);</pre></p>
<p><code>AEGP_DisplayChannelType</code> will be one of the following:</p>
<ul>
<li><code>AEGP_DisplayChannel_NONE</code></li>
<li><code>AEGP_DisplayChannel_RED</code></li>
<li><code>AEGP_DisplayChannel_GREEN</code></li>
<li><code>AEGP_DisplayChannel_BLUE</code></li>
<li><code>AEGP_DisplayChannel_ALPHA</code></li>
<li><code>AEGP_DisplayChannel_RED_ALT</code></li>
<li><code>AEGP_DisplayChannel_GREEN_ALT</code></li>
<li><code>AEGP_DisplayChannel_BLUE_ALT</code></li>
<li><code>AEGP_DisplayChannel_ALPHA_ALT</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInteractiveExposure</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the exposure for the given <code>PR_RenderContextH</code>, expressed as a floating point number.</p>
<p><pre lang="cpp">AEGP_GetInteractiveExposure(<br/>  const PR_RenderContextH  rcH,<br/>  A_FpLong                 *exposurePF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetColorTransform</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the color transform for the given <code>PR_RenderContextH</code>.</p>
<p><pre lang="cpp">AEGP_GetColorTransform(<br/>  const PR_RenderContextH  render_contextH,<br/>  A_Boolean                *cms_onB,<br/>  A_u_long                 *xform_keyLu,<br/>  void                      *xformP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCompShutterTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the shutter angle for the given <code>PR_RenderContextH</code>.</p>
<p><pre lang="cpp">AEGP_GetCompShutterTime(<br/>  PR_RenderContextH  render_contextH,<br/>  A_Time             *shutter_time,<br/>  A_Time             *shutter_dur);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_MapCompToLayerTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Unlike <a href="#aegps-aegp-suites-aegp_layersuite9">AEGP_ConvertCompToLayerTime</a>, this handles time remapping with collapsed or nested comps.</p>
<p><pre lang="cpp">AEGP_MapCompToLayerTime(<br/>  PR_RenderContextH         render_contextH,<br/>  AEGP_RenderLayerContextH  layer_contextH,<br/>  const A_Time              *comp_timePT,<br/>  A_Time                    *layer_timePT);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="artisans-artisan-data-types-convert-between-different-contexts">Convert Between Different Contexts<a class="headerlink" href="#artisans-artisan-data-types-convert-between-different-contexts" title="Permanent link">&para;</a></h2>
<p>Convert between render and instance contexts, and manage global data specific to the artisan.</p>
<h3 id="artisans-artisan-data-types-aegp_artisanutilsuite1">AEGP_ArtisanUtilSuite1<a class="headerlink" href="#artisans-artisan-data-types-aegp_artisanutilsuite1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetGlobalContextFromInstanceContext</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given an instance context, returns a handle to the global context.</p>
<p><pre lang="cpp">AEGP_GetGlobalContextFromInstanceContext(<br/>  const PR_InstanceContextH  instance_contextH,<br/>  PR_GlobalContextH          *global_contextPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInstanceContextFromRenderContext</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given the render context, returns a handle to the instance context.</p>
<p><pre lang="cpp">AEGP_GetInstanceContextFromRenderContext(<br/>  const PR_RenderContextH  render_contextH,<br/>  PR_InstanceContextH      *instnc_ctextPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInstanceContextFromQueryContext</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a query context, returns a handle to the instance context.</p>
<p><pre lang="cpp">AEGP_GetInstanceContextFromQueryContext(<br/>  const PR_QueryContextH  query_contextH,<br/>  PR_InstanceContextH     *instnce_contextPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetGlobalData</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given the global context, returns a handle to global data.</p>
<p><pre lang="cpp">AEGP_GetGlobalData(<br/>  const PR_GlobalContextH  global_contextH,<br/>  PR_GlobalDataH           *global_dataPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInstanceData</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given an instance context, return the associated instance data.</p>
<p><pre lang="cpp">AEGP_GetInstanceData(<br/>  const PR_InstanceContextH  instance_contextH,<br/>  PR_InstanceDataH           *instance_dataPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetRenderData</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a render context, returns the associated render data.</p>
<p><pre lang="cpp">AEGP_GetRenderData(<br/>  const PR_RenderContextH  render_contextH,<br/>  PR_RenderDataH           *render_dataPH);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="artisans-artisan-data-types-smile-cameras">Smile! Cameras<a class="headerlink" href="#artisans-artisan-data-types-smile-cameras" title="Permanent link">&para;</a></h2>
<p>Obtains the camera geometry, including camera properties (type, lens, depth of field, focal distance, aperture, et cetera).</p>
<h3 id="artisans-artisan-data-types-aegp_camerasuite2">AEGP_CameraSuite2<a class="headerlink" href="#artisans-artisan-data-types-aegp_camerasuite2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCamera</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a layer handle and time, returns the current camera layer handle.</p>
<p><pre lang="cpp">AEGP_GetCamera(<br/>  PR_RenderContextH  render_contextH,<br/>  const A_Time       *comp_timeP,<br/>  AEGP_LayerH        *camera_layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCameraType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a layer, returns the camera type of the layer.</p>
<p><pre lang="cpp">AEGP_GetCameraType(<br/>  AEGP_LayerH      aegp_layerH,<br/>  AEGP_CameraType  *camera_typeP;</pre></p>
<p>The camera type can be the following:</p>
<ul>
<li><code>AEGP_CameraType_NONE = -1</code></li>
<li><code>AEGP_CameraType_PERSPECTIVE</code></li>
<li><code>AEGP_CameraType_ORTHOGRAPHIC</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetDefaultCameraDistanceToImagePlane</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a composition handle, returns the camera distance to the image plane.</p>
<p><pre lang="cpp">AEGP_GetDefaultCamera DistanceToImagePlane(<br/>  AEGP_CompH  compH,<br/>  A_FpLong    *dist_to_planePF)</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetCameraFilmSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the size (and units used to measure that size) of the film used by the designated camera.</p>
<p><pre lang="cpp">AEGP_GetCameraFilmSize(<br/>  AEGP_LayerH         camera_layerH,<br/>  AEGP_FilmSizeUnits  *film_size_unitsP,<br/>  A_FpLong            *film_sizePF0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetCameraFilmSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the size (and unites used to measure that size) of the film used by the designated camera.</p>
<p><pre lang="cpp">AEGP_SetCameraFilmSize)(<br/>  AEGP_LayerH         camera_layerH,<br/>  AEGP_FilmSizeUnits  film_size_units,<br/>  A_FpLong            *film_sizePF0);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="artisans-artisan-data-types-notes-regarding-camera-behavior">Notes Regarding Camera Behavior<a class="headerlink" href="#artisans-artisan-data-types-notes-regarding-camera-behavior" title="Permanent link">&para;</a></h2>
<p>Camera orientation is in composition coordinates, and the rotations are in layer (the camera's layer) coordinates.</p>
<p>If the camera layer has a parent, the position is in a coordinate space relative to the parent.</p>
<hr />
<h2 id="artisans-artisan-data-types-orthographic-camera-matrix">Orthographic Camera Matrix<a class="headerlink" href="#artisans-artisan-data-types-orthographic-camera-matrix" title="Permanent link">&para;</a></h2>
<p>Internally, we use composition width and height to set the matrix described by the OpenGL specification as</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><span class="n">glOrtho</span><span class="p">(</span><span class="o">-</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span>
</span></code></pre></div>
<p>The orthographic matrix describes the projection. The position of the camera is described by another, scaled matrix. The inverse of the camera position matrix provides the "eye" coordinates.</p>
<hr />
<h2 id="artisans-artisan-data-types-focus-on-focal">Focus On Focal<a class="headerlink" href="#artisans-artisan-data-types-focus-on-focal" title="Permanent link">&para;</a></h2>
<p>Remember, focal length affects field of view; focal distance only affects depth of field.</p>
<hr />
<h2 id="artisans-artisan-data-types-film-size">Film Size<a class="headerlink" href="#artisans-artisan-data-types-film-size" title="Permanent link">&para;</a></h2>
<p>In the real world, film size is measured in millimeters. In After Effects, it's measured in pixels. Multiply by 72 and divide by 25.4 to move from millimeters to pixels.</p>
<p>Field of view is more complex;</p>
<p>ϴ = 1/2 field of view</p>
<p>tan(ϴ) = 1/2 composition height / focal length</p>
<p>focal length = 2 tan(ϴ) / composition height</p>
<hr />
<h2 id="artisans-artisan-data-types-hit-the-lights">Hit The Lights!<a class="headerlink" href="#artisans-artisan-data-types-hit-the-lights" title="Permanent link">&para;</a></h2>
<p>Get and set the type of lights in a composition.</p>
<h3 id="artisans-artisan-data-types-aegp_lightsuite2">AEGP_LightSuite2<a class="headerlink" href="#artisans-artisan-data-types-aegp_lightsuite2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetLightType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the <code>AEGP_LightType</code> of the specified camera layer.</p>
<p><pre lang="cpp">AEGP_GetLightType(<br/>  AEGP_LayerH     light_layerH,<br/>  AEGP_LightType  *light_typeP);</pre></p>
<p><code>AEGP_LightType</code> will be one of the following:</p>
<ul>
<li><code>AEGP_LightType_PARALLEL</code></li>
<li><code>AEGP_LightType_SPOT</code></li>
<li><code>AEGP_LightType_POINT</code></li>
<li><code>AEGP_LightType_AMBIENT</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetLightType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the <code>AEGP_LightType</code> for the specified camera layer.</p>
<p><pre lang="cpp">AEGP_SetLightType(<br/>  AEGP_LayerH     light_layerH,<br/>  AEGP_LightType  light_type);</pre></p>
</td>
</tr>
</tbody>
</table>
<h3 id="artisans-artisan-data-types-notes-on-light-behavior">Notes On Light Behavior<a class="headerlink" href="#artisans-artisan-data-types-notes-on-light-behavior" title="Permanent link">&para;</a></h3>
<p>The formula for parallel lights is found in Foley and Van Dam's "Introduction to Computer Graphics" (ISBN 0-201-60921-5) as is the formula for point lights.</p>
<p>We use the half angle variant proposed by Jim Blinn instead.</p>
<p>Suppose we have a point on a layer and want to shade it with the light.</p>
<p>Let V be the unit vector from the layer point to the eye point.
Let L be the unit vector to the light (in the parallel light case this is constant). Let H be (V+L)/2 (normalized).
Let N be the unit normal vector to the layer.</p>
<p>The amount of specular reflected light is S * power(H Dot N, shine), where S is the specular coefficient.</p>
<hr />
<h2 id="artisans-artisan-data-types-how-should-i-draw-that">How Should I Draw That?<a class="headerlink" href="#artisans-artisan-data-types-how-should-i-draw-that" title="Permanent link">&para;</a></h2>
<p>After Effects relies upon Artisans to draw 3D layer handles. If your Artisan chooses not to respond to this call, the default Artisan will draw 3D layer handles for you. Querying transforms is important for optimization of After Effects' caching.</p>
<p>The coordinate system is positive x to right, positive y down, positive z into the screen. The origin is the upper left corner. Rotations are x then y then z. For matrices the translate is the bottom row, orientations are quaternions (which are applied first), then any x-y-z rotation after that. As a general rule, use orientation or rotation but not both. Also use rotations if you need control over angular velocity.</p>
<hr />
<h2 id="artisans-artisan-data-types-query-transform-functions">Query Transform Functions<a class="headerlink" href="#artisans-artisan-data-types-query-transform-functions" title="Permanent link">&para;</a></h2>
<p>These functions give artisans information about the transforms they'll need in order to correctly place layers within a composition and respond appropriately to the various queries After Effects will send to their <code>PR_QueryFunc</code> entry point function.</p>
<p>As that entry point is optional, so is your artisan's response to the queries; however, if you don't, your users may be disappointed that (while doing interactive preview drawing) all the camera and light indicators vanish, until they stop moving! Artisans are complex beasts; contact us if you have any questions.</p>
<h3 id="artisans-artisan-data-types-aegp_queryxformsuite2">AEGP_QueryXFormSuite2<a class="headerlink" href="#artisans-artisan-data-types-aegp_queryxformsuite2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryXformGetSrcType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a query context, returns trasnsform source currently being modified.</p>
<p><pre lang="cpp">AEGP_QueryXformGetSrcType(<br/>  PR_QueryContextH     query_contextH,<br/>  AEGP_QueryXformType  *src_type);</pre></p>
<p>The query context will be one of the following:</p>
<ul>
<li><code>AEGP_Query_Xform_LAYER</code></li>
<li><code>AEGP_Query_Xform_WORLD</code></li>
<li><code>AEGP_Query_Xform_VIEW</code></li>
<li><code>AEGP_Query_Xform_SCREEN</code></li>
</ul>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryXformGetDstType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a query context, returns the currently requested transform destination.</p>
<p><pre lang="cpp">AEGP_QueryXformGetDstType(<br/>  PR_QueryContextH     query_contextH,<br/>  AEGP_QueryXformType  *dst_type);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryXformGetLayer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Used if the source or destination type is a layer. Given a query context, returns the layer handle.</p>
<p><pre lang="cpp">AEGP_QueryXformGetLayer(<br/>  PR_QueryContextH  query_contextH,<br/>  AEGP_LayerH       *layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryXformGetComp</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a query context, returns the current composition handle.</p>
<p><pre lang="cpp">AEGP_QueryXformGetComp(<br/>  PR_QueryContextH  query_contextH,<br/>  AEGP_CompH        *compPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryXformGetTransformTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a query context, returns the time of the transformation.</p>
<p><pre lang="cpp">AEGP_QueryXformGetTransformTime(<br/>  PR_QueryContextH  query_contextH,<br/>  A_Time            *time);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryXformGetViewTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a query context, returns the time of the associated view.</p>
<p><pre lang="cpp">AEGP_QueryXformGetViewTime(<br/>  PR_QueryContextH  query_contextH,<br/>  A_Time            *time);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryXformGetCamera</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a query context, returns the current camera layer handle.</p>
<p><pre lang="cpp">AEGP_QueryXformGetCamera(<br/>  PR_QueryContextH  query_contextH,<br/>  AEGP_LayerH       *camera_layerPH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryXformGetXform</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a query context, returns the current matrix transform.</p>
<p><pre lang="cpp">AEGP_QueryXformGetXform(<br/>  PR_QueryContextH  query_contextH,<br/>  A_Matrix4         *xform);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryXformSetXform</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a query context, return the matrix transform you compute in <code>xform</code>.</p>
<p><pre lang="cpp">AEGP_QueryXformSetXform(<br/>  PR_QueryContextH  query_contextH,<br/>  A_Matrix4         *xform);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryWindowRef</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the window reference to be used (by After Effects) for the given <code>PR_QueryContextH</code>.</p>
<p><pre lang="cpp">AEGP_QueryWindowRef(<br/>  PR_QueryContextH        q_contextH,<br/>  AEGP_PlatformWindowRef  *window_refP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryWindowClear</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns which <code>AEGP_PlatformWindowRef</code> (and <code>A_Rect</code>) to clear, for the given <code>PR_QueryContextH</code>.</p>
<p><pre lang="cpp">AEGP_QueryWindowClear(<br/>  PR_QueryContextH        q_contextH,<br/>  AEGP_PlatformWindowRef  *window_refP,<br/>  A_LegacyRect            *boundsPR);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryFrozenProxy</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns whether or not the textures used in the given <code>PR_QueryContextH</code> should be frozen.</p>
<p><pre lang="cpp">AEGP_QueryFrozenProxy(<br/>  PR_QueryContextH  q_contextH,<br/>  A_Boolean         *onPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QuerySwapBuffer</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sent after rendering and camera/light handle drawing is complete; After Effects returns the buffer into which the artisan should draw its output.</p>
<p><pre lang="cpp">AEGP_QuerySwapBuffer(<br/>  PR_QueryContextH        q_contextH,<br/>  AEGP_PlatformWindowRef  *window_refP,<br/>  AEGP_WorldH             *dest_bufferp);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryDrawProcs</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the interactive drawing functions After Effects will call while drawing camera and lighting handles into the artisan's provided context.</p>
<p><pre lang="cpp">AEGP_QueryDrawProcs(<br/>  PR_QueryContextH         query_contextH,<br/>  PR_InteractiveDrawProcs  *window_refP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryPrepareForLineDrawing</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Informs After Effects about the context into which it will be drawing.</p>
<p><pre lang="cpp">AEGP_QueryPrepareForLineDrawing(<br/>  PR_QueryContextH        query_contextH,<br/>  AEGP_PlatformWindowRef  *window_refP,<br/>  A_LegacyRect            *viewportP,<br/>  A_LPoint                *originP,<br/>  A_FloatPoint            *scaleP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_QueryUnprepareForLineDrawing</code></p>
</td>
<td colspan="1" rowspan="1">
<p>As far as After Effects is concerned, the artisan is done drawing lines.</p>
<p><pre lang="cpp">AEGP_QueryUnprepareForLineDrawing(<br/>  PR_QueryContextH        query_contextH,<br/>  AEGP_PlatformWindowRef  *window_refP);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="artisans-artisan-data-types-interactive-drawing-functions">Interactive Drawing Functions<a class="headerlink" href="#artisans-artisan-data-types-interactive-drawing-functions" title="Permanent link">&para;</a></h2>
<p>We've added the ability for artisans to provide functions After Effects can use to do basic drawing functions for updating the comp window display during preview, including camera, light, and wireframe preview modeling.</p>
<h3 id="artisans-artisan-data-types-pr_interactivedrawprocs">PR_InteractiveDrawProcs<a class="headerlink" href="#artisans-artisan-data-types-pr_interactivedrawprocs" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>PR_Draw_MoveToFunc</code></td>
<td><pre lang="cpp">PR_Draw_MoveToFunc(<br/>  short  x,<br/>  short  y);</pre></td>
</tr>
<tr>
<td><code>PR_Draw_LineToFunc</code></td>
<td><pre lang="cpp">PR_Draw_LineToFunc(<br/>  short  x,<br/>  short  y);</pre></td>
</tr>
<tr>
<td><code>PR_Draw_ForeColorFunc</code></td>
<td><pre lang="cpp">PR_Draw_ForeColorFunc(<br/>  const A_Color  *fore_colo</pre></td>
</tr>
<tr>
<td><code>PR_Draw_FrameRectFunc</code></td>
<td><pre lang="cpp">PR_Draw_FrameRectFunc(<br/>  const A_Rect  *rectPR );</pre></td>
</tr>
<tr>
<td><code>PR_Draw_PaintRectFunc</code></td>
<td><pre lang="cpp">PR_Draw_PaintRectFunc(<br/>  const A_Rect  *rectPR );</pre></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="artisans-artisan-data-types-notes-on-query-time-functions">Notes On Query Time Functions<a class="headerlink" href="#artisans-artisan-data-types-notes-on-query-time-functions" title="Permanent link">&para;</a></h2>
<p><code>AEGP_QueryXformGetTransformTime()</code> and <code>AEGP_QueryXformGetViewTime()</code> are both necessary for an artisan to build a representation of the scene to render.</p>
<p><code>AEGP_QueryXformGetTransformTime()</code> gets the time of the transform, which is then passed to <code>AEGP_GetCompShutterFrameRange()</code> from <a href="#aegps-aegp-suites-aegp_compsuite11">AEGP_CompSuite11</a>.</p>
<p><code>AEGP_QueryXformGetViewTime()</code> gets the time of the view, which is used in calling <code>AEGP_GetLayerToWorldXformFromView()</code> from <a href="#aegps-aegp-suites-aegp_layersuite9">AEGP_LayerSuite9</a>.</p></section><h1 class='nav-section-title-end'>Ended: Artisans</h1>
                        <h1 class='nav-section-title' id='section-aeios'>
                            AEIOs <a class='headerlink' href='#section-aeios' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="aeios-aeios"><h1 id="aeios-aeios-aeios">AEIOs<a class="headerlink" href="#aeios-aeios-aeios" title="Permanent link">&para;</a></h1>
<p>AEIOs are AEGPs that perform media file import and/or export. AEIOs do everything for a file of a given type that After Effects (or the plug-ins which ship with After Effects) would normally do. On the import side, AEIOs can open existing files, manage file-specific interpretation options, and provide audio and frames from the file to After Effects in AEGP_SoundWorld and PF_EffectWorld format. Additionally, AEIOs can create files interactively, asking users for the settings they'd like instead of reading them from a file. On the export side, AEIOs can create and manage output options for render queue items, create output files and save frames (provided by After Effects as PF_EffectWorlds) into those files.</p>
<p>AEIOs work with uncompressed video with pixels in ARGB order from low to high-byte. Pixels can be 8-bit, 16-bit, or 32-bit float per channel. AEIOs must handle their own compression/decompression of any codecs supported.</p>
<hr />
<h2 id="aeios-aeios-aeio-or-aegp">AEIO, or AEGP?<a class="headerlink" href="#aeios-aeios-aeio-or-aegp" title="Permanent link">&para;</a></h2>
<p>AEIOs provide pixels and audio data to After Effects.</p>
<p>If you're writing an importer/exporter for a file format that represents timeline or project format (referencing file formats supported by After Effects or other installed AEIOs), write an AEGP and add its command to the Import/Export submenu.</p>
<hr />
<h2 id="aeios-aeios-aeio-for-import-or-mediacore-importer">AEIO For Import, Or MediaCore Importer?<a class="headerlink" href="#aeios-aeios-aeio-for-import-or-mediacore-importer" title="Permanent link">&para;</a></h2>
<p>After Effects supports MediaCore importer plug-ins. MediaCore is a set of shared libraries that grew out of Premiere Pro; thus the MediaCore APIs are described in the <a href="http://ppro-plugin-sdk.aenhancers.com/">Premiere Pro SDK</a>.</p>
<p>Only MediaCore importer plug-ins support an importer priority system: The highest priority importer gets the first opportunity to import a file, and if the particular imported file isn't supported, the next-highest priority importer will then have the opportunity to try importing it, and so on. MediaCore importers cannot defer file import to an AEIO. So if your goal is to take over file handling for any file type for which After Effects already provides a plug-in, you need to develop a MediaCore importer plug-in.</p>
<p>If the above constraints haven't already answered whether you need to build an AEIO or MediaCore importer, then you'll likely want to build a MediaCore importer, which can be used across the video and audio applications including Premiere Pro, Media Encoder, Prelude, SpeedGrade, and Audition.</p>
<hr />
<h2 id="aeios-aeios-how-it-works">How It Works<a class="headerlink" href="#aeios-aeios-how-it-works" title="Permanent link">&para;</a></h2>
<p>From within its entry point function, an AEIO populates a structure of function pointers with the names of the functions it wants called in response to certain events. Many of these function hooks are optional.</p>
<hr />
<h2 id="aeios-aeios-what-would-after-effects-do">What Would After Effects Do?<a class="headerlink" href="#aeios-aeios-what-would-after-effects-do" title="Permanent link">&para;</a></h2>
<p>For many AEIO hook functions, you can ask After Effects to perform default processing (this capability is noted in each hook's descriptions).</p>
<p>Unless you have compelling reasons to do otherwise, return <code>AEIO_Err_USE_DFLT_CALLBACK</code> from the function, and let After Effects do the work.</p>
<p>This is also a good way to learn the calling sequence before beginning implementation.</p>
<hr />
<h2 id="aeios-aeios-registering-your-aeio">Registering Your AEIO<a class="headerlink" href="#aeios-aeios-registering-your-aeio" title="Permanent link">&para;</a></h2>
<p>During your plug-in's entry point function, populate a AEIO_ModuleInfo describing the filetype(s) the AEIO supports, and an AEIO_FunctionBlock structure that points to your file handling functions. For some of these functions, you can rely on After Effects' default behavior by returning AEIO_Err_USE_DFLT_CALLBACK. However, you must still provide a function matching the required signature, that does so. Once you've filled out both these structures, call <code>AEGP_RegisterIO()</code> from <a href="#aegps-aegp-suites-aegp_registersuites5">AEGP_RegisterSuites5</a>.</p>
<p>In the AEIO_ModuleInfo that you pass in to the register call, you provide the file type and description information that After Effects uses in the Import dialog, for the "Files of type" drop-down on Windows, or the Enable drop-down on MacOS. As of CS6, file extensions cannot be more than three characters long, even though we have a few built-in importers with longer extensions.</p>
<hr />
<h2 id="aeios-aeios-inspec-outspec">InSpec, OutSpec<a class="headerlink" href="#aeios-aeios-inspec-outspec" title="Permanent link">&para;</a></h2>
<p>On most import-related functions, an <code>AEIO_InSpecH</code> is passed. On most output-related functions, an <code>AEIO_OutSpecH</code> is passed.</p>
<p>What are these mysterious handles? These opaque data handles can be used with <a href="#aeios-new-kids-on-the-function-block-aegp_ioinsuite5">AEGP_IOInSuite5</a> and <a href="#aeios-new-kids-on-the-function-block-aegpiooutsuite4">AEGPIOOutSuite4</a>, to set or query for information about the import or output.</p>
<p>For example, on an import, you'll use <code>AEIO_InSpecH</code> when calling <code>AEGP_SetInSpecDimensions</code> in AEGP_IOInSuite.</p>
<p>And during an export, you'll use <code>AEIO_OutSpecH</code> when calling <code>AEGP_GetOutSpecDimensions</code> in <code>AEGP_IOOutSuite</code>. So use these handles to exchange information with After Effects about the details of the input or output.</p></section><section class="print-page" id="aeios-calling-sequence"><h1 id="aeios-calling-sequence-calling-sequence">Calling Sequence<a class="headerlink" href="#aeios-calling-sequence-calling-sequence" title="Permanent link">&para;</a></h1>
<p>As with all AEGPs, the entry point function exported in the plug-in's PiPL is called during launch. During this function, the AEIO must provide function pointers to required functions and describe their capabilities, then pass the appropriate structures to <a href="#aegps-aegp-suites-aegp_registersuites5">AEGP_RegisterIO()</a>.</p>
<hr />
<h2 id="aeios-calling-sequence-import">Import<a class="headerlink" href="#aeios-calling-sequence-import" title="Permanent link">&para;</a></h2>
<p>When users select a file in the file import dialog which is of a type handled by your AEIO, its <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_VerifyFileImportable()</a> function will be called; it's called again for each such file the user imports. <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_InitInSpecFromFile()</a> will be called for each file; parse the file, and use the various set functions to describe it to After Effects. Also, construct any options data associated with the file, and save that data using <a href="#aeios-new-kids-on-the-function-block-aegp_ioinsuite5">AEGP_SetInSpecOptionsHandle()</a>.</p>
<p>After Effects then calls the plug-in's <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_GetInSpecInfo()</a> function, to get descriptive text about the file for display in the project window. As noted in the description of this function, it may be called for folders as well; we recommend that, if there is no valid options data for the file, you do nothing and return no error (that's what our AEIOs do).</p>
<p><a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_CountUserData()</a> is then sent; if the AEIO indicates that there is user data present, <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_GetUserData()</a> will follow. After Effects will then request that the plug-in draw a frame of video (for the project window thumbnail) by sending <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_DrawSparseFrame()</a>.</p>
<p>Once the supported file is added to a composition, user interaction will generate calls to <code>AEIO_DrawSparseFrame()</code> and <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_GetSound()</a>.</p>
<p>When the project is saved, and if there is options data associated with the AEIO_InSpec, After Effects will send <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_FlattenOptions()</a> during which the AEIO parses the options data, and creates a representation of it that contains no references to external memory. Likewise, the presence of any AEIO_OutSpec options data will result in <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_GetFlatOutputOptions()</a> being sent.</p>
<hr />
<h2 id="aeios-calling-sequence-export">Export<a class="headerlink" href="#aeios-calling-sequence-export" title="Permanent link">&para;</a></h2>
<p>If the user adds an item to the render queue and chooses the AEIO's supported output format, <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_InitOutputSpec()</a> will be sent. Use the various get functions to obtain information about the output settings, and store any pertinent information using <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEGP_SetOutSpecOptionsHandle()</a>, followed by <code>AEIO_GetFlatOutputOptions()</code>. <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_GetDepths()</a> is sent so After Effects can determine what output pixel bit depths the AEIO supports. <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_GetOutputInfo()</a> is sent so that file name, type and subtype information can be displayed in the output module details.</p>
<p>When the user clicks on the Format Options button, in the render queue, <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_UserOptionsDialog()</a> is called.</p>
<p>When the user actually clicks on the "Render" button, <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_SetOutputFile()</a> will be called, followed by <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_GetSizes()</a> (your AEIO is responsible for determining whether the destination has sufficient disk space available).</p>
<p>Before the video frames are sent, <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_StartAdding()</a> is sent for the AEIO to open the file handle and write out the file header. If the AEIO supports a video or audio format, <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_AddSoundChunk()</a> is sent for each audio chunk, and an <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_AddFrame()</a> for each video frame.</p>
<p>If the AEIO supports sequences of still images, <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_OutputFrame()</a> is called repeatedly. After Effects sends a PF_EffectWorld representation of the frame to be output.</p>
<p><a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_WriteLabels()</a> is called (for each frame) to give the plug-in a chance to write out field and alpha interpretation information. <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_EndAdding()</a> is sent when there are no more frames (or audio) to be output. Close the output file.</p></section><section class="print-page" id="aeios-aeio_moduleinfo"><h1 id="aeios-aeio_moduleinfo-aeio_moduleinfo">AEIO_ModuleInfo<a class="headerlink" href="#aeios-aeio_moduleinfo-aeio_moduleinfo" title="Permanent link">&para;</a></h1>
<p>This is the structure where your AEIO will define its basic properties.</p>
<p>Notice that, in addition to describing the filetypes and extensions supported by your AEIO, you also describe your signature and behavior using the AEIO_ModuleFlags. We love flags.</p>
<hr />
<h2 id="aeios-aeio_moduleinfo-aeio_moduleinfo-members">AEIO_ModuleInfo Members<a class="headerlink" href="#aeios-aeio_moduleinfo-aeio_moduleinfo-members" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Member</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>sig</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A long, uniquely identifying your plug-in.</p>
<p>Many developers prefer to use a decidedly Mac-ish four character code here.</p>
<p>Please <a href="mailto:zlam@adobe.com">let us know</a> what sig you're using.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>name</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Descriptive name for your AEIO plug-in.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>flags</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set of <code>AEIO_ModuleFlags</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>flags2</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set of <code>AEIO_ModuleFlags2</code>.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>max_width</code>, <code>max_height</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The maximum dimensions supported by your format.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>num_filetypes</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The number of filetypes supported by your AEIO.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>num_extensions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The number of file extensions supported by your AEIO.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>num_clips</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The number of clipboard formats supported by your AEIO.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>create_kind</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The macOS four character code for files created by your AEIO.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>create_ext</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The file extension for files created by your AEIO.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>read_kinds</code></p>
</td>
<td colspan="1" rowspan="1">
<p>This array of 16 <code>AEIO_FileKinds</code> need not be entirely filled out, but the first <code>[num_filetypes + num_extensions + num_clips]</code> ones must be populated, in that order.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>num_aux_extensions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The number of auxiliary extensions supported by your AEIO.</p>
<p>Say, for example, that you're writing an AEIO to import information from a 3D program that saves scene information into a .123 file, and camera information into a .xyz file.</p>
<p>The .xyz would be an auxiliary extension; it's not necessary to get the rest of the scene information, but it's associated with the .123 files.</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>aux_ext</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The file extension of the auxiliary filetype(s) supported by your AEIO.</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aeios-aeio_moduleinfo-behavior-flags">Behavior Flags<a class="headerlink" href="#aeios-aeio_moduleinfo-behavior-flags" title="Permanent link">&para;</a></h2>
<p>AEIOs set these flags (like effect plug-ins use global outflags) in AEIO_ModuleInfo.flags to indicate their behavior to After Effects. Some flags are only relevant to input, and some are only relevant to output.</p>
<h3 id="aeios-aeio_moduleinfo-aeio_moduleflags">AEIO_ModuleFlags<a class="headerlink" href="#aeios-aeio_moduleinfo-aeio_moduleflags" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Flag</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
<th colspan="1" rowspan="1">
<p>I or O?</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_INPUT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>AEIO is an input module.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input!</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_OUTPUT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>AEIO is an output module (one plug-in can be both).</p>
</td>
<td colspan="1" rowspan="1">
<p>Output!</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_FILE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Each clip imported directly corresponds to a file, somewhere.</p>
</td>
<td colspan="1" rowspan="1">
<p>Both</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_STILL</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Supports still images, not video.</p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_VIDEO</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Supports video images, not stills.</p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_AUDIO</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Supports audio.</p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_NO_TIME</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Time information isn't part of the file format.</p>
<p>This would be the case with numbered stills, with individual frames imported based on the composition's time settings.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_INTERACTIVE_GET</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A new input sequence necessitates user interaction.</p>
<p>This would be the case for a non-file-based input module.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_INTERACTIVE_PUT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>A new output sequence necessitates user interaction.</p>
<p>This would be the case for a non-file-based output module.</p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_CANT_CLIP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO's drawing functions cannot accept dimensions smaller than the requested dimensions.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_MUST_INTERACT_PUT</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO must display a dialog box, even if a valid options data handle is available.</p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_CANT_SOUND_INTERLEAVE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO requires that all video data be processed, then sound data (instead of interleaving the processing the video and audio).</p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_CAN_ADD_FRAMES_NON_LINEAR</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO supports adding non-sequential frames.</p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_HOST_DEPTH_DIALOG</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO wants After Effects to display a bit-depth selection dialog.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_HOST_FRAME_START_DIALOG</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO wants After Effects to display a dialog requesting that the user specify a starting frame.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_NO_OPTIONS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO does not accept output options.</p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_NO_PIXELS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO's file format doesn't actually store pixels. Currently unused as of CS6.</p>
</td>
<td colspan="1" rowspan="1">
<p>(unused)</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_SEQUENCE_OPTIONS_OK</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO will adopt the sequence options of its parent if a folder is selected.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_INPUT_OPTIONS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO has user options associated with each input sequence.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The options information must be flat (not referring to any data contained in external pointers or handles).</p>
</div>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_HSF_AWARE</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO will provide horizontal scaling factor (pixel aspect ratio) information for each new sequence.</p>
<p>This prevents After Effects from guessing.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_HAS_LAYERS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO supports multiple layers in a single document.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_SCRAP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO has a clipboard parsing component.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_NO_UI</code></p>
</td>
<td colspan="1" rowspan="1">
<p>After Effects should display no UI for this module</p>
<p>(do not combine this flag with <code>AEIO_MFlag_HOST_DEPTH_DIALOG</code> or <code>AEIO_MFlag_HOST_FRAME_START_DIALOG</code>)</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_SEQ_OPTIONS_DLG</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO has sequence options accessible from the More Options button in the Interpret Footage dialog.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_HAS_AUX_DATA</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The file format supported by the AEIO has depth information, normals, or some other non-color information related to each pixel.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_HAS_META_DATA</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The file format supported by the AEIO supports user-definable metadata.</p>
<p>If this flag is set, the embed pop-up in the output module dialog will be enabled.</p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_CAN_DO_MARKERS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The file format support by the AEIO supports markers, url flips, and/or chapters.</p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_CAN_DRAW_DEEP</code></p>
</td>
<td colspan="1" rowspan="1">
<p>The AEIO can draw into 16bpc ("deep") <code>PF_EffectWorlds</code>.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_MFlag_RESERVED4</code>
</p>
</td>
<td colspan="1" rowspan="1">
<p>Special super-secret flag. Doesn't do anything...or does it?
(<em>No, it doesn't.</em>)</p>
</td>
<td colspan="1" rowspan="1">
<p>???
</p>
</td>
</tr>
</tbody>
</table>
<h3 id="aeios-aeio_moduleinfo-aeio_moduleflags2">AEIO_ModuleFlags2<a class="headerlink" href="#aeios-aeio_moduleinfo-aeio_moduleflags2" title="Permanent link">&para;</a></h3>
<p>Gotta have dem flags...</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Purpose</th>
<th>I or O?</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AEIO_MFlag2_AUDIO_OPTIONS</code></td>
<td>The AEIO has an audio options dialog.</td>
<td>Output</td>
</tr>
<tr>
<td><code>AEIO_MFlag2_SEND_ADDMARKER_BEFORE_ADDFRAME</code></td>
<td>The AEIO wants to receive marker data before outputting video or audio (useful for MPEG streams).</td>
<td>Output</td>
</tr>
<tr>
<td><code>AEIO_MFlag2_CAN_DO_MARKERS_2</code></td>
<td>The AEIO supports combined markers; URL flips, chapters, and comments.</td>
<td>Output</td>
</tr>
<tr>
<td><code>AEIO_MFlag2_CAN_DRAW_FLOAT</code></td>
<td>The AEIO can draw into float (32-bpc) worlds.</td>
<td>Input</td>
</tr>
<tr>
<td><code>AEIO_MFlag2_CAN_DO_AUDIO_32</code></td>
<td>Supports 32-bit audio output.</td>
<td>Output</td>
</tr>
<tr>
<td><code>AEIO_MFlag2_SUPPORTS_ICC_PROFILES</code></td>
<td>Supports ICC profiles.</td>
<td>Both</td>
</tr>
<tr>
<td><code>AEIO_MFlag2_CAN_DO_MARKERS_3</code></td>
<td>The AEIO supports combined markers; URL flips, chapters, comments, and cue points.</td>
<td>Output</td>
</tr>
<tr>
<td><code>AEIO_MFlag2_SEND_ADDMARKER_BEFORE_STARTADDING</code></td>
<td>The AEIO wants to process markers before video during export.</td>
<td>Output</td>
</tr>
<tr>
<td><code>AEIO_MFlag2_USES_QUICKTIME</code></td>
<td>On MacOS, prior to the host calling <code>AEIO_AddFrame</code> or <code>AEIO_OutputFrame</code> from <a href="#aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_FunctionBlock4</a>, it will lock the global QuickTime mutex.</td>
<td>Output</td>
</tr>
</tbody>
</table></section><section class="print-page" id="aeios-new-kids-on-the-function-block"><h1 id="aeios-new-kids-on-the-function-block-new-kids-on-the-function-block">New Kids On The Function Block<a class="headerlink" href="#aeios-new-kids-on-the-function-block-new-kids-on-the-function-block" title="Permanent link">&para;</a></h1>
<p>During its main entry point function, each AEIO plug-in must fill in an AEIO_FunctionBlock, providing pointers to the functions After Effects will call for different file-related tasks.</p>
<p>The table below shows which functions are needed for input, and which ones are needed for output. For a bare-bones implementation, start with the functions that are noted as "Required" in the right column. You can often invoke "best-case" behavior by having After Effects handle the call for you (by returning <code>AEIO_Err_USE_DFLT_CALLBACK</code>).</p>
<p>For a barebones AEIO for video input only, implement the following functions: <code>AEIO_InitInSpecFromFile</code> or <code>AEIO_InitInSpecInteractive</code> (depending on whether the source is a file or interactively generated), <code>AEIO_DisposeInSpec</code>, <code>AEIO_GetInSpecInfo</code>, <code>AEIO_DrawSparseFrame</code>, <code>AEIO_CloseSourceFiles</code>, and <code>AEIO_InqNextFrameTime</code> (using <code>AEIO_Err_USE_DFLT_CALLBACK</code> is fine).</p>
<p>Starting from the IO sample, it is best to leave the other functions defined too, and fill them in further as needed.</p>
<hr />
<h2 id="aeios-new-kids-on-the-function-block-aeio_functionblock4">AEIO_FunctionBlock4<a class="headerlink" href="#aeios-new-kids-on-the-function-block-aeio_functionblock4" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Response</p>
</th>
<th colspan="1" rowspan="1">
<p>I or O?</p>
</th>
<th colspan="1" rowspan="1">
<p>Required?</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_InitInSpecFromFile</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Given a file path, describe its contents to After Effects in the provided <code>AEIO_InSpecH</code>.
Use all appropriate "set" calls from the <a href="#aeios-new-kids-on-the-function-block-aegp_ioinsuite5">AEGP_IOInSuite</a> to do so; if there is image data, set its depth, dimensions, and alpha interpretation.
If there is audio, describe its channels and sample rate.</p>
<p>The file path is a NULL-terminated UTF-16 string with platform separators.</p>
<p><pre lang="cpp">AEIO_InitInSpecFromFile(<br/>  AEIO_BasicData     *basic_dataP,<br/>  const A_UTF16Char  *file_pathZ,<br/>  AEIO_InSpecH       inH);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes, for file-based media</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_InitInSpecInteractive</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Using some form of user interaction (and not a file path provided by After Effects), describe the audio and video your generated AEIO_InSpecH contains.</p>
<p><pre lang="cpp">AEIO_InitInSpecInteractive(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes, for interactiv ely generated media</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_DisposeInSpec</code>
</p>
</td>
<td colspan="1" rowspan="1">
<p>Free an <code>AEIO_InSpecH</code>.
<pre lang="cpp">AEIO_DisposeInSpec(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input
</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes
</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_FlattenOptions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>For the given <code>AEIO_InSpecH</code>, return a flattened version of the data contained in its options handle.</p>
<p>Obtain the unflattened options handle using <code>AEGP_GetInSpecOptionsHandle</code>.</p>
<p><pre lang="cpp">AEIO_FlattenOptions(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH,<br/>  AEIO_Handle     *flat_optionsPH);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_InflateOptions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>For the given <code>AEIO_InSpecH</code>, create (using <code>AEGP_SetInSpecOptionsHandle</code>) an unflattened version of its flattened option data.</p>
<p><pre lang="cpp">AEIO_InflateOptions(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH,<br/>  AEIO_Handle     flat_optionsH);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_SynchInSpec</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEIO_Err_USE_DFLT_CALLBACK</code> allowed. Inspect the <code>AEIO_InSpecH</code>, (update its options if necessary), and indicate whether or not you made changes.</p>
<p><pre lang="cpp">AEIO_SynchInSpec(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH,<br/>  A_Boolean       *changed0);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetActiveExtent</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEIO_Err_USE_DFLT_CALLBACK</code> allowed. Populate the provided <code>A_LRect</code> with the active extent of the file's pixels at the given time.</p>
<p><pre lang="cpp">AEIO_GetActiveExtent(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH,<br/>  const A_Time    *tr,<br/>  A_LRect         *extent);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetInSpecInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Provide a few strings in <code>AEIO_Verbiage</code> to describe the file, which will appear in the Project panel. This includes the strings used to describe the file type and subtype (the codec).</p>
<p><pre lang="cpp">AEIO_GetInSpecInfo(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH,<br/>  AEIO_Verbiage   *verbiageP);</pre></p>
<p>This function gets called OFTEN; every time we refresh the project panel. Keep allocations to a minimum.</p>
<p>In the AEIOs that ship with After Effects, we check for a valid <code>optionsH</code> (using <code>AEGP_GetInSpecOptionsHandle</code>); if we find one, we use the information from within it. If not, we do nothing.</p>
<p>This is important; if your AEIO handles still images, this function <em>will</em> get called for the folder containing the stills. Hopefully, there won't be an optionsH associated with it (unless you're writing a truly bizarre AEIO).</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_DrawSparseFrame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Draw a frame from the <code>AEIO_InSpecH</code>.</p>
<p>The <code>PF_EffectWorld*</code> contains the width and height to use, but make sure you take the required_region0 into account, if it's not <code>NULL</code>.</p>
<p><pre lang="cpp">AEIO_DrawSparseFrame(<br/>  AEIO_BasicData            *basic_dataP,<br/>  AEIO_InSpecH              inH,<br/>  AEIO_Quality              qual,<br/>  const AEIO_RationalScale  *rs0,<br/>  const A_Time              *tr,<br/>  const A_Time              *duration0,<br/>  const A_Rect               *required_region0,<br/>  PF_EffectWorld            *wP,<br/>  A_long<em>                   originx,<br/>  A_long</em>                   originy,<br/>  AEIO_DrawingFlags         *draw_flagsP);</pre></p>
<p>NOTE: return data as linear light (1.0), and After Effects will perform any necessary transformations to bring the footage into the working colorspace.</p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetDimensions</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEIO_Err_USE_DFLT_CALLBACK</code> allowed. Provide the dimensions (and, if necessary, scaling factor) of the video in the AEIO_InSpecH.</p>
<p><pre lang="cpp">AEIO_GetDimensions(<br/>  AEIO_BasicData            *basic_dataP,<br/>  AEIO_InSpecH              inH,<br/>  const AEIO_RationalScale  *rs0,<br/>  A_long                    *width0,<br/>  A_long                    *height0);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEIO_Err_USE_DFLT_CALLBACK</code> allowed. Provide the duration of an <code>AEIO_InSpecH</code>, in seconds.</p>
<p><pre lang="cpp">AEIO_GetDuration(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH,<br/>  A_Time          *trP);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEIO_Err_USE_DFLT_CALLBACK</code> allowed. Provide the timebase of an <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEIO_GetTime(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH,<br/>  A_Time          *tr);</pre></p>
<p>Here are the values we use internally for common timebases:</p>
<ul>
<li>29.97 fps: <code>scale = 100; value= 2997;</code></li>
<li>59.94 fps: <code>scale = 50; value = 2997;</code></li>
<li>23.976 fps: <code>scale = 125; value = 2997;</code></li>
<li>30 fps: <code>scale = 1; value = 30;</code></li>
<li>25 fps: <code>scale = 1; value = 25;</code></li>
</ul>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetSound</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEIO_Err_USE_DFLT_CALLBACK</code> allowed. Provide sound from an <code>AEIO_InSpecH</code>, at the quality described.</p>
<p><pre lang="cpp">AEIO_GetSound(<br/>  AEIO_BasicData             *basic_dataP,<br/>  AEIO_InSpecH               inH,<br/>  AEIO_SndQuality            quality,<br/>  const AEIO_InterruptFuncs  *interrupt_funcsP0,<br/>  const A_Time               *startPT,<br/>  const A_Time               *durPT,<br/>  A_u_long                   start_sampLu,<br/>  A_u_long                   num_samplesLu,<br/>  void                       *dataPV);</pre></p>
<p><code>AEIO_SndQuality</code> may be:</p>
<ul>
<li><code>AEIO_SndQuality_APPROX</code>, (this quality is used to draw the audio waveform)</li>
<li><code>AEIO_SndQuality_LO</code>,</li>
<li><code>AEIO_SndQuality_HI</code></li>
</ul>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_InqNextFrameTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEIO_Err_USE_DFLT_CALLBACK</code> allowed.</p>
<p>Provide the time of the next frame (in the source footage's timebase) within the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEIO_InqNextFrameTime(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH,<br/>  const A_Time    *base_time_tr,<br/>  AEIO_TimeDir    time_dir,<br/>  A_Boolean       *found0,<br/>  A_Time          *key_time_tr0);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_InitOutputSpec</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEIO_Err_USE_DFLT_CALLBACK</code> allowed.</p>
<p>Perform any initialization necessary for a new <code>AEIO_OutSpecH</code>, and indicate whether you made changes.</p>
<p><pre lang="cpp">AEIO_InitOutputSpec(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH,<br/>  A_Boolean       *user_interacted);</pre></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The first time your AEIO is used, After Effects caches the last-known-good <code>optionsH</code> in its preferences.</p>
</div>
<p>When testing this function, <a href="#intro-debugging-plug-ins-deleting-preferences">delete your preferences</a> often.</p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetFlatOutputOptions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Describe (in an <code>AEIO_Handle</code>) the output options for an <code>AEIO_OutSpecH</code>, in a disk-safe flat data structure (one that does not reference external memory).</p>
<p>Note that your output options must be cross-platform, so pay attention to byte ordering issues.</p>
<p><pre lang="cpp">AEIO_GetFlatOutputOptions(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH,<br/>  AEIO_Handle     *optionsH);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_DisposeOutputOptions</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEIO_Err_USE_DFLT_CALLBACK</code> allowed. Free the memory for the output options passed in.</p>
<p><pre lang="cpp">AEIO_DisposeOutputOptions(<br/>  AEIO_BasicData  *basic_dataP,<br/>  void            *optionsPV);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_UserOptionsDialog</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Display an output settings dialog (select TIFF output within After Effects to see when this dialog will occur).</p>
<p>Store this information in an options handle using <code>AEGP_SetInSpecOptionsHandle</code>.</p>
<p><pre lang="cpp">AEIO_UserOptionsDialog(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH,<br/>  PF_EffectWorld  *sample0,<br/>  A_Boolean       *interacted0);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetOutputInfo</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Describe (in text) the output options in an <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEIO_GetOutputInfo(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH,<br/>  AEIO_Verbiage   *verbiage);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_OutputInfoChanged</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Update the <code>AEIO_OutSpecH</code> based on the current settings (using the various Get functions to obtain them).</p>
<p><pre lang="cpp">AEIO_OutputInfoChanged(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_SetOutputFile</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEIO_Err_USE_DFLT_CALLBACK</code> allowed. Set the file path for output of an <code>AEIO_OutSpecH</code>.</p>
<p>Return <code>AEIO_Err_USE_DEFAULT_CALLBACK</code> unless you've changed the path.</p>
<p>The file path is a NULL-terminated UTF-16 string with platform separators.</p>
<p><pre lang="cpp">AEIO_SetOutputFile(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH,<br/>  A_UTF16Char     *file_pathZ);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_StartAdding</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Prepare to add frames to the output file.</p>
<p>This is a good time to create the ouput file(s) on disk, and to write any header information to such files. This is also your first opportunity to allocate pixel buffers based on valid output spec values.</p>
<p><pre lang="cpp">AEIO_StartAdding(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH,<br/>  A_long          flags);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes, for writing formats that support multiple frames</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_AddFrame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Add frame(s) to output file. You may pass a pointer to a function you want called if the user interrupts the render.</p>
<p><pre lang="cpp">AEIO_AddFrame(<br/>  AEIO_BasicData       *basic_dataP,<br/>  AEIO_OutSpecH        outH,<br/>  A_long               frame_index,<br/>  A_long               frames,<br/>  PF_EffectWorld       *wP,<br/>  const A_LPoint       *origin0,<br/>  A_Boolean            was_compressedB,<br/>  AEIO_InterruptFuncs  *inter0);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes, for writing formats that support multiple frames</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_EndAdding</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Perform any clean-up associated with adding frames.</p>
<p><pre lang="cpp">AEIO_EndAdding(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH,<br/>  A_long          flags);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes, for writing formats that support multiple frames</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_OutputFrame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Output a single frame.</p>
<p><pre lang="cpp">AEIO_OutputFrame(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH,<br/>  PF_EffectWorld  *wP);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes, for writing formats that support a single frame</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_WriteLabels</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEIO_Err_USE_DFLT_CALLBACK</code> allowed. Set alpha interpretation and field usage information for the <code>AEIO_OutSpecH</code>.</p>
<p>Indicate in <code>AEIO_LabelFlags</code> which flags you wrote.</p>
<p><pre lang="cpp">AEIO_WriteLabels(<br/>  AEIO_BasicData   *basic_dataP,<br/>  AEIO_OutSpecH    outH,<br/>  AEIO_LabelFlags  *written);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetSizes</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEIO_Err_USE_DFLT_CALLBACK</code> allowed. Provide information about file size and remaining free space on output volume.</p>
<p><pre lang="cpp">AEIO_GetSizes(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH,<br/>  A_u_longlong    *free_space,<br/>  A_u_longlong    *file_size);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_Flush</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Destroy any options or user data associated with the <code>OutSpecH</code>.</p>
<p><pre lang="cpp">AEIO_Flush(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_AddSoundChunk</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Add the given sound to the output file.</p>
<p><pre lang="cpp">AEIO_AddSoundChunk(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH,<br/>  const A_Time    *start,<br/>  AEIO_SndWorldH  swH);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes, for writing formats with audio</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_Idle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Optional. Do something with idle time. <code>AEIO_Err_USE_DFLT_CALLBACK</code> is not supported.</p>
<p><pre lang="cpp">AEIO_Idle(<br/>  AEIO_BasicData        *basic_dataP,<br/>  AEIO_ModuleSignature  sig,<br/>  AEIO_IdleFlags        *idle_flags0);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetDepths</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set <code>AEIO_OptionsFlags</code> to indicate which pixel and color depths are valid for your output format.</p>
<p>See the discussion on <a href="#aeios-implementation-details-implementation-details">Export Bit-Depth</a>.</p>
<p><pre lang="cpp">AEIO_GetDepths(<br/>  AEIO_BasicData     *basic_dataP,<br/>  AEIO_OutSpecH      outH,<br/>  AEIO_OptionsFlags  *which);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetOutputSuffix</code></p>
</td>
<td colspan="1" rowspan="1">
<p><code>AEIO_Err_USE_DFLT_CALLBACK</code> allowed. Describe the three character extension for the output file.</p>
<p><pre lang="cpp">AEIO_GetOutputSuffix(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH,<br/>  A_char          *suffix);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_SeqOptionsDlg</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Display a footage options dialog, and indicate whether the user made any changes.</p>
<p><pre lang="cpp">AEIO_SeqOptionsDlg(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH,<br/>  A_Boolean       *interactedPB);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetNumAuxChannels</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Enumerate the auxiliary (beyond red, green, blue and alpha) channels of data contained in an <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEIO_GetNumAuxChannels(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH,<br/>  A_long          *num_channelsPL);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetAuxChannelDesc</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Describe the data type, name, channel, and dimensionality of an auxiliary data channel.</p>
<p><pre lang="cpp">AEIO_GetAuxChannelDesc(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH,<br/>  long            chan_indexL,<br/>  PF_ChannelDesc  *descP);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_DrawAuxChannel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Draw the auxiliary channel(s) from an <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEIO_DrawAuxChannel(<br/>  AEIO_BasicData          *basic_dataP,<br/>  AEIO_InSpecH            inH,<br/>  A_long                  chan_indexL,<br/>  const AEIO_DrawFramePB  *pbP,<br/>  PF_ChannelChunk         *chunkP);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_FreeAuxChannel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Free data associated with an auxiliary channel.</p>
<p><pre lang="cpp">AEIO_FreeAuxChannel(<br/>  AEIO_BasicData   *basic_dataP,<br/>  AEIO_InSpecH     inH,<br/>  PF_ChannelChunk  *chunkP);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_Num</code> AuxFiles</p>
</td>
<td colspan="1" rowspan="1">
<p>Enumerate the files needed to render the given <code>AEIO_InSpecH</code>.</p>
<p>This function and <code>AEIO_GetNthAuxFileSpec</code> will be called when the user chooses <code>File &gt; Dependencies &gt; Collect Files...</code>. Here your AEIO tells AE what the associated files are.</p>
<p><pre lang="cpp">AEIO_NumAuxFiles(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    seqH,<br/>  A_long          *files_per_framePL);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetNthAuxFileSpec</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieve data from the nth auxiliary file, for the specified frame.</p>
<p>The path is a handle to a NULL-terminated A_UTF16Char string, and must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEIO_GetNthAuxFileSpec(<br/>  AEIO_BasicData *basic_dataP,<br/>  AEIO_InSpecH   seqH,<br/>  A_long         frame_numL,<br/>  A_long         n,<br/>  AEGP_MemHandle *pathPH);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No, if no aux files</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_CloseSourceFiles</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Close (or open, depending upon closeB) the source files for an <code>AEIO_InSpecH</code>.</p>
<p>When the user Collects Files, the AEIO will first be asked to close its source files, then re-open them.</p>
<p><pre lang="cpp">AEIO_CloseSourceFiles(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    seqH,<br/>  A_Boolean       closeB);</pre></p>
<ul>
<li><code>TRUE</code> for close</li>
<li><code>FALSE</code> for open.</li>
</ul>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>Yes</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_CountUserData</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Enumerate the units of user data associated with the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEIO_CountUserData(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH,<br/>  A_u_long        typeLu,<br/>  A_u_long        max_sizeLu,<br/>  A_u_long        *num_of_typePLu);</pre></p>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_SetUserData</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set user data (of the given index and type) for the given <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEIO_SetUserData(<br/>  AEIO_BasicData     *basic_dataP,<br/>  AEIO_OutSpecH      outH,<br/>  A_u_long           typeLu,<br/>  A_u_long           indexLu,<br/>  const AEIO_Handle  dataH);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetUserData</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Describe the user data (at the index and of the type given) associated with the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEIO_GetUserData(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_InSpecH    inH,<br/>  A_u_long        typeLu,<br/>  A_u_long        indexLu,<br/>  A_u_long        max_sizeLu,<br/>  AEIO_Handle     *dataPH);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_AddMarker</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Associate a marker of the specified type, at the specified frame, with the <code>AEIO_OutSpecH</code>.</p>
<p>You may provide an interrupt function to handle user cancellation of this action.</p>
<p><pre lang="cpp">AEIO_AddMarker(<br/>  AEIO_BasicData       *basic_dataP,<br/>  AEIO_OutSpecH        outH,<br/>  A_long               frame_index,<br/>  AEIO_MarkerType      marker_type,<br/>  void                 *marker_dataPV,<br/>  AEIO_InterruptFuncs  *inter0);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_VerifyFileImportable</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Indicate (by setting <code>importablePB</code>) whether or not the plug-in can import the file.</p>
<p>Note that After Effects has already done basic extension checking; you may wish to open the file and determine whether or not it's valid.</p>
<p>This can be a time-consuming process; most AEIOs that ship with After Effects simply return TRUE, and deal with bad files during <code>AEIO_InitInSpecFromFile</code>.</p>
<p>The file path is a NULL-terminated UTF-16 string with platform separators.</p>
<p><pre lang="cpp">AEIO_VerifyFileImportable(<br/>  AEIO_BasicData        *basic_dataP,<br/>  AEIO_ModuleSignature  sig,<br/>  const A_UTF16Char     *file_pathZ,<br/>  A_Boolean             *importablePB);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Input</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_UserAudioOptionsDialog</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Display an audio options dialog.</p>
<p><pre lang="cpp">AEIO_UserAudioOptionsDialog(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH,<br/>  A_Boolean       *interacted0);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_AddMarker3</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Add a marker, with a flag specifying whether or not this is a composition marker.</p>
<p><pre lang="cpp">AEIO_AddMarker3(<br/>  AEIO_BasicData         *basic_dataP,<br/>  AEIO_OutSpecH          outH,<br/>  A_long                 frame_index,<br/>  AEGP_ConstMarkerValP   marker_valP,<br/>  AEIO_RenderMarkerFlag  marker_flag,<br/>  AEIO_InterruptFuncs    *inter0);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEIO_GetMimeType</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Describe the output mime type. This is used for XMP support.</p>
<p><pre lang="cpp">AEIO_GetMimeType(<br/>  AEIO_BasicData  *basic_dataP,<br/>  AEIO_OutSpecH   outH,<br/>  A_long          mime_type_sizeL,<br/>  char            *mime_typeZ);</pre></p>
</td>
<td colspan="1" rowspan="1">
<p>Output</p>
</td>
<td colspan="1" rowspan="1">
<p>No</p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aeios-new-kids-on-the-function-block-what-goes-in">What Goes In<a class="headerlink" href="#aeios-new-kids-on-the-function-block-what-goes-in" title="Permanent link">&para;</a></h2>
<p>These functions manage an input specification, After Effects' internal representation of data gathered from any source.</p>
<p>Any image or audio data in After Effects (except solids) is obtained from an input specification handle, or <code>AEIO_InSpecH</code>.</p>
<h3 id="aeios-new-kids-on-the-function-block-aegp_ioinsuite5">AEGP_IOInSuite5<a class="headerlink" href="#aeios-new-kids-on-the-function-block-aegp_ioinsuite5" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecOptionsHandle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the options data (created by your AEIO) for the given <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetInSpecOptionsHandle(<br/>  AEIO_InSpecH  inH,<br/>  void          *optionsPPV);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecOptionsHandle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the options data for the given <code>AEIO_InSpecH</code>.</p>
<p>Must be allocated using the <a href="#aegps-aegp-suites-aegp_memorysuite1">Memory Suite</a>.</p>
<p><pre lang="cpp">AEGP_SetInSpecOptionsHandle(<br/>  AEIO_InSpecH  inH,<br/>  void          *optionsPV,<br/>  void          *old_optionsPPV);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecFilePath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the file path for the <code>AEIO_InSpecH</code>.</p>
<p>The file path is a handle to a NULL-terminated A_UTF16Char string, and must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p><pre lang="cpp">AEGP_GetInSpecFilePath(<br/>  AEIO_InSpecH    inH,<br/>  AEGP_MemHandle  *file_nameZ);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecNativeFPS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the frame rate of the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetInSpecNativeFPS(<br/>  AEIO_InSpecH  inH,<br/>  A_Fixed       *native_fpsP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecNativeFPS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the frame rate of the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetInSpecNativeFPS(<br/>  AEIO_InSpecH  inH,<br/>  A_Fixed       native_fpsP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecDepth</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the bit depth of the image data in the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetInSpecDepth(<br/>  AEIO_InSpecH  inH,<br/>  A_short       *depthPS);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecDepth</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Indicates to After Effects the bit depth of the image data in the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetInSpecDepth(<br/>  AEIO_InSpecH  inH,<br/>  A_short       depthS);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the size (in bytes) of the data referenced by the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetInSpecSize(<br/>  AEIO_InSpecH   inH,<br/>  AEIO_FileSize  *sizePLLu);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Indicates to After Effects the size (in bytes) of the data referenced by the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetInSpecSize(<br/>  AEIO_InSpecH   inH,<br/>  AEIO_FileSize  sizeL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecInterlaceLabel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves field information for the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetInSpecInterlaceLabel(<br/>  AEIO_InSpecH  inH,<br/>  FIEL_Label    *interlaceP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecInterlaceLabel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Specifies field information for the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetInSpecInterlaceLabel(<br/>  AEIO_InSpecH      inH,<br/>  const FIEL_Label  *interlaceP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecAlphaLabel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves alpha channel interpretation information for the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetInSpecAlphaLabel(<br/>  AEIO_InSpecH     inH,<br/>  AEIO_AlphaLabel  *alphaP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecAlphaLabel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets alpha channel interpretation information for the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetInSpecAlphaLabel(<br/>  AEIO_InSpecH           inH,<br/>  const AEIO_AlphaLabel* alphaP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the duration of the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetInSpecDuration(<br/>  AEIO_InSpecH  inH,<br/>  A_Time        *durationP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the duration of the <code>AEIO_InSpecH</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of 5.5, this must be called, even for frame-based file formats.</p>
<p>If you don't set the <code>A_Time.scale</code> to something other than zero, your file(s) will not import.</p>
<p>This will be fixed in future versions.</p>
</div>
<p><pre lang="cpp">AEGP_SetInSpecDuration(<br/>  AEIO_InSpecH  inH,<br/>  const A_Time  *durationP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecDimensions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the width and height of the image data in the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetInSpecDimensions(<br/>  AEIO_InSpecH  inH,<br/>  A_long        *widthPL0,<br/>  A_long        *heightPL0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecDimensions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Indicates to After Effects the width and height of the image data in the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetInSpecDimensions(<br/>  AEIO_InSpecH  inH,<br/>  A_long        widthL,<br/>  A_long        heightL);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_InSpecGetRational</code> Dimensions</p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the width, height, bounding rect, and scaling factor applied to an <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_InSpecGetRationalDimensions(<br/>  AEIO_InSpecH              inH,<br/>  const AEIO_RationalScale  *rs0,<br/>  A_long                    *width0,<br/>  A_long                    *height0,<br/>  A_Rect                    *r0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecHSF</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the horizontal scaling factor applied to an <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetInSpecHSF(<br/>  AEIO_InSpecH  inH,<br/>  A_Ratio       *hsf);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecHSF</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the horizontal scaling factor of an <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetInSpecHSF(<br/>  AEIO_InSpecH   inH,<br/>  const A_Ratio  *hsf);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecSoundRate</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the sampling rate (in samples per second) for the audio data referenced by the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetInSpecSoundRate(<br/>  AEIO_InSpecH  inH,<br/>  A_FpLong      *ratePF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecSoundRate</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the sampling rate (in samples per second) for the audio data referenced by the <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetInSpecSoundRate(<br/>  AEIO_InSpecH  inH,<br/>  A_FpLong      rateF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecSoundEncoding</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the encoding method (signed PCM, unsigned PCM, or floating point) from an AEIO_InSpecH.</p>
<p><pre lang="cpp">AEGP_GetInSpecSoundEncoding(<br/>  AEIO_InSpecH      inH,<br/>  AEIO_SndEncoding  *encodingP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecSoundEncoding</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the encoding method of an AEIO_InSpecH.</p>
<p><pre lang="cpp">AEGP_SetInSpecSoundEncoding(<br/>  AEIO_InSpecH      inH,<br/>  AEIO_SndEncoding  encoding);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecSoundSampleSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the bytes-per-sample (1,2, or 4) from an <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetInSpecSoundSampleSize(<br/>  AEIO_InSpecH        inH,<br/>  AEIO_SndSampleSize  *bytes_per_smpP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecSoundSampleSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set the bytes per sample of an <code>AEIO_InSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetInSpecSoundSampleSize(<br/>  AEIO_InSpecH        inH,<br/>  AEIO_SndSampleSize  bytes_per_sample);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecSoundChannels</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Determines whether the audio in the <code>AEIO_SndChannels</code> is mono or stereo.</p>
<p><pre lang="cpp">AEGP_GetInSpecSoundChannels(<br/>  AEIO_InSpecH      inH,<br/>  AEIO_SndChannels  *num_channelsP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecSoundChannels</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the audio in an <code>AEIO_SndChannels</code> to mono or stereo.</p>
<p><pre lang="cpp">AEGP_SetInSpecSoundChannels(<br/>  AEIO_InSpecH      inH,<br/>  AEIO_SndChannels  num_channels);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_AddAuxExtMap</code></p>
</td>
<td colspan="1" rowspan="1">
<p>If your file format has auxiliary files which you want to prevent users from opening directly, pass it's extension, file type and creator to this function to keep it from appearing in input dialogs.</p>
<p><pre lang="cpp">AEGP_AddAuxExtMap(<br/>  const A_char  *extension,<br/>  A_long        file_type,<br/>  A_long        creator);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecEmbeddedColorProfile</code></p>
</td>
<td colspan="1" rowspan="1">
<p>In case of RGB data, if there is an embedded icc profile, build an <code>AEGP_ColorProfile</code> out of this icc profile using <code>AEGP_GetNewColorProfileFromICCProfile</code> from <a href="#aegps-aegp-suites-aegp_colorsettingssuite5">AEGP_ColorSettingsSuite5</a> and set the profile description set to NULL.</p>
<p>In case of non-RGB data, if there is an embedded non-RGB icc profile or you know the color space the data is in, set the color profile set to NULL, and provide the description as a NULL-terminated unicode string. Doing this disables color management UI that allows user to affect profile choice in the application UI.</p>
<p>If you are unpacking non-RGB data directly into working space (to get working space use <code>AEGP_GetNewWorkingSpaceColorProfile</code>), you are done.</p>
<p>If you are unpacking non-RGB data into specific RGB color space, you must pass the profile describing this space to <code>AEGP_SetInSpecAssignedColorProfile</code> below. Otherwise, your RGB data will be incorrectly interpreted as being in working space.</p>
<p>Either color profile or profile description should be NULL in this function. You cannot use both.</p>
<p><pre lang="cpp">AEGP_SetInSpecEmbeddedColorProfile(<br/>  AEIO_InSpecH             inH,<br/>  AEGP_ConstColorProfileP  color_profileP0,<br/>  const A_UTF16Char        *profile_descP0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecAssignedColorProfile</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Assign a valid RGB color profile to the footage.</p>
<p><pre lang="cpp">AEGP_SetInSpecAssignedColorProfile(<br/>  AEIO_InSpecH             inH,<br/>  AEGP_ConstColorProfileP  color_profileP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecNativeStartTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Retrieves the native start time of the footage.</p>
<p><pre lang="cpp">AEGP_GetInSpecNativeStartTime(<br/>  AEIO_InSpecH  inH,<br/>  A_Time        *startTimeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecNativeStartTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Assign a native start time to the footage.</p>
<p><pre lang="cpp">AEGP_SetInSpecNativeStartTime(<br/>  AEIO_InSpecH  inH,<br/>  const A_Time  *startTimeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_ClearInSpecNativeStartTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Clear the native start time of the footage.</p>
<p>Setting the native start time to 0 using <code>AEGP_SetInSpecNativeStartTime</code> doesn't do this.</p>
<p>It still means there is a special native start time provided.</p>
<p><pre lang="cpp">AEGP_ClearInSpecNativeStartTime(<br/>  AEIO_InSpecH  inH);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetInSpecNativeDisplayDropFrame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Retrieve the drop-frame setting of the footage.</p>
<p><pre lang="cpp">AEGP_GetInSpecNativeDisplayDropFrame(<br/>  AEIO_InSpecH  inH,<br/>  A_Boolean     *displayDropFrameBP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetInSpecNativeDisplayDropFrame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>New in CC. Assign the drop-frame setting of the footage.</p>
<p><pre lang="cpp">AEGP_SetInSpecNativeDisplayDropFrame(<br/>  AEIO_InSpecH  inH,<br/>  A_Boolean     displayDropFrameB);</pre></p>
</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="aeios-new-kids-on-the-function-block-what-goes-out">What Goes Out<a class="headerlink" href="#aeios-new-kids-on-the-function-block-what-goes-out" title="Permanent link">&para;</a></h2>
<p>These functions manage all interactions with an output specification in After Effects' render queue.</p>
<h3 id="aeios-new-kids-on-the-function-block-aegpiooutsuite4">AEGPIOOutSuite4<a class="headerlink" href="#aeios-new-kids-on-the-function-block-aegpiooutsuite4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th colspan="1" rowspan="1">
<p>Function</p>
</th>
<th colspan="1" rowspan="1">
<p>Purpose</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecOptionsHandle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Retrieves the Options for the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecOptionsHandle(<br/>  AEIO_OutSpecH  outH,<br/>  void           *optionsPPV);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetOutSpecOptionsHandle</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the Options for the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetOutSpecOptionsHandle(<br/>  AEIO_OutSpecH  outH,<br/>  void           *optionsPV,<br/>  void           *old_optionsPPV);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecFilePath</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the path for the <code>AEIO_OutSpecH</code>.</p>
<p>The file path is a handle to a NULL-terminated A_UTF16Char string, and must be disposed with <code>AEGP_FreeMemHandle</code>.</p>
<p>If <code>file_rsrvdPB</code> returns <code>TRUE</code>, the plug-in should not overwrite it (After Effects has already created an empty file); doing so can cause network renders to fail.</p>
<p><pre lang="cpp">AEGP_GetOutSpecFilePath(<br/>  AEIO_OutSpecH   outH,<br/>  AEGP_MemHandle  *unicode_pathPH,<br/>  A_Boolean       *file_rsrvdPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecFPS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the frames per second of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecFPS(<br/>  AEIO_OutSpecH  outH,<br/>  A_Fixed        *native_fpsP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetOutSpecNativeFPS</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the frames per second of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetOutSpecNativeFPS(<br/>  AEIO_OutSpecH  outH,<br/>  A_Fixed        native_fpsP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecDepth</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the pixel bit depth of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecDepth(<br/>  AEIO_OutSpecH  outH,<br/>  A_short        *depthPS);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetOutSpecDepth</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the pixel bit depth of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetOutSpecDepth(<br/>  AEIO_OutSpecH  outH,<br/>  A_short        depthPS);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecInterlaceLabel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains field information for the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecInterlaceLabel(<br/>  AEIO_OutSpecH  outH,<br/>  FIEL_Label     *interlaceP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetOutSpecInterlaceLabel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Set the field information for the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetOutSpecInterlaceLabel(<br/>  AEIO_OutSpecH     outH,<br/>  const FIEL_Label  *interlaceP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecAlphaLabel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains alpha interpretation information for the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecAlphaLabel(<br/>  AEIO_OutSpecH    outH,<br/>  AEIO_AlphaLabel  *alphaP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetOutSpecAlphaLabel</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the alpha interpretation for the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetOutSpecAlphaLabel(<br/>  AEIO_OutSpecH          outH,<br/>  const AEIO_AlphaLabel  *alphaP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the duration of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecDuration(<br/>  AEIO_OutSpecH  outH,<br/>  A_Time         *durationP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetOutSpecDuration</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the duration of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetOutSpecDuration(<br/>  AEIO_OutSpecH  outH,<br/>  const A_Time   *durationP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecDimensions</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the dimensions of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecDimensions(<br/>  AEIO_OutSpecH  outH,<br/>  A_long         *widthPL0,<br/>  A_long         *heightPL0);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecHSF</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the horizontal scaling factor of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecHSF(<br/>  AEIO_OutSpecH  outH,<br/>  A_Ratio        *hsf);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetOutSpecHSF</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the horizontal scaling factor of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetOutSpecHSF(<br/>  AEIO_OutSpecH  outH,<br/>  const A_Ratio  *hsf);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecSoundRate</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the sampling rate for the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecSoundRate(<br/>  AEIO_OutSpecH  outH,<br/>  A_FpLong       *ratePF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetOutSpecSoundRate</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the sampling rate for the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetOutSpecSoundRate(<br/>  AEIO_OutSpecH  outH,<br/>  A_FpLong       rateF);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecSoundEncoding</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the sound encoding format of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecSoundEncoding(<br/>  AEIO_OutSpecH     outH,<br/>  AEIO_SndEncoding  *encodingP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetOutSpecSoundEncoding</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the sound encoding format of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetOutSpecSoundEncoding(<br/>  AEIO_OutSpecH     outH,<br/>  AEIO_SndEncoding  encoding);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecSoundSampleSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the bytes-per-sample of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecSoundSampleSize(<br/>  AEIO_OutSpecH       outH,<br/>  AEIO_SndSampleSize  *bpsP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetOutSpecSoundSampleSize</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the bytes-per-sample of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetOutSpecSoundSampleSize(<br/>  AEIO_OutSpecH       outH,<br/>  AEIO_SndSampleSize  bpsP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecSoundChannels</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the number of sounds channels in the  <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecSoundChannels(<br/>  AEIO_OutSpecH     outH,<br/>  AEIO_SndChannels  *channelsP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_SetOutSpecSoundChannels</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Sets the number of sounds channels in the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_SetOutSpecSoundChannels(<br/>  AEIO_OutSpecH     outH,<br/>  AEIO_SndChannels  channels);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecIsStill</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Determines whether the <code>AEIO_OutSpecH</code> is a still.</p>
<p><pre lang="cpp">AEGP_GetOutSpecIsStill(<br/>  AEIO_OutSpecH  outH,<br/>  A_Boolean      *is_stillPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecPosterTime</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the time of the <code>AEIO_OutSpecH's</code> poster frame.</p>
<p><pre lang="cpp">AEGP_GetOutSpecPosterTime(<br/>  AEIO_OutSpecH  outH,<br/>  A_Time         *poster_timeP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecStartFrame</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the time of the first frame in the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecStartFrame(<br/>  AEIO_OutSpecH  outH,<br/>  A_long         *start_frameP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecPullDown</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Obtains the pulldown phase of the <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecPullDown(<br/>  AEIO_OutSpecH  outH,<br/>  AEIO_Pulldown  *pulldownP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecIsMissing</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Passes back TRUE if there is no <code>AEIO_OutSpecH</code>.</p>
<p><pre lang="cpp">AEGP_GetOutSpecIsMissing(<br/>  AEIO_OutSpecH  outH,<br/>  A_Boolean      *missingPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecShouldEmbedICCProfile</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns TRUE if the AEIO should embed a color profile in the output.</p>
<p><pre lang="cpp">AEGP_GetOutSpecShouldEmbedICCProfile(<br/>  AEIO_OutSpecH  outH,<br/>  A_Boolean      *embedPB);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetNewOutSpecColorProfile</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns an (opaque) ICC color profile for embedding in the AEIO's output.</p>
<p>Must be disposed with <code>AEGP_DisposeColorProfile</code>.</p>
<p><pre lang="cpp">AEGP_GetNewOutSpecColorProfile(<br/>  AEGP_PluginID       aegp_plugin_id,<br/>  AEIO_OutSpecH       outH,<br/>  AEGP_ColorProfileP  *color_profilePP);</pre></p>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<p><code>AEGP_GetOutSpecOutputModule</code></p>
</td>
<td colspan="1" rowspan="1">
<p>Returns the <code>AEGP_RQItemRefH</code> and <code>AEGP_OutputModuleRefH</code> associated with the given <code>AEIO_OutSpecH</code>.</p>
<p>Fails if the render queue item is not found, or if <code>AEIO_OutSpecH</code> is not a confirmed outH and is a copy, i.e. if the Output Module settings dialog is open and the user hasn't hit OK.</p>
<p><pre lang="cpp">AEGP_GetOutSpecOutputModule(<br/>  AEIO_OutSpecH          outH,<br/>  AEGP_RQItemRefH        *rq_itemP,<br/>  AEGP_OutputModuleRefH  *om_refP);</pre></p>
</td>
</tr>
</tbody>
</table></section><section class="print-page" id="aeios-implementation-details"><h1 id="aeios-implementation-details-implementation-details">Implementation Details<a class="headerlink" href="#aeios-implementation-details-implementation-details" title="Permanent link">&para;</a></h1>
<h2 id="aeios-implementation-details-export-bit-depth">Export Bit-Depth<a class="headerlink" href="#aeios-implementation-details-export-bit-depth" title="Permanent link">&para;</a></h2>
<p>In the Output Module Settings, the user can choose a Depth based on the options the AEIO declares support for in <code>AEIO_GetDepths()</code> from <a href="#aeios-new-kids-on-the-function-block-new-kids-on-the-function-block">AEIO_FunctionBlock4</a>.</p>
<p>If a plug-in supports higher bit-depth exports, it should be able to handle these higher bit-depth PF_EffectWorlds passed in <code>AEIO_AddFrame()</code> or <code>AEIO_OutputFrame()</code>, even when the export setting is not set to the same depth.</p>
<p>The frame delivered to the AEIO, and the final output will not necessarily be the same depth.</p>
<p>You may get frames passed in the project bit-depth instead of the final output if After Effects thinks that will be higher quality.</p>
<hr />
<h2 id="aeios-implementation-details-user-data-vs-options">User Data vs. Options<a class="headerlink" href="#aeios-implementation-details-user-data-vs-options" title="Permanent link">&para;</a></h2>
<p>It's possible to use either user data allocations or options handles to store metadata about a file.</p>
<p>We use user data for information that's to be embedded in the file (presuming the file format supports such information); marker data, field labels, etc.</p>
<p>We use option handles for information about the file; output settings, dimensions, details of compression settings used.</p></section><h1 class='nav-section-title-end'>Ended: AEIOs</h1>
                        <h1 class='nav-section-title' id='section-premiere-pro'>
                            Premiere Pro <a class='headerlink' href='#section-premiere-pro' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="ppro-ppro"><h1 id="ppro-ppro-premiere-pro-other-hosts">Premiere Pro &amp; Other Hosts<a class="headerlink" href="#ppro-ppro-premiere-pro-other-hosts" title="Permanent link">&para;</a></h1>
<p>Adobe Premiere Pro and Adobe Premiere Elements both support the After Effects effect API as described in chapters 2, 3, and 5.</p>
<p>They offer a thorough host implementation, some the key omissions being 3D-related calls (auxiliary channel information, cameras and lights), 16-bit and SmartFX support, and other utility functions provided by After Effects' AEGP API.</p>
<p>Both Premiere Pro and Premiere Elements set <code>PF_InData&gt;appl_id</code> to 'PrMr'.</p>
<p>In this chapter, we will describe the AE API support in Premiere Pro, but generally the same support exists in corresponding versions of Premiere Elements.</p>
<p>If you need to distinguish between Premiere Pro and Premiere Elements, you may use the Premiere-specific App Info Suite, available from the <a href="http://ppro-plugin-sdk.aenhancers.com">Premiere Pro SDK</a> headers.</p>
<table>
<thead>
<tr>
<th>Application Versions</th>
<th>PF_InData&gt; version.major</th>
<th>PF_InData&gt; version.minor</th>
</tr>
</thead>
<tbody>
<tr>
<td>Premiere Pro CC through Premiere Pro CC 2019</td>
<td>13</td>
<td>4</td>
</tr>
<tr>
<td>Premiere Pro CS6</td>
<td>13</td>
<td>2</td>
</tr>
<tr>
<td>Premiere Pro CS5.5</td>
<td>13</td>
<td>1</td>
</tr>
<tr>
<td>Premiere Pro CS5, Premiere Elements 9</td>
<td>13</td>
<td>0</td>
</tr>
<tr>
<td>Premiere Pro CS4, Premiere Elements 8</td>
<td>12</td>
<td>5</td>
</tr>
<tr>
<td>Premiere Pro CS3, Premiere Elements 4 and 7</td>
<td>12</td>
<td>4</td>
</tr>
<tr>
<td>Premiere Pro 2.0, Premiere Elements 3</td>
<td>12</td>
<td>3</td>
</tr>
<tr>
<td>Premiere Pro 1.5, Premiere Elements 2</td>
<td>12</td>
<td>2</td>
</tr>
<tr>
<td>Premiere Pro 1.0, Premiere Elements 1</td>
<td>12</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Note that the versioning used by Premiere Pro and Premiere Elements does not mean that they support the same API features After Effects did at the same version. It is simply meant to distinguish from one version to the next.</p></section><section class="print-page" id="ppro-plug-in-installation"><h1 id="ppro-plug-in-installation-plug-in-installation">Plug-in Installation<a class="headerlink" href="#ppro-plug-in-installation-plug-in-installation" title="Permanent link">&para;</a></h1>
<p>Use the common plug-in folder as described here: <a href="#intro-where-installers-should-put-plug-ins">Where Installers Should Put Plug-ins</a>.</p>
<p>If you try to install an effect plug-in only to the Premiere Pro plug-ins directory, you will be surprised to find that your effect is not rendered when you export to disk through Adobe Media Encoder, an entirely separate application.</p>
<p>Oh, and you'll also miss out on project interchange and copy / paste between Premiere Pro and After Effects.</p></section><section class="print-page" id="ppro-basic-host-differences"><h1 id="ppro-basic-host-differences-basic-host-differences">Basic Host Differences<a class="headerlink" href="#ppro-basic-host-differences-basic-host-differences" title="Permanent link">&para;</a></h1>
<p>We've tried to provide robust compatibility for After Effects effect plug-ins in Premiere Pro.</p>
<p>There are underlying differences in the render pipeline that lead to differences, and we realize the API implementation may not be perfect.</p>
<p>Below is an overview of some differences the plug-in will encounter when running in Premiere Pro.</p>
<hr />
<h2 id="ppro-basic-host-differences-time-values">Time Values<a class="headerlink" href="#ppro-basic-host-differences-time-values" title="Permanent link">&para;</a></h2>
<p>Premiere Pro uses slightly different time values in PF_InData. For example in CS4:</p>
<p>Rendering in NTSC, time_scale is 60000, time_step is 1001, field gives field order (in After Effects, for field rendering, scale is 2997, step is 50, or for progressive rendering, scale is 2997, step is 100).</p>
<p>Rendering in PAL, time_scale is 50, time_step is 1, field gives field order (in After Effects, for field rendering, scale is 3200, step is 64, or for progressive rendering, scale is 3200, step is 128).</p>
<p>It's the ratio of time-related values that produces the time value, not specifically the time_scale value. It's possible Premiere Pro will use different time_scales in the future, so please don't hard code. Just be aware that it does not necessarily use the exact same values as After Effects.</p>
<hr />
<h2 id="ppro-basic-host-differences-rendering-frames">Rendering Frames<a class="headerlink" href="#ppro-basic-host-differences-rendering-frames" title="Permanent link">&para;</a></h2>
<p>Premiere is optimized for responsive editing. When scrubbing in the timeline, and changing effect parameters, Premiere will immediately request a low-quality render for immediate display, followed by a high-quality render. So the effect may receive two requests for the same effective time, one at a low resolution, low bit-depth, followed by one at full-resolution, full bit-depth. The resolution requested for each render with take into account the Playback and Paused Resolution set in the Source and Program Monitors: The first request will be at the Playback Resolution, and the second request will be at the Paused Resolution.</p>
<p>Premiere will also perform speculative rendering, to render a set of frames ahead in the timeline, so that if/when the editor starts playback, the initial frames will be ready. This means that when repositioning the time needle, or when changing effect parameters, Premiere will ask the effect to render a set of frames ahead of the current time. If the frames have previously been rendered and cached, the effect will not see these render requests because the cached frames will be used.</p>
<p>When rendering frames in Premiere-native pixel formats, Premiere will send PF_Cmd_RENDER once for each field, rather than for each frame. The <code>PF_InData-&gt;field</code> will indicate which field is being rendered, the <code>PF_LayerDef-&gt;height</code> will be half of the frame height, and the <code>PF_LayerDef-&gt;rowbytes</code> will be double the normal value.</p>
<hr />
<h2 id="ppro-basic-host-differences-render-order">Render Order<a class="headerlink" href="#ppro-basic-host-differences-render-order" title="Permanent link">&para;</a></h2>
<p>Premiere Pro was built to provide real-time playback of footage with effects wherever possible. The render scheduling is much more aggressive and multithreaded rendering is a basic requirement. This is quite different than After Effects, where users are building layers upon layers of effects and more willing to wait for a RAM preview.</p>
<p>Multithreaded rendering in Premiere applies to AE effects too. When rendering an AE effect, the request from Premiere passes through a critical section which is used for all commands, except those relating to arbitrary data. The critical section prevents two threads from calling the same instance of the effect at the same time. However, Premiere creates multiple instances of the effect, which can be called concurrently from separate threads.</p>
<p>Therefore, an effect should not expect to receive render requests in order of increasing time. Also, effects should not depend on static, non-constant variables.</p>
<hr />
<h2 id="ppro-basic-host-differences-frame-dimensions">Frame Dimensions<a class="headerlink" href="#ppro-basic-host-differences-frame-dimensions" title="Permanent link">&para;</a></h2>
<p>Differences between source footage and the project/composition are handled differently.</p>
<p>For example, in CS4, when importing an NTSC clip in a PAL sequence, <code>PF_InData&gt;width,height</code> are <code>(598,480)</code> and <code>PF_InData-&gt;pixel_aspect_ratio</code> is <code>(768,702)</code>.</p>
<p>In AE, <code>width,height</code> are <code>(720,480)</code> and <code>pixel_aspect_ratio</code> is <code>(10,11)</code>.</p>
<hr />
<h2 id="ppro-basic-host-differences-pf_indata">PF_InData<a class="headerlink" href="#ppro-basic-host-differences-pf_indata" title="Permanent link">&para;</a></h2>
<p>Premiere Pro handles field rendering differently than After Effects. While field rendering, <code>PF_InData&gt;field</code> gives the current field being rendered, ignoring whether or not <code>PF_OutFlag_PIX_INDEPENDENT</code> flag was set.</p>
<p>In Premiere Pro, effects receive the quality setting of the monitor window in <a href="#effect-basics-pf_indata-pf_indata-members">PF_InData&gt;quality</a>. This differs from After Effects, where the source layer's quality setting is provided here.</p>
<hr />
<h2 id="ppro-basic-host-differences-parameter-ui">Parameter UI<a class="headerlink" href="#ppro-basic-host-differences-parameter-ui" title="Permanent link">&para;</a></h2>
<p>Premiere Pro does not honor the <a href="#effect-basics-pf_paramdef-parameter-flags">PF_ParamFlag_START_COLLAPSED</a> flag. Parameters are always initialized with their twirlies collapsed, and cannot be automatically twirled open by parameter supervision.</p>
<p>Premiere Pro supports the macro <code>PF_ADD_FLOAT_EXPONENTIAL_SLIDER()</code>, which lets you define an exponent. Although this macro is newly added for the CC 2015 release 2 SDK, Premiere Pro has used this for some time in the Fast Color Corrector, in the Input Grey Level parameter. The exponent is used so that although the range is from 0.10 to 10, 1.0 is about in the middle of the slider. The exponent we used was 2.5. Typical values would be from 0.01 to 100.</p>
<p>Starting in CC 2015, effects will not be sent <code>PF_Cmd_UPDATE_PARAMS_UI</code> or <code>PF_Event_DRAW</code> when the time needle is moved and there are no keyframes, unless the effect sets <code>PF_OutFlag_NON_PARAM_VARY</code>. Effects such as those that draw histograms in the Effect Controls panel will need to be aware of this optimization.</p>
<hr />
<h2 id="ppro-basic-host-differences-missing-suites">Missing Suites<a class="headerlink" href="#ppro-basic-host-differences-missing-suites" title="Permanent link">&para;</a></h2>
<p>Many suites supported by After Effects are not implemented in the Premiere Pro host. In several cases, even if a suite is missing in Premiere Pro, an equivalent macro function is available. Here are a few examples:</p>
<table>
<thead>
<tr>
<th>After Effects suite call</th>
<th>Premiere Pro equivalent function</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WorldTransformSuite1()-&gt;copy()</code></td>
<td><code>PF_COPY()</code></td>
</tr>
<tr>
<td><code>WorldTransformSuite1()-&gt;convolve()</code></td>
<td><code>in_data-&gt;utils-&gt;convolve()</code></td>
</tr>
<tr>
<td><code>FillMatteSuite2()-&gt;fill()</code></td>
<td><code>PF_FILL()</code></td>
</tr>
<tr>
<td><code>PF_PixelDataSuite1-&gt;get_pixel_data8()</code></td>
<td><code>PF_GET_PIXEL_DATA8()</code></td>
</tr>
</tbody>
</table>
<p>The sample projects demonstrate alternate ways of handling a missing suite, by checking for the host application and version. The Portable sample project demonstrates both host application and version checking.</p>
<hr />
<h2 id="ppro-basic-host-differences-a-special-suite-for-ae-effects-running-in-premiere-pro">A Special Suite for AE Effects Running in Premiere Pro<a class="headerlink" href="#ppro-basic-host-differences-a-special-suite-for-ae-effects-running-in-premiere-pro" title="Permanent link">&para;</a></h2>
<p>No AEGP calls are supported by Premiere Pro. However, there are some interesting parallels in the header PrSDKAESupport.h. For example, you can use the Utility Suite in that header to get the frame rate or field type of the source footage, or to get the speed applied to the clip.</p>
<p>Note that other suites from the Premiere Pro SDK cannot be used in AE effects.</p></section><section class="print-page" id="ppro-multithreading"><h1 id="ppro-multithreading-multithreading">Multithreading<a class="headerlink" href="#ppro-multithreading-multithreading" title="Permanent link">&para;</a></h1>
<p>You may have noticed this flag: <code>PF_OutFlag2_PPRO_DO_NOT_CLONE_SEQUENCE_DATA_FOR_RENDER</code>. We advise against setting this flag, as it has been found to cause parameter UI problems.</p></section><section class="print-page" id="ppro-bigger-differences"><h1 id="ppro-bigger-differences-bigger-differences">Bigger Differences<a class="headerlink" href="#ppro-bigger-differences-bigger-differences" title="Permanent link">&para;</a></h1>
<p>As long as an effect only supports the basic ARGB_8u pixel format supported by After Effects, Premiere Pro will try to imitate the After Effects hosting behavior and hide various differences because of the different render pipeline architecture. But if an effect wants to support additional pixel formats, such as 32-bit RGB, be prepared to handle further divergent behavior.</p>
<hr />
<h2 id="ppro-bigger-differences-pixel-formats">Pixel Formats<a class="headerlink" href="#ppro-bigger-differences-pixel-formats" title="Permanent link">&para;</a></h2>
<p>Premiere Pro provides function suites for declaring support for pixel formats other than the 8-bit RGB format used by After Effects - ARGB_8u. These pixel formats include the Premiere Pro native 8-bit RGB format - BGRA_8u, as well as YUV, 32-bit formats, and more. For a more detailed discussion of the various pixel formats, see <a href="http://ppro-plugin-sdk.aenhancers.com/universals/pixel-formats-and-color-spaces.html">"Pixel Formats and Colorspaces" from the Premiere Pro SDK Guide</a>.</p>
<p>Use the PF Pixel Format Suite (defined in PrAESDKSupport.h) to register for <a href="#effect-basics-pf_effectworld">PF_EffectWorld / PF_LayerDef</a> in other pixel formats. Use the Premiere Pixel Format Suite (defined in the aptly-named PrSDKPixelFormatSuite.h) to get black and white values in those pixel formats.</p>
<p>After Effects functions such as <code>PF_BLEND()</code> have not been enhanced to work with pixel formats beyond 8-bit RGB.</p>
<hr />
<h2 id="ppro-bigger-differences-32-bit-float-support">32-Bit Float Support<a class="headerlink" href="#ppro-bigger-differences-32-bit-float-support" title="Permanent link">&para;</a></h2>
<p>Premiere Pro does not support After Effects 16-bit rendering or SmartFX. For 32-bit rendering in Premiere Pro, you'll need to declare support for one of the 32-bit pixel formats (see previous section), and then implement 32-bit rendering for <code>PF_Cmd_RENDER</code>. You can support multiple render depths this way. See the SDK Noise sample project for an example.</p>
<p>Depending on the clip(s) to which an effect is applied, 32-bit processing is not always necessary to preserve the quality of the source input. But there are settings to force 32-bit rendering, to give effects processing finer granularity and more headroom, if desired. Go to Settings&gt;Sequence Settings&gt; Video Previews&gt;Maximum Bit Depth, to control previewing from the timeline. For export to file, use Export Settings&gt;Video&gt;Basic Settings&gt;Render at Maximum Depth.</p>
<hr />
<h2 id="ppro-bigger-differences-pf_checkout_param-and-pixel-formats">PF_CHECKOUT_PARAM and Pixel Formats<a class="headerlink" href="#ppro-bigger-differences-pf_checkout_param-and-pixel-formats" title="Permanent link">&para;</a></h2>
<p>Before CS6, <code>PF_CHECKOUT_PARAM()</code> only returned 8-bit ARGB buffers, regardless of the pixel format currently being used for rendering. Starting in CS6, an effect can opt in to get frames in the same format as the render request, whether it is 32-bit float, YUV, etc.</p>
<p>Plug-ins may request this behavior, but existing plug-ins will continue working receiving 8-bit ARGB frames. The call is EffectWantsCheckedOutFramesToMatch RenderPixelFormat(), in the PF Utility Suite, defined in PrSDKAESupport.h. The call should be made on <code>PF_Cmd_GLOBAL_SETUP</code>, the same selector where an effect would already advertise support beyond 8-bit RGB using <code>AddSupportedPixelFormat()</code>.</p></section><section class="print-page" id="ppro-plug-ins-reloaded"><h1 id="ppro-plug-ins-reloaded-plug-ins-reloaded">Plug-Ins... Reloaded<a class="headerlink" href="#ppro-plug-ins-reloaded-plug-ins-reloaded" title="Permanent link">&para;</a></h1>
<p>On it's first launch, Premiere Pro loads all the plug-ins, reads the PiPL, and sends <code>PF_Cmd_GLOBAL_SETUP</code> to determine the plug-ins' capabilities. To save time on future application launches, it saves some of these capabilities in what we call the plug-in cache (the registry on Windows, a Property List file on macOS). The next time the application is launched, the cached information is used wherever possible, rather than loading the plug-ins.</p>
<p>When debugging, you can always force a reload of all the plug-ins by holding down the Shift key when launching Premiere Pro.</p>
<p>If your effect needs to be reloaded each time, there is a way to disable this caching. The plug-in can use the PF Cache On Load Suite in AE_CacheOnLoadSuite.h (from the <a href="http://ppro-plugin-sdk.aenhancers.com/">Premiere Pro SDK</a> headers) to call <code>PF_SetNoCacheOnLoad()</code> during <code>PF_Cmd_GLOBAL_SETUP</code>. For the second parameter of that function, pass a non-zero value if you want your effect to show up in the UI. Pass zero if loading failed, but you still want Premiere Pro to attempt to load it again on the next relaunch.</p>
<hr />
<h1 id="ppro-plug-ins-reloaded-effects-presets">Effects Presets<a class="headerlink" href="#ppro-plug-ins-reloaded-effects-presets" title="Permanent link">&para;</a></h1>
<p>Premiere Pro uses a different preset scheme than After Effects.</p>
<p>From the Premiere Pro SDK Guide:</p>
<p>Effect presets appear in the Presets bin in the Effects panel, and can be applied just like Effects with specific parameter settings and keyframes. Effect presets can be created as follows:</p>
<ol>
<li>Apply a filter to a clip</li>
<li>Set the parameters of the filter, adding keyframes if desired</li>
<li>Right-click on the filter name in the Effect Controls panel, and select "Save Preset..."</li>
<li>Create preset bins if desired by right-clicking in the Effects panel and choosing "New Presets Bin"</li>
<li>Organize the presets in the preset folders</li>
<li>Select the bins and/or presets you wish to export, right-click, and choose "Export Preset"</li>
</ol>
<p>Presets should be installed in the Plug-ins directory. Once they are installed in that directory, they will be read-only, and the user will not be able to move them to a different folder or change their names. User-created presets will be modifiable.</p>
<p>On Windows Vista, these are in the user's hidden AppData folder (e.g. <code>C:/Users/[user name]/AppData/Roaming/AdobePremiere Pro/[version]/Effect Presets and Custom Items.prfpset</code>).</p>
<p>On macOS, they are in the user folder, at <code>~/Library/Application Support/Adobe/Premiere Pro/[version]/Effect Presets and Custom Items.prfpset</code>.</p>
<hr />
<h1 id="ppro-plug-ins-reloaded-custom-ecw-ui-over-a-standard-data-type">Custom ECW UI Over A Standard Data Type<a class="headerlink" href="#ppro-plug-ins-reloaded-custom-ecw-ui-over-a-standard-data-type" title="Permanent link">&para;</a></h1>
<p>While this is logged as bug #1235407, there is a simple workaround: Create two separate parameters, and have the custom UI control the slider param using parameter supervision.</p></section><section class="print-page" id="ppro-premiere-elements"><h1 id="ppro-premiere-elements-premiere-elements">Premiere Elements<a class="headerlink" href="#ppro-premiere-elements-premiere-elements" title="Permanent link">&para;</a></h1>
<p>Premiere Elements (but not Premiere Pro) displays visual icons for each effect. You will need to provide icons for your effects, or else an empty black icon will be shown for your effects, or even worse behavior in Premiere Elements 8.</p>
<p>The icons are 60x45 PNG files, and are placed here:</p>
<p><code>/[Program Files]/Adobe/Adobe Premiere Elements [version]/Plug-in/Common/Effect/Previews/</code></p>
<p>The filename should be the match name of the effect, which you specify in the <a href="#intro-pipl-resources">PiPL Resources</a>, prefixed with "AE." So if the match name was "MatchName", then the filename should be "AE.MatchName.png"</p></section><section class="print-page" id="ppro-unsupported-features"><h1 id="ppro-unsupported-features-unsupported-features">Unsupported Features<a class="headerlink" href="#ppro-unsupported-features-unsupported-features" title="Permanent link">&para;</a></h1>
<p>Premiere Pro is currently known to not support the following features of the After Effects API:</p>
<p>(If you would like a feature with a "-" bullet, please email <a href="mailto:bbb@adobe.com">Premiere Pro API Engineering</a> with the feature request. Numbers preceded by an 'F' are feature request numbers, and the others are bug numbers)</p>
<ul>
<li>F7233 - extent_hint support</li>
<li>F7835 - Multiple PiPLs in a single plug-in</li>
<li>F7836 - AEGP support</li>
<li>F7517 - Audio support - if a plug-in sets PF_OutFlag_I_USE_AUDIO in PF_Cmd_GLOBAL_SETUP, it will not be loaded at all</li>
<li>F9355 - Support PF_ParamFlag_COLLAPSE_TWIRLY</li>
<li>PF World Transform Suite</li>
<li>PF AE Channel Suite</li>
<li>AE's implementation of high bit color depth support</li>
<li>SmartFX</li>
<li>3D support</li>
<li>PF_SUBPIXEL_SAMPLE(), PF_GET_PIXEL_DATA16()</li>
</ul>
<hr />
<h2 id="ppro-unsupported-features-but-whyd-you-load-it-if-you-cant-run-it">But... Why'd You LOAD It If You Can't RUN It?!<a class="headerlink" href="#ppro-unsupported-features-but-whyd-you-load-it-if-you-cant-run-it" title="Permanent link">&para;</a></h2>
<p>Premiere Pro attempts to load AEGP plug-ins. To detect this and avoid any problem behavior, your command hook function can access a suite which is only provided by After Effects; AEGP_CanvasSuite is a fine candidate.</p>
<p>If the suite isn't present, return an error. The plug-in will be placed on Premiere Pro's "don't load these" list.</p></section><section class="print-page" id="ppro-other-hosts"><h1 id="ppro-other-hosts-other-hosts">Other Hosts<a class="headerlink" href="#ppro-other-hosts-other-hosts" title="Permanent link">&para;</a></h1>
<p>For third-party hosts, the Adobe policy remains:</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>Adobe neither supports nor recommends the creation of Adobe-compatible third-party hosts. While it may be possible to create a partially functional host by reverse engineering from the plug-in API specification, we do not recommend it and will not support you in doing so.</p>
</div>
<hr />
<h2 id="ppro-other-hosts-reality-sandwich">Reality Sandwich<a class="headerlink" href="#ppro-other-hosts-reality-sandwich" title="Permanent link">&para;</a></h2>
<p>We realize that, for developers like you, one good way to grow your market is to ensure that your plug-ins work in as many hosts as possible.</p>
<p>Our SmartFX API has created quite a bit of distance between the After Effects API and the implementations available in the rest of the plug-in hosting world.</p>
<p>We will do what we can to help the other hosts support newer features. If you encounter problems in third party hosts, please refer them to us if they need assistance.</p></section><h1 class='nav-section-title-end'>Ended: Premiere Pro</h1></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      All content is copyright Adobe Systems Incorporated.
    </div>
  
  
    Made with
    <a
      href="https://squidfunk.github.io/mkdocs-material/"
      target="_blank" rel="noopener"
    >
      Material for MkDocs
    </a>
  
</div>

<!-- Print button -->
<div class="md-copyright">
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "/", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.copy", "search.highlight", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../_static/extra.js"></script>
      
        <script src="../docs/_global/js/global.js"></script>
      
    
  </body>
</html>